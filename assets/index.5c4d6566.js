(function(){const E=document.createElement("link").relList;if(E&&E.supports&&E.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))V(o);new MutationObserver(o=>{for(const q of o)if(q.type==="childList")for(const K of q.addedNodes)K.tagName==="LINK"&&K.rel==="modulepreload"&&V(K)}).observe(document,{childList:!0,subtree:!0});function P(o){const q={};return o.integrity&&(q.integrity=o.integrity),o.referrerpolicy&&(q.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?q.credentials="include":o.crossorigin==="anonymous"?q.credentials="omit":q.credentials="same-origin",q}function V(o){if(o.ep)return;o.ep=!0;const q=P(o);fetch(o.href,q)}})();function qg(C,E){return E.forEach(function(P){P&&typeof P!="string"&&!Array.isArray(P)&&Object.keys(P).forEach(function(V){if(V!=="default"&&!(V in C)){var o=Object.getOwnPropertyDescriptor(P,V);Object.defineProperty(C,V,o.get?o:{enumerable:!0,get:function(){return P[V]}})}})}),Object.freeze(C)}function zo(){}function HA(C,E){for(const P in E)C[P]=E[P];return C}function Zg(C){return C()}function fm(){return Object.create(null)}function VA(C){C.forEach(Zg)}function Pf(C){return typeof C=="function"}function Ua(C,E){return C!=C?E==E:C!==E||C&&typeof C=="object"||typeof C=="function"}function hu(C,E,P){C.$$.on_destroy.push(function(V,...o){if(V==null)return zo;const q=V.subscribe(...o);return q.unsubscribe?()=>q.unsubscribe():q}(E,P))}function mm(C,E,P,V){return C[1]&&V?HA(P.ctx.slice(),C[1](V(E))):P.ctx}function gm(C,E){const P={};E=new Set(E);for(const V in C)E.has(V)||V[0]==="$"||(P[V]=C[V]);return P}function $u(C){return C==null?"":C}function Np(C){return C&&Pf(C.destroy)?C.destroy:zo}function ar(C,E){C.appendChild(E)}function Di(C,E,P){C.insertBefore(E,P||null)}function Ci(C){C.parentNode.removeChild(C)}function Vc(C,E){for(let P=0;P<C.length;P+=1)C[P]&&C[P].d(E)}function wr(C){return document.createElement(C)}function Ap(C){return document.createElementNS("http://www.w3.org/2000/svg",C)}function dl(C){return document.createTextNode(C)}function to(){return dl(" ")}function fp(){return dl("")}function gn(C,E,P,V){return C.addEventListener(E,P,V),()=>C.removeEventListener(E,P,V)}function Dt(C,E,P){P==null?C.removeAttribute(E):C.getAttribute(E)!==P&&C.setAttribute(E,P)}function yd(C){return C===""?null:+C}function qu(C,E){E=""+E,C.wholeText!==E&&(C.data=E)}function Ku(C,E){C.value=E==null?"":E}function cp(C,E,P,V){P===null?C.style.removeProperty(E):C.style.setProperty(E,P,V?"important":"")}function _d(C,E){for(let P=0;P<C.options.length;P+=1){const V=C.options[P];if(V.__value===E)return void(V.selected=!0)}C.selectedIndex=-1}function Xg(C){const E=C.querySelector(":checked")||C.options[0];return E&&E.__value}let Yp,Hp;function w_(){if(Yp===void 0){Yp=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{Yp=!0}}return Yp}function vd(C,E,P){C.classList[P?"add":"remove"](E)}function Op(C){Hp=C}function Qf(){if(!Hp)throw new Error("Function called outside component initialization");return Hp}function Fd(C){Qf().$$.on_mount.push(C)}function Wg(C){Qf().$$.on_destroy.push(C)}function fc(){const C=Qf();return(E,P)=>{const V=C.$$.callbacks[E];if(V){const o=function(q,K,ae=!1){const Y=document.createEvent("CustomEvent");return Y.initCustomEvent(q,ae,!1,K),Y}(E,P);V.slice().forEach(q=>{q.call(C,o)})}}}function Tl(C,E){const P=C.$$.callbacks[E.type];P&&P.slice().forEach(V=>V.call(this,E))}const Rp=[],df=[],pd=[],ym=[],Jg=Promise.resolve();let ff=!1;function Yg(){ff||(ff=!0,Jg.then(ey))}function pp(C){pd.push(C)}const Nd=new Set;let ed=0;function ey(){const C=Hp;do{for(;ed<Rp.length;){const E=Rp[ed];ed++,Op(E),b_(E.$$)}for(Op(null),Rp.length=0,ed=0;df.length;)df.pop()();for(let E=0;E<pd.length;E+=1){const P=pd[E];Nd.has(P)||(Nd.add(P),P())}pd.length=0}while(Rp.length);for(;ym.length;)ym.pop()();ff=!1,Nd.clear(),Op(C)}function b_(C){if(C.fragment!==null){C.update(),VA(C.before_update);const E=C.dirty;C.dirty=[-1],C.fragment&&C.fragment.p(C.ctx,E),C.after_update.forEach(pp)}}const dd=new Set;let bh;function Ul(){bh={r:0,c:[],p:bh}}function Ml(){bh.r||VA(bh.c),bh=bh.p}function ti(C,E){C&&C.i&&(dd.delete(C),C.i(E))}function xi(C,E,P,V){if(C&&C.o){if(dd.has(C))return;dd.add(C),bh.c.push(()=>{dd.delete(C),V&&(P&&C.d(1),V())}),C.o(E)}}function du(C,E){const P={},V={},o={$$scope:1};let q=C.length;for(;q--;){const K=C[q],ae=E[q];if(ae){for(const Y in K)Y in ae||(V[Y]=1);for(const Y in ae)o[Y]||(P[Y]=ae[Y],o[Y]=1);C[q]=ae}else for(const Y in K)o[Y]=1}for(const K in V)K in P||(P[K]=void 0);return P}function Hc(C){return typeof C=="object"&&C!==null?C:{}}function qo(C){C&&C.c()}function Do(C,E,P,V){const{fragment:o,on_mount:q,on_destroy:K,after_update:ae}=C.$$;o&&o.m(E,P),V||pp(()=>{const Y=q.map(Zg).filter(Pf);K?K.push(...Y):VA(Y),C.$$.on_mount=[]}),ae.forEach(pp)}function Lo(C,E){const P=C.$$;P.fragment!==null&&(VA(P.on_destroy),P.fragment&&P.fragment.d(E),P.on_destroy=P.fragment=null,P.ctx=[])}function cs(C,E,P,V,o,q,K,ae=[-1]){const Y=Hp;Op(C);const ie=C.$$={fragment:null,ctx:null,props:q,update:zo,not_equal:o,bound:fm(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(E.context||(Y?Y.$$.context:[])),callbacks:fm(),dirty:ae,skip_bound:!1,root:E.target||Y.$$.root};K&&K(ie.root);let be=!1;if(ie.ctx=P?P(C,E.props||{},(ze,it,...tt)=>{const _t=tt.length?tt[0]:it;return ie.ctx&&o(ie.ctx[ze],ie.ctx[ze]=_t)&&(!ie.skip_bound&&ie.bound[ze]&&ie.bound[ze](_t),be&&function(yt,Bt){yt.$$.dirty[0]===-1&&(Rp.push(yt),Yg(),yt.$$.dirty.fill(0)),yt.$$.dirty[Bt/31|0]|=1<<Bt%31}(C,ze)),it}):[],ie.update(),be=!0,VA(ie.before_update),ie.fragment=!!V&&V(ie.ctx),E.target){if(E.hydrate){const ze=function(it){return Array.from(it.childNodes)}(E.target);ie.fragment&&ie.fragment.l(ze),ze.forEach(Ci)}else ie.fragment&&ie.fragment.c();E.intro&&ti(C.$$.fragment),Do(C,E.target,E.anchor,E.customElement),ey()}Op(Y)}class us{$destroy(){Lo(this,1),this.$destroy=zo}$on(E,P){const V=this.$$.callbacks[E]||(this.$$.callbacks[E]=[]);return V.push(P),()=>{const o=V.indexOf(P);o!==-1&&V.splice(o,1)}}$set(E){var P;this.$$set&&(P=E,Object.keys(P).length!==0)&&(this.$$.skip_bound=!0,this.$$set(E),this.$$.skip_bound=!1)}}var OA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function B_(C){if(C.__esModule)return C;var E=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(C).forEach(function(P){var V=Object.getOwnPropertyDescriptor(C,P);Object.defineProperty(E,P,V.get?V:{enumerable:!0,get:function(){return C[P]}})}),E}var ty={exports:{}},ry=ty.exports=function(){var C,E,P;function V(o,q){if(C)if(E){var K="var sharedChunk = {}; ("+C+")(sharedChunk); ("+E+")(sharedChunk);",ae={};C(ae),P=q(ae),typeof window<"u"&&(P.workerUrl=window.URL.createObjectURL(new Blob([K],{type:"text/javascript"})))}else E=q;else C=q}return V(["exports"],function(o){function q(e,n){return e(n={exports:{}},n.exports),n.exports}var K=ae;function ae(e,n,s,p){this.cx=3*e,this.bx=3*(s-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(p-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=p,this.p2x=s,this.p2y=p}ae.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},ae.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},ae.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},ae.prototype.solveCurveX=function(e,n){var s,p,g,x,T;for(n===void 0&&(n=1e-6),g=e,T=0;T<8;T++){if(x=this.sampleCurveX(g)-e,Math.abs(x)<n)return g;var D=this.sampleCurveDerivativeX(g);if(Math.abs(D)<1e-6)break;g-=x/D}if((g=e)<(s=0))return s;if(g>(p=1))return p;for(;s<p;){if(x=this.sampleCurveX(g),Math.abs(x-e)<n)return g;e>x?s=g:p=g,g=.5*(p-s)+s}return g},ae.prototype.solve=function(e,n){return this.sampleCurveY(this.solveCurveX(e,n))};var Y=ie;function ie(e,n){this.x=e,this.y=n}ie.prototype={clone:function(){return new ie(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,n){return this.clone()._rotateAround(e,n)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var n=e.x-this.x,s=e.y-this.y;return n*n+s*s},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,n){return Math.atan2(this.x*n-this.y*e,this.x*e+this.y*n)},_matMult:function(e){var n=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=n,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var n=Math.cos(e),s=Math.sin(e),p=s*this.x+n*this.y;return this.x=n*this.x-s*this.y,this.y=p,this},_rotateAround:function(e,n){var s=Math.cos(e),p=Math.sin(e),g=n.y+p*(this.x-n.x)+s*(this.y-n.y);return this.x=n.x+s*(this.x-n.x)-p*(this.y-n.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ie.convert=function(e){return e instanceof ie?e:Array.isArray(e)?new ie(e[0],e[1]):e};var be=typeof self<"u"?self:{},ze=Math.pow(2,53)-1;function it(e,n,s,p){var g=new K(e,n,s,p);return function(x){return g.solve(x)}}var tt=it(.25,.1,.25,1);function _t(e,n,s){return Math.min(s,Math.max(n,e))}function yt(e,n,s){var p=s-n,g=((e-n)%p+p)%p+n;return g===n?s:g}function Bt(e){for(var n=[],s=arguments.length-1;s-- >0;)n[s]=arguments[s+1];for(var p=0,g=n;p<g.length;p+=1){var x=g[p];for(var T in x)e[T]=x[T]}return e}var rt=1;function It(){return rt++}function gt(){return function e(n){return n?(n^16*Math.random()>>n/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function Zt(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function dr(e,n){e.forEach(function(s){n[s]&&(n[s]=n[s].bind(n))})}function Xr(e,n){return e.indexOf(n,e.length-n.length)!==-1}function ur(e,n,s){var p={};for(var g in e)p[g]=n.call(s||this,e[g],g,e);return p}function _r(e,n,s){var p={};for(var g in e)n.call(s||this,e[g],g,e)&&(p[g]=e[g]);return p}function Rr(e){return Array.isArray(e)?e.map(Rr):typeof e=="object"&&e?ur(e,Rr):e}var ei={};function rr(e){ei[e]||(typeof console<"u"&&console.warn(e),ei[e]=!0)}function kt(e,n,s){return(s.y-e.y)*(n.x-e.x)>(n.y-e.y)*(s.x-e.x)}function Rt(e){for(var n=0,s=0,p=e.length,g=p-1,x=void 0,T=void 0;s<p;g=s++)n+=((T=e[g]).x-(x=e[s]).x)*(x.y+T.y);return n}function br(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Or(e){var n={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(p,g,x,T){var D=x||T;return n[g]=!D||D.toLowerCase(),""}),n["max-age"]){var s=parseInt(n["max-age"],10);isNaN(s)?delete n["max-age"]:n["max-age"]=s}return n}var Kr=null;function di(e){if(Kr==null){var n=e.navigator?e.navigator.userAgent:null;Kr=!!e.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return Kr}function ri(e){try{var n=be[e];return n.setItem("_mapbox_test_",1),n.removeItem("_mapbox_test_"),!0}catch{return!1}}var ii,ki,kn,Zi,Bn=be.performance&&be.performance.now?be.performance.now.bind(be.performance):Date.now.bind(Date),la=be.requestAnimationFrame||be.mozRequestAnimationFrame||be.webkitRequestAnimationFrame||be.msRequestAnimationFrame,Xi=be.cancelAnimationFrame||be.mozCancelAnimationFrame||be.webkitCancelAnimationFrame||be.msCancelAnimationFrame,cn={now:Bn,frame:function(e){var n=la(e);return{cancel:function(){return Xi(n)}}},getImageData:function(e,n){n===void 0&&(n=0);var s=be.document.createElement("canvas"),p=s.getContext("2d");if(!p)throw new Error("failed to create canvas 2d context");return s.width=e.width,s.height=e.height,p.drawImage(e,0,0,e.width,e.height),p.getImageData(-n,-n,e.width+2*n,e.height+2*n)},resolveURL:function(e){return ii||(ii=be.document.createElement("a")),ii.href=e,ii.href},hardwareConcurrency:be.navigator&&be.navigator.hardwareConcurrency||4,get devicePixelRatio(){return be.devicePixelRatio},get prefersReducedMotion(){return!!be.matchMedia&&(ki==null&&(ki=be.matchMedia("(prefers-reduced-motion: reduce)")),ki.matches)}},wi={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Vi={supported:!1,testSupport:function(e){!Ln&&Zi&&(Wi?ni(e):kn=e)}},Ln=!1,Wi=!1;function ni(e){var n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,Zi),e.isContextLost())return;Vi.supported=!0}catch{}e.deleteTexture(n),Ln=!0}be.document&&((Zi=be.document.createElement("img")).onload=function(){kn&&ni(kn),kn=null,Wi=!0},Zi.onerror=function(){Ln=!0,kn=null},Zi.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var Pn="01",an=function(e,n){this._transformRequestFn=e,this._customAccessToken=n,this._createSkuToken()};function qn(e){return e.indexOf("mapbox:")===0}an.prototype._createSkuToken=function(){var e=function(){for(var n="",s=0;s<10;s++)n+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Pn,n].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},an.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},an.prototype.transformRequest=function(e,n){return this._transformRequestFn&&this._transformRequestFn(e,n)||{url:e}},an.prototype.normalizeStyleURL=function(e,n){if(!qn(e))return e;var s=Ri(e);return s.path="/styles/v1"+s.path,this._makeAPIURL(s,this._customAccessToken||n)},an.prototype.normalizeGlyphsURL=function(e,n){if(!qn(e))return e;var s=Ri(e);return s.path="/fonts/v1"+s.path,this._makeAPIURL(s,this._customAccessToken||n)},an.prototype.normalizeSourceURL=function(e,n){if(!qn(e))return e;var s=Ri(e);return s.path="/v4/"+s.authority+".json",s.params.push("secure"),this._makeAPIURL(s,this._customAccessToken||n)},an.prototype.normalizeSpriteURL=function(e,n,s,p){var g=Ri(e);return qn(e)?(g.path="/styles/v1"+g.path+"/sprite"+n+s,this._makeAPIURL(g,this._customAccessToken||p)):(g.path+=""+n+s,Hr(g))},an.prototype.normalizeTileURL=function(e,n){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!qn(e))return e;var s=Ri(e);s.path=s.path.replace(/(\.(png|jpg)\d*)(?=$)/,(cn.devicePixelRatio>=2||n===512?"@2x":"")+(Vi.supported?".webp":"$1")),s.path=s.path.replace(/^.+\/v4\//,"/"),s.path="/v4"+s.path;var p=this._customAccessToken||function(g){for(var x=0,T=g;x<T.length;x+=1){var D=T[x].match(/^access_token=(.*)$/);if(D)return D[1]}return null}(s.params)||wi.ACCESS_TOKEN;return wi.REQUIRE_ACCESS_TOKEN&&p&&this._skuToken&&s.params.push("sku="+this._skuToken),this._makeAPIURL(s,p)},an.prototype.canonicalizeTileURL=function(e,n){var s=Ri(e);if(!s.path.match(/(^\/v4\/)/)||!s.path.match(/\.[\w]+$/))return e;var p="mapbox://tiles/";p+=s.path.replace("/v4/","");var g=s.params;return n&&(g=g.filter(function(x){return!x.match(/^access_token=/)})),g.length&&(p+="?"+g.join("&")),p},an.prototype.canonicalizeTileset=function(e,n){for(var s=!!n&&qn(n),p=[],g=0,x=e.tiles||[];g<x.length;g+=1){var T=x[g];Wr(T)?p.push(this.canonicalizeTileURL(T,s)):p.push(T)}return p},an.prototype._makeAPIURL=function(e,n){var s="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",p=Ri(wi.API_URL);if(e.protocol=p.protocol,e.authority=p.authority,e.protocol==="http"){var g=e.params.indexOf("secure");g>=0&&e.params.splice(g,1)}if(p.path!=="/"&&(e.path=""+p.path+e.path),!wi.REQUIRE_ACCESS_TOKEN)return Hr(e);if(!(n=n||wi.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+s);if(n[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+s);return e.params=e.params.filter(function(x){return x.indexOf("access_token")===-1}),e.params.push("access_token="+n),Hr(e)};var un=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Wr(e){return un.test(e)}var Nn=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ri(e){var n=e.match(Nn);if(!n)throw new Error("Unable to parse URL object");return{protocol:n[1],authority:n[2],path:n[3]||"/",params:n[4]?n[4].split("&"):[]}}function Hr(e){var n=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+n}function Ji(e){if(!e)return null;var n=e.split(".");if(!n||n.length!==3)return null;try{return JSON.parse(decodeURIComponent(be.atob(n[1]).split("").map(function(s){return"%"+("00"+s.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var Cn=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Cn.prototype.getStorageKey=function(e){var n,s=Ji(wi.ACCESS_TOKEN);return n=s&&s.u?be.btoa(encodeURIComponent(s.u).replace(/%([0-9A-F]{2})/g,function(p,g){return String.fromCharCode(Number("0x"+g))})):wi.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+n:"mapbox.eventData:"+n},Cn.prototype.fetchEventData=function(){var e=ri("localStorage"),n=this.getStorageKey(),s=this.getStorageKey("uuid");if(e)try{var p=be.localStorage.getItem(n);p&&(this.eventData=JSON.parse(p));var g=be.localStorage.getItem(s);g&&(this.anonId=g)}catch{rr("Unable to read from LocalStorage")}},Cn.prototype.saveEventData=function(){var e=ri("localStorage"),n=this.getStorageKey(),s=this.getStorageKey("uuid");if(e)try{be.localStorage.setItem(s,this.anonId),Object.keys(this.eventData).length>=1&&be.localStorage.setItem(n,JSON.stringify(this.eventData))}catch{rr("Unable to write to LocalStorage")}},Cn.prototype.processRequests=function(e){},Cn.prototype.postEvent=function(e,n,s,p){var g=this;if(wi.EVENTS_URL){var x=Ri(wi.EVENTS_URL);x.params.push("access_token="+(p||wi.ACCESS_TOKEN||""));var T={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.2",skuId:Pn,userId:this.anonId},D=n?Bt(T,n):T,j={url:Hr(x),headers:{"Content-Type":"text/plain"},body:JSON.stringify([D])};this.pendingRequest=mi(j,function(ee){g.pendingRequest=null,s(ee),g.saveEventData(),g.processRequests(p)})}},Cn.prototype.queueRequest=function(e,n){this.queue.push(e),this.processRequests(n)};var $i,yn,En=function(e){function n(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.postMapLoadEvent=function(s,p,g,x){this.skuToken=g,(wi.EVENTS_URL&&x||wi.ACCESS_TOKEN&&Array.isArray(s)&&s.some(function(T){return qn(T)||Wr(T)}))&&this.queueRequest({id:p,timestamp:Date.now()},x)},n.prototype.processRequests=function(s){var p=this;if(!this.pendingRequest&&this.queue.length!==0){var g=this.queue.shift(),x=g.id,T=g.timestamp;x&&this.success[x]||(this.anonId||this.fetchEventData(),Zt(this.anonId)||(this.anonId=gt()),this.postEvent(T,{skuToken:this.skuToken},function(D){D||x&&(p.success[x]=!0)},s))}},n}(Cn),Ut=new(function(e){function n(s){e.call(this,"appUserTurnstile"),this._customAccessToken=s}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.postTurnstileEvent=function(s,p){wi.EVENTS_URL&&wi.ACCESS_TOKEN&&Array.isArray(s)&&s.some(function(g){return qn(g)||Wr(g)})&&this.queueRequest(Date.now(),p)},n.prototype.processRequests=function(s){var p=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var g=Ji(wi.ACCESS_TOKEN),x=g?g.u:wi.ACCESS_TOKEN,T=x!==this.eventData.tokenU;Zt(this.anonId)||(this.anonId=gt(),T=!0);var D=this.queue.shift();if(this.eventData.lastSuccess){var j=new Date(this.eventData.lastSuccess),ee=new Date(D),oe=(D-this.eventData.lastSuccess)/864e5;T=T||oe>=1||oe<-1||j.getDate()!==ee.getDate()}else T=!0;if(!T)return this.processRequests();this.postEvent(D,{"enabled.telemetry":!1},function(le){le||(p.eventData.lastSuccess=D,p.eventData.tokenU=x)},s)}},n}(Cn)),ir=Ut.postTurnstileEvent.bind(Ut),Ma=new En,lo=Ma.postMapLoadEvent.bind(Ma),bi=500,bo=50;function ro(){be.caches&&!$i&&($i=be.caches.open("mapbox-tiles"))}function Ao(e){var n=e.indexOf("?");return n<0?e:e.slice(0,n)}var Bo,er=1/0;function Vr(){return Bo==null&&(Bo=be.OffscreenCanvas&&new be.OffscreenCanvas(1,1).getContext("2d")&&typeof be.createImageBitmap=="function"),Bo}var Nr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Nr);var _n,Qn,Gr=function(e){function n(s,p,g){p===401&&Wr(g)&&(s+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,s),this.status=p,this.url=g,this.name=this.constructor.name,this.message=s}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},n}(Error),mo=br()?function(){return self.worker&&self.worker.referrer}:function(){return(be.location.protocol==="blob:"?be.parent:be).location.href},In=function(e,n){if(!(/^file:/.test(s=e.url)||/^file:/.test(mo())&&!/^\w+:/.test(s))){if(be.fetch&&be.Request&&be.AbortController&&be.Request.prototype.hasOwnProperty("signal"))return function(p,g){var x,T=new be.AbortController,D=new be.Request(p.url,{method:p.method||"GET",body:p.body,credentials:p.credentials,headers:p.headers,referrer:mo(),signal:T.signal}),j=!1,ee=!1,oe=(x=D.url).indexOf("sku=")>0&&Wr(x);p.type==="json"&&D.headers.set("Accept","application/json");var le=function(i,t,a){if(!ee){if(i&&i.message!=="SecurityError"&&rr(i),t&&a)return ye(t);var h=Date.now();be.fetch(D).then(function(f){if(f.ok){var v=oe?f.clone():null;return ye(f,v,h)}return g(new Gr(f.statusText,f.status,p.url))}).catch(function(f){f.code!==20&&g(new Error(f.message))})}},ye=function(i,t,a){(p.type==="arrayBuffer"?i.arrayBuffer():p.type==="json"?i.json():i.text()).then(function(h){ee||(t&&a&&function(f,v,w){if(ro(),$i){var k={status:v.status,statusText:v.statusText,headers:new be.Headers};v.headers.forEach(function(O,Z){return k.headers.set(Z,O)});var L=Or(v.headers.get("Cache-Control")||"");L["no-store"]||(L["max-age"]&&k.headers.set("Expires",new Date(w+1e3*L["max-age"]).toUTCString()),new Date(k.headers.get("Expires")).getTime()-w<42e4||function(O,Z){if(yn===void 0)try{new Response(new ReadableStream),yn=!0}catch{yn=!1}yn?Z(O.body):O.blob().then(Z)}(v,function(O){var Z=new be.Response(O,k);ro(),$i&&$i.then(function(re){return re.put(Ao(f.url),Z)}).catch(function(re){return rr(re.message)})}))}}(D,t,a),j=!0,g(null,h,i.headers.get("Cache-Control"),i.headers.get("Expires")))}).catch(function(h){ee||g(new Error(h.message))})};return oe?function(i,t){if(ro(),!$i)return t(null);var a=Ao(i.url);$i.then(function(h){h.match(a).then(function(f){var v=function(w){if(!w)return!1;var k=new Date(w.headers.get("Expires")||0),L=Or(w.headers.get("Cache-Control")||"");return k>Date.now()&&!L["no-cache"]}(f);h.delete(a),v&&h.put(a,f.clone()),t(null,f,v)}).catch(t)}).catch(t)}(D,le):le(null,null),{cancel:function(){ee=!0,j||T.abort()}}}(e,n);if(br()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,n,void 0,!0)}var s;return function(p,g){var x=new be.XMLHttpRequest;for(var T in x.open(p.method||"GET",p.url,!0),p.type==="arrayBuffer"&&(x.responseType="arraybuffer"),p.headers)x.setRequestHeader(T,p.headers[T]);return p.type==="json"&&(x.responseType="text",x.setRequestHeader("Accept","application/json")),x.withCredentials=p.credentials==="include",x.onerror=function(){g(new Error(x.statusText))},x.onload=function(){if((x.status>=200&&x.status<300||x.status===0)&&x.response!==null){var D=x.response;if(p.type==="json")try{D=JSON.parse(x.response)}catch(j){return g(j)}g(null,D,x.getResponseHeader("Cache-Control"),x.getResponseHeader("Expires"))}else g(new Gr(x.statusText,x.status,p.url))},x.send(p.body),{cancel:function(){return x.abort()}}}(e,n)},ka=function(e,n){return In(Bt(e,{type:"arrayBuffer"}),n)},mi=function(e,n){return In(Bt(e,{method:"POST"}),n)},ne="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";_n=[],Qn=0;var fe=function(e,n){if(Vi.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),Qn>=wi.MAX_PARALLEL_IMAGE_REQUESTS){var s={requestParameters:e,callback:n,cancelled:!1,cancel:function(){this.cancelled=!0}};return _n.push(s),s}Qn++;var p=!1,g=function(){if(!p)for(p=!0,Qn--;_n.length&&Qn<wi.MAX_PARALLEL_IMAGE_REQUESTS;){var T=_n.shift();T.cancelled||(T.cancel=fe(T.requestParameters,T.callback).cancel)}},x=ka(e,function(T,D,j,ee){g(),T?n(T):D&&(Vr()?function(oe,le){var ye=new be.Blob([new Uint8Array(oe)],{type:"image/png"});be.createImageBitmap(ye).then(function(i){le(null,i)}).catch(function(i){le(new Error("Could not load image because of "+i.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(D,n):function(oe,le,ye,i){var t=new be.Image,a=be.URL;t.onload=function(){le(null,t),a.revokeObjectURL(t.src),t.onload=null,be.requestAnimationFrame(function(){t.src=ne})},t.onerror=function(){return le(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var h=new be.Blob([new Uint8Array(oe)],{type:"image/png"});t.cacheControl=ye,t.expires=i,t.src=oe.byteLength?a.createObjectURL(h):ne}(D,n,j,ee))});return{cancel:function(){x.cancel(),g()}}};function xe(e,n,s){s[e]&&s[e].indexOf(n)!==-1||(s[e]=s[e]||[],s[e].push(n))}function Fe(e,n,s){if(s&&s[e]){var p=s[e].indexOf(n);p!==-1&&s[e].splice(p,1)}}var Re=function(e,n){n===void 0&&(n={}),Bt(this,n),this.type=e},We=function(e){function n(s,p){p===void 0&&(p={}),e.call(this,"error",Bt({error:s},p))}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n}(Re),st=function(){};st.prototype.on=function(e,n){return this._listeners=this._listeners||{},xe(e,n,this._listeners),this},st.prototype.off=function(e,n){return Fe(e,n,this._listeners),Fe(e,n,this._oneTimeListeners),this},st.prototype.once=function(e,n){return this._oneTimeListeners=this._oneTimeListeners||{},xe(e,n,this._oneTimeListeners),this},st.prototype.fire=function(e,n){typeof e=="string"&&(e=new Re(e,n||{}));var s=e.type;if(this.listens(s)){e.target=this;for(var p=0,g=this._listeners&&this._listeners[s]?this._listeners[s].slice():[];p<g.length;p+=1)g[p].call(this,e);for(var x=0,T=this._oneTimeListeners&&this._oneTimeListeners[s]?this._oneTimeListeners[s].slice():[];x<T.length;x+=1){var D=T[x];Fe(s,D,this._oneTimeListeners),D.call(this,e)}var j=this._eventedParent;j&&(Bt(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),j.fire(e))}else e instanceof We&&console.error(e.error);return this},st.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},st.prototype.setEventedParent=function(e,n){return this._eventedParent=e,this._eventedParentData=n,this};var Ee={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},X=function(e,n,s,p){this.message=(e?e+": ":"")+s,p&&(this.identifier=p),n!=null&&n.__line__&&(this.line=n.__line__)};function H(e){var n=e.value;return n?[new X(e.key,n,"constants have been deprecated as of v8")]:[]}function te(e){for(var n=[],s=arguments.length-1;s-- >0;)n[s]=arguments[s+1];for(var p=0,g=n;p<g.length;p+=1){var x=g[p];for(var T in x)e[T]=x[T]}return e}function pe(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function se(e){if(Array.isArray(e))return e.map(se);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var n={};for(var s in e)n[s]=se(e[s]);return n}return pe(e)}var Se=function(e){function n(s,p){e.call(this,p),this.message=p,this.key=s}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n}(Error),Ne=function(e,n){n===void 0&&(n=[]),this.parent=e,this.bindings={};for(var s=0,p=n;s<p.length;s+=1){var g=p[s];this.bindings[g[0]]=g[1]}};Ne.prototype.concat=function(e){return new Ne(this,e)},Ne.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},Ne.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var Me={kind:"null"},ve={kind:"number"},Oe={kind:"string"},Je={kind:"boolean"},ct={kind:"color"},we={kind:"object"},Pe={kind:"value"},dt={kind:"collator"},xt={kind:"formatted"},Lt={kind:"resolvedImage"};function zt(e,n){return{kind:"array",itemType:e,N:n}}function Jt(e){if(e.kind==="array"){var n=Jt(e.itemType);return typeof e.N=="number"?"array<"+n+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+n+">"}return e.kind}var or=[Me,ve,Oe,Je,ct,xt,we,zt(Pe),Lt];function Ar(e,n){if(n.kind==="error")return null;if(e.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!Ar(e.itemType,n.itemType))&&(typeof e.N!="number"||e.N===n.N))return null}else{if(e.kind===n.kind)return null;if(e.kind==="value"){for(var s=0,p=or;s<p.length;s+=1)if(!Ar(p[s],n))return null}}return"Expected "+Jt(e)+" but found "+Jt(n)+" instead."}function Br(e,n){return n.some(function(s){return s.kind===e.kind})}function vr(e,n){return n.some(function(s){return s==="null"?e===null:s==="array"?Array.isArray(e):s==="object"?e&&!Array.isArray(e)&&typeof e=="object":s===typeof e})}var Sr=q(function(e,n){var s={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function p(D){return(D=Math.round(D))<0?0:D>255?255:D}function g(D){return p(D[D.length-1]==="%"?parseFloat(D)/100*255:parseInt(D))}function x(D){return(j=D[D.length-1]==="%"?parseFloat(D)/100:parseFloat(D))<0?0:j>1?1:j;var j}function T(D,j,ee){return ee<0?ee+=1:ee>1&&(ee-=1),6*ee<1?D+(j-D)*ee*6:2*ee<1?j:3*ee<2?D+(j-D)*(2/3-ee)*6:D}try{n.parseCSSColor=function(D){var j,ee=D.replace(/ /g,"").toLowerCase();if(ee in s)return s[ee].slice();if(ee[0]==="#")return ee.length===4?(j=parseInt(ee.substr(1),16))>=0&&j<=4095?[(3840&j)>>4|(3840&j)>>8,240&j|(240&j)>>4,15&j|(15&j)<<4,1]:null:ee.length===7&&(j=parseInt(ee.substr(1),16))>=0&&j<=16777215?[(16711680&j)>>16,(65280&j)>>8,255&j,1]:null;var oe=ee.indexOf("("),le=ee.indexOf(")");if(oe!==-1&&le+1===ee.length){var ye=ee.substr(0,oe),i=ee.substr(oe+1,le-(oe+1)).split(","),t=1;switch(ye){case"rgba":if(i.length!==4)return null;t=x(i.pop());case"rgb":return i.length!==3?null:[g(i[0]),g(i[1]),g(i[2]),t];case"hsla":if(i.length!==4)return null;t=x(i.pop());case"hsl":if(i.length!==3)return null;var a=(parseFloat(i[0])%360+360)%360/360,h=x(i[1]),f=x(i[2]),v=f<=.5?f*(h+1):f+h-f*h,w=2*f-v;return[p(255*T(w,v,a+1/3)),p(255*T(w,v,a)),p(255*T(w,v,a-1/3)),t];default:return null}}return null}}catch{}}).parseCSSColor,Tr=function(e,n,s,p){p===void 0&&(p=1),this.r=e,this.g=n,this.b=s,this.a=p};Tr.parse=function(e){if(e){if(e instanceof Tr)return e;if(typeof e=="string"){var n=Sr(e);if(n)return new Tr(n[0]/255*n[3],n[1]/255*n[3],n[2]/255*n[3],n[3])}}},Tr.prototype.toString=function(){var e=this.toArray(),n=e[1],s=e[2],p=e[3];return"rgba("+Math.round(e[0])+","+Math.round(n)+","+Math.round(s)+","+p+")"},Tr.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},Tr.black=new Tr(0,0,0,1),Tr.white=new Tr(1,1,1,1),Tr.transparent=new Tr(0,0,0,0),Tr.red=new Tr(1,0,0,1);var li=function(e,n,s){this.sensitivity=e?n?"variant":"case":n?"accent":"base",this.locale=s,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};li.prototype.compare=function(e,n){return this.collator.compare(e,n)},li.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Co=function(e,n,s,p,g){this.text=e,this.image=n,this.scale=s,this.fontStack=p,this.textColor=g},Bi=function(e){this.sections=e};Bi.fromString=function(e){return new Bi([new Co(e,null,null,null,null)])},Bi.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},Bi.factory=function(e){return e instanceof Bi?e:Bi.fromString(e)},Bi.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},Bi.prototype.serialize=function(){for(var e=["format"],n=0,s=this.sections;n<s.length;n+=1){var p=s[n];if(p.image)e.push(["image",p.image.name]);else{e.push(p.text);var g={};p.fontStack&&(g["text-font"]=["literal",p.fontStack.split(",")]),p.scale&&(g["font-scale"]=p.scale),p.textColor&&(g["text-color"]=["rgba"].concat(p.textColor.toArray())),e.push(g)}}return e};var hi=function(e){this.name=e.name,this.available=e.available};function Na(e,n,s,p){return typeof e=="number"&&e>=0&&e<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof s=="number"&&s>=0&&s<=255?p===void 0||typeof p=="number"&&p>=0&&p<=1?null:"Invalid rgba value ["+[e,n,s,p].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof p=="number"?[e,n,s,p]:[e,n,s]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Pa(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof Tr||e instanceof li||e instanceof Bi||e instanceof hi)return!0;if(Array.isArray(e)){for(var n=0,s=e;n<s.length;n+=1)if(!Pa(s[n]))return!1;return!0}if(typeof e=="object"){for(var p in e)if(!Pa(e[p]))return!1;return!0}return!1}function zn(e){if(e===null)return Me;if(typeof e=="string")return Oe;if(typeof e=="boolean")return Je;if(typeof e=="number")return ve;if(e instanceof Tr)return ct;if(e instanceof li)return dt;if(e instanceof Bi)return xt;if(e instanceof hi)return Lt;if(Array.isArray(e)){for(var n,s=e.length,p=0,g=e;p<g.length;p+=1){var x=zn(g[p]);if(n){if(n===x)continue;n=Pe;break}n=x}return zt(n||Pe,s)}return we}function js(e){var n=typeof e;return e===null?"":n==="string"||n==="number"||n==="boolean"?String(e):e instanceof Tr||e instanceof Bi||e instanceof hi?e.toString():JSON.stringify(e)}hi.prototype.toString=function(){return this.name},hi.fromString=function(e){return e?new hi({name:e,available:!1}):null},hi.prototype.serialize=function(){return["image",this.name]};var Eo=function(e,n){this.type=e,this.value=n};Eo.parse=function(e,n){if(e.length!==2)return n.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!Pa(e[1]))return n.error("invalid value");var s=e[1],p=zn(s),g=n.expectedType;return p.kind!=="array"||p.N!==0||!g||g.kind!=="array"||typeof g.N=="number"&&g.N!==0||(p=g),new Eo(p,s)},Eo.prototype.evaluate=function(){return this.value},Eo.prototype.eachChild=function(){},Eo.prototype.outputDefined=function(){return!0},Eo.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Tr?["rgba"].concat(this.value.toArray()):this.value instanceof Bi?this.value.serialize():this.value};var fi=function(e){this.name="ExpressionEvaluationError",this.message=e};fi.prototype.toJSON=function(){return this.message};var vi={string:Oe,number:ve,boolean:Je,object:we},Ni=function(e,n){this.type=e,this.args=n};Ni.parse=function(e,n){if(e.length<2)return n.error("Expected at least one argument.");var s,p=1,g=e[0];if(g==="array"){var x,T;if(e.length>2){var D=e[1];if(typeof D!="string"||!(D in vi)||D==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);x=vi[D],p++}else x=Pe;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return n.error('The length argument to "array" must be a positive integer literal',2);T=e[2],p++}s=zt(x,T)}else s=vi[g];for(var j=[];p<e.length;p++){var ee=n.parse(e[p],p,Pe);if(!ee)return null;j.push(ee)}return new Ni(s,j)},Ni.prototype.evaluate=function(e){for(var n=0;n<this.args.length;n++){var s=this.args[n].evaluate(e);if(!Ar(this.type,zn(s)))return s;if(n===this.args.length-1)throw new fi("Expected value to be of type "+Jt(this.type)+", but found "+Jt(zn(s))+" instead.")}return null},Ni.prototype.eachChild=function(e){this.args.forEach(e)},Ni.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Ni.prototype.serialize=function(){var e=this.type,n=[e.kind];if(e.kind==="array"){var s=e.itemType;if(s.kind==="string"||s.kind==="number"||s.kind==="boolean"){n.push(s.kind);var p=e.N;(typeof p=="number"||this.args.length>1)&&n.push(p)}}return n.concat(this.args.map(function(g){return g.serialize()}))};var go=function(e){this.type=xt,this.sections=e};go.parse=function(e,n){if(e.length<2)return n.error("Expected at least one argument.");var s=e[1];if(!Array.isArray(s)&&typeof s=="object")return n.error("First argument must be an image or text section.");for(var p=[],g=!1,x=1;x<=e.length-1;++x){var T=e[x];if(g&&typeof T=="object"&&!Array.isArray(T)){g=!1;var D=null;if(T["font-scale"]&&!(D=n.parse(T["font-scale"],1,ve)))return null;var j=null;if(T["text-font"]&&!(j=n.parse(T["text-font"],1,zt(Oe))))return null;var ee=null;if(T["text-color"]&&!(ee=n.parse(T["text-color"],1,ct)))return null;var oe=p[p.length-1];oe.scale=D,oe.font=j,oe.textColor=ee}else{var le=n.parse(e[x],1,Pe);if(!le)return null;var ye=le.type.kind;if(ye!=="string"&&ye!=="value"&&ye!=="null"&&ye!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");g=!0,p.push({content:le,scale:null,font:null,textColor:null})}}return new go(p)},go.prototype.evaluate=function(e){return new Bi(this.sections.map(function(n){var s=n.content.evaluate(e);return zn(s)===Lt?new Co("",s,null,null,null):new Co(js(s),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null)}))},go.prototype.eachChild=function(e){for(var n=0,s=this.sections;n<s.length;n+=1){var p=s[n];e(p.content),p.scale&&e(p.scale),p.font&&e(p.font),p.textColor&&e(p.textColor)}},go.prototype.outputDefined=function(){return!1},go.prototype.serialize=function(){for(var e=["format"],n=0,s=this.sections;n<s.length;n+=1){var p=s[n];e.push(p.content.serialize());var g={};p.scale&&(g["font-scale"]=p.scale.serialize()),p.font&&(g["text-font"]=p.font.serialize()),p.textColor&&(g["text-color"]=p.textColor.serialize()),e.push(g)}return e};var Uo=function(e){this.type=Lt,this.input=e};Uo.parse=function(e,n){if(e.length!==2)return n.error("Expected two arguments.");var s=n.parse(e[1],1,Oe);return s?new Uo(s):n.error("No image name provided.")},Uo.prototype.evaluate=function(e){var n=this.input.evaluate(e),s=hi.fromString(n);return s&&e.availableImages&&(s.available=e.availableImages.indexOf(n)>-1),s},Uo.prototype.eachChild=function(e){e(this.input)},Uo.prototype.outputDefined=function(){return!1},Uo.prototype.serialize=function(){return["image",this.input.serialize()]};var ea={"to-boolean":Je,"to-color":ct,"to-number":ve,"to-string":Oe},Dn=function(e,n){this.type=e,this.args=n};Dn.parse=function(e,n){if(e.length<2)return n.error("Expected at least one argument.");var s=e[0];if((s==="to-boolean"||s==="to-string")&&e.length!==2)return n.error("Expected one argument.");for(var p=ea[s],g=[],x=1;x<e.length;x++){var T=n.parse(e[x],x,Pe);if(!T)return null;g.push(T)}return new Dn(p,g)},Dn.prototype.evaluate=function(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){for(var n,s,p=0,g=this.args;p<g.length;p+=1){if(s=null,(n=g[p].evaluate(e))instanceof Tr)return n;if(typeof n=="string"){var x=e.parseColor(n);if(x)return x}else if(Array.isArray(n)&&!(s=n.length<3||n.length>4?"Invalid rbga value "+JSON.stringify(n)+": expected an array containing either three or four numeric values.":Na(n[0],n[1],n[2],n[3])))return new Tr(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new fi(s||"Could not parse color from value '"+(typeof n=="string"?n:String(JSON.stringify(n)))+"'")}if(this.type.kind==="number"){for(var T=null,D=0,j=this.args;D<j.length;D+=1){if((T=j[D].evaluate(e))===null)return 0;var ee=Number(T);if(!isNaN(ee))return ee}throw new fi("Could not convert "+JSON.stringify(T)+" to number.")}return this.type.kind==="formatted"?Bi.fromString(js(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?hi.fromString(js(this.args[0].evaluate(e))):js(this.args[0].evaluate(e))},Dn.prototype.eachChild=function(e){this.args.forEach(e)},Dn.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Dn.prototype.serialize=function(){if(this.type.kind==="formatted")return new go([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Uo(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(n){e.push(n.serialize())}),e};var Aa=["Unknown","Point","LineString","Polygon"],co=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};co.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},co.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Aa[this.feature.type]:this.feature.type:null},co.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},co.prototype.canonicalID=function(){return this.canonical},co.prototype.properties=function(){return this.feature&&this.feature.properties||{}},co.prototype.parseColor=function(e){var n=this._parseColorCache[e];return n||(n=this._parseColorCache[e]=Tr.parse(e)),n};var hn=function(e,n,s,p){this.name=e,this.type=n,this._evaluate=s,this.args=p};hn.prototype.evaluate=function(e){return this._evaluate(e,this.args)},hn.prototype.eachChild=function(e){this.args.forEach(e)},hn.prototype.outputDefined=function(){return!1},hn.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},hn.parse=function(e,n){var s,p=e[0],g=hn.definitions[p];if(!g)return n.error('Unknown expression "'+p+'". If you wanted a literal array, use ["literal", [...]].',0);for(var x=Array.isArray(g)?g[0]:g.type,T=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,D=T.filter(function(me){var Ue=me[0];return!Array.isArray(Ue)||Ue.length===e.length-1}),j=null,ee=0,oe=D;ee<oe.length;ee+=1){var le=oe[ee],ye=le[0],i=le[1];j=new Ga(n.registry,n.path,null,n.scope);for(var t=[],a=!1,h=1;h<e.length;h++){var f=e[h],v=Array.isArray(ye)?ye[h-1]:ye.type,w=j.parse(f,1+t.length,v);if(!w){a=!0;break}t.push(w)}if(!a)if(Array.isArray(ye)&&ye.length!==t.length)j.error("Expected "+ye.length+" arguments, but found "+t.length+" instead.");else{for(var k=0;k<t.length;k++){var L=Array.isArray(ye)?ye[k]:ye.type,O=t[k];j.concat(k+1).checkSubtype(L,O.type)}if(j.errors.length===0)return new hn(p,x,i,t)}}if(D.length===1)(s=n.errors).push.apply(s,j.errors);else{for(var Z=(D.length?D:T).map(function(me){var Ue;return Ue=me[0],Array.isArray(Ue)?"("+Ue.map(Jt).join(", ")+")":"("+Jt(Ue.type)+"...)"}).join(" | "),re=[],he=1;he<e.length;he++){var de=n.parse(e[he],1+re.length);if(!de)return null;re.push(Jt(de.type))}n.error("Expected arguments of type "+Z+", but found ("+re.join(", ")+") instead.")}return null},hn.register=function(e,n){for(var s in hn.definitions=n,n)e[s]=hn};var Io=function(e,n,s){this.type=dt,this.locale=s,this.caseSensitive=e,this.diacriticSensitive=n};function Sn(e,n){e[0]=Math.min(e[0],n[0]),e[1]=Math.min(e[1],n[1]),e[2]=Math.max(e[2],n[0]),e[3]=Math.max(e[3],n[1])}function Ka(e,n){return!(e[0]<=n[0]||e[2]>=n[2]||e[1]<=n[1]||e[3]>=n[3])}function Qa(e,n){var s=(180+e[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,g=Math.pow(2,n.z);return[Math.round(s*g*8192),Math.round(p*g*8192)]}function Fs(e,n,s){return n[1]>e[1]!=s[1]>e[1]&&e[0]<(s[0]-n[0])*(e[1]-n[1])/(s[1]-n[1])+n[0]}function pn(e,n){for(var s,p,g,x,T,D,j,ee=!1,oe=0,le=n.length;oe<le;oe++)for(var ye=n[oe],i=0,t=ye.length;i<t-1;i++){if((x=(s=e)[0]-(p=ye[i])[0])*(j=s[1]-(g=ye[i+1])[1])-(D=s[0]-g[0])*(T=s[1]-p[1])==0&&x*D<=0&&T*j<=0)return!1;Fs(e,ye[i],ye[i+1])&&(ee=!ee)}return ee}function hs(e,n){for(var s=0;s<n.length;s++)if(pn(e,n[s]))return!0;return!1}function kl(e,n,s,p){var g=p[0]-s[0],x=p[1]-s[1],T=(e[0]-s[0])*x-g*(e[1]-s[1]),D=(n[0]-s[0])*x-g*(n[1]-s[1]);return T>0&&D<0||T<0&&D>0}function fl(e,n,s){for(var p=0,g=s;p<g.length;p+=1)for(var x=g[p],T=0;T<x.length-1;++T)if((le=[(oe=x[T+1])[0]-(ee=x[T])[0],oe[1]-ee[1]])[0]*(ye=[(j=n)[0]-(D=e)[0],j[1]-D[1]])[1]-le[1]*ye[0]!=0&&kl(D,j,ee,oe)&&kl(ee,oe,D,j))return!0;var D,j,ee,oe,le,ye;return!1}function Us(e,n){for(var s=0;s<e.length;++s)if(!pn(e[s],n))return!1;for(var p=0;p<e.length-1;++p)if(fl(e[p],e[p+1],n))return!1;return!0}function ya(e,n){for(var s=0;s<n.length;s++)if(Us(e,n[s]))return!0;return!1}function $s(e,n,s){for(var p=[],g=0;g<e.length;g++){for(var x=[],T=0;T<e[g].length;T++){var D=Qa(e[g][T],s);Sn(n,D),x.push(D)}p.push(x)}return p}function vA(e,n,s){for(var p=[],g=0;g<e.length;g++){var x=$s(e[g],n,s);p.push(x)}return p}function Pl(e,n,s,p){if(e[0]<s[0]||e[0]>s[2]){var g=.5*p,x=e[0]-s[0]>g?-p:s[0]-e[0]>g?p:0;x===0&&(x=e[0]-s[2]>g?-p:s[2]-e[0]>g?p:0),e[0]+=x}Sn(n,e)}function xA(e,n,s,p){for(var g=8192*Math.pow(2,p.z),x=[8192*p.x,8192*p.y],T=[],D=0,j=e;D<j.length;D+=1)for(var ee=0,oe=j[D];ee<oe.length;ee+=1){var le=oe[ee],ye=[le.x+x[0],le.y+x[1]];Pl(ye,n,s,g),T.push(ye)}return T}function Ql(e,n,s,p){for(var g,x=8192*Math.pow(2,p.z),T=[8192*p.x,8192*p.y],D=[],j=0,ee=e;j<ee.length;j+=1){for(var oe=[],le=0,ye=ee[j];le<ye.length;le+=1){var i=ye[le],t=[i.x+T[0],i.y+T[1]];Sn(n,t),oe.push(t)}D.push(oe)}if(n[2]-n[0]<=x/2){(g=n)[0]=g[1]=1/0,g[2]=g[3]=-1/0;for(var a=0,h=D;a<h.length;a+=1)for(var f=0,v=h[a];f<v.length;f+=1)Pl(v[f],n,s,x)}return D}Io.parse=function(e,n){if(e.length!==2)return n.error("Expected one argument.");var s=e[1];if(typeof s!="object"||Array.isArray(s))return n.error("Collator options argument must be an object.");var p=n.parse(s["case-sensitive"]!==void 0&&s["case-sensitive"],1,Je);if(!p)return null;var g=n.parse(s["diacritic-sensitive"]!==void 0&&s["diacritic-sensitive"],1,Je);if(!g)return null;var x=null;return s.locale&&!(x=n.parse(s.locale,1,Oe))?null:new Io(p,g,x)},Io.prototype.evaluate=function(e){return new li(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},Io.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},Io.prototype.outputDefined=function(){return!1},Io.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var _a=function(e,n){this.type=Je,this.geojson=e,this.geometries=n};function Ya(e){if(e instanceof hn&&(e.name==="get"&&e.args.length===1||e.name==="feature-state"||e.name==="has"&&e.args.length===1||e.name==="properties"||e.name==="geometry-type"||e.name==="id"||/^filter-/.test(e.name))||e instanceof _a)return!1;var n=!0;return e.eachChild(function(s){n&&!Ya(s)&&(n=!1)}),n}function Ti(e){if(e instanceof hn&&e.name==="feature-state")return!1;var n=!0;return e.eachChild(function(s){n&&!Ti(s)&&(n=!1)}),n}function Ms(e,n){if(e instanceof hn&&n.indexOf(e.name)>=0)return!1;var s=!0;return e.eachChild(function(p){s&&!Ms(p,n)&&(s=!1)}),s}_a.parse=function(e,n){if(e.length!==2)return n.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(Pa(e[1])){var s=e[1];if(s.type==="FeatureCollection")for(var p=0;p<s.features.length;++p){var g=s.features[p].geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new _a(s,s.features[p].geometry)}else if(s.type==="Feature"){var x=s.geometry.type;if(x==="Polygon"||x==="MultiPolygon")return new _a(s,s.geometry)}else if(s.type==="Polygon"||s.type==="MultiPolygon")return new _a(s,s)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")},_a.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(n,s){var p=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],x=n.canonicalID();if(s.type==="Polygon"){var T=$s(s.coordinates,g,x),D=xA(n.geometry(),p,g,x);if(!Ka(p,g))return!1;for(var j=0,ee=D;j<ee.length;j+=1)if(!pn(ee[j],T))return!1}if(s.type==="MultiPolygon"){var oe=vA(s.coordinates,g,x),le=xA(n.geometry(),p,g,x);if(!Ka(p,g))return!1;for(var ye=0,i=le;ye<i.length;ye+=1)if(!hs(i[ye],oe))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(n,s){var p=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],x=n.canonicalID();if(s.type==="Polygon"){var T=$s(s.coordinates,g,x),D=Ql(n.geometry(),p,g,x);if(!Ka(p,g))return!1;for(var j=0,ee=D;j<ee.length;j+=1)if(!Us(ee[j],T))return!1}if(s.type==="MultiPolygon"){var oe=vA(s.coordinates,g,x),le=Ql(n.geometry(),p,g,x);if(!Ka(p,g))return!1;for(var ye=0,i=le;ye<i.length;ye+=1)if(!ya(i[ye],oe))return!1}return!0}(e,this.geometries)}return!1},_a.prototype.eachChild=function(){},_a.prototype.outputDefined=function(){return!0},_a.prototype.serialize=function(){return["within",this.geojson]};var qs=function(e,n){this.type=n.type,this.name=e,this.boundExpression=n};qs.parse=function(e,n){if(e.length!==2||typeof e[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");var s=e[1];return n.scope.has(s)?new qs(s,n.scope.get(s)):n.error('Unknown variable "'+s+'". Make sure "'+s+'" has been bound in an enclosing "let" expression before using it.',1)},qs.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},qs.prototype.eachChild=function(){},qs.prototype.outputDefined=function(){return!1},qs.prototype.serialize=function(){return["var",this.name]};var Ga=function(e,n,s,p,g){n===void 0&&(n=[]),p===void 0&&(p=new Ne),g===void 0&&(g=[]),this.registry=e,this.path=n,this.key=n.map(function(x){return"["+x+"]"}).join(""),this.scope=p,this.errors=g,this.expectedType=s};function uo(e,n){for(var s,p=e.length-1,g=0,x=p,T=0;g<=x;)if((s=e[T=Math.floor((g+x)/2)])<=n){if(T===p||n<e[T+1])return T;g=T+1}else{if(!(s>n))throw new fi("Input is not a number.");x=T-1}return 0}Ga.prototype.parse=function(e,n,s,p,g){return g===void 0&&(g={}),n?this.concat(n,s,p)._parse(e,g):this._parse(e,g)},Ga.prototype._parse=function(e,n){function s(ee,oe,le){return le==="assert"?new Ni(oe,[ee]):le==="coerce"?new Dn(oe,[ee]):ee}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var p=e[0];if(typeof p!="string")return this.error("Expression name must be a string, but found "+typeof p+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var g=this.registry[p];if(g){var x=g.parse(e,this);if(!x)return null;if(this.expectedType){var T=this.expectedType,D=x.type;if(T.kind!=="string"&&T.kind!=="number"&&T.kind!=="boolean"&&T.kind!=="object"&&T.kind!=="array"||D.kind!=="value")if(T.kind!=="color"&&T.kind!=="formatted"&&T.kind!=="resolvedImage"||D.kind!=="value"&&D.kind!=="string"){if(this.checkSubtype(T,D))return null}else x=s(x,T,n.typeAnnotation||"coerce");else x=s(x,T,n.typeAnnotation||"assert")}if(!(x instanceof Eo)&&x.type.kind!=="resolvedImage"&&function ee(oe){if(oe instanceof qs)return ee(oe.boundExpression);if(oe instanceof hn&&oe.name==="error"||oe instanceof Io||oe instanceof _a)return!1;var le=oe instanceof Dn||oe instanceof Ni,ye=!0;return oe.eachChild(function(i){ye=le?ye&&ee(i):ye&&i instanceof Eo}),!!ye&&Ya(oe)&&Ms(oe,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(x)){var j=new co;try{x=new Eo(x.type,x.evaluate(j))}catch(ee){return this.error(ee.message),null}}return x}return this.error('Unknown expression "'+p+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},Ga.prototype.concat=function(e,n,s){var p=typeof e=="number"?this.path.concat(e):this.path,g=s?this.scope.concat(s):this.scope;return new Ga(this.registry,p,n||null,g,this.errors)},Ga.prototype.error=function(e){for(var n=[],s=arguments.length-1;s-- >0;)n[s]=arguments[s+1];var p=""+this.key+n.map(function(g){return"["+g+"]"}).join("");this.errors.push(new Se(p,e))},Ga.prototype.checkSubtype=function(e,n){var s=Ar(e,n);return s&&this.error(s),s};var ca=function(e,n,s){this.type=e,this.input=n,this.labels=[],this.outputs=[];for(var p=0,g=s;p<g.length;p+=1){var x=g[p],T=x[1];this.labels.push(x[0]),this.outputs.push(T)}};function Li(e,n,s){return e*(1-s)+n*s}ca.parse=function(e,n){if(e.length-1<4)return n.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");var s=n.parse(e[1],1,ve);if(!s)return null;var p=[],g=null;n.expectedType&&n.expectedType.kind!=="value"&&(g=n.expectedType);for(var x=1;x<e.length;x+=2){var T=x===1?-1/0:e[x],D=e[x+1],j=x,ee=x+1;if(typeof T!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(p.length&&p[p.length-1][0]>=T)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',j);var oe=n.parse(D,ee,g);if(!oe)return null;g=g||oe.type,p.push([T,oe])}return new ca(g,s,p)},ca.prototype.evaluate=function(e){var n=this.labels,s=this.outputs;if(n.length===1)return s[0].evaluate(e);var p=this.input.evaluate(e);if(p<=n[0])return s[0].evaluate(e);var g=n.length;return p>=n[g-1]?s[g-1].evaluate(e):s[uo(n,p)].evaluate(e)},ca.prototype.eachChild=function(e){e(this.input);for(var n=0,s=this.outputs;n<s.length;n+=1)e(s[n])},ca.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},ca.prototype.serialize=function(){for(var e=["step",this.input.serialize()],n=0;n<this.labels.length;n++)n>0&&e.push(this.labels[n]),e.push(this.outputs[n].serialize());return e};var Zs=Object.freeze({__proto__:null,number:Li,color:function(e,n,s){return new Tr(Li(e.r,n.r,s),Li(e.g,n.g,s),Li(e.b,n.b,s),Li(e.a,n.a,s))},array:function(e,n,s){return e.map(function(p,g){return Li(p,n[g],s)})}}),Yl=6/29*3*(6/29),wA=Math.PI/180,NA=180/Math.PI;function Xs(e){return e>.008856451679035631?Math.pow(e,1/3):e/Yl+4/29}function ks(e){return e>6/29?e*e*e:Yl*(e-4/29)}function Dl(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function eA(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function ja(e){var n=eA(e.r),s=eA(e.g),p=eA(e.b),g=Xs((.4124564*n+.3575761*s+.1804375*p)/.95047),x=Xs((.2126729*n+.7151522*s+.072175*p)/1);return{l:116*x-16,a:500*(g-x),b:200*(x-Xs((.0193339*n+.119192*s+.9503041*p)/1.08883)),alpha:e.a}}function Ll(e){var n=(e.l+16)/116,s=isNaN(e.a)?n:n+e.a/500,p=isNaN(e.b)?n:n-e.b/200;return n=1*ks(n),s=.95047*ks(s),p=1.08883*ks(p),new Tr(Dl(3.2404542*s-1.5371385*n-.4985314*p),Dl(-.969266*s+1.8760108*n+.041556*p),Dl(.0556434*s-.2040259*n+1.0572252*p),e.alpha)}function bA(e,n,s){var p=n-e;return e+s*(p>180||p<-180?p-360*Math.round(p/360):p)}var ps={forward:ja,reverse:Ll,interpolate:function(e,n,s){return{l:Li(e.l,n.l,s),a:Li(e.a,n.a,s),b:Li(e.b,n.b,s),alpha:Li(e.alpha,n.alpha,s)}}},tA={forward:function(e){var n=ja(e),s=n.l,p=n.a,g=n.b,x=Math.atan2(g,p)*NA;return{h:x<0?x+360:x,c:Math.sqrt(p*p+g*g),l:s,alpha:e.a}},reverse:function(e){var n=e.h*wA,s=e.c;return Ll({l:e.l,a:Math.cos(n)*s,b:Math.sin(n)*s,alpha:e.alpha})},interpolate:function(e,n,s){return{h:bA(e.h,n.h,s),c:Li(e.c,n.c,s),l:Li(e.l,n.l,s),alpha:Li(e.alpha,n.alpha,s)}}},mc=Object.freeze({__proto__:null,lab:ps,hcl:tA}),Ro=function(e,n,s,p,g){this.type=e,this.operator=n,this.interpolation=s,this.input=p,this.labels=[],this.outputs=[];for(var x=0,T=g;x<T.length;x+=1){var D=T[x],j=D[1];this.labels.push(D[0]),this.outputs.push(j)}};function KA(e,n,s,p){var g=p-s,x=e-s;return g===0?0:n===1?x/g:(Math.pow(n,x)-1)/(Math.pow(n,g)-1)}Ro.interpolationFactor=function(e,n,s,p){var g=0;if(e.name==="exponential")g=KA(n,e.base,s,p);else if(e.name==="linear")g=KA(n,1,s,p);else if(e.name==="cubic-bezier"){var x=e.controlPoints;g=new K(x[0],x[1],x[2],x[3]).solve(KA(n,1,s,p))}return g},Ro.parse=function(e,n){var s=e[0],p=e[1],g=e[2],x=e.slice(3);if(!Array.isArray(p)||p.length===0)return n.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){var T=p[1];if(typeof T!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:T}}else{if(p[0]!=="cubic-bezier")return n.error("Unknown interpolation type "+String(p[0]),1,0);var D=p.slice(1);if(D.length!==4||D.some(function(h){return typeof h!="number"||h<0||h>1}))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:D}}if(e.length-1<4)return n.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(!(g=n.parse(g,2,ve)))return null;var j=[],ee=null;s==="interpolate-hcl"||s==="interpolate-lab"?ee=ct:n.expectedType&&n.expectedType.kind!=="value"&&(ee=n.expectedType);for(var oe=0;oe<x.length;oe+=2){var le=x[oe],ye=x[oe+1],i=oe+3,t=oe+4;if(typeof le!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',i);if(j.length&&j[j.length-1][0]>=le)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',i);var a=n.parse(ye,t,ee);if(!a)return null;ee=ee||a.type,j.push([le,a])}return ee.kind==="number"||ee.kind==="color"||ee.kind==="array"&&ee.itemType.kind==="number"&&typeof ee.N=="number"?new Ro(ee,s,p,g,j):n.error("Type "+Jt(ee)+" is not interpolatable.")},Ro.prototype.evaluate=function(e){var n=this.labels,s=this.outputs;if(n.length===1)return s[0].evaluate(e);var p=this.input.evaluate(e);if(p<=n[0])return s[0].evaluate(e);var g=n.length;if(p>=n[g-1])return s[g-1].evaluate(e);var x=uo(n,p),T=Ro.interpolationFactor(this.interpolation,p,n[x],n[x+1]),D=s[x].evaluate(e),j=s[x+1].evaluate(e);return this.operator==="interpolate"?Zs[this.type.kind.toLowerCase()](D,j,T):this.operator==="interpolate-hcl"?tA.reverse(tA.interpolate(tA.forward(D),tA.forward(j),T)):ps.reverse(ps.interpolate(ps.forward(D),ps.forward(j),T))},Ro.prototype.eachChild=function(e){e(this.input);for(var n=0,s=this.outputs;n<s.length;n+=1)e(s[n])},Ro.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Ro.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var n=[this.operator,e,this.input.serialize()],s=0;s<this.labels.length;s++)n.push(this.labels[s],this.outputs[s].serialize());return n};var Ws=function(e,n){this.type=e,this.args=n};Ws.parse=function(e,n){if(e.length<2)return n.error("Expectected at least one argument.");var s=null,p=n.expectedType;p&&p.kind!=="value"&&(s=p);for(var g=[],x=0,T=e.slice(1);x<T.length;x+=1){var D=n.parse(T[x],1+g.length,s,void 0,{typeAnnotation:"omit"});if(!D)return null;s=s||D.type,g.push(D)}var j=p&&g.some(function(ee){return Ar(p,ee.type)});return new Ws(j?Pe:s,g)},Ws.prototype.evaluate=function(e){for(var n,s=null,p=0,g=0,x=this.args;g<x.length&&(p++,(s=x[g].evaluate(e))&&s instanceof hi&&!s.available&&(n||(n=s.name),s=null,p===this.args.length&&(s=n)),s===null);g+=1);return s},Ws.prototype.eachChild=function(e){this.args.forEach(e)},Ws.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Ws.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(n){e.push(n.serialize())}),e};var Js=function(e,n){this.type=n.type,this.bindings=[].concat(e),this.result=n};Js.prototype.evaluate=function(e){return this.result.evaluate(e)},Js.prototype.eachChild=function(e){for(var n=0,s=this.bindings;n<s.length;n+=1)e(s[n][1]);e(this.result)},Js.parse=function(e,n){if(e.length<4)return n.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var s=[],p=1;p<e.length-1;p+=2){var g=e[p];if(typeof g!="string")return n.error("Expected string, but found "+typeof g+" instead.",p);if(/[^a-zA-Z0-9_]/.test(g))return n.error("Variable names must contain only alphanumeric characters or '_'.",p);var x=n.parse(e[p+1],p+1);if(!x)return null;s.push([g,x])}var T=n.parse(e[e.length-1],e.length-1,n.expectedType,s);return T?new Js(s,T):null},Js.prototype.outputDefined=function(){return this.result.outputDefined()},Js.prototype.serialize=function(){for(var e=["let"],n=0,s=this.bindings;n<s.length;n+=1){var p=s[n];e.push(p[0],p[1].serialize())}return e.push(this.result.serialize()),e};var Ps=function(e,n,s){this.type=e,this.index=n,this.input=s};Ps.parse=function(e,n){if(e.length!==3)return n.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var s=n.parse(e[1],1,ve),p=n.parse(e[2],2,zt(n.expectedType||Pe));return s&&p?new Ps(p.type.itemType,s,p):null},Ps.prototype.evaluate=function(e){var n=this.index.evaluate(e),s=this.input.evaluate(e);if(n<0)throw new fi("Array index out of bounds: "+n+" < 0.");if(n>=s.length)throw new fi("Array index out of bounds: "+n+" > "+(s.length-1)+".");if(n!==Math.floor(n))throw new fi("Array index must be an integer, but found "+n+" instead.");return s[n]},Ps.prototype.eachChild=function(e){e(this.index),e(this.input)},Ps.prototype.outputDefined=function(){return!1},Ps.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var ds=function(e,n){this.type=Je,this.needle=e,this.haystack=n};ds.parse=function(e,n){if(e.length!==3)return n.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var s=n.parse(e[1],1,Pe),p=n.parse(e[2],2,Pe);return s&&p?Br(s.type,[Je,Oe,ve,Me,Pe])?new ds(s,p):n.error("Expected first argument to be of type boolean, string, number or null, but found "+Jt(s.type)+" instead"):null},ds.prototype.evaluate=function(e){var n=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(!s)return!1;if(!vr(n,["boolean","string","number","null"]))throw new fi("Expected first argument to be of type boolean, string, number or null, but found "+Jt(zn(n))+" instead.");if(!vr(s,["string","array"]))throw new fi("Expected second argument to be of type array or string, but found "+Jt(zn(s))+" instead.");return s.indexOf(n)>=0},ds.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},ds.prototype.outputDefined=function(){return!0},ds.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var fs=function(e,n,s){this.type=ve,this.needle=e,this.haystack=n,this.fromIndex=s};fs.parse=function(e,n){if(e.length<=2||e.length>=5)return n.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var s=n.parse(e[1],1,Pe),p=n.parse(e[2],2,Pe);if(!s||!p)return null;if(!Br(s.type,[Je,Oe,ve,Me,Pe]))return n.error("Expected first argument to be of type boolean, string, number or null, but found "+Jt(s.type)+" instead");if(e.length===4){var g=n.parse(e[3],3,ve);return g?new fs(s,p,g):null}return new fs(s,p)},fs.prototype.evaluate=function(e){var n=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(!vr(n,["boolean","string","number","null"]))throw new fi("Expected first argument to be of type boolean, string, number or null, but found "+Jt(zn(n))+" instead.");if(!vr(s,["string","array"]))throw new fi("Expected second argument to be of type array or string, but found "+Jt(zn(s))+" instead.");if(this.fromIndex){var p=this.fromIndex.evaluate(e);return s.indexOf(n,p)}return s.indexOf(n)},fs.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},fs.prototype.outputDefined=function(){return!1},fs.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Qs=function(e,n,s,p,g,x){this.inputType=e,this.type=n,this.input=s,this.cases=p,this.outputs=g,this.otherwise=x};Qs.parse=function(e,n){if(e.length<5)return n.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return n.error("Expected an even number of arguments.");var s,p;n.expectedType&&n.expectedType.kind!=="value"&&(p=n.expectedType);for(var g={},x=[],T=2;T<e.length-1;T+=2){var D=e[T],j=e[T+1];Array.isArray(D)||(D=[D]);var ee=n.concat(T);if(D.length===0)return ee.error("Expected at least one branch label.");for(var oe=0,le=D;oe<le.length;oe+=1){var ye=le[oe];if(typeof ye!="number"&&typeof ye!="string")return ee.error("Branch labels must be numbers or strings.");if(typeof ye=="number"&&Math.abs(ye)>Number.MAX_SAFE_INTEGER)return ee.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof ye=="number"&&Math.floor(ye)!==ye)return ee.error("Numeric branch labels must be integer values.");if(s){if(ee.checkSubtype(s,zn(ye)))return null}else s=zn(ye);if(g[String(ye)]!==void 0)return ee.error("Branch labels must be unique.");g[String(ye)]=x.length}var i=n.parse(j,T,p);if(!i)return null;p=p||i.type,x.push(i)}var t=n.parse(e[1],1,Pe);if(!t)return null;var a=n.parse(e[e.length-1],e.length-1,p);return a?t.type.kind!=="value"&&n.concat(1).checkSubtype(s,t.type)?null:new Qs(s,p,t,g,x,a):null},Qs.prototype.evaluate=function(e){var n=this.input.evaluate(e);return(zn(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(e)},Qs.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},Qs.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},Qs.prototype.serialize=function(){for(var e=this,n=["match",this.input.serialize()],s=[],p={},g=0,x=Object.keys(this.cases).sort();g<x.length;g+=1){var T=x[g];(le=p[this.cases[T]])===void 0?(p[this.cases[T]]=s.length,s.push([this.cases[T],[T]])):s[le][1].push(T)}for(var D=function(i){return e.inputType.kind==="number"?Number(i):i},j=0,ee=s;j<ee.length;j+=1){var oe=ee[j],le=oe[0],ye=oe[1];n.push(ye.length===1?D(ye[0]):ye.map(D)),n.push(this.outputs[outputIndex$1].serialize())}return n.push(this.otherwise.serialize()),n};var $a=function(e,n,s){this.type=e,this.branches=n,this.otherwise=s};$a.parse=function(e,n){if(e.length<4)return n.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return n.error("Expected an odd number of arguments.");var s;n.expectedType&&n.expectedType.kind!=="value"&&(s=n.expectedType);for(var p=[],g=1;g<e.length-1;g+=2){var x=n.parse(e[g],g,Je);if(!x)return null;var T=n.parse(e[g+1],g+1,s);if(!T)return null;p.push([x,T]),s=s||T.type}var D=n.parse(e[e.length-1],e.length-1,s);return D?new $a(s,p,D):null},$a.prototype.evaluate=function(e){for(var n=0,s=this.branches;n<s.length;n+=1){var p=s[n],g=p[1];if(p[0].evaluate(e))return g.evaluate(e)}return this.otherwise.evaluate(e)},$a.prototype.eachChild=function(e){for(var n=0,s=this.branches;n<s.length;n+=1){var p=s[n],g=p[1];e(p[0]),e(g)}e(this.otherwise)},$a.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},$a.prototype.serialize=function(){var e=["case"];return this.eachChild(function(n){e.push(n.serialize())}),e};var qa=function(e,n,s,p){this.type=e,this.input=n,this.beginIndex=s,this.endIndex=p};function GA(e,n){return e==="=="||e==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function rA(e,n,s,p){return p.compare(n,s)===0}function Ki(e,n,s){var p=e!=="=="&&e!=="!=";return function(){function g(x,T,D){this.type=Je,this.lhs=x,this.rhs=T,this.collator=D,this.hasUntypedArgument=x.type.kind==="value"||T.type.kind==="value"}return g.parse=function(x,T){if(x.length!==3&&x.length!==4)return T.error("Expected two or three arguments.");var D=x[0],j=T.parse(x[1],1,Pe);if(!j)return null;if(!GA(D,j.type))return T.concat(1).error('"'+D+`" comparisons are not supported for type '`+Jt(j.type)+"'.");var ee=T.parse(x[2],2,Pe);if(!ee)return null;if(!GA(D,ee.type))return T.concat(2).error('"'+D+`" comparisons are not supported for type '`+Jt(ee.type)+"'.");if(j.type.kind!==ee.type.kind&&j.type.kind!=="value"&&ee.type.kind!=="value")return T.error("Cannot compare types '"+Jt(j.type)+"' and '"+Jt(ee.type)+"'.");p&&(j.type.kind==="value"&&ee.type.kind!=="value"?j=new Ni(ee.type,[j]):j.type.kind!=="value"&&ee.type.kind==="value"&&(ee=new Ni(j.type,[ee])));var oe=null;if(x.length===4){if(j.type.kind!=="string"&&ee.type.kind!=="string"&&j.type.kind!=="value"&&ee.type.kind!=="value")return T.error("Cannot use collator to compare non-string types.");if(!(oe=T.parse(x[3],3,dt)))return null}return new g(j,ee,oe)},g.prototype.evaluate=function(x){var T=this.lhs.evaluate(x),D=this.rhs.evaluate(x);if(p&&this.hasUntypedArgument){var j=zn(T),ee=zn(D);if(j.kind!==ee.kind||j.kind!=="string"&&j.kind!=="number")throw new fi('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+j.kind+", "+ee.kind+") instead.")}if(this.collator&&!p&&this.hasUntypedArgument){var oe=zn(T),le=zn(D);if(oe.kind!=="string"||le.kind!=="string")return n(x,T,D)}return this.collator?s(x,T,D,this.collator.evaluate(x)):n(x,T,D)},g.prototype.eachChild=function(x){x(this.lhs),x(this.rhs),this.collator&&x(this.collator)},g.prototype.outputDefined=function(){return!0},g.prototype.serialize=function(){var x=[e];return this.eachChild(function(T){x.push(T.serialize())}),x},g}()}qa.parse=function(e,n){if(e.length<=2||e.length>=5)return n.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var s=n.parse(e[1],1,Pe),p=n.parse(e[2],2,ve);if(!s||!p)return null;if(!Br(s.type,[zt(Pe),Oe,Pe]))return n.error("Expected first argument to be of type array or string, but found "+Jt(s.type)+" instead");if(e.length===4){var g=n.parse(e[3],3,ve);return g?new qa(s.type,s,p,g):null}return new qa(s.type,s,p)},qa.prototype.evaluate=function(e){var n=this.input.evaluate(e),s=this.beginIndex.evaluate(e);if(!vr(n,["string","array"]))throw new fi("Expected first argument to be of type array or string, but found "+Jt(zn(n))+" instead.");if(this.endIndex){var p=this.endIndex.evaluate(e);return n.slice(s,p)}return n.slice(s)},qa.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},qa.prototype.outputDefined=function(){return!1},qa.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var gc=Ki("==",function(e,n,s){return n===s},rA),Ds=Ki("!=",function(e,n,s){return n!==s},function(e,n,s,p){return!rA(0,n,s,p)}),Rn=Ki("<",function(e,n,s){return n<s},function(e,n,s,p){return p.compare(n,s)<0}),jA=Ki(">",function(e,n,s){return n>s},function(e,n,s,p){return p.compare(n,s)>0}),Pi=Ki("<=",function(e,n,s){return n<=s},function(e,n,s,p){return p.compare(n,s)<=0}),Gi=Ki(">=",function(e,n,s){return n>=s},function(e,n,s,p){return p.compare(n,s)>=0}),Yi=function(e,n,s,p,g){this.type=Oe,this.number=e,this.locale=n,this.currency=s,this.minFractionDigits=p,this.maxFractionDigits=g};Yi.parse=function(e,n){if(e.length!==3)return n.error("Expected two arguments.");var s=n.parse(e[1],1,ve);if(!s)return null;var p=e[2];if(typeof p!="object"||Array.isArray(p))return n.error("NumberFormat options argument must be an object.");var g=null;if(p.locale&&!(g=n.parse(p.locale,1,Oe)))return null;var x=null;if(p.currency&&!(x=n.parse(p.currency,1,Oe)))return null;var T=null;if(p["min-fraction-digits"]&&!(T=n.parse(p["min-fraction-digits"],1,ve)))return null;var D=null;return p["max-fraction-digits"]&&!(D=n.parse(p["max-fraction-digits"],1,ve))?null:new Yi(s,g,x,T,D)},Yi.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},Yi.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},Yi.prototype.outputDefined=function(){return!1},Yi.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var sn=function(e){this.type=ve,this.input=e};sn.parse=function(e,n){if(e.length!==2)return n.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var s=n.parse(e[1],1);return s?s.type.kind!=="array"&&s.type.kind!=="string"&&s.type.kind!=="value"?n.error("Expected argument of type string or array, but found "+Jt(s.type)+" instead."):new sn(s):null},sn.prototype.evaluate=function(e){var n=this.input.evaluate(e);if(typeof n=="string"||Array.isArray(n))return n.length;throw new fi("Expected value to be of type string or array, but found "+Jt(zn(n))+" instead.")},sn.prototype.eachChild=function(e){e(this.input)},sn.prototype.outputDefined=function(){return!1},sn.prototype.serialize=function(){var e=["length"];return this.eachChild(function(n){e.push(n.serialize())}),e};var ua={"==":gc,"!=":Ds,">":jA,"<":Rn,">=":Gi,"<=":Pi,array:Ni,at:Ps,boolean:Ni,case:$a,coalesce:Ws,collator:Io,format:go,image:Uo,in:ds,"index-of":fs,interpolate:Ro,"interpolate-hcl":Ro,"interpolate-lab":Ro,length:sn,let:Js,literal:Eo,match:Qs,number:Ni,"number-format":Yi,object:Ni,slice:qa,step:ca,string:Ni,"to-boolean":Dn,"to-color":Dn,"to-number":Dn,"to-string":Dn,var:qs,within:_a};function Za(e,n){var s=n[0],p=n[1],g=n[2],x=n[3];s=s.evaluate(e),p=p.evaluate(e),g=g.evaluate(e);var T=x?x.evaluate(e):1,D=Na(s,p,g,T);if(D)throw new fi(D);return new Tr(s/255*T,p/255*T,g/255*T,T)}function Tn(e,n){return e in n}function $A(e,n){var s=n[e];return s===void 0?null:s}function ms(e){return{type:e}}function qA(e){return{result:"success",value:e}}function ha(e){return{result:"error",value:e}}function So(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function zl(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function ta(e){return!!e.expression&&e.expression.interpolated}function Ai(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function Rl(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function To(e){return e}function es(e,n,s){return e!==void 0?e:n!==void 0?n:s!==void 0?s:void 0}function Mo(e,n,s,p,g){return es(typeof s===g?p[s]:void 0,e.default,n.default)}function Ol(e,n,s){if(Ai(s)!=="number")return es(e.default,n.default);var p=e.stops.length;if(p===1||s<=e.stops[0][0])return e.stops[0][1];if(s>=e.stops[p-1][0])return e.stops[p-1][1];var g=uo(e.stops.map(function(x){return x[0]}),s);return e.stops[g][1]}function Fn(e,n,s){var p=e.base!==void 0?e.base:1;if(Ai(s)!=="number")return es(e.default,n.default);var g=e.stops.length;if(g===1||s<=e.stops[0][0])return e.stops[0][1];if(s>=e.stops[g-1][0])return e.stops[g-1][1];var x=uo(e.stops.map(function(le){return le[0]}),s),T=function(le,ye,i,t){var a=t-i,h=le-i;return a===0?0:ye===1?h/a:(Math.pow(ye,h)-1)/(Math.pow(ye,a)-1)}(s,p,e.stops[x][0],e.stops[x+1][0]),D=e.stops[x][1],j=e.stops[x+1][1],ee=Zs[n.type]||To;if(e.colorSpace&&e.colorSpace!=="rgb"){var oe=mc[e.colorSpace];ee=function(le,ye){return oe.reverse(oe.interpolate(oe.forward(le),oe.forward(ye),T))}}return typeof D.evaluate=="function"?{evaluate:function(){for(var le=[],ye=arguments.length;ye--;)le[ye]=arguments[ye];var i=D.evaluate.apply(void 0,le),t=j.evaluate.apply(void 0,le);if(i!==void 0&&t!==void 0)return ee(i,t,T)}}:ee(D,j,T)}function Hl(e,n,s){return n.type==="color"?s=Tr.parse(s):n.type==="formatted"?s=Bi.fromString(s.toString()):n.type==="resolvedImage"?s=hi.fromString(s.toString()):Ai(s)===n.type||n.type==="enum"&&n.values[s]||(s=void 0),es(s,e.default,n.default)}hn.register(ua,{error:[{kind:"error"},[Oe],function(e,n){throw new fi(n[0].evaluate(e))}],typeof:[Oe,[Pe],function(e,n){return Jt(zn(n[0].evaluate(e)))}],"to-rgba":[zt(ve,4),[ct],function(e,n){return n[0].evaluate(e).toArray()}],rgb:[ct,[ve,ve,ve],Za],rgba:[ct,[ve,ve,ve,ve],Za],has:{type:Je,overloads:[[[Oe],function(e,n){return Tn(n[0].evaluate(e),e.properties())}],[[Oe,we],function(e,n){var s=n[1];return Tn(n[0].evaluate(e),s.evaluate(e))}]]},get:{type:Pe,overloads:[[[Oe],function(e,n){return $A(n[0].evaluate(e),e.properties())}],[[Oe,we],function(e,n){var s=n[1];return $A(n[0].evaluate(e),s.evaluate(e))}]]},"feature-state":[Pe,[Oe],function(e,n){return $A(n[0].evaluate(e),e.featureState||{})}],properties:[we,[],function(e){return e.properties()}],"geometry-type":[Oe,[],function(e){return e.geometryType()}],id:[Pe,[],function(e){return e.id()}],zoom:[ve,[],function(e){return e.globals.zoom}],"heatmap-density":[ve,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[ve,[],function(e){return e.globals.lineProgress||0}],accumulated:[Pe,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[ve,ms(ve),function(e,n){for(var s=0,p=0,g=n;p<g.length;p+=1)s+=g[p].evaluate(e);return s}],"*":[ve,ms(ve),function(e,n){for(var s=1,p=0,g=n;p<g.length;p+=1)s*=g[p].evaluate(e);return s}],"-":{type:ve,overloads:[[[ve,ve],function(e,n){var s=n[1];return n[0].evaluate(e)-s.evaluate(e)}],[[ve],function(e,n){return-n[0].evaluate(e)}]]},"/":[ve,[ve,ve],function(e,n){var s=n[1];return n[0].evaluate(e)/s.evaluate(e)}],"%":[ve,[ve,ve],function(e,n){var s=n[1];return n[0].evaluate(e)%s.evaluate(e)}],ln2:[ve,[],function(){return Math.LN2}],pi:[ve,[],function(){return Math.PI}],e:[ve,[],function(){return Math.E}],"^":[ve,[ve,ve],function(e,n){var s=n[1];return Math.pow(n[0].evaluate(e),s.evaluate(e))}],sqrt:[ve,[ve],function(e,n){return Math.sqrt(n[0].evaluate(e))}],log10:[ve,[ve],function(e,n){return Math.log(n[0].evaluate(e))/Math.LN10}],ln:[ve,[ve],function(e,n){return Math.log(n[0].evaluate(e))}],log2:[ve,[ve],function(e,n){return Math.log(n[0].evaluate(e))/Math.LN2}],sin:[ve,[ve],function(e,n){return Math.sin(n[0].evaluate(e))}],cos:[ve,[ve],function(e,n){return Math.cos(n[0].evaluate(e))}],tan:[ve,[ve],function(e,n){return Math.tan(n[0].evaluate(e))}],asin:[ve,[ve],function(e,n){return Math.asin(n[0].evaluate(e))}],acos:[ve,[ve],function(e,n){return Math.acos(n[0].evaluate(e))}],atan:[ve,[ve],function(e,n){return Math.atan(n[0].evaluate(e))}],min:[ve,ms(ve),function(e,n){return Math.min.apply(Math,n.map(function(s){return s.evaluate(e)}))}],max:[ve,ms(ve),function(e,n){return Math.max.apply(Math,n.map(function(s){return s.evaluate(e)}))}],abs:[ve,[ve],function(e,n){return Math.abs(n[0].evaluate(e))}],round:[ve,[ve],function(e,n){var s=n[0].evaluate(e);return s<0?-Math.round(-s):Math.round(s)}],floor:[ve,[ve],function(e,n){return Math.floor(n[0].evaluate(e))}],ceil:[ve,[ve],function(e,n){return Math.ceil(n[0].evaluate(e))}],"filter-==":[Je,[Oe,Pe],function(e,n){var s=n[0],p=n[1];return e.properties()[s.value]===p.value}],"filter-id-==":[Je,[Pe],function(e,n){var s=n[0];return e.id()===s.value}],"filter-type-==":[Je,[Oe],function(e,n){var s=n[0];return e.geometryType()===s.value}],"filter-<":[Je,[Oe,Pe],function(e,n){var s=n[0],p=n[1],g=e.properties()[s.value],x=p.value;return typeof g==typeof x&&g<x}],"filter-id-<":[Je,[Pe],function(e,n){var s=n[0],p=e.id(),g=s.value;return typeof p==typeof g&&p<g}],"filter->":[Je,[Oe,Pe],function(e,n){var s=n[0],p=n[1],g=e.properties()[s.value],x=p.value;return typeof g==typeof x&&g>x}],"filter-id->":[Je,[Pe],function(e,n){var s=n[0],p=e.id(),g=s.value;return typeof p==typeof g&&p>g}],"filter-<=":[Je,[Oe,Pe],function(e,n){var s=n[0],p=n[1],g=e.properties()[s.value],x=p.value;return typeof g==typeof x&&g<=x}],"filter-id-<=":[Je,[Pe],function(e,n){var s=n[0],p=e.id(),g=s.value;return typeof p==typeof g&&p<=g}],"filter->=":[Je,[Oe,Pe],function(e,n){var s=n[0],p=n[1],g=e.properties()[s.value],x=p.value;return typeof g==typeof x&&g>=x}],"filter-id->=":[Je,[Pe],function(e,n){var s=n[0],p=e.id(),g=s.value;return typeof p==typeof g&&p>=g}],"filter-has":[Je,[Pe],function(e,n){return n[0].value in e.properties()}],"filter-has-id":[Je,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[Je,[zt(Oe)],function(e,n){return n[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[Je,[zt(Pe)],function(e,n){return n[0].value.indexOf(e.id())>=0}],"filter-in-small":[Je,[Oe,zt(Pe)],function(e,n){var s=n[0];return n[1].value.indexOf(e.properties()[s.value])>=0}],"filter-in-large":[Je,[Oe,zt(Pe)],function(e,n){var s=n[0],p=n[1];return function(g,x,T,D){for(;T<=D;){var j=T+D>>1;if(x[j]===g)return!0;x[j]>g?D=j-1:T=j+1}return!1}(e.properties()[s.value],p.value,0,p.value.length-1)}],all:{type:Je,overloads:[[[Je,Je],function(e,n){var s=n[1];return n[0].evaluate(e)&&s.evaluate(e)}],[ms(Je),function(e,n){for(var s=0,p=n;s<p.length;s+=1)if(!p[s].evaluate(e))return!1;return!0}]]},any:{type:Je,overloads:[[[Je,Je],function(e,n){var s=n[1];return n[0].evaluate(e)||s.evaluate(e)}],[ms(Je),function(e,n){for(var s=0,p=n;s<p.length;s+=1)if(p[s].evaluate(e))return!0;return!1}]]},"!":[Je,[Je],function(e,n){return!n[0].evaluate(e)}],"is-supported-script":[Je,[Oe],function(e,n){var s=e.globals&&e.globals.isSupportedScript;return!s||s(n[0].evaluate(e))}],upcase:[Oe,[Oe],function(e,n){return n[0].evaluate(e).toUpperCase()}],downcase:[Oe,[Oe],function(e,n){return n[0].evaluate(e).toLowerCase()}],concat:[Oe,ms(Pe),function(e,n){return n.map(function(s){return js(s.evaluate(e))}).join("")}],"resolved-locale":[Oe,[dt],function(e,n){return n[0].evaluate(e).resolvedLocale()}]});var Da=function(e,n){this.expression=e,this._warningHistory={},this._evaluator=new co,this._defaultValue=n?function(s){return s.type==="color"&&Rl(s.default)?new Tr(0,0,0,0):s.type==="color"?Tr.parse(s.default)||null:s.default===void 0?null:s.default}(n):null,this._enumValues=n&&n.type==="enum"?n.values:null};function gs(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in ua}function ys(e,n){var s=new Ga(ua,[],n?function(g){var x={color:ct,string:Oe,number:ve,enum:Oe,boolean:Je,formatted:xt,resolvedImage:Lt};return g.type==="array"?zt(x[g.value]||Pe,g.length):x[g.type]}(n):void 0),p=s.parse(e,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return p?qA(new Da(p,n)):ha(s.errors)}Da.prototype.evaluateWithoutErrorHandling=function(e,n,s,p,g,x){return this._evaluator.globals=e,this._evaluator.feature=n,this._evaluator.featureState=s,this._evaluator.canonical=p,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=x,this.expression.evaluate(this._evaluator)},Da.prototype.evaluate=function(e,n,s,p,g,x){this._evaluator.globals=e,this._evaluator.feature=n||null,this._evaluator.featureState=s||null,this._evaluator.canonical=p,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=x||null;try{var T=this.expression.evaluate(this._evaluator);if(T==null||typeof T=="number"&&T!=T)return this._defaultValue;if(this._enumValues&&!(T in this._enumValues))throw new fi("Expected value to be one of "+Object.keys(this._enumValues).map(function(D){return JSON.stringify(D)}).join(", ")+", but found "+JSON.stringify(T)+" instead.");return T}catch(D){return this._warningHistory[D.message]||(this._warningHistory[D.message]=!0,typeof console<"u"&&console.warn(D.message)),this._defaultValue}};var Ys=function(e,n){this.kind=e,this._styleExpression=n,this.isStateDependent=e!=="constant"&&!Ti(n.expression)};Ys.prototype.evaluateWithoutErrorHandling=function(e,n,s,p,g,x){return this._styleExpression.evaluateWithoutErrorHandling(e,n,s,p,g,x)},Ys.prototype.evaluate=function(e,n,s,p,g,x){return this._styleExpression.evaluate(e,n,s,p,g,x)};var _s=function(e,n,s,p){this.kind=e,this.zoomStops=s,this._styleExpression=n,this.isStateDependent=e!=="camera"&&!Ti(n.expression),this.interpolationType=p};function BA(e,n){if((e=ys(e,n)).result==="error")return e;var s=e.value.expression,p=Ya(s);if(!p&&!So(n))return ha([new Se("","data expressions not supported")]);var g=Ms(s,["zoom"]);if(!g&&!zl(n))return ha([new Se("","zoom expressions not supported")]);var x=function T(D){var j=null;if(D instanceof Js)j=T(D.result);else if(D instanceof Ws)for(var ee=0,oe=D.args;ee<oe.length&&!(j=T(oe[ee]));ee+=1);else(D instanceof ca||D instanceof Ro)&&D.input instanceof hn&&D.input.name==="zoom"&&(j=D);return j instanceof Se||D.eachChild(function(le){var ye=T(le);ye instanceof Se?j=ye:!j&&ye?j=new Se("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):j&&ye&&j!==ye&&(j=new Se("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),j}(s);return x||g?x instanceof Se?ha([x]):x instanceof Ro&&!ta(n)?ha([new Se("",'"interpolate" expressions cannot be used with this property')]):qA(x?new _s(p?"camera":"composite",e.value,x.labels,x instanceof Ro?x.interpolation:void 0):new Ys(p?"constant":"source",e.value)):ha([new Se("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}_s.prototype.evaluateWithoutErrorHandling=function(e,n,s,p,g,x){return this._styleExpression.evaluateWithoutErrorHandling(e,n,s,p,g,x)},_s.prototype.evaluate=function(e,n,s,p,g,x){return this._styleExpression.evaluate(e,n,s,p,g,x)},_s.prototype.interpolationFactor=function(e,n,s){return this.interpolationType?Ro.interpolationFactor(this.interpolationType,e,n,s):0};var Oo=function(e,n){this._parameters=e,this._specification=n,te(this,function s(p,g){var x,T,D,j=g.type==="color",ee=p.stops&&typeof p.stops[0][0]=="object",oe=ee||!(ee||p.property!==void 0),le=p.type||(ta(g)?"exponential":"interval");if(j&&((p=te({},p)).stops&&(p.stops=p.stops.map(function(de){return[de[0],Tr.parse(de[1])]})),p.default=Tr.parse(p.default?p.default:g.default)),p.colorSpace&&p.colorSpace!=="rgb"&&!mc[p.colorSpace])throw new Error("Unknown color space: "+p.colorSpace);if(le==="exponential")x=Fn;else if(le==="interval")x=Ol;else if(le==="categorical"){x=Mo,T=Object.create(null);for(var ye=0,i=p.stops;ye<i.length;ye+=1){var t=i[ye];T[t[0]]=t[1]}D=typeof p.stops[0][0]}else{if(le!=="identity")throw new Error('Unknown function type "'+le+'"');x=Hl}if(ee){for(var a={},h=[],f=0;f<p.stops.length;f++){var v=p.stops[f],w=v[0].zoom;a[w]===void 0&&(a[w]={zoom:w,type:p.type,property:p.property,default:p.default,stops:[]},h.push(w)),a[w].stops.push([v[0].value,v[1]])}for(var k=[],L=0,O=h;L<O.length;L+=1){var Z=O[L];k.push([a[Z].zoom,s(a[Z],g)])}var re={name:"linear"};return{kind:"composite",interpolationType:re,interpolationFactor:Ro.interpolationFactor.bind(void 0,re),zoomStops:k.map(function(de){return de[0]}),evaluate:function(de,me){var Ue=de.zoom;return Fn({stops:k,base:p.base},g,Ue).evaluate(Ue,me)}}}if(oe){var he=le==="exponential"?{name:"exponential",base:p.base!==void 0?p.base:1}:null;return{kind:"camera",interpolationType:he,interpolationFactor:Ro.interpolationFactor.bind(void 0,he),zoomStops:p.stops.map(function(de){return de[0]}),evaluate:function(de){return x(p,g,de.zoom,T,D)}}}return{kind:"source",evaluate:function(de,me){var Ue=me&&me.properties?me.properties[p.property]:void 0;return Ue===void 0?es(p.default,g.default):x(p,g,Ue,T,D)}}}(this._parameters,this._specification))};function ho(e){var n=e.key,s=e.value,p=e.valueSpec||{},g=e.objectElementValidators||{},x=e.style,T=e.styleSpec,D=[],j=Ai(s);if(j!=="object")return[new X(n,s,"object expected, "+j+" found")];for(var ee in s){var oe=ee.split(".")[0],le=p[oe]||p["*"],ye=void 0;if(g[oe])ye=g[oe];else if(p[oe])ye=Ei;else if(g["*"])ye=g["*"];else{if(!p["*"]){D.push(new X(n,s[ee],'unknown property "'+ee+'"'));continue}ye=Ei}D=D.concat(ye({key:(n&&n+".")+ee,value:s[ee],valueSpec:le,style:x,styleSpec:T,object:s,objectKey:ee},s))}for(var i in p)g[i]||p[i].required&&p[i].default===void 0&&s[i]===void 0&&D.push(new X(n,s,'missing required property "'+i+'"'));return D}function ts(e){var n=e.value,s=e.valueSpec,p=e.style,g=e.styleSpec,x=e.key,T=e.arrayElementValidator||Ei;if(Ai(n)!=="array")return[new X(x,n,"array expected, "+Ai(n)+" found")];if(s.length&&n.length!==s.length)return[new X(x,n,"array length "+s.length+" expected, length "+n.length+" found")];if(s["min-length"]&&n.length<s["min-length"])return[new X(x,n,"array length at least "+s["min-length"]+" expected, length "+n.length+" found")];var D={type:s.value,values:s.values};g.$version<7&&(D.function=s.function),Ai(s.value)==="object"&&(D=s.value);for(var j=[],ee=0;ee<n.length;ee++)j=j.concat(T({array:n,arrayIndex:ee,value:n[ee],valueSpec:D,style:p,styleSpec:g,key:x+"["+ee+"]"}));return j}function po(e){var n=e.key,s=e.value,p=e.valueSpec,g=Ai(s);return g==="number"&&s!=s&&(g="NaN"),g!=="number"?[new X(n,s,"number expected, "+g+" found")]:"minimum"in p&&s<p.minimum?[new X(n,s,s+" is less than the minimum value "+p.minimum)]:"maximum"in p&&s>p.maximum?[new X(n,s,s+" is greater than the maximum value "+p.maximum)]:[]}function La(e){var n,s,p,g=e.valueSpec,x=pe(e.value.type),T={},D=x!=="categorical"&&e.value.property===void 0,j=!D,ee=Ai(e.value.stops)==="array"&&Ai(e.value.stops[0])==="array"&&Ai(e.value.stops[0][0])==="object",oe=ho({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(i){if(x==="identity")return[new X(i.key,i.value,'identity function may not have a "stops" property')];var t=[],a=i.value;return t=t.concat(ts({key:i.key,value:a,valueSpec:i.valueSpec,style:i.style,styleSpec:i.styleSpec,arrayElementValidator:le})),Ai(a)==="array"&&a.length===0&&t.push(new X(i.key,a,"array must have at least one stop")),t},default:function(i){return Ei({key:i.key,value:i.value,valueSpec:g,style:i.style,styleSpec:i.styleSpec})}}});return x==="identity"&&D&&oe.push(new X(e.key,e.value,'missing required property "property"')),x==="identity"||e.value.stops||oe.push(new X(e.key,e.value,'missing required property "stops"')),x==="exponential"&&e.valueSpec.expression&&!ta(e.valueSpec)&&oe.push(new X(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(j&&!So(e.valueSpec)?oe.push(new X(e.key,e.value,"property functions not supported")):D&&!zl(e.valueSpec)&&oe.push(new X(e.key,e.value,"zoom functions not supported"))),x!=="categorical"&&!ee||e.value.property!==void 0||oe.push(new X(e.key,e.value,'"property" property is required')),oe;function le(i){var t=[],a=i.value,h=i.key;if(Ai(a)!=="array")return[new X(h,a,"array expected, "+Ai(a)+" found")];if(a.length!==2)return[new X(h,a,"array length 2 expected, length "+a.length+" found")];if(ee){if(Ai(a[0])!=="object")return[new X(h,a,"object expected, "+Ai(a[0])+" found")];if(a[0].zoom===void 0)return[new X(h,a,"object stop key must have zoom")];if(a[0].value===void 0)return[new X(h,a,"object stop key must have value")];if(p&&p>pe(a[0].zoom))return[new X(h,a[0].zoom,"stop zoom values must appear in ascending order")];pe(a[0].zoom)!==p&&(p=pe(a[0].zoom),s=void 0,T={}),t=t.concat(ho({key:h+"[0]",value:a[0],valueSpec:{zoom:{}},style:i.style,styleSpec:i.styleSpec,objectElementValidators:{zoom:po,value:ye}}))}else t=t.concat(ye({key:h+"[0]",value:a[0],valueSpec:{},style:i.style,styleSpec:i.styleSpec},a));return gs(se(a[1]))?t.concat([new X(h+"[1]",a[1],"expressions are not allowed in function stops.")]):t.concat(Ei({key:h+"[1]",value:a[1],valueSpec:g,style:i.style,styleSpec:i.styleSpec}))}function ye(i,t){var a=Ai(i.value),h=pe(i.value),f=i.value!==null?i.value:t;if(n){if(a!==n)return[new X(i.key,f,a+" stop domain type must match previous stop domain type "+n)]}else n=a;if(a!=="number"&&a!=="string"&&a!=="boolean")return[new X(i.key,f,"stop domain value must be a number, string, or boolean")];if(a!=="number"&&x!=="categorical"){var v="number expected, "+a+" found";return So(g)&&x===void 0&&(v+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new X(i.key,f,v)]}return x!=="categorical"||a!=="number"||isFinite(h)&&Math.floor(h)===h?x!=="categorical"&&a==="number"&&s!==void 0&&h<s?[new X(i.key,f,"stop domain values must appear in ascending order")]:(s=h,x==="categorical"&&h in T?[new X(i.key,f,"stop domain values must be unique")]:(T[h]=!0,[])):[new X(i.key,f,"integer expected, found "+h)]}}function za(e){var n=(e.expressionContext==="property"?BA:ys)(se(e.value),e.valueSpec);if(n.result==="error")return n.value.map(function(p){return new X(""+e.key+p.key,e.value,p.message)});var s=n.value.expression||n.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!s.outputDefined())return[new X(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!Ti(s))return[new X(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!Ti(s))return[new X(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!Ms(s,["zoom","feature-state"]))return[new X(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!Ya(s))return[new X(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function vs(e){var n=e.key,s=e.value,p=e.valueSpec,g=[];return Array.isArray(p.values)?p.values.indexOf(pe(s))===-1&&g.push(new X(n,s,"expected one of ["+p.values.join(", ")+"], "+JSON.stringify(s)+" found")):Object.keys(p.values).indexOf(pe(s))===-1&&g.push(new X(n,s,"expected one of ["+Object.keys(p.values).join(", ")+"], "+JSON.stringify(s)+" found")),g}function ml(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var n=0,s=e.slice(1);n<s.length;n+=1){var p=s[n];if(!ml(p)&&typeof p!="boolean")return!1}return!0;default:return!0}}Oo.deserialize=function(e){return new Oo(e._parameters,e._specification)},Oo.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var el={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function iA(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};ml(e)||(e=Ra(e));var n=ys(e,el);if(n.result==="error")throw new Error(n.value.map(function(s){return s.key+": "+s.message}).join(", "));return{filter:function(s,p,g){return n.value.evaluate(s,p,{},g)},needGeometry:function s(p){if(!Array.isArray(p))return!1;if(p[0]==="within")return!0;for(var g=1;g<p.length;g++)if(s(p[g]))return!0;return!1}(e)}}function Vl(e,n){return e<n?-1:e>n?1:0}function Ra(e){if(!e)return!0;var n,s=e[0];return e.length<=1?s!=="any":s==="=="?tl(e[1],e[2],"=="):s==="!="?zs(tl(e[1],e[2],"==")):s==="<"||s===">"||s==="<="||s===">="?tl(e[1],e[2],s):s==="any"?(n=e.slice(1),["any"].concat(n.map(Ra))):s==="all"?["all"].concat(e.slice(1).map(Ra)):s==="none"?["all"].concat(e.slice(1).map(Ra).map(zs)):s==="in"?ZA(e[1],e.slice(2)):s==="!in"?zs(ZA(e[1],e.slice(2))):s==="has"?Ls(e[1]):s==="!has"?zs(Ls(e[1])):s!=="within"||e}function tl(e,n,s){switch(e){case"$type":return["filter-type-"+s,n];case"$id":return["filter-id-"+s,n];default:return["filter-"+s,e,n]}}function ZA(e,n){if(n.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(function(s){return typeof s!=typeof n[0]})?["filter-in-large",e,["literal",n.sort(Vl)]]:["filter-in-small",e,["literal",n]]}}function Ls(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function zs(e){return["!",e]}function pa(e){return ml(se(e.value))?za(te({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function n(s){var p=s.value,g=s.key;if(Ai(p)!=="array")return[new X(g,p,"array expected, "+Ai(p)+" found")];var x,T=s.styleSpec,D=[];if(p.length<1)return[new X(g,p,"filter array must have at least 1 element")];switch(D=D.concat(vs({key:g+"[0]",value:p[0],valueSpec:T.filter_operator,style:s.style,styleSpec:s.styleSpec})),pe(p[0])){case"<":case"<=":case">":case">=":p.length>=2&&pe(p[1])==="$type"&&D.push(new X(g,p,'"$type" cannot be use with operator "'+p[0]+'"'));case"==":case"!=":p.length!==3&&D.push(new X(g,p,'filter array for operator "'+p[0]+'" must have 3 elements'));case"in":case"!in":p.length>=2&&(x=Ai(p[1]))!=="string"&&D.push(new X(g+"[1]",p[1],"string expected, "+x+" found"));for(var j=2;j<p.length;j++)x=Ai(p[j]),pe(p[1])==="$type"?D=D.concat(vs({key:g+"["+j+"]",value:p[j],valueSpec:T.geometry_type,style:s.style,styleSpec:s.styleSpec})):x!=="string"&&x!=="number"&&x!=="boolean"&&D.push(new X(g+"["+j+"]",p[j],"string, number, or boolean expected, "+x+" found"));break;case"any":case"all":case"none":for(var ee=1;ee<p.length;ee++)D=D.concat(n({key:g+"["+ee+"]",value:p[ee],style:s.style,styleSpec:s.styleSpec}));break;case"has":case"!has":x=Ai(p[1]),p.length!==2?D.push(new X(g,p,'filter array for "'+p[0]+'" operator must have 2 elements')):x!=="string"&&D.push(new X(g+"[1]",p[1],"string expected, "+x+" found"));break;case"within":x=Ai(p[1]),p.length!==2?D.push(new X(g,p,'filter array for "'+p[0]+'" operator must have 2 elements')):x!=="object"&&D.push(new X(g+"[1]",p[1],"object expected, "+x+" found"))}return D}(e)}function gl(e,n){var s=e.key,p=e.style,g=e.styleSpec,x=e.value,T=e.objectKey,D=g[n+"_"+e.layerType];if(!D)return[];var j=T.match(/^(.*)-transition$/);if(n==="paint"&&j&&D[j[1]]&&D[j[1]].transition)return Ei({key:s,value:x,valueSpec:g.transition,style:p,styleSpec:g});var ee,oe=e.valueSpec||D[T];if(!oe)return[new X(s,x,'unknown property "'+T+'"')];if(Ai(x)==="string"&&So(oe)&&!oe.tokens&&(ee=/^{([^}]+)}$/.exec(x)))return[new X(s,x,'"'+T+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(ee[1])+" }`.")];var le=[];return e.layerType==="symbol"&&(T==="text-field"&&p&&!p.glyphs&&le.push(new X(s,x,'use of "text-field" requires a style "glyphs" property')),T==="text-font"&&Rl(se(x))&&pe(x.type)==="identity"&&le.push(new X(s,x,'"text-font" does not support identity functions'))),le.concat(Ei({key:e.key,value:x,valueSpec:oe,style:p,styleSpec:g,expressionContext:"property",propertyType:n,propertyKey:T}))}function Zn(e){return gl(e,"paint")}function Nl(e){return gl(e,"layout")}function Rs(e){var n=[],s=e.value,p=e.key,g=e.style,x=e.styleSpec;s.type||s.ref||n.push(new X(p,s,'either "type" or "ref" is required'));var T,D=pe(s.type),j=pe(s.ref);if(s.id)for(var ee=pe(s.id),oe=0;oe<e.arrayIndex;oe++){var le=g.layers[oe];pe(le.id)===ee&&n.push(new X(p,s.id,'duplicate layer id "'+s.id+'", previously used at line '+le.id.__line__))}if("ref"in s)["type","source","source-layer","filter","layout"].forEach(function(t){t in s&&n.push(new X(p,s[t],'"'+t+'" is prohibited for ref layers'))}),g.layers.forEach(function(t){pe(t.id)===j&&(T=t)}),T?T.ref?n.push(new X(p,s.ref,"ref cannot reference another ref layer")):D=pe(T.type):n.push(new X(p,s.ref,'ref layer "'+j+'" not found'));else if(D!=="background")if(s.source){var ye=g.sources&&g.sources[s.source],i=ye&&pe(ye.type);ye?i==="vector"&&D==="raster"?n.push(new X(p,s.source,'layer "'+s.id+'" requires a raster source')):i==="raster"&&D!=="raster"?n.push(new X(p,s.source,'layer "'+s.id+'" requires a vector source')):i!=="vector"||s["source-layer"]?i==="raster-dem"&&D!=="hillshade"?n.push(new X(p,s.source,"raster-dem source can only be used with layer type 'hillshade'.")):D!=="line"||!s.paint||!s.paint["line-gradient"]||i==="geojson"&&ye.lineMetrics||n.push(new X(p,s,'layer "'+s.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):n.push(new X(p,s,'layer "'+s.id+'" must specify a "source-layer"')):n.push(new X(p,s.source,'source "'+s.source+'" not found'))}else n.push(new X(p,s,'missing required property "source"'));return n=n.concat(ho({key:p,value:s,valueSpec:x.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Ei({key:p+".type",value:s.type,valueSpec:x.layer.type,style:e.style,styleSpec:e.styleSpec,object:s,objectKey:"type"})},filter:pa,layout:function(t){return ho({layer:s,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(a){return Nl(te({layerType:D},a))}}})},paint:function(t){return ho({layer:s,key:t.key,value:t.value,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(a){return Zn(te({layerType:D},a))}}})}}}))}function rl(e){var n=e.value,s=e.key,p=Ai(n);return p!=="string"?[new X(s,n,"string expected, "+p+" found")]:[]}var Oi={promoteId:function(e){var n=e.key,s=e.value;if(Ai(s)==="string")return rl({key:n,value:s});var p=[];for(var g in s)p.push.apply(p,rl({key:n+"."+g,value:s[g]}));return p}};function il(e){var n=e.value,s=e.key,p=e.styleSpec,g=e.style;if(!n.type)return[new X(s,n,'"type" is required')];var x,T=pe(n.type);switch(T){case"vector":case"raster":case"raster-dem":return ho({key:s,value:n,valueSpec:p["source_"+T.replace("-","_")],style:e.style,styleSpec:p,objectElementValidators:Oi});case"geojson":if(x=ho({key:s,value:n,valueSpec:p.source_geojson,style:g,styleSpec:p,objectElementValidators:Oi}),n.cluster)for(var D in n.clusterProperties){var j=n.clusterProperties[D],ee=j[0],oe=typeof ee=="string"?[ee,["accumulated"],["get",D]]:ee;x.push.apply(x,za({key:s+"."+D+".map",value:j[1],expressionContext:"cluster-map"})),x.push.apply(x,za({key:s+"."+D+".reduce",value:oe,expressionContext:"cluster-reduce"}))}return x;case"video":return ho({key:s,value:n,valueSpec:p.source_video,style:g,styleSpec:p});case"image":return ho({key:s,value:n,valueSpec:p.source_image,style:g,styleSpec:p});case"canvas":return[new X(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return vs({key:s+".type",value:n.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:g,styleSpec:p})}}function xs(e){var n=e.value,s=e.styleSpec,p=s.light,g=e.style,x=[],T=Ai(n);if(n===void 0)return x;if(T!=="object")return x.concat([new X("light",n,"object expected, "+T+" found")]);for(var D in n){var j=D.match(/^(.*)-transition$/);x=x.concat(j&&p[j[1]]&&p[j[1]].transition?Ei({key:D,value:n[D],valueSpec:s.transition,style:g,styleSpec:s}):p[D]?Ei({key:D,value:n[D],valueSpec:p[D],style:g,styleSpec:s}):[new X(D,n[D],'unknown property "'+D+'"')])}return x}var Os={"*":function(){return[]},array:ts,boolean:function(e){var n=e.value,s=e.key,p=Ai(n);return p!=="boolean"?[new X(s,n,"boolean expected, "+p+" found")]:[]},number:po,color:function(e){var n=e.key,s=e.value,p=Ai(s);return p!=="string"?[new X(n,s,"color expected, "+p+" found")]:Sr(s)===null?[new X(n,s,'color expected, "'+s+'" found')]:[]},constants:H,enum:vs,filter:pa,function:La,layer:Rs,object:ho,source:il,light:xs,string:rl,formatted:function(e){return rl(e).length===0?[]:za(e)},resolvedImage:function(e){return rl(e).length===0?[]:za(e)}};function Ei(e){var n=e.value,s=e.valueSpec,p=e.styleSpec;return s.expression&&Rl(pe(n))?La(e):s.expression&&gs(se(n))?za(e):s.type&&Os[s.type]?Os[s.type](e):ho(te({},e,{valueSpec:s.type?p[s.type]:s}))}function ln(e){var n=e.value,s=e.key,p=rl(e);return p.length||(n.indexOf("{fontstack}")===-1&&p.push(new X(s,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&p.push(new X(s,n,'"glyphs" url must include a "{range}" token'))),p}function Ho(e,n){n===void 0&&(n=Ee);var s=[];return s=s.concat(Ei({key:"",value:e,valueSpec:n.$root,styleSpec:n,style:e,objectElementValidators:{glyphs:ln,"*":function(){return[]}}})),e.constants&&(s=s.concat(H({key:"constants",value:e.constants,style:e,styleSpec:n}))),va(s)}function va(e){return[].concat(e).sort(function(n,s){return n.line-s.line})}function xr(e){return function(){for(var n=[],s=arguments.length;s--;)n[s]=arguments[s];return va(e.apply(this,n))}}Ho.source=xr(il),Ho.light=xr(xs),Ho.layer=xr(Rs),Ho.filter=xr(pa),Ho.paintProperty=xr(Zn),Ho.layoutProperty=xr(Nl);var yl=Ho,_l=yl.light,rs=yl.paintProperty,vl=yl.layoutProperty;function pr(e,n){var s=!1;if(n&&n.length)for(var p=0,g=n;p<g.length;p+=1)e.fire(new We(new Error(g[p].message))),s=!0;return s}var xa=yo;function yo(e,n,s){var p=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var g=new Int32Array(this.arrayBuffer);e=g[0],this.d=(n=g[1])+2*(s=g[2]);for(var x=0;x<this.d*this.d;x++){var T=g[3+x],D=g[3+x+1];p.push(T===D?null:g.subarray(T,D))}var j=g[3+p.length+1];this.keys=g.subarray(g[3+p.length],j),this.bboxes=g.subarray(j),this.insert=this._insertReadonly}else{this.d=n+2*s;for(var ee=0;ee<this.d*this.d;ee++)p.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=e,this.padding=s,this.scale=n/e,this.uid=0;var oe=s/n*e;this.min=-oe,this.max=e+oe}yo.prototype.insert=function(e,n,s,p,g){this._forEachCell(n,s,p,g,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(n),this.bboxes.push(s),this.bboxes.push(p),this.bboxes.push(g)},yo.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},yo.prototype._insertCell=function(e,n,s,p,g,x){this.cells[g].push(x)},yo.prototype.query=function(e,n,s,p,g){var x=this.min,T=this.max;if(e<=x&&n<=x&&T<=s&&T<=p&&!g)return Array.prototype.slice.call(this.keys);var D=[];return this._forEachCell(e,n,s,p,this._queryCell,D,{},g),D},yo.prototype._queryCell=function(e,n,s,p,g,x,T,D){var j=this.cells[g];if(j!==null)for(var ee=this.keys,oe=this.bboxes,le=0;le<j.length;le++){var ye=j[le];if(T[ye]===void 0){var i=4*ye;(D?D(oe[i+0],oe[i+1],oe[i+2],oe[i+3]):e<=oe[i+2]&&n<=oe[i+3]&&s>=oe[i+0]&&p>=oe[i+1])?(T[ye]=!0,x.push(ee[ye])):T[ye]=!1}}},yo.prototype._forEachCell=function(e,n,s,p,g,x,T,D){for(var j=this._convertToCellCoord(e),ee=this._convertToCellCoord(n),oe=this._convertToCellCoord(s),le=this._convertToCellCoord(p),ye=j;ye<=oe;ye++)for(var i=ee;i<=le;i++){var t=this.d*i+ye;if((!D||D(this._convertFromCellCoord(ye),this._convertFromCellCoord(i),this._convertFromCellCoord(ye+1),this._convertFromCellCoord(i+1)))&&g.call(this,e,n,s,p,t,x,T,D))return}},yo.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},yo.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},yo.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,n=3+this.cells.length+1+1,s=0,p=0;p<this.cells.length;p++)s+=this.cells[p].length;var g=new Int32Array(n+s+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;for(var x=n,T=0;T<e.length;T++){var D=e[T];g[3+T]=x,g.set(D,x),x+=D.length}return g[3+e.length]=x,g.set(this.keys,x),g[3+e.length+1]=x+=this.keys.length,g.set(this.bboxes,x),x+=this.bboxes.length,g.buffer};var Xa=be.ImageData,nA=be.ImageBitmap,io={};function fr(e,n,s){s===void 0&&(s={}),Object.defineProperty(n,"_classRegistryKey",{value:e,writeable:!1}),io[e]={klass:n,omit:s.omit||[],shallow:s.shallow||[]}}for(var wa in fr("Object",Object),xa.serialize=function(e,n){var s=e.toArrayBuffer();return n&&n.push(s),{buffer:s}},xa.deserialize=function(e){return new xa(e.buffer)},fr("Grid",xa),fr("Color",Tr),fr("Error",Error),fr("ResolvedImage",hi),fr("StylePropertyFunction",Oo),fr("StyleExpression",Da,{omit:["_evaluator"]}),fr("ZoomDependentExpression",_s),fr("ZoomConstantExpression",Ys),fr("CompoundExpression",hn,{omit:["_evaluate"]}),ua)ua[wa]._classRegistryKey||fr("Expression_"+wa,ua[wa]);function oA(e){return e&&typeof ArrayBuffer<"u"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function nl(e){return nA&&e instanceof nA}function ra(e,n){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(oA(e)||nl(e))return n&&n.push(e),e;if(ArrayBuffer.isView(e)){var s=e;return n&&n.push(s.buffer),s}if(e instanceof Xa)return n&&n.push(e.data.buffer),e;if(Array.isArray(e)){for(var p=[],g=0,x=e;g<x.length;g+=1)p.push(ra(x[g],n));return p}if(typeof e=="object"){var T=e.constructor,D=T._classRegistryKey;if(!D)throw new Error("can't serialize object of unregistered class");var j=T.serialize?T.serialize(e,n):{};if(!T.serialize){for(var ee in e)if(e.hasOwnProperty(ee)&&!(io[D].omit.indexOf(ee)>=0)){var oe=e[ee];j[ee]=io[D].shallow.indexOf(ee)>=0?oe:ra(oe,n)}e instanceof Error&&(j.message=e.message)}if(j.$name)throw new Error("$name property is reserved for worker serialization logic.");return D!=="Object"&&(j.$name=D),j}throw new Error("can't serialize object of type "+typeof e)}function ia(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||oA(e)||nl(e)||ArrayBuffer.isView(e)||e instanceof Xa)return e;if(Array.isArray(e))return e.map(ia);if(typeof e=="object"){var n=e.$name||"Object",s=io[n].klass;if(!s)throw new Error("can't deserialize unregistered class "+n);if(s.deserialize)return s.deserialize(e);for(var p=Object.create(s.prototype),g=0,x=Object.keys(e);g<x.length;g+=1){var T=x[g];if(T!=="$name"){var D=e[T];p[T]=io[n].shallow.indexOf(T)>=0?D:ia(D)}}return p}throw new Error("can't deserialize object of type "+typeof e)}var aA=function(){this.first=!0};aA.prototype.update=function(e,n){var s=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=s,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=s,!0):(this.lastFloorZoom>s?(this.lastIntegerZoom=s+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<s&&(this.lastIntegerZoom=s,this.lastIntegerZoomTime=n),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=s,!0))};var Gt={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function ws(e){for(var n=0,s=e;n<s.length;n+=1)if(sA(s[n].charCodeAt(0)))return!0;return!1}function sA(e){return!(e!==746&&e!==747&&(e<4352||!(Gt["Bopomofo Extended"](e)||Gt.Bopomofo(e)||Gt["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||Gt["CJK Compatibility Ideographs"](e)||Gt["CJK Compatibility"](e)||Gt["CJK Radicals Supplement"](e)||Gt["CJK Strokes"](e)||!(!Gt["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||Gt["CJK Unified Ideographs Extension A"](e)||Gt["CJK Unified Ideographs"](e)||Gt["Enclosed CJK Letters and Months"](e)||Gt["Hangul Compatibility Jamo"](e)||Gt["Hangul Jamo Extended-A"](e)||Gt["Hangul Jamo Extended-B"](e)||Gt["Hangul Jamo"](e)||Gt["Hangul Syllables"](e)||Gt.Hiragana(e)||Gt["Ideographic Description Characters"](e)||Gt.Kanbun(e)||Gt["Kangxi Radicals"](e)||Gt["Katakana Phonetic Extensions"](e)||Gt.Katakana(e)&&e!==12540||!(!Gt["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!Gt["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||Gt["Unified Canadian Aboriginal Syllabics"](e)||Gt["Unified Canadian Aboriginal Syllabics Extended"](e)||Gt["Vertical Forms"](e)||Gt["Yijing Hexagram Symbols"](e)||Gt["Yi Syllables"](e)||Gt["Yi Radicals"](e))))}function ol(e){return!(sA(e)||function(n){return!!(Gt["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||Gt["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||Gt["Letterlike Symbols"](n)||Gt["Number Forms"](n)||Gt["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||Gt["Control Pictures"](n)&&n!==9251||Gt["Optical Character Recognition"](n)||Gt["Enclosed Alphanumerics"](n)||Gt["Geometric Shapes"](n)||Gt["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||Gt["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||Gt["CJK Symbols and Punctuation"](n)||Gt.Katakana(n)||Gt["Private Use Area"](n)||Gt["CJK Compatibility Forms"](n)||Gt["Small Form Variants"](n)||Gt["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(e))}function ba(e){return e>=1424&&e<=2303||Gt["Arabic Presentation Forms-A"](e)||Gt["Arabic Presentation Forms-B"](e)}function _o(e,n){return!(!n&&ba(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||Gt.Khmer(e))}function lA(e){for(var n=0,s=e;n<s.length;n+=1)if(ba(s[n].charCodeAt(0)))return!0;return!1}var da=null,Hi="unavailable",Oa=null,al=function(e){e&&typeof e=="string"&&e.indexOf("NetworkError")>-1&&(Hi="error"),da&&da(e)};function Kl(){CA.fire(new Re("pluginStateChange",{pluginStatus:Hi,pluginURL:Oa}))}var CA=new st,EA=function(){return Hi},is=function(){if(Hi!=="deferred"||!Oa)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Hi="loading",Kl(),Oa&&ka({url:Oa},function(e){e?al(e):(Hi="loaded",Kl())})},Xn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Hi==="loaded"||Xn.applyArabicShaping!=null},isLoading:function(){return Hi==="loading"},setState:function(e){Hi=e.pluginStatus,Oa=e.pluginURL},isParsed:function(){return Xn.applyArabicShaping!=null&&Xn.processBidirectionalText!=null&&Xn.processStyledBidirectionalText!=null},getPluginURL:function(){return Oa}},pi=function(e,n){this.zoom=e,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.zoomHistory=n.zoomHistory,this.transition=n.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new aA,this.transition={})};pi.prototype.isSupportedScript=function(e){return function(n,s){for(var p=0,g=n;p<g.length;p+=1)if(!_o(g[p].charCodeAt(0),s))return!1;return!0}(e,Xn.isLoaded())},pi.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},pi.prototype.getCrossfadeParameters=function(){var e=this.zoom,n=e-Math.floor(e),s=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*s}:{fromScale:.5,toScale:1,t:1-(1-s)*n}};var Cr=function(e,n){this.property=e,this.value=n,this.expression=function(s,p){if(Rl(s))return new Oo(s,p);if(gs(s)){var g=BA(s,p);if(g.result==="error")throw new Error(g.value.map(function(T){return T.key+": "+T.message}).join(", "));return g.value}var x=s;return typeof s=="string"&&p.type==="color"&&(x=Tr.parse(s)),{kind:"constant",evaluate:function(){return x}}}(n===void 0?e.specification.default:n,e.specification)};Cr.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Cr.prototype.possiblyEvaluate=function(e,n,s){return this.property.possiblyEvaluate(this,e,n,s)};var Pr=function(e){this.property=e,this.value=new Cr(e,void 0)};Pr.prototype.transitioned=function(e,n){return new Hs(this.property,this.value,n,Bt({},e.transition,this.transition),e.now)},Pr.prototype.untransitioned=function(){return new Hs(this.property,this.value,null,{},0)};var no=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};no.prototype.getValue=function(e){return Rr(this._values[e].value.value)},no.prototype.setValue=function(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new Pr(this._values[e].property)),this._values[e].value=new Cr(this._values[e].property,n===null?void 0:Rr(n))},no.prototype.getTransition=function(e){return Rr(this._values[e].transition)},no.prototype.setTransition=function(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new Pr(this._values[e].property)),this._values[e].transition=Rr(n)||void 0},no.prototype.serialize=function(){for(var e={},n=0,s=Object.keys(this._values);n<s.length;n+=1){var p=s[n],g=this.getValue(p);g!==void 0&&(e[p]=g);var x=this.getTransition(p);x!==void 0&&(e[p+"-transition"]=x)}return e},no.prototype.transitioned=function(e,n){for(var s=new fa(this._properties),p=0,g=Object.keys(this._values);p<g.length;p+=1){var x=g[p];s._values[x]=this._values[x].transitioned(e,n._values[x])}return s},no.prototype.untransitioned=function(){for(var e=new fa(this._properties),n=0,s=Object.keys(this._values);n<s.length;n+=1){var p=s[n];e._values[p]=this._values[p].untransitioned()}return e};var Hs=function(e,n,s,p,g){this.property=e,this.value=n,this.begin=g+p.delay||0,this.end=this.begin+p.duration||0,e.specification.transition&&(p.delay||p.duration)&&(this.prior=s)};Hs.prototype.possiblyEvaluate=function(e,n,s){var p=e.now||0,g=this.value.possiblyEvaluate(e,n,s),x=this.prior;if(x){if(p>this.end)return this.prior=null,g;if(this.value.isDataDriven())return this.prior=null,g;if(p<this.begin)return x.possiblyEvaluate(e,n,s);var T=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(e,n,s),g,function(D){if(D<=0)return 0;if(D>=1)return 1;var j=D*D,ee=j*D;return 4*(D<.5?ee:3*(D-j)+ee-.75)}(T))}return g};var fa=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};fa.prototype.possiblyEvaluate=function(e,n,s){for(var p=new Ba(this._properties),g=0,x=Object.keys(this._values);g<x.length;g+=1){var T=x[g];p._values[T]=this._values[T].possiblyEvaluate(e,n,s)}return p},fa.prototype.hasTransition=function(){for(var e=0,n=Object.keys(this._values);e<n.length;e+=1)if(this._values[n[e]].prior)return!0;return!1};var On=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};On.prototype.getValue=function(e){return Rr(this._values[e].value)},On.prototype.setValue=function(e,n){this._values[e]=new Cr(this._values[e].property,n===null?void 0:Rr(n))},On.prototype.serialize=function(){for(var e={},n=0,s=Object.keys(this._values);n<s.length;n+=1){var p=s[n],g=this.getValue(p);g!==void 0&&(e[p]=g)}return e},On.prototype.possiblyEvaluate=function(e,n,s){for(var p=new Ba(this._properties),g=0,x=Object.keys(this._values);g<x.length;g+=1){var T=x[g];p._values[T]=this._values[T].possiblyEvaluate(e,n,s)}return p};var oo=function(e,n,s){this.property=e,this.value=n,this.parameters=s};oo.prototype.isConstant=function(){return this.value.kind==="constant"},oo.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},oo.prototype.evaluate=function(e,n,s,p){return this.property.evaluate(this.value,this.parameters,e,n,s,p)};var Ba=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};Ba.prototype.get=function(e){return this._values[e]};var kr=function(e){this.specification=e};kr.prototype.possiblyEvaluate=function(e,n){return e.expression.evaluate(n)},kr.prototype.interpolate=function(e,n,s){var p=Zs[this.specification.type];return p?p(e,n,s):e};var cr=function(e,n){this.specification=e,this.overrides=n};cr.prototype.possiblyEvaluate=function(e,n,s,p){return new oo(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(n,null,{},s,p)}:e.expression,n)},cr.prototype.interpolate=function(e,n,s){if(e.value.kind!=="constant"||n.value.kind!=="constant")return e;if(e.value.value===void 0||n.value.value===void 0)return new oo(this,{kind:"constant",value:void 0},e.parameters);var p=Zs[this.specification.type];return p?new oo(this,{kind:"constant",value:p(e.value.value,n.value.value,s)},e.parameters):e},cr.prototype.evaluate=function(e,n,s,p,g,x){return e.kind==="constant"?e.value:e.evaluate(n,s,p,g,x)};var Wn=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.possiblyEvaluate=function(s,p,g,x){if(s.value===void 0)return new oo(this,{kind:"constant",value:void 0},p);if(s.expression.kind==="constant"){var T=s.expression.evaluate(p,null,{},g,x),D=s.property.specification.type==="resolvedImage"&&typeof T!="string"?T.name:T,j=this._calculate(D,D,D,p);return new oo(this,{kind:"constant",value:j},p)}if(s.expression.kind==="camera"){var ee=this._calculate(s.expression.evaluate({zoom:p.zoom-1}),s.expression.evaluate({zoom:p.zoom}),s.expression.evaluate({zoom:p.zoom+1}),p);return new oo(this,{kind:"constant",value:ee},p)}return new oo(this,s.expression,p)},n.prototype.evaluate=function(s,p,g,x,T,D){if(s.kind==="source"){var j=s.evaluate(p,g,x,T,D);return this._calculate(j,j,j,p)}return s.kind==="composite"?this._calculate(s.evaluate({zoom:Math.floor(p.zoom)-1},g,x),s.evaluate({zoom:Math.floor(p.zoom)},g,x),s.evaluate({zoom:Math.floor(p.zoom)+1},g,x),p):s.value},n.prototype._calculate=function(s,p,g,x){return x.zoom>x.zoomHistory.lastIntegerZoom?{from:s,to:p}:{from:g,to:p}},n.prototype.interpolate=function(s){return s},n}(cr),qi=function(e){this.specification=e};qi.prototype.possiblyEvaluate=function(e,n,s,p){if(e.value!==void 0){if(e.expression.kind==="constant"){var g=e.expression.evaluate(n,null,{},s,p);return this._calculate(g,g,g,n)}return this._calculate(e.expression.evaluate(new pi(Math.floor(n.zoom-1),n)),e.expression.evaluate(new pi(Math.floor(n.zoom),n)),e.expression.evaluate(new pi(Math.floor(n.zoom+1),n)),n)}},qi.prototype._calculate=function(e,n,s,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:e,to:n}:{from:s,to:n}},qi.prototype.interpolate=function(e){return e};var Ca=function(e){this.specification=e};Ca.prototype.possiblyEvaluate=function(e,n,s,p){return!!e.expression.evaluate(n,null,{},s,p)},Ca.prototype.interpolate=function(){return!1};var eo=function(e){for(var n in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var s=e[n];s.specification.overridable&&this.overridableProperties.push(n);var p=this.defaultPropertyValues[n]=new Cr(s,void 0),g=this.defaultTransitionablePropertyValues[n]=new Pr(s);this.defaultTransitioningPropertyValues[n]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=p.possiblyEvaluate({})}};fr("DataDrivenProperty",cr),fr("DataConstantProperty",kr),fr("CrossFadedDataDrivenProperty",Wn),fr("CrossFadedProperty",qi),fr("ColorRampProperty",Ca);var y=function(e){function n(s,p){if(e.call(this),this.id=s.id,this.type=s.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},s.type!=="custom"&&(this.metadata=(s=s).metadata,this.minzoom=s.minzoom,this.maxzoom=s.maxzoom,s.type!=="background"&&(this.source=s.source,this.sourceLayer=s["source-layer"],this.filter=s.filter),p.layout&&(this._unevaluatedLayout=new On(p.layout)),p.paint)){for(var g in this._transitionablePaint=new no(p.paint),s.paint)this.setPaintProperty(g,s.paint[g],{validate:!1});for(var x in s.layout)this.setLayoutProperty(x,s.layout[x],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ba(p.paint)}}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},n.prototype.getLayoutProperty=function(s){return s==="visibility"?this.visibility:this._unevaluatedLayout.getValue(s)},n.prototype.setLayoutProperty=function(s,p,g){g===void 0&&(g={}),p!=null&&this._validate(vl,"layers."+this.id+".layout."+s,s,p,g)||(s!=="visibility"?this._unevaluatedLayout.setValue(s,p):this.visibility=p)},n.prototype.getPaintProperty=function(s){return Xr(s,"-transition")?this._transitionablePaint.getTransition(s.slice(0,-11)):this._transitionablePaint.getValue(s)},n.prototype.setPaintProperty=function(s,p,g){if(g===void 0&&(g={}),p!=null&&this._validate(rs,"layers."+this.id+".paint."+s,s,p,g))return!1;if(Xr(s,"-transition"))return this._transitionablePaint.setTransition(s.slice(0,-11),p||void 0),!1;var x=this._transitionablePaint._values[s],T=x.property.specification["property-type"]==="cross-faded-data-driven",D=x.value.isDataDriven(),j=x.value;this._transitionablePaint.setValue(s,p),this._handleSpecialPaintPropertyUpdate(s);var ee=this._transitionablePaint._values[s].value;return ee.isDataDriven()||D||T||this._handleOverridablePaintPropertyUpdate(s,j,ee)},n.prototype._handleSpecialPaintPropertyUpdate=function(s){},n.prototype._handleOverridablePaintPropertyUpdate=function(s,p,g){return!1},n.prototype.isHidden=function(s){return!!(this.minzoom&&s<this.minzoom)||!!(this.maxzoom&&s>=this.maxzoom)||this.visibility==="none"},n.prototype.updateTransitions=function(s){this._transitioningPaint=this._transitionablePaint.transitioned(s,this._transitioningPaint)},n.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},n.prototype.recalculate=function(s,p){s.getCrossfadeParameters&&(this._crossfadeParameters=s.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(s,void 0,p)),this.paint=this._transitioningPaint.possiblyEvaluate(s,void 0,p)},n.prototype.serialize=function(){var s={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(s.layout=s.layout||{},s.layout.visibility=this.visibility),_r(s,function(p,g){return!(p===void 0||g==="layout"&&!Object.keys(p).length||g==="paint"&&!Object.keys(p).length)})},n.prototype._validate=function(s,p,g,x,T){return T===void 0&&(T={}),(!T||T.validate!==!1)&&pr(this,s.call(yl,{key:p,layerType:this.type,objectKey:g,value:x,styleSpec:Ee,style:{glyphs:!0,sprite:!0}}))},n.prototype.is3D=function(){return!1},n.prototype.isTileClipped=function(){return!1},n.prototype.hasOffscreenPass=function(){return!1},n.prototype.resize=function(){},n.prototype.isStateDependent=function(){for(var s in this.paint._values){var p=this.paint.get(s);if(p instanceof oo&&So(p.property.specification)&&(p.value.kind==="source"||p.value.kind==="composite")&&p.value.isStateDependent)return!0}return!1},n}(st),r={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},c=function(e,n){this._structArray=e,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},m=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function _(e,n){n===void 0&&(n=1);var s=0,p=0;return{members:e.map(function(g){var x=r[g.type].BYTES_PER_ELEMENT,T=s=S(s,Math.max(n,x)),D=g.components||1;return p=Math.max(p,x),s+=x*D,{name:g.name,type:g.type,components:D,offset:T}}),size:S(s,Math.max(p,n)),alignment:n}}function S(e,n){return Math.ceil(e/n)*n}m.serialize=function(e,n){return e._trim(),n&&(e.isTransferred=!0,n.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},m.deserialize=function(e){var n=Object.create(this.prototype);return n.arrayBuffer=e.arrayBuffer,n.length=e.length,n.capacity=e.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n},m.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},m.prototype.clear=function(){this.length=0},m.prototype.resize=function(e){this.reserve(e),this.length=e},m.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}},m.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var z=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(s,p){var g=this.length;return this.resize(g+1),this.emplace(g,s,p)},n.prototype.emplace=function(s,p,g){var x=2*s;return this.int16[x+0]=p,this.int16[x+1]=g,s},n}(m);z.prototype.bytesPerElement=4,fr("StructArrayLayout2i4",z);var N=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(s,p,g,x){var T=this.length;return this.resize(T+1),this.emplace(T,s,p,g,x)},n.prototype.emplace=function(s,p,g,x,T){var D=4*s;return this.int16[D+0]=p,this.int16[D+1]=g,this.int16[D+2]=x,this.int16[D+3]=T,s},n}(m);N.prototype.bytesPerElement=8,fr("StructArrayLayout4i8",N);var $=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(s,p,g,x,T,D){var j=this.length;return this.resize(j+1),this.emplace(j,s,p,g,x,T,D)},n.prototype.emplace=function(s,p,g,x,T,D,j){var ee=6*s;return this.int16[ee+0]=p,this.int16[ee+1]=g,this.int16[ee+2]=x,this.int16[ee+3]=T,this.int16[ee+4]=D,this.int16[ee+5]=j,s},n}(m);$.prototype.bytesPerElement=12,fr("StructArrayLayout2i4i12",$);var W=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(s,p,g,x,T,D){var j=this.length;return this.resize(j+1),this.emplace(j,s,p,g,x,T,D)},n.prototype.emplace=function(s,p,g,x,T,D,j){var ee=4*s,oe=8*s;return this.int16[ee+0]=p,this.int16[ee+1]=g,this.uint8[oe+4]=x,this.uint8[oe+5]=T,this.uint8[oe+6]=D,this.uint8[oe+7]=j,s},n}(m);W.prototype.bytesPerElement=8,fr("StructArrayLayout2i4ub8",W);var ce=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(s,p){var g=this.length;return this.resize(g+1),this.emplace(g,s,p)},n.prototype.emplace=function(s,p,g){var x=2*s;return this.float32[x+0]=p,this.float32[x+1]=g,s},n}(m);ce.prototype.bytesPerElement=8,fr("StructArrayLayout2f8",ce);var ge=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(s,p,g,x,T,D,j,ee,oe,le){var ye=this.length;return this.resize(ye+1),this.emplace(ye,s,p,g,x,T,D,j,ee,oe,le)},n.prototype.emplace=function(s,p,g,x,T,D,j,ee,oe,le,ye){var i=10*s;return this.uint16[i+0]=p,this.uint16[i+1]=g,this.uint16[i+2]=x,this.uint16[i+3]=T,this.uint16[i+4]=D,this.uint16[i+5]=j,this.uint16[i+6]=ee,this.uint16[i+7]=oe,this.uint16[i+8]=le,this.uint16[i+9]=ye,s},n}(m);ge.prototype.bytesPerElement=20,fr("StructArrayLayout10ui20",ge);var Ce=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(s,p,g,x,T,D,j,ee,oe,le,ye,i){var t=this.length;return this.resize(t+1),this.emplace(t,s,p,g,x,T,D,j,ee,oe,le,ye,i)},n.prototype.emplace=function(s,p,g,x,T,D,j,ee,oe,le,ye,i,t){var a=12*s;return this.int16[a+0]=p,this.int16[a+1]=g,this.int16[a+2]=x,this.int16[a+3]=T,this.uint16[a+4]=D,this.uint16[a+5]=j,this.uint16[a+6]=ee,this.uint16[a+7]=oe,this.int16[a+8]=le,this.int16[a+9]=ye,this.int16[a+10]=i,this.int16[a+11]=t,s},n}(m);Ce.prototype.bytesPerElement=24,fr("StructArrayLayout4i4ui4i24",Ce);var je=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(s,p,g){var x=this.length;return this.resize(x+1),this.emplace(x,s,p,g)},n.prototype.emplace=function(s,p,g,x){var T=3*s;return this.float32[T+0]=p,this.float32[T+1]=g,this.float32[T+2]=x,s},n}(m);je.prototype.bytesPerElement=12,fr("StructArrayLayout3f12",je);var De=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(s){var p=this.length;return this.resize(p+1),this.emplace(p,s)},n.prototype.emplace=function(s,p){return this.uint32[1*s+0]=p,s},n}(m);De.prototype.bytesPerElement=4,fr("StructArrayLayout1ul4",De);var Ke=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(s,p,g,x,T,D,j,ee,oe){var le=this.length;return this.resize(le+1),this.emplace(le,s,p,g,x,T,D,j,ee,oe)},n.prototype.emplace=function(s,p,g,x,T,D,j,ee,oe,le){var ye=10*s,i=5*s;return this.int16[ye+0]=p,this.int16[ye+1]=g,this.int16[ye+2]=x,this.int16[ye+3]=T,this.int16[ye+4]=D,this.int16[ye+5]=j,this.uint32[i+3]=ee,this.uint16[ye+8]=oe,this.uint16[ye+9]=le,s},n}(m);Ke.prototype.bytesPerElement=20,fr("StructArrayLayout6i1ul2ui20",Ke);var lt=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(s,p,g,x,T,D){var j=this.length;return this.resize(j+1),this.emplace(j,s,p,g,x,T,D)},n.prototype.emplace=function(s,p,g,x,T,D,j){var ee=6*s;return this.int16[ee+0]=p,this.int16[ee+1]=g,this.int16[ee+2]=x,this.int16[ee+3]=T,this.int16[ee+4]=D,this.int16[ee+5]=j,s},n}(m);lt.prototype.bytesPerElement=12,fr("StructArrayLayout2i2i2i12",lt);var ht=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(s,p,g,x,T){var D=this.length;return this.resize(D+1),this.emplace(D,s,p,g,x,T)},n.prototype.emplace=function(s,p,g,x,T,D){var j=4*s,ee=8*s;return this.float32[j+0]=p,this.float32[j+1]=g,this.float32[j+2]=x,this.int16[ee+6]=T,this.int16[ee+7]=D,s},n}(m);ht.prototype.bytesPerElement=16,fr("StructArrayLayout2f1f2i16",ht);var vt=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(s,p,g,x){var T=this.length;return this.resize(T+1),this.emplace(T,s,p,g,x)},n.prototype.emplace=function(s,p,g,x,T){var D=12*s,j=3*s;return this.uint8[D+0]=p,this.uint8[D+1]=g,this.float32[j+1]=x,this.float32[j+2]=T,s},n}(m);vt.prototype.bytesPerElement=12,fr("StructArrayLayout2ub2f12",vt);var $e=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(s,p,g){var x=this.length;return this.resize(x+1),this.emplace(x,s,p,g)},n.prototype.emplace=function(s,p,g,x){var T=3*s;return this.uint16[T+0]=p,this.uint16[T+1]=g,this.uint16[T+2]=x,s},n}(m);$e.prototype.bytesPerElement=6,fr("StructArrayLayout3ui6",$e);var Ct=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(s,p,g,x,T,D,j,ee,oe,le,ye,i,t,a,h,f,v){var w=this.length;return this.resize(w+1),this.emplace(w,s,p,g,x,T,D,j,ee,oe,le,ye,i,t,a,h,f,v)},n.prototype.emplace=function(s,p,g,x,T,D,j,ee,oe,le,ye,i,t,a,h,f,v,w){var k=24*s,L=12*s,O=48*s;return this.int16[k+0]=p,this.int16[k+1]=g,this.uint16[k+2]=x,this.uint16[k+3]=T,this.uint32[L+2]=D,this.uint32[L+3]=j,this.uint32[L+4]=ee,this.uint16[k+10]=oe,this.uint16[k+11]=le,this.uint16[k+12]=ye,this.float32[L+7]=i,this.float32[L+8]=t,this.uint8[O+36]=a,this.uint8[O+37]=h,this.uint8[O+38]=f,this.uint32[L+10]=v,this.int16[k+22]=w,s},n}(m);Ct.prototype.bytesPerElement=48,fr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ct);var wt=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(s,p,g,x,T,D,j,ee,oe,le,ye,i,t,a,h,f,v,w,k,L,O,Z,re,he,de,me,Ue,Qe){var Ye=this.length;return this.resize(Ye+1),this.emplace(Ye,s,p,g,x,T,D,j,ee,oe,le,ye,i,t,a,h,f,v,w,k,L,O,Z,re,he,de,me,Ue,Qe)},n.prototype.emplace=function(s,p,g,x,T,D,j,ee,oe,le,ye,i,t,a,h,f,v,w,k,L,O,Z,re,he,de,me,Ue,Qe,Ye){var ot=34*s,nt=17*s;return this.int16[ot+0]=p,this.int16[ot+1]=g,this.int16[ot+2]=x,this.int16[ot+3]=T,this.int16[ot+4]=D,this.int16[ot+5]=j,this.int16[ot+6]=ee,this.int16[ot+7]=oe,this.uint16[ot+8]=le,this.uint16[ot+9]=ye,this.uint16[ot+10]=i,this.uint16[ot+11]=t,this.uint16[ot+12]=a,this.uint16[ot+13]=h,this.uint16[ot+14]=f,this.uint16[ot+15]=v,this.uint16[ot+16]=w,this.uint16[ot+17]=k,this.uint16[ot+18]=L,this.uint16[ot+19]=O,this.uint16[ot+20]=Z,this.uint16[ot+21]=re,this.uint16[ot+22]=he,this.uint32[nt+12]=de,this.float32[nt+13]=me,this.float32[nt+14]=Ue,this.float32[nt+15]=Qe,this.float32[nt+16]=Ye,s},n}(m);wt.prototype.bytesPerElement=68,fr("StructArrayLayout8i15ui1ul4f68",wt);var Mt=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(s){var p=this.length;return this.resize(p+1),this.emplace(p,s)},n.prototype.emplace=function(s,p){return this.float32[1*s+0]=p,s},n}(m);Mt.prototype.bytesPerElement=4,fr("StructArrayLayout1f4",Mt);var Ft=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(s,p,g){var x=this.length;return this.resize(x+1),this.emplace(x,s,p,g)},n.prototype.emplace=function(s,p,g,x){var T=3*s;return this.int16[T+0]=p,this.int16[T+1]=g,this.int16[T+2]=x,s},n}(m);Ft.prototype.bytesPerElement=6,fr("StructArrayLayout3i6",Ft);var jt=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(s,p,g){var x=this.length;return this.resize(x+1),this.emplace(x,s,p,g)},n.prototype.emplace=function(s,p,g,x){var T=4*s;return this.uint32[2*s+0]=p,this.uint16[T+2]=g,this.uint16[T+3]=x,s},n}(m);jt.prototype.bytesPerElement=8,fr("StructArrayLayout1ul2ui8",jt);var St=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(s,p){var g=this.length;return this.resize(g+1),this.emplace(g,s,p)},n.prototype.emplace=function(s,p,g){var x=2*s;return this.uint16[x+0]=p,this.uint16[x+1]=g,s},n}(m);St.prototype.bytesPerElement=4,fr("StructArrayLayout2ui4",St);var mr=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},n.prototype.emplaceBack=function(s){var p=this.length;return this.resize(p+1),this.emplace(p,s)},n.prototype.emplace=function(s,p){return this.uint16[1*s+0]=p,s},n}(m);mr.prototype.bytesPerElement=2,fr("StructArrayLayout1ui2",mr);var sr=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},n.prototype.emplaceBack=function(s,p,g,x){var T=this.length;return this.resize(T+1),this.emplace(T,s,p,g,x)},n.prototype.emplace=function(s,p,g,x,T){var D=4*s;return this.float32[D+0]=p,this.float32[D+1]=g,this.float32[D+2]=x,this.float32[D+3]=T,s},n}(m);sr.prototype.bytesPerElement=16,fr("StructArrayLayout4f16",sr);var l=function(e){function n(){e.apply(this,arguments)}e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n;var s={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return s.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},s.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},s.x1.get=function(){return this._structArray.int16[this._pos2+2]},s.y1.get=function(){return this._structArray.int16[this._pos2+3]},s.x2.get=function(){return this._structArray.int16[this._pos2+4]},s.y2.get=function(){return this._structArray.int16[this._pos2+5]},s.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},s.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},s.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},s.anchorPoint.get=function(){return new Y(this.anchorPointX,this.anchorPointY)},Object.defineProperties(n.prototype,s),n}(c);l.prototype.size=20;var u=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.get=function(s){return new l(this,s)},n}(Ke);fr("CollisionBoxArray",u);var A=function(e){function n(){e.apply(this,arguments)}e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n;var s={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return s.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},s.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},s.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},s.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},s.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},s.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},s.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},s.segment.get=function(){return this._structArray.uint16[this._pos2+10]},s.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},s.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},s.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},s.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},s.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},s.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},s.placedOrientation.set=function(p){this._structArray.uint8[this._pos1+37]=p},s.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},s.hidden.set=function(p){this._structArray.uint8[this._pos1+38]=p},s.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},s.crossTileID.set=function(p){this._structArray.uint32[this._pos4+10]=p},s.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(n.prototype,s),n}(c);A.prototype.size=48;var d=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.get=function(s){return new A(this,s)},n}(Ct);fr("PlacedSymbolArray",d);var b=function(e){function n(){e.apply(this,arguments)}e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n;var s={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return s.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},s.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},s.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},s.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},s.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},s.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},s.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},s.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},s.key.get=function(){return this._structArray.uint16[this._pos2+8]},s.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},s.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},s.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},s.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},s.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},s.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},s.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},s.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},s.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},s.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},s.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},s.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},s.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},s.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},s.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},s.crossTileID.set=function(p){this._structArray.uint32[this._pos4+12]=p},s.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},s.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},s.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},s.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(n.prototype,s),n}(c);b.prototype.size=68;var M=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.get=function(s){return new b(this,s)},n}(wt);fr("SymbolInstanceArray",M);var Q=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.getoffsetX=function(s){return this.float32[1*s+0]},n}(Mt);fr("GlyphOffsetArray",Q);var R=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.getx=function(s){return this.int16[3*s+0]},n.prototype.gety=function(s){return this.int16[3*s+1]},n.prototype.gettileUnitDistanceFromAnchor=function(s){return this.int16[3*s+2]},n}(Ft);fr("SymbolLineVertexArray",R);var J=function(e){function n(){e.apply(this,arguments)}e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n;var s={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return s.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},s.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},s.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(n.prototype,s),n}(c);J.prototype.size=8;var Ae=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.get=function(s){return new J(this,s)},n}(jt);fr("FeatureIndexArray",Ae);var Be=_([{name:"a_pos",components:2,type:"Int16"}],4).members,Ie=function(e){e===void 0&&(e=[]),this.segments=e};function Te(e,n){return 256*(e=_t(Math.floor(e),0,255))+_t(Math.floor(n),0,255)}Ie.prototype.prepareSegment=function(e,n,s,p){var g=this.segments[this.segments.length-1];return e>Ie.MAX_VERTEX_ARRAY_LENGTH&&rr("Max vertices per segment is "+Ie.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!g||g.vertexLength+e>Ie.MAX_VERTEX_ARRAY_LENGTH||g.sortKey!==p)&&(g={vertexOffset:n.length,primitiveOffset:s.length,vertexLength:0,primitiveLength:0},p!==void 0&&(g.sortKey=p),this.segments.push(g)),g},Ie.prototype.get=function(){return this.segments},Ie.prototype.destroy=function(){for(var e=0,n=this.segments;e<n.length;e+=1){var s=n[e];for(var p in s.vaos)s.vaos[p].destroy()}},Ie.simpleSegment=function(e,n,s,p){return new Ie([{vertexOffset:e,primitiveOffset:n,vertexLength:s,primitiveLength:p,vaos:{},sortKey:0}])},Ie.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,fr("SegmentVector",Ie);var He=_([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Le=q(function(e){e.exports=function(n,s){var p,g,x,T,D,j,ee,oe;for(g=n.length-(p=3&n.length),x=s,D=3432918353,j=461845907,oe=0;oe<g;)ee=255&n.charCodeAt(oe)|(255&n.charCodeAt(++oe))<<8|(255&n.charCodeAt(++oe))<<16|(255&n.charCodeAt(++oe))<<24,++oe,x=27492+(65535&(T=5*(65535&(x=(x^=ee=(65535&(ee=(ee=(65535&ee)*D+(((ee>>>16)*D&65535)<<16)&4294967295)<<15|ee>>>17))*j+(((ee>>>16)*j&65535)<<16)&4294967295)<<13|x>>>19))+((5*(x>>>16)&65535)<<16)&4294967295))+((58964+(T>>>16)&65535)<<16);switch(ee=0,p){case 3:ee^=(255&n.charCodeAt(oe+2))<<16;case 2:ee^=(255&n.charCodeAt(oe+1))<<8;case 1:x^=ee=(65535&(ee=(ee=(65535&(ee^=255&n.charCodeAt(oe)))*D+(((ee>>>16)*D&65535)<<16)&4294967295)<<15|ee>>>17))*j+(((ee>>>16)*j&65535)<<16)&4294967295}return x^=n.length,x=2246822507*(65535&(x^=x>>>16))+((2246822507*(x>>>16)&65535)<<16)&4294967295,x=3266489909*(65535&(x^=x>>>13))+((3266489909*(x>>>16)&65535)<<16)&4294967295,(x^=x>>>16)>>>0}}),qe=q(function(e){e.exports=function(n,s){for(var p,g=n.length,x=s^g,T=0;g>=4;)p=1540483477*(65535&(p=255&n.charCodeAt(T)|(255&n.charCodeAt(++T))<<8|(255&n.charCodeAt(++T))<<16|(255&n.charCodeAt(++T))<<24))+((1540483477*(p>>>16)&65535)<<16),x=1540483477*(65535&x)+((1540483477*(x>>>16)&65535)<<16)^(p=1540483477*(65535&(p^=p>>>24))+((1540483477*(p>>>16)&65535)<<16)),g-=4,++T;switch(g){case 3:x^=(255&n.charCodeAt(T+2))<<16;case 2:x^=(255&n.charCodeAt(T+1))<<8;case 1:x=1540483477*(65535&(x^=255&n.charCodeAt(T)))+((1540483477*(x>>>16)&65535)<<16)}return x=1540483477*(65535&(x^=x>>>13))+((1540483477*(x>>>16)&65535)<<16),(x^=x>>>15)>>>0}}),ke=Le,Xe=qe;ke.murmur3=Le,ke.murmur2=Xe;var et=function(){this.ids=[],this.positions=[],this.indexed=!1};et.prototype.add=function(e,n,s,p){this.ids.push(mt(e)),this.positions.push(n,s,p)},et.prototype.getPositions=function(e){for(var n=mt(e),s=0,p=this.ids.length-1;s<p;){var g=s+p>>1;this.ids[g]>=n?p=g:s=g+1}for(var x=[];this.ids[s]===n;)x.push({index:this.positions[3*s],start:this.positions[3*s+1],end:this.positions[3*s+2]}),s++;return x},et.serialize=function(e,n){var s=new Float64Array(e.ids),p=new Uint32Array(e.positions);return function g(x,T,D,j){for(;D<j;){for(var ee=x[D+j>>1],oe=D-1,le=j+1;;){do oe++;while(x[oe]<ee);do le--;while(x[le]>ee);if(oe>=le)break;Ze(x,oe,le),Ze(T,3*oe,3*le),Ze(T,3*oe+1,3*le+1),Ze(T,3*oe+2,3*le+2)}le-D<j-le?(g(x,T,D,le),D=le+1):(g(x,T,le+1,j),j=le)}}(s,p,0,s.length-1),n&&n.push(s.buffer,p.buffer),{ids:s,positions:p}},et.deserialize=function(e){var n=new et;return n.ids=e.ids,n.positions=e.positions,n.indexed=!0,n};var at=Math.pow(2,53)-1;function mt(e){var n=+e;return!isNaN(n)&&n<=at?n:ke(String(e))}function Ze(e,n,s){var p=e[n];e[n]=e[s],e[s]=p}fr("FeaturePositionMap",et);var bt=function(e,n){this.gl=e.gl,this.location=n},Tt=function(e){function n(s,p){e.call(this,s,p),this.current=0}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.set=function(s){this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))},n}(bt),Vt=function(e){function n(s,p){e.call(this,s,p),this.current=0}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.set=function(s){this.current!==s&&(this.current=s,this.gl.uniform1f(this.location,s))},n}(bt),Ht=function(e){function n(s,p){e.call(this,s,p),this.current=[0,0]}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.set=function(s){s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1]))},n}(bt),hr=function(e){function n(s,p){e.call(this,s,p),this.current=[0,0,0]}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.set=function(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2]))},n}(bt),Er=function(e){function n(s,p){e.call(this,s,p),this.current=[0,0,0,0]}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.set=function(s){s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]&&s[3]===this.current[3]||(this.current=s,this.gl.uniform4f(this.location,s[0],s[1],s[2],s[3]))},n}(bt),Mr=function(e){function n(s,p){e.call(this,s,p),this.current=Tr.transparent}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.set=function(s){s.r===this.current.r&&s.g===this.current.g&&s.b===this.current.b&&s.a===this.current.a||(this.current=s,this.gl.uniform4f(this.location,s.r,s.g,s.b,s.a))},n}(bt),Ur=new Float32Array(16),gi=function(e){function n(s,p){e.call(this,s,p),this.current=Ur}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.set=function(s){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(var p=1;p<16;p++)if(s[p]!==this.current[p]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}},n}(bt);function lr(e){return[Te(255*e.r,255*e.g),Te(255*e.b,255*e.a)]}var zr=function(e,n,s){this.value=e,this.uniformNames=n.map(function(p){return"u_"+p}),this.type=s};zr.prototype.setUniform=function(e,n,s){e.set(s.constantOr(this.value))},zr.prototype.getBinding=function(e,n,s){return this.type==="color"?new Mr(e,n):new Vt(e,n)};var $r=function(e,n){this.uniformNames=n.map(function(s){return"u_"+s}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};$r.prototype.setConstantPatternPositions=function(e,n){this.pixelRatioFrom=n.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=n.tlbr,this.patternTo=e.tlbr},$r.prototype.setUniform=function(e,n,s,p){var g=p==="u_pattern_to"?this.patternTo:p==="u_pattern_from"?this.patternFrom:p==="u_pixel_ratio_to"?this.pixelRatioTo:p==="u_pixel_ratio_from"?this.pixelRatioFrom:null;g&&e.set(g)},$r.prototype.getBinding=function(e,n,s){return s.substr(0,9)==="u_pattern"?new Er(e,n):new Vt(e,n)};var qr=function(e,n,s,p){this.expression=e,this.type=s,this.maxValue=0,this.paintVertexAttributes=n.map(function(g){return{name:"a_"+g,type:"Float32",components:s==="color"?2:1,offset:0}}),this.paintVertexArray=new p};qr.prototype.populatePaintArray=function(e,n,s,p,g){var x=this.paintVertexArray.length,T=this.expression.evaluate(new pi(0),n,{},p,[],g);this.paintVertexArray.resize(e),this._setPaintValue(x,e,T)},qr.prototype.updatePaintArray=function(e,n,s,p){var g=this.expression.evaluate({zoom:0},s,p);this._setPaintValue(e,n,g)},qr.prototype._setPaintValue=function(e,n,s){if(this.type==="color")for(var p=lr(s),g=e;g<n;g++)this.paintVertexArray.emplace(g,p[0],p[1]);else{for(var x=e;x<n;x++)this.paintVertexArray.emplace(x,s);this.maxValue=Math.max(this.maxValue,Math.abs(s))}},qr.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},qr.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Zr=function(e,n,s,p,g,x){this.expression=e,this.uniformNames=n.map(function(T){return"u_"+T+"_t"}),this.type=s,this.useIntegerZoom=p,this.zoom=g,this.maxValue=0,this.paintVertexAttributes=n.map(function(T){return{name:"a_"+T,type:"Float32",components:s==="color"?4:2,offset:0}}),this.paintVertexArray=new x};Zr.prototype.populatePaintArray=function(e,n,s,p,g){var x=this.expression.evaluate(new pi(this.zoom),n,{},p,[],g),T=this.expression.evaluate(new pi(this.zoom+1),n,{},p,[],g),D=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(D,e,x,T)},Zr.prototype.updatePaintArray=function(e,n,s,p){var g=this.expression.evaluate({zoom:this.zoom},s,p),x=this.expression.evaluate({zoom:this.zoom+1},s,p);this._setPaintValue(e,n,g,x)},Zr.prototype._setPaintValue=function(e,n,s,p){if(this.type==="color")for(var g=lr(s),x=lr(p),T=e;T<n;T++)this.paintVertexArray.emplace(T,g[0],g[1],x[0],x[1]);else{for(var D=e;D<n;D++)this.paintVertexArray.emplace(D,s,p);this.maxValue=Math.max(this.maxValue,Math.abs(s),Math.abs(p))}},Zr.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Zr.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Zr.prototype.setUniform=function(e,n){var s=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,p=_t(this.expression.interpolationFactor(s,this.zoom,this.zoom+1),0,1);e.set(p)},Zr.prototype.getBinding=function(e,n,s){return new Vt(e,n)};var si=function(e,n,s,p,g,x){this.expression=e,this.type=n,this.useIntegerZoom=s,this.zoom=p,this.layerId=x,this.zoomInPaintVertexArray=new g,this.zoomOutPaintVertexArray=new g};si.prototype.populatePaintArray=function(e,n,s){var p=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(p,e,n.patterns&&n.patterns[this.layerId],s)},si.prototype.updatePaintArray=function(e,n,s,p,g){this._setPaintValues(e,n,s.patterns&&s.patterns[this.layerId],g)},si.prototype._setPaintValues=function(e,n,s,p){if(p&&s){var g=p[s.min],x=p[s.mid],T=p[s.max];if(g&&x&&T)for(var D=e;D<n;D++)this.zoomInPaintVertexArray.emplace(D,x.tl[0],x.tl[1],x.br[0],x.br[1],g.tl[0],g.tl[1],g.br[0],g.br[1],x.pixelRatio,g.pixelRatio),this.zoomOutPaintVertexArray.emplace(D,x.tl[0],x.tl[1],x.br[0],x.br[1],T.tl[0],T.tl[1],T.br[0],T.br[1],x.pixelRatio,T.pixelRatio)}},si.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,He.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,He.members,this.expression.isStateDependent))},si.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Lr=function(e,n,s){this.binders={},this._buffers=[];var p=[];for(var g in e.paint._values)if(s(g)){var x=e.paint.get(g);if(x instanceof oo&&So(x.property.specification)){var T=Kn(g,e.type),D=x.value,j=x.property.specification.type,ee=x.property.useIntegerZoom,oe=x.property.specification["property-type"],le=oe==="cross-faded"||oe==="cross-faded-data-driven";if(D.kind==="constant")this.binders[g]=le?new $r(D.value,T):new zr(D.value,T,j),p.push("/u_"+g);else if(D.kind==="source"||le){var ye=dn(g,j,"source");this.binders[g]=le?new si(D,j,ee,n,ye,e.id):new qr(D,T,j,ye),p.push("/a_"+g)}else{var i=dn(g,j,"composite");this.binders[g]=new Zr(D,T,j,ee,n,i),p.push("/z_"+g)}}}this.cacheKey=p.sort().join("")};Lr.prototype.getMaxValue=function(e){var n=this.binders[e];return n instanceof qr||n instanceof Zr?n.maxValue:0},Lr.prototype.populatePaintArrays=function(e,n,s,p,g){for(var x in this.binders){var T=this.binders[x];(T instanceof qr||T instanceof Zr||T instanceof si)&&T.populatePaintArray(e,n,s,p,g)}},Lr.prototype.setConstantPatternPositions=function(e,n){for(var s in this.binders){var p=this.binders[s];p instanceof $r&&p.setConstantPatternPositions(e,n)}},Lr.prototype.updatePaintArrays=function(e,n,s,p,g){var x=!1;for(var T in e)for(var D=0,j=n.getPositions(T);D<j.length;D+=1){var ee=j[D],oe=s.feature(ee.index);for(var le in this.binders){var ye=this.binders[le];if((ye instanceof qr||ye instanceof Zr||ye instanceof si)&&ye.expression.isStateDependent===!0){var i=p.paint.get(le);ye.expression=i.value,ye.updatePaintArray(ee.start,ee.end,oe,e[T],g),x=!0}}}return x},Lr.prototype.defines=function(){var e=[];for(var n in this.binders){var s=this.binders[n];(s instanceof zr||s instanceof $r)&&e.push.apply(e,s.uniformNames.map(function(p){return"#define HAS_UNIFORM_"+p}))}return e},Lr.prototype.getBinderAttributes=function(){var e=[];for(var n in this.binders){var s=this.binders[n];if(s instanceof qr||s instanceof Zr)for(var p=0;p<s.paintVertexAttributes.length;p++)e.push(s.paintVertexAttributes[p].name);else if(s instanceof si)for(var g=0;g<He.members.length;g++)e.push(He.members[g].name)}return e},Lr.prototype.getBinderUniforms=function(){var e=[];for(var n in this.binders){var s=this.binders[n];if(s instanceof zr||s instanceof $r||s instanceof Zr)for(var p=0,g=s.uniformNames;p<g.length;p+=1)e.push(g[p])}return e},Lr.prototype.getPaintVertexBuffers=function(){return this._buffers},Lr.prototype.getUniforms=function(e,n){var s=[];for(var p in this.binders){var g=this.binders[p];if(g instanceof zr||g instanceof $r||g instanceof Zr)for(var x=0,T=g.uniformNames;x<T.length;x+=1){var D=T[x];if(n[D]){var j=g.getBinding(e,n[D],D);s.push({name:D,property:p,binding:j})}}}return s},Lr.prototype.setUniforms=function(e,n,s,p){for(var g=0,x=n;g<x.length;g+=1){var T=x[g],D=T.name,j=T.property;this.binders[j].setUniform(T.binding,p,s.get(j),D)}},Lr.prototype.updatePaintBuffers=function(e){for(var n in this._buffers=[],this.binders){var s=this.binders[n];if(e&&s instanceof si){var p=e.fromScale===2?s.zoomInPaintVertexBuffer:s.zoomOutPaintVertexBuffer;p&&this._buffers.push(p)}else(s instanceof qr||s instanceof Zr)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}},Lr.prototype.upload=function(e){for(var n in this.binders){var s=this.binders[n];(s instanceof qr||s instanceof Zr||s instanceof si)&&s.upload(e)}this.updatePaintBuffers()},Lr.prototype.destroy=function(){for(var e in this.binders){var n=this.binders[e];(n instanceof qr||n instanceof Zr||n instanceof si)&&n.destroy()}};var Dr=function(e,n,s){s===void 0&&(s=function(){return!0}),this.programConfigurations={};for(var p=0,g=e;p<g.length;p+=1){var x=g[p];this.programConfigurations[x.id]=new Lr(x,n,s)}this.needsUpload=!1,this._featureMap=new et,this._bufferOffset=0};function Kn(e,n){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(n+"-","").replace(/-/g,"_")]}function dn(e,n,s){var p={color:{source:ce,composite:sr},number:{source:Mt,composite:ce}},g=function(x){return{"line-pattern":{source:ge,composite:ge},"fill-pattern":{source:ge,composite:ge},"fill-extrusion-pattern":{source:ge,composite:ge}}[x]}(e);return g&&g[s]||p[n][s]}Dr.prototype.populatePaintArrays=function(e,n,s,p,g,x){for(var T in this.programConfigurations)this.programConfigurations[T].populatePaintArrays(e,n,p,g,x);n.id!==void 0&&this._featureMap.add(n.id,s,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},Dr.prototype.updatePaintArrays=function(e,n,s,p){for(var g=0,x=s;g<x.length;g+=1){var T=x[g];this.needsUpload=this.programConfigurations[T.id].updatePaintArrays(e,this._featureMap,n,T,p)||this.needsUpload}},Dr.prototype.get=function(e){return this.programConfigurations[e]},Dr.prototype.upload=function(e){if(this.needsUpload){for(var n in this.programConfigurations)this.programConfigurations[n].upload(e);this.needsUpload=!1}},Dr.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},fr("ConstantBinder",zr),fr("CrossFadedConstantBinder",$r),fr("SourceExpressionBinder",qr),fr("CrossFadedCompositeBinder",si),fr("CompositeExpressionBinder",Zr),fr("ProgramConfiguration",Lr,{omit:["_buffers"]}),fr("ProgramConfigurationSet",Dr);var ao=Math.pow(2,14)-1,Vo=-ao-1;function Un(e){for(var n=8192/e.extent,s=e.loadGeometry(),p=0;p<s.length;p++)for(var g=s[p],x=0;x<g.length;x++){var T=g[x],D=Math.round(T.x*n),j=Math.round(T.y*n);T.x=_t(D,Vo,ao),T.y=_t(j,Vo,ao),(D<T.x||D>T.x+1||j<T.y||j>T.y+1)&&rr("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return s}function vo(e,n){return{type:e.type,id:e.id,properties:e.properties,geometry:n?Un(e):[]}}function Ea(e,n,s,p,g){e.emplaceBack(2*n+(p+1)/2,2*s+(g+1)/2)}var en=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(n){return n.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new z,this.indexArray=new $e,this.segments=new Ie,this.programConfigurations=new Dr(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(function(n){return n.isStateDependent()}).map(function(n){return n.id})};function ns(e,n){for(var s=0;s<e.length;s++)if(bs(n,e[s]))return!0;for(var p=0;p<n.length;p++)if(bs(e,n[p]))return!0;return!!sl(e,n)}function No(e,n,s){return!!bs(e,n)||!!ll(n,e,s)}function ma(e,n){if(e.length===1)return AA(n,e[0]);for(var s=0;s<n.length;s++)for(var p=n[s],g=0;g<p.length;g++)if(bs(e,p[g]))return!0;for(var x=0;x<e.length;x++)if(AA(n,e[x]))return!0;for(var T=0;T<n.length;T++)if(sl(e,n[T]))return!0;return!1}function Ko(e,n,s){if(e.length>1){if(sl(e,n))return!0;for(var p=0;p<n.length;p++)if(ll(n[p],e,s))return!0}for(var g=0;g<e.length;g++)if(ll(e[g],n,s))return!0;return!1}function sl(e,n){if(e.length===0||n.length===0)return!1;for(var s=0;s<e.length-1;s++)for(var p=e[s],g=e[s+1],x=0;x<n.length-1;x++)if(xl(p,g,n[x],n[x+1]))return!0;return!1}function xl(e,n,s,p){return kt(e,s,p)!==kt(n,s,p)&&kt(e,n,s)!==kt(e,n,p)}function ll(e,n,s){var p=s*s;if(n.length===1)return e.distSqr(n[0])<p;for(var g=1;g<n.length;g++)if(IA(e,n[g-1],n[g])<p)return!0;return!1}function IA(e,n,s){var p=n.distSqr(s);if(p===0)return e.distSqr(n);var g=((e.x-n.x)*(s.x-n.x)+(e.y-n.y)*(s.y-n.y))/p;return e.distSqr(g<0?n:g>1?s:s.sub(n)._mult(g)._add(n))}function AA(e,n){for(var s,p,g,x=!1,T=0;T<e.length;T++)for(var D=0,j=(s=e[T]).length-1;D<s.length;j=D++)(p=s[D]).y>n.y!=(g=s[j]).y>n.y&&n.x<(g.x-p.x)*(n.y-p.y)/(g.y-p.y)+p.x&&(x=!x);return x}function bs(e,n){for(var s=!1,p=0,g=e.length-1;p<e.length;g=p++){var x=e[p],T=e[g];x.y>n.y!=T.y>n.y&&n.x<(T.x-x.x)*(n.y-x.y)/(T.y-x.y)+x.x&&(s=!s)}return s}function wl(e,n,s){var p=s[0],g=s[2];if(e.x<p.x&&n.x<p.x||e.x>g.x&&n.x>g.x||e.y<p.y&&n.y<p.y||e.y>g.y&&n.y>g.y)return!1;var x=kt(e,n,s[0]);return x!==kt(e,n,s[1])||x!==kt(e,n,s[2])||x!==kt(e,n,s[3])}function Vs(e,n,s){var p=n.paint.get(e).value;return p.kind==="constant"?p.value:s.programConfigurations.get(n.id).getMaxValue(e)}function xo(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Ns(e,n,s,p,g){if(!n[0]&&!n[1])return e;var x=Y.convert(n)._mult(g);s==="viewport"&&x._rotate(-p);for(var T=[],D=0;D<e.length;D++)T.push(e[D].sub(x));return T}en.prototype.populate=function(e,n,s){var p=this.layers[0],g=[],x=null;p.type==="circle"&&(x=p.layout.get("circle-sort-key"));for(var T=0,D=e;T<D.length;T+=1){var j=D[T],ee=j.feature,oe=j.id,le=j.index,ye=j.sourceLayerIndex,i=this.layers[0]._featureFilter.needGeometry,t=vo(ee,i);if(this.layers[0]._featureFilter.filter(new pi(this.zoom),t,s)){var a=x?x.evaluate(t,{},s):void 0,h={id:oe,properties:ee.properties,type:ee.type,sourceLayerIndex:ye,index:le,geometry:i?t.geometry:Un(ee),patterns:{},sortKey:a};g.push(h)}}x&&g.sort(function(re,he){return re.sortKey-he.sortKey});for(var f=0,v=g;f<v.length;f+=1){var w=v[f],k=w.geometry,L=w.index,O=w.sourceLayerIndex,Z=e[L].feature;this.addFeature(w,k,L,s),n.featureIndex.insert(Z,k,L,O,this.index)}},en.prototype.update=function(e,n,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,s)},en.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},en.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},en.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Be),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},en.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},en.prototype.addFeature=function(e,n,s,p){for(var g=0,x=n;g<x.length;g+=1)for(var T=0,D=x[g];T<D.length;T+=1){var j=D[T],ee=j.x,oe=j.y;if(!(ee<0||ee>=8192||oe<0||oe>=8192)){var le=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),ye=le.vertexLength;Ea(this.layoutVertexArray,ee,oe,-1,-1),Ea(this.layoutVertexArray,ee,oe,1,-1),Ea(this.layoutVertexArray,ee,oe,1,1),Ea(this.layoutVertexArray,ee,oe,-1,1),this.indexArray.emplaceBack(ye,ye+1,ye+2),this.indexArray.emplaceBack(ye,ye+3,ye+2),le.vertexLength+=4,le.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,{},p)},fr("CircleBucket",en,{omit:["layers"]});var Al=new eo({"circle-sort-key":new cr(Ee.layout_circle["circle-sort-key"])}),Wa={paint:new eo({"circle-radius":new cr(Ee.paint_circle["circle-radius"]),"circle-color":new cr(Ee.paint_circle["circle-color"]),"circle-blur":new cr(Ee.paint_circle["circle-blur"]),"circle-opacity":new cr(Ee.paint_circle["circle-opacity"]),"circle-translate":new kr(Ee.paint_circle["circle-translate"]),"circle-translate-anchor":new kr(Ee.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new kr(Ee.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new kr(Ee.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new cr(Ee.paint_circle["circle-stroke-width"]),"circle-stroke-color":new cr(Ee.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new cr(Ee.paint_circle["circle-stroke-opacity"])}),layout:Al},tn=typeof Float32Array<"u"?Float32Array:Array;function ga(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function na(e,n,s){var p=n[0],g=n[1],x=n[2],T=n[3],D=n[4],j=n[5],ee=n[6],oe=n[7],le=n[8],ye=n[9],i=n[10],t=n[11],a=n[12],h=n[13],f=n[14],v=n[15],w=s[0],k=s[1],L=s[2],O=s[3];return e[0]=w*p+k*D+L*le+O*a,e[1]=w*g+k*j+L*ye+O*h,e[2]=w*x+k*ee+L*i+O*f,e[3]=w*T+k*oe+L*t+O*v,e[4]=(w=s[4])*p+(k=s[5])*D+(L=s[6])*le+(O=s[7])*a,e[5]=w*g+k*j+L*ye+O*h,e[6]=w*x+k*ee+L*i+O*f,e[7]=w*T+k*oe+L*t+O*v,e[8]=(w=s[8])*p+(k=s[9])*D+(L=s[10])*le+(O=s[11])*a,e[9]=w*g+k*j+L*ye+O*h,e[10]=w*x+k*ee+L*i+O*f,e[11]=w*T+k*oe+L*t+O*v,e[12]=(w=s[12])*p+(k=s[13])*D+(L=s[14])*le+(O=s[15])*a,e[13]=w*g+k*j+L*ye+O*h,e[14]=w*x+k*ee+L*i+O*f,e[15]=w*T+k*oe+L*t+O*v,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,n=0,s=arguments.length;s--;)n+=e[s]*e[s];return Math.sqrt(n)});var ko,Nc=na;function yc(e,n,s){var p=n[0],g=n[1],x=n[2],T=n[3];return e[0]=s[0]*p+s[4]*g+s[8]*x+s[12]*T,e[1]=s[1]*p+s[5]*g+s[9]*x+s[13]*T,e[2]=s[2]*p+s[6]*g+s[10]*x+s[14]*T,e[3]=s[3]*p+s[7]*g+s[11]*x+s[15]*T,e}ko=new tn(3),tn!=Float32Array&&(ko[0]=0,ko[1]=0,ko[2]=0),function(){var e=new tn(4);tn!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var Ia=(function(){var e=new tn(2);tn!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function n(s){e.call(this,s,Wa)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.createBucket=function(s){return new en(s)},n.prototype.queryRadius=function(s){var p=s;return Vs("circle-radius",this,p)+Vs("circle-stroke-width",this,p)+xo(this.paint.get("circle-translate"))},n.prototype.queryIntersectsFeature=function(s,p,g,x,T,D,j,ee){for(var oe=Ns(s,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),D.angle,j),le=this.paint.get("circle-radius").evaluate(p,g)+this.paint.get("circle-stroke-width").evaluate(p,g),ye=this.paint.get("circle-pitch-alignment")==="map",i=ye?oe:function(Z,re){return Z.map(function(he){return Go(he,re)})}(oe,ee),t=ye?le*j:le,a=0,h=x;a<h.length;a+=1)for(var f=0,v=h[a];f<v.length;f+=1){var w=v[f],k=ye?w:Go(w,ee),L=t,O=yc([],[w.x,w.y,0,1],ee);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?L*=O[3]/D.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(L*=D.cameraToCenterDistance/O[3]),No(i,k,L))return!0}return!1},n}(y));function Go(e,n){var s=yc([],[e.x,e.y,0,1],n);return new Y(s[0]/s[3],s[1]/s[3])}var Kc=function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n}(en);function Gl(e,n,s,p){var g=n.width,x=n.height;if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==g*x*s)throw new RangeError("mismatched image size")}else p=new Uint8Array(g*x*s);return e.width=g,e.height=x,e.data=p,e}function XA(e,n,s){var p=n.width,g=n.height;if(p!==e.width||g!==e.height){var x=Gl({},{width:p,height:g},s);WA(e,x,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,p),height:Math.min(e.height,g)},s),e.width=p,e.height=g,e.data=x.data}}function WA(e,n,s,p,g,x){if(g.width===0||g.height===0)return n;if(g.width>e.width||g.height>e.height||s.x>e.width-g.width||s.y>e.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>n.width||g.height>n.height||p.x>n.width-g.width||p.y>n.height-g.height)throw new RangeError("out of range destination coordinates for image copy");for(var T=e.data,D=n.data,j=0;j<g.height;j++)for(var ee=((s.y+j)*e.width+s.x)*x,oe=((p.y+j)*n.width+p.x)*x,le=0;le<g.width*x;le++)D[oe+le]=T[ee+le];return n}fr("HeatmapBucket",Kc,{omit:["layers"]});var JA=function(e,n){Gl(this,e,1,n)};JA.prototype.resize=function(e){XA(this,e,1)},JA.prototype.clone=function(){return new JA({width:this.width,height:this.height},new Uint8Array(this.data))},JA.copy=function(e,n,s,p,g){WA(e,n,s,p,g,1)};var Ha=function(e,n){Gl(this,e,4,n)};Ha.prototype.resize=function(e){XA(this,e,4)},Ha.prototype.replace=function(e,n){n?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},Ha.prototype.clone=function(){return new Ha({width:this.width,height:this.height},new Uint8Array(this.data))},Ha.copy=function(e,n,s,p,g){WA(e,n,s,p,g,4)},fr("AlphaImage",JA),fr("RGBAImage",Ha);var Xu={paint:new eo({"heatmap-radius":new cr(Ee.paint_heatmap["heatmap-radius"]),"heatmap-weight":new cr(Ee.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new kr(Ee.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ca(Ee.paint_heatmap["heatmap-color"]),"heatmap-opacity":new kr(Ee.paint_heatmap["heatmap-opacity"])})};function Gc(e){var n={},s=e.resolution||256,p=e.clips?e.clips.length:1,g=e.image||new Ha({width:s,height:p}),x=function(t,a,h){n[e.evaluationKey]=h;var f=e.expression.evaluate(n);g.data[t+a+0]=Math.floor(255*f.r/f.a),g.data[t+a+1]=Math.floor(255*f.g/f.a),g.data[t+a+2]=Math.floor(255*f.b/f.a),g.data[t+a+3]=Math.floor(255*f.a)};if(e.clips)for(var T=0,D=0;T<p;++T,D+=4*s)for(var j=0,ee=0;j<s;j++,ee+=4){var oe=j/(s-1),le=e.clips[T];x(D,ee,le.start*(1-oe)+le.end*oe)}else for(var ye=0,i=0;ye<s;ye++,i+=4)x(0,i,ye/(s-1));return g}var gu=function(e){function n(s){e.call(this,s,Xu),this._updateColorRamp()}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.createBucket=function(s){return new Kc(s)},n.prototype._handleSpecialPaintPropertyUpdate=function(s){s==="heatmap-color"&&this._updateColorRamp()},n.prototype._updateColorRamp=function(){this.colorRamp=Gc({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},n.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},n.prototype.queryRadius=function(){return 0},n.prototype.queryIntersectsFeature=function(){return!1},n.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},n}(y),Wu={paint:new eo({"hillshade-illumination-direction":new kr(Ee.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new kr(Ee.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new kr(Ee.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new kr(Ee.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new kr(Ee.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new kr(Ee.paint_hillshade["hillshade-accent-color"])})},Sa=function(e){function n(s){e.call(this,s,Wu)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},n}(y),jc=_([{name:"a_pos",components:2,type:"Int16"}],4).members,$c=YA,Eh=YA;function YA(e,n,s){s=s||2;var p,g,x,T,D,j,ee,oe=n&&n.length,le=oe?n[0]*s:e.length,ye=SA(e,0,le,s,!0),i=[];if(!ye||ye.next===ye.prev)return i;if(oe&&(ye=function(a,h,f,v){var w,k,L,O=[];for(w=0,k=h.length;w<k;w++)(L=SA(a,h[w]*v,w<k-1?h[w+1]*v:a.length,v,!1))===L.next&&(L.steiner=!0),O.push(Sh(L));for(O.sort(_u),w=0;w<O.length;w++)Ih(O[w],f),f=oa(f,f.next);return f}(e,n,ye,s)),e.length>80*s){p=x=e[0],g=T=e[1];for(var t=s;t<le;t+=s)(D=e[t])<p&&(p=D),(j=e[t+1])<g&&(g=j),D>x&&(x=D),j>T&&(T=j);ee=(ee=Math.max(x-p,T-g))!==0?1/ee:0}return _c(ye,i,s,p,g,ee),i}function SA(e,n,s,p,g){var x,T;if(g===qc(e,n,s,p)>0)for(x=n;x<s;x+=p)T=Yu(x,e[x],e[x+1],T);else for(x=s-p;x>=n;x-=p)T=Yu(x,e[x],e[x+1],T);return T&&vu(T,T.next)&&(Jn(T),T=T.next),T}function oa(e,n){if(!e)return e;n||(n=e);var s,p=e;do if(s=!1,p.steiner||!vu(p,p.next)&&Po(p.prev,p,p.next)!==0)p=p.next;else{if(Jn(p),(p=n=p.prev)===p.next)break;s=!0}while(s||p!==n);return n}function _c(e,n,s,p,g,x,T){if(e){!T&&x&&function(oe,le,ye,i){var t=oe;do t.z===null&&(t.z=FA(t.x,t.y,le,ye,i)),t.prevZ=t.prev,t.nextZ=t.next,t=t.next;while(t!==oe);t.prevZ.nextZ=null,t.prevZ=null,function(a){var h,f,v,w,k,L,O,Z,re=1;do{for(f=a,a=null,k=null,L=0;f;){for(L++,v=f,O=0,h=0;h<re&&(O++,v=v.nextZ);h++);for(Z=re;O>0||Z>0&&v;)O!==0&&(Z===0||!v||f.z<=v.z)?(w=f,f=f.nextZ,O--):(w=v,v=v.nextZ,Z--),k?k.nextZ=w:a=w,w.prevZ=k,k=w;f=v}k.nextZ=null,re*=2}while(L>1)}(t)}(e,p,g,x);for(var D,j,ee=e;e.prev!==e.next;)if(D=e.prev,j=e.next,x?xp(e,p,g,x):vp(e))n.push(D.i/s),n.push(e.i/s),n.push(j.i/s),Jn(e),e=j.next,ee=j.next;else if((e=j)===ee){T?T===1?_c(e=wp(oa(e),n,s),n,s,p,g,x,2):T===2&&yu(e,n,s,p,g,x):_c(oa(e),n,s,p,g,x,1);break}}}function vp(e){var n=e.prev,s=e,p=e.next;if(Po(n,s,p)>=0)return!1;for(var g=e.next.next;g!==e.prev;){if(ec(n.x,n.y,s.x,s.y,p.x,p.y,g.x,g.y)&&Po(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function xp(e,n,s,p){var g=e.prev,x=e,T=e.next;if(Po(g,x,T)>=0)return!1;for(var D=g.x>x.x?g.x>T.x?g.x:T.x:x.x>T.x?x.x:T.x,j=g.y>x.y?g.y>T.y?g.y:T.y:x.y>T.y?x.y:T.y,ee=FA(g.x<x.x?g.x<T.x?g.x:T.x:x.x<T.x?x.x:T.x,g.y<x.y?g.y<T.y?g.y:T.y:x.y<T.y?x.y:T.y,n,s,p),oe=FA(D,j,n,s,p),le=e.prevZ,ye=e.nextZ;le&&le.z>=ee&&ye&&ye.z<=oe;){if(le!==e.prev&&le!==e.next&&ec(g.x,g.y,x.x,x.y,T.x,T.y,le.x,le.y)&&Po(le.prev,le,le.next)>=0||(le=le.prevZ,ye!==e.prev&&ye!==e.next&&ec(g.x,g.y,x.x,x.y,T.x,T.y,ye.x,ye.y)&&Po(ye.prev,ye,ye.next)>=0))return!1;ye=ye.nextZ}for(;le&&le.z>=ee;){if(le!==e.prev&&le!==e.next&&ec(g.x,g.y,x.x,x.y,T.x,T.y,le.x,le.y)&&Po(le.prev,le,le.next)>=0)return!1;le=le.prevZ}for(;ye&&ye.z<=oe;){if(ye!==e.prev&&ye!==e.next&&ec(g.x,g.y,x.x,x.y,T.x,T.y,ye.x,ye.y)&&Po(ye.prev,ye,ye.next)>=0)return!1;ye=ye.nextZ}return!0}function wp(e,n,s){var p=e;do{var g=p.prev,x=p.next.next;!vu(g,x)&&Th(g,p,p.next,x)&&UA(g,x)&&UA(x,g)&&(n.push(g.i/s),n.push(p.i/s),n.push(x.i/s),Jn(p),Jn(p.next),p=e=x),p=p.next}while(p!==e);return oa(p)}function yu(e,n,s,p,g,x){var T=e;do{for(var D=T.next.next;D!==T.prev;){if(T.i!==D.i&&Ju(T,D)){var j=tc(T,D);return T=oa(T,T.next),j=oa(j,j.next),_c(T,n,s,p,g,x),void _c(j,n,s,p,g,x)}D=D.next}T=T.next}while(T!==e)}function _u(e,n){return e.x-n.x}function Ih(e,n){if(n=function(p,g){var x,T=g,D=p.x,j=p.y,ee=-1/0;do{if(j<=T.y&&j>=T.next.y&&T.next.y!==T.y){var oe=T.x+(j-T.y)*(T.next.x-T.x)/(T.next.y-T.y);if(oe<=D&&oe>ee){if(ee=oe,oe===D){if(j===T.y)return T;if(j===T.next.y)return T.next}x=T.x<T.next.x?T:T.next}}T=T.next}while(T!==g);if(!x)return null;if(D===ee)return x;var le,ye=x,i=x.x,t=x.y,a=1/0;T=x;do D>=T.x&&T.x>=i&&D!==T.x&&ec(j<t?D:ee,j,i,t,j<t?ee:D,j,T.x,T.y)&&(le=Math.abs(j-T.y)/(D-T.x),UA(T,p)&&(le<a||le===a&&(T.x>x.x||T.x===x.x&&TA(x,T)))&&(x=T,a=le)),T=T.next;while(T!==ye);return x}(e,n)){var s=tc(n,e);oa(n,n.next),oa(s,s.next)}}function TA(e,n){return Po(e.prev,e,n.prev)<0&&Po(n.next,e,e.next)<0}function FA(e,n,s,p,g){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-s)*g)|e<<8))|e<<4))|e<<2))|e<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=32767*(n-p)*g)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function Sh(e){var n=e,s=e;do(n.x<s.x||n.x===s.x&&n.y<s.y)&&(s=n),n=n.next;while(n!==e);return s}function ec(e,n,s,p,g,x,T,D){return(g-T)*(n-D)-(e-T)*(x-D)>=0&&(e-T)*(p-D)-(s-T)*(n-D)>=0&&(s-T)*(x-D)-(g-T)*(p-D)>=0}function Ju(e,n){return e.next.i!==n.i&&e.prev.i!==n.i&&!function(s,p){var g=s;do{if(g.i!==s.i&&g.next.i!==s.i&&g.i!==p.i&&g.next.i!==p.i&&Th(g,g.next,s,p))return!0;g=g.next}while(g!==s);return!1}(e,n)&&(UA(e,n)&&UA(n,e)&&function(s,p){var g=s,x=!1,T=(s.x+p.x)/2,D=(s.y+p.y)/2;do g.y>D!=g.next.y>D&&g.next.y!==g.y&&T<(g.next.x-g.x)*(D-g.y)/(g.next.y-g.y)+g.x&&(x=!x),g=g.next;while(g!==s);return x}(e,n)&&(Po(e.prev,e,n.prev)||Po(e,n.prev,n))||vu(e,n)&&Po(e.prev,e,e.next)>0&&Po(n.prev,n,n.next)>0)}function Po(e,n,s){return(n.y-e.y)*(s.x-n.x)-(n.x-e.x)*(s.y-n.y)}function vu(e,n){return e.x===n.x&&e.y===n.y}function Th(e,n,s,p){var g=cA(Po(e,n,s)),x=cA(Po(e,n,p)),T=cA(Po(s,p,e)),D=cA(Po(s,p,n));return g!==x&&T!==D||!(g!==0||!xu(e,s,n))||!(x!==0||!xu(e,p,n))||!(T!==0||!xu(s,e,p))||!(D!==0||!xu(s,n,p))}function xu(e,n,s){return n.x<=Math.max(e.x,s.x)&&n.x>=Math.min(e.x,s.x)&&n.y<=Math.max(e.y,s.y)&&n.y>=Math.min(e.y,s.y)}function cA(e){return e>0?1:e<0?-1:0}function UA(e,n){return Po(e.prev,e,e.next)<0?Po(e,n,e.next)>=0&&Po(e,e.prev,n)>=0:Po(e,n,e.prev)<0||Po(e,e.next,n)<0}function tc(e,n){var s=new rc(e.i,e.x,e.y),p=new rc(n.i,n.x,n.y),g=e.next,x=n.prev;return e.next=n,n.prev=e,s.next=g,g.prev=s,p.next=s,s.prev=p,x.next=p,p.prev=x,p}function Yu(e,n,s,p){var g=new rc(e,n,s);return p?(g.next=p.next,g.prev=p,p.next.prev=g,p.next=g):(g.prev=g,g.next=g),g}function Jn(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function rc(e,n,s){this.i=e,this.x=n,this.y=s,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function qc(e,n,s,p){for(var g=0,x=n,T=s-p;x<s;x+=p)g+=(e[T]-e[x])*(e[x+1]+e[T+1]),T=x;return g}function Zc(e,n,s,p,g){(function x(T,D,j,ee,oe){for(;ee>j;){if(ee-j>600){var le=ee-j+1,ye=D-j+1,i=Math.log(le),t=.5*Math.exp(2*i/3),a=.5*Math.sqrt(i*t*(le-t)/le)*(ye-le/2<0?-1:1);x(T,D,Math.max(j,Math.floor(D-ye*t/le+a)),Math.min(ee,Math.floor(D+(le-ye)*t/le+a)),oe)}var h=T[D],f=j,v=ee;for(MA(T,j,D),oe(T[ee],h)>0&&MA(T,j,ee);f<v;){for(MA(T,f,v),f++,v--;oe(T[f],h)<0;)f++;for(;oe(T[v],h)>0;)v--}oe(T[j],h)===0?MA(T,j,v):MA(T,++v,ee),v<=D&&(j=v+1),D<=v&&(ee=v-1)}})(e,n,s||0,p||e.length-1,g||kA)}function MA(e,n,s){var p=e[n];e[n]=e[s],e[s]=p}function kA(e,n){return e<n?-1:e>n?1:0}function Xc(e,n){var s=e.length;if(s<=1)return[e];for(var p,g,x=[],T=0;T<s;T++){var D=Rt(e[T]);D!==0&&(e[T].area=Math.abs(D),g===void 0&&(g=D<0),g===D<0?(p&&x.push(p),p=[e[T]]):p.push(e[T]))}if(p&&x.push(p),n>1)for(var j=0;j<x.length;j++)x[j].length<=n||(Zc(x[j],n,1,x[j].length-1,eh),x[j]=x[j].slice(0,n));return x}function eh(e,n){return n.area-e.area}function ic(e,n,s){for(var p=s.patternDependencies,g=!1,x=0,T=n;x<T.length;x+=1){var D=T[x].paint.get(e+"-pattern");D.isConstant()||(g=!0);var j=D.constantOr(null);j&&(g=!0,p[j.to]=!0,p[j.from]=!0)}return g}function Wc(e,n,s,p,g){for(var x=g.patternDependencies,T=0,D=n;T<D.length;T+=1){var j=D[T],ee=j.paint.get(e+"-pattern").value;if(ee.kind!=="constant"){var oe=ee.evaluate({zoom:p-1},s,{},g.availableImages),le=ee.evaluate({zoom:p},s,{},g.availableImages),ye=ee.evaluate({zoom:p+1},s,{},g.availableImages);le=le&&le.name?le.name:le,ye=ye&&ye.name?ye.name:ye,x[oe=oe&&oe.name?oe.name:oe]=!0,x[le]=!0,x[ye]=!0,s.patterns[j.id]={min:oe,mid:le,max:ye}}}return s}YA.deviation=function(e,n,s,p){var g=n&&n.length,x=Math.abs(qc(e,0,g?n[0]*s:e.length,s));if(g)for(var T=0,D=n.length;T<D;T++)x-=Math.abs(qc(e,n[T]*s,T<D-1?n[T+1]*s:e.length,s));var j=0;for(T=0;T<p.length;T+=3){var ee=p[T]*s,oe=p[T+1]*s,le=p[T+2]*s;j+=Math.abs((e[ee]-e[le])*(e[oe+1]-e[ee+1])-(e[ee]-e[oe])*(e[le+1]-e[ee+1]))}return x===0&&j===0?0:Math.abs((j-x)/x)},YA.flatten=function(e){for(var n=e[0][0].length,s={vertices:[],holes:[],dimensions:n},p=0,g=0;g<e.length;g++){for(var x=0;x<e[g].length;x++)for(var T=0;T<n;T++)s.vertices.push(e[g][x][T]);g>0&&s.holes.push(p+=e[g-1].length)}return s},$c.default=Eh;var Bs=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(n){return n.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new z,this.indexArray=new $e,this.indexArray2=new St,this.programConfigurations=new Dr(e.layers,e.zoom),this.segments=new Ie,this.segments2=new Ie,this.stateDependentLayerIds=this.layers.filter(function(n){return n.isStateDependent()}).map(function(n){return n.id})};Bs.prototype.populate=function(e,n,s){this.hasPattern=ic("fill",this.layers,n);for(var p=this.layers[0].layout.get("fill-sort-key"),g=[],x=0,T=e;x<T.length;x+=1){var D=T[x],j=D.feature,ee=D.id,oe=D.index,le=D.sourceLayerIndex,ye=this.layers[0]._featureFilter.needGeometry,i=vo(j,ye);if(this.layers[0]._featureFilter.filter(new pi(this.zoom),i,s)){var t=p?p.evaluate(i,{},s,n.availableImages):void 0,a={id:ee,properties:j.properties,type:j.type,sourceLayerIndex:le,index:oe,geometry:ye?i.geometry:Un(j),patterns:{},sortKey:t};g.push(a)}}p&&g.sort(function(Z,re){return Z.sortKey-re.sortKey});for(var h=0,f=g;h<f.length;h+=1){var v=f[h],w=v.geometry,k=v.index,L=v.sourceLayerIndex;if(this.hasPattern){var O=Wc("fill",this.layers,v,this.zoom,n);this.patternFeatures.push(O)}else this.addFeature(v,w,k,s,{});n.featureIndex.insert(e[k].feature,w,k,L,this.index)}},Bs.prototype.update=function(e,n,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,s)},Bs.prototype.addFeatures=function(e,n,s){for(var p=0,g=this.patternFeatures;p<g.length;p+=1){var x=g[p];this.addFeature(x,x.geometry,x.index,n,s)}},Bs.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Bs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Bs.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,jc),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},Bs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Bs.prototype.addFeature=function(e,n,s,p,g){for(var x=0,T=Xc(n,500);x<T.length;x+=1){for(var D=T[x],j=0,ee=0,oe=D;ee<oe.length;ee+=1)j+=oe[ee].length;for(var le=this.segments.prepareSegment(j,this.layoutVertexArray,this.indexArray),ye=le.vertexLength,i=[],t=[],a=0,h=D;a<h.length;a+=1){var f=h[a];if(f.length!==0){f!==D[0]&&t.push(i.length/2);var v=this.segments2.prepareSegment(f.length,this.layoutVertexArray,this.indexArray2),w=v.vertexLength;this.layoutVertexArray.emplaceBack(f[0].x,f[0].y),this.indexArray2.emplaceBack(w+f.length-1,w),i.push(f[0].x),i.push(f[0].y);for(var k=1;k<f.length;k++)this.layoutVertexArray.emplaceBack(f[k].x,f[k].y),this.indexArray2.emplaceBack(w+k-1,w+k),i.push(f[k].x),i.push(f[k].y);v.vertexLength+=f.length,v.primitiveLength+=f.length}}for(var L=$c(i,t),O=0;O<L.length;O+=3)this.indexArray.emplaceBack(ye+L[O],ye+L[O+1],ye+L[O+2]);le.vertexLength+=j,le.primitiveLength+=L.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,g,p)},fr("FillBucket",Bs,{omit:["layers","patternFeatures"]});var vc=new eo({"fill-sort-key":new cr(Ee.layout_fill["fill-sort-key"])}),wu={paint:new eo({"fill-antialias":new kr(Ee.paint_fill["fill-antialias"]),"fill-opacity":new cr(Ee.paint_fill["fill-opacity"]),"fill-color":new cr(Ee.paint_fill["fill-color"]),"fill-outline-color":new cr(Ee.paint_fill["fill-outline-color"]),"fill-translate":new kr(Ee.paint_fill["fill-translate"]),"fill-translate-anchor":new kr(Ee.paint_fill["fill-translate-anchor"]),"fill-pattern":new Wn(Ee.paint_fill["fill-pattern"])}),layout:vc},PA=function(e){function n(s){e.call(this,s,wu)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.recalculate=function(s,p){e.prototype.recalculate.call(this,s,p);var g=this.paint._values["fill-outline-color"];g.value.kind==="constant"&&g.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},n.prototype.createBucket=function(s){return new Bs(s)},n.prototype.queryRadius=function(){return xo(this.paint.get("fill-translate"))},n.prototype.queryIntersectsFeature=function(s,p,g,x,T,D,j){return ma(Ns(s,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),D.angle,j),x)},n.prototype.isTileClipped=function(){return!0},n}(y),bp=_([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,bu=xc;function xc(e,n,s,p,g){this.properties={},this.extent=s,this.type=0,this._pbf=e,this._geometry=-1,this._keys=p,this._values=g,e.readFields(th,this,n)}function th(e,n,s){e==1?n.id=s.readVarint():e==2?function(p,g){for(var x=p.readVarint()+p.pos;p.pos<x;){var T=g._keys[p.readVarint()],D=g._values[p.readVarint()];g.properties[T]=D}}(s,n):e==3?n.type=s.readVarint():e==4&&(n._geometry=s.pos)}function Bu(e){for(var n,s,p=0,g=0,x=e.length,T=x-1;g<x;T=g++)p+=((s=e[T]).x-(n=e[g]).x)*(n.y+s.y);return p}xc.types=["Unknown","Point","LineString","Polygon"],xc.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var n,s=e.readVarint()+e.pos,p=1,g=0,x=0,T=0,D=[];e.pos<s;){if(g<=0){var j=e.readVarint();p=7&j,g=j>>3}if(g--,p===1||p===2)x+=e.readSVarint(),T+=e.readSVarint(),p===1&&(n&&D.push(n),n=[]),n.push(new Y(x,T));else{if(p!==7)throw new Error("unknown command "+p);n&&n.push(n[0].clone())}}return n&&D.push(n),D},xc.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var n=e.readVarint()+e.pos,s=1,p=0,g=0,x=0,T=1/0,D=-1/0,j=1/0,ee=-1/0;e.pos<n;){if(p<=0){var oe=e.readVarint();s=7&oe,p=oe>>3}if(p--,s===1||s===2)(g+=e.readSVarint())<T&&(T=g),g>D&&(D=g),(x+=e.readSVarint())<j&&(j=x),x>ee&&(ee=x);else if(s!==7)throw new Error("unknown command "+s)}return[T,j,D,ee]},xc.prototype.toGeoJSON=function(e,n,s){var p,g,x=this.extent*Math.pow(2,s),T=this.extent*e,D=this.extent*n,j=this.loadGeometry(),ee=xc.types[this.type];function oe(i){for(var t=0;t<i.length;t++){var a=i[t];i[t]=[360*(a.x+T)/x-180,360/Math.PI*Math.atan(Math.exp((180-360*(a.y+D)/x)*Math.PI/180))-90]}}switch(this.type){case 1:var le=[];for(p=0;p<j.length;p++)le[p]=j[p][0];oe(j=le);break;case 2:for(p=0;p<j.length;p++)oe(j[p]);break;case 3:for(j=function(i){var t=i.length;if(t<=1)return[i];for(var a,h,f=[],v=0;v<t;v++){var w=Bu(i[v]);w!==0&&(h===void 0&&(h=w<0),h===w<0?(a&&f.push(a),a=[i[v]]):a.push(i[v]))}return a&&f.push(a),f}(j),p=0;p<j.length;p++)for(g=0;g<j[p].length;g++)oe(j[p][g])}j.length===1?j=j[0]:ee="Multi"+ee;var ye={type:"Feature",geometry:{type:ee,coordinates:j},properties:this.properties};return"id"in this&&(ye.id=this.id),ye};var wc=rh;function rh(e,n){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(Fh,this,n),this.length=this._features.length}function Fh(e,n,s){e===15?n.version=s.readVarint():e===1?n.name=s.readString():e===5?n.extent=s.readVarint():e===2?n._features.push(s.pos):e===3?n._keys.push(s.readString()):e===4&&n._values.push(function(p){for(var g=null,x=p.readVarint()+p.pos;p.pos<x;){var T=p.readVarint()>>3;g=T===1?p.readString():T===2?p.readFloat():T===3?p.readDouble():T===4?p.readVarint64():T===5?p.readVarint():T===6?p.readSVarint():T===7?p.readBoolean():null}return g}(s))}function ih(e,n,s){if(e===3){var p=new wc(s,s.readVarint()+s.pos);p.length&&(n[p.name]=p)}}rh.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var n=this._pbf.readVarint()+this._pbf.pos;return new bu(this._pbf,n,this.extent,this._keys,this._values)};var nc={VectorTile:function(e,n){this.layers=e.readFields(ih,{},n)},VectorTileFeature:bu,VectorTileLayer:wc},Uh=nc.VectorTileFeature.types,jl=Math.pow(2,13);function QA(e,n,s,p,g,x,T,D){e.emplaceBack(n,s,2*Math.floor(p*jl)+T,g*jl*2,x*jl*2,Math.round(D))}var os=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(n){return n.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new $,this.indexArray=new $e,this.programConfigurations=new Dr(e.layers,e.zoom),this.segments=new Ie,this.stateDependentLayerIds=this.layers.filter(function(n){return n.isStateDependent()}).map(function(n){return n.id})};function oc(e,n){return e.x===n.x&&(e.x<0||e.x>8192)||e.y===n.y&&(e.y<0||e.y>8192)}os.prototype.populate=function(e,n,s){this.features=[],this.hasPattern=ic("fill-extrusion",this.layers,n);for(var p=0,g=e;p<g.length;p+=1){var x=g[p],T=x.feature,D=x.id,j=x.index,ee=x.sourceLayerIndex,oe=this.layers[0]._featureFilter.needGeometry,le=vo(T,oe);if(this.layers[0]._featureFilter.filter(new pi(this.zoom),le,s)){var ye={id:D,sourceLayerIndex:ee,index:j,geometry:oe?le.geometry:Un(T),properties:T.properties,type:T.type,patterns:{}};this.hasPattern?this.features.push(Wc("fill-extrusion",this.layers,ye,this.zoom,n)):this.addFeature(ye,ye.geometry,j,s,{}),n.featureIndex.insert(T,ye.geometry,j,ee,this.index,!0)}}},os.prototype.addFeatures=function(e,n,s){for(var p=0,g=this.features;p<g.length;p+=1){var x=g[p];this.addFeature(x,x.geometry,x.index,n,s)}},os.prototype.update=function(e,n,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,s)},os.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},os.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},os.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,bp),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},os.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},os.prototype.addFeature=function(e,n,s,p,g){for(var x=0,T=Xc(n,500);x<T.length;x+=1){for(var D=T[x],j=0,ee=0,oe=D;ee<oe.length;ee+=1)j+=oe[ee].length;for(var le=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),ye=0,i=D;ye<i.length;ye+=1){var t=i[ye];if(t.length!==0&&!((nt=t).every(function(At){return At.x<0})||nt.every(function(At){return At.x>8192})||nt.every(function(At){return At.y<0})||nt.every(function(At){return At.y>8192})))for(var a=0,h=0;h<t.length;h++){var f=t[h];if(h>=1){var v=t[h-1];if(!oc(f,v)){le.vertexLength+4>Ie.MAX_VERTEX_ARRAY_LENGTH&&(le=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var w=f.sub(v)._perp()._unit(),k=v.dist(f);a+k>32768&&(a=0),QA(this.layoutVertexArray,f.x,f.y,w.x,w.y,0,0,a),QA(this.layoutVertexArray,f.x,f.y,w.x,w.y,0,1,a),QA(this.layoutVertexArray,v.x,v.y,w.x,w.y,0,0,a+=k),QA(this.layoutVertexArray,v.x,v.y,w.x,w.y,0,1,a);var L=le.vertexLength;this.indexArray.emplaceBack(L,L+2,L+1),this.indexArray.emplaceBack(L+1,L+2,L+3),le.vertexLength+=4,le.primitiveLength+=2}}}}if(le.vertexLength+j>Ie.MAX_VERTEX_ARRAY_LENGTH&&(le=this.segments.prepareSegment(j,this.layoutVertexArray,this.indexArray)),Uh[e.type]==="Polygon"){for(var O=[],Z=[],re=le.vertexLength,he=0,de=D;he<de.length;he+=1){var me=de[he];if(me.length!==0){me!==D[0]&&Z.push(O.length/2);for(var Ue=0;Ue<me.length;Ue++){var Qe=me[Ue];QA(this.layoutVertexArray,Qe.x,Qe.y,0,0,1,1,0),O.push(Qe.x),O.push(Qe.y)}}}for(var Ye=$c(O,Z),ot=0;ot<Ye.length;ot+=3)this.indexArray.emplaceBack(re+Ye[ot],re+Ye[ot+2],re+Ye[ot+1]);le.primitiveLength+=Ye.length/3,le.vertexLength+=j}}var nt;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,g,p)},fr("FillExtrusionBucket",os,{omit:["layers","features"]});var Mh={paint:new eo({"fill-extrusion-opacity":new kr(Ee["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new cr(Ee["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new kr(Ee["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new kr(Ee["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Wn(Ee["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new cr(Ee["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new cr(Ee["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new kr(Ee["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Bp=function(e){function n(s){e.call(this,s,Mh)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.createBucket=function(s){return new os(s)},n.prototype.queryRadius=function(){return xo(this.paint.get("fill-extrusion-translate"))},n.prototype.is3D=function(){return!0},n.prototype.queryIntersectsFeature=function(s,p,g,x,T,D,j,ee){var oe=Ns(s,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),D.angle,j),le=this.paint.get("fill-extrusion-height").evaluate(p,g),ye=this.paint.get("fill-extrusion-base").evaluate(p,g),i=function(a,h,f,v){for(var w=[],k=0,L=a;k<L.length;k+=1){var O=L[k],Z=[O.x,O.y,0,1];yc(Z,Z,h),w.push(new Y(Z[0]/Z[3],Z[1]/Z[3]))}return w}(oe,ee),t=function(a,h,f,v){for(var w=[],k=[],L=v[8]*h,O=v[9]*h,Z=v[10]*h,re=v[11]*h,he=v[8]*f,de=v[9]*f,me=v[10]*f,Ue=v[11]*f,Qe=0,Ye=a;Qe<Ye.length;Qe+=1){for(var ot=[],nt=[],At=0,Et=Ye[Qe];At<Et.length;At+=1){var ft=Et[At],$t=ft.x,nr=ft.y,Xt=v[0]*$t+v[4]*nr+v[12],qt=v[1]*$t+v[5]*nr+v[13],Kt=v[2]*$t+v[6]*nr+v[14],Wt=v[3]*$t+v[7]*nr+v[15],Yt=Kt+Z,Ot=Wt+re,Ir=Xt+he,gr=qt+de,Jr=Kt+me,yi=Wt+Ue,Ui=new Y((Xt+L)/Ot,(qt+O)/Ot);Ui.z=Yt/Ot,ot.push(Ui);var jr=new Y(Ir/yi,gr/yi);jr.z=Jr/yi,nt.push(jr)}w.push(ot),k.push(nt)}return[w,k]}(x,ye,le,ee);return function(a,h,f){var v=1/0;ma(f,h)&&(v=Cu(f,h[0]));for(var w=0;w<h.length;w++)for(var k=h[w],L=a[w],O=0;O<k.length-1;O++){var Z=k[O],re=[Z,k[O+1],L[O+1],L[O],Z];ns(f,re)&&(v=Math.min(v,Cu(f,re)))}return v!==1/0&&v}(t[0],t[1],i)},n}(y);function bc(e,n){return e.x*n.x+e.y*n.y}function Cu(e,n){if(e.length===1){for(var s,p=0,g=n[p++];!s||g.equals(s);)if(!(s=n[p++]))return 1/0;for(;p<n.length;p++){var x=n[p],T=e[0],D=s.sub(g),j=x.sub(g),ee=T.sub(g),oe=bc(D,D),le=bc(D,j),ye=bc(j,j),i=bc(ee,D),t=bc(ee,j),a=oe*ye-le*le,h=(ye*i-le*t)/a,f=(oe*t-le*i)/a,v=g.z*(1-h-f)+s.z*h+x.z*f;if(isFinite(v))return v}return 1/0}for(var w=1/0,k=0,L=n;k<L.length;k+=1)w=Math.min(w,L[k].z);return w}var kh=_([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Cp=_([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,Bc=nc.VectorTileFeature.types,Ph=Math.cos(Math.PI/180*37.5),jo=Math.pow(2,14)/.5,wo=function(e){var n=this;this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(s){return s.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(s){n.gradients[s.id]={}}),this.layoutVertexArray=new W,this.layoutVertexArray2=new ce,this.indexArray=new $e,this.programConfigurations=new Dr(e.layers,e.zoom),this.segments=new Ie,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(s){return s.isStateDependent()}).map(function(s){return s.id})};wo.prototype.populate=function(e,n,s){this.hasPattern=ic("line",this.layers,n);for(var p=this.layers[0].layout.get("line-sort-key"),g=[],x=0,T=e;x<T.length;x+=1){var D=T[x],j=D.feature,ee=D.id,oe=D.index,le=D.sourceLayerIndex,ye=this.layers[0]._featureFilter.needGeometry,i=vo(j,ye);if(this.layers[0]._featureFilter.filter(new pi(this.zoom),i,s)){var t=p?p.evaluate(i,{},s):void 0,a={id:ee,properties:j.properties,type:j.type,sourceLayerIndex:le,index:oe,geometry:ye?i.geometry:Un(j),patterns:{},sortKey:t};g.push(a)}}p&&g.sort(function(Z,re){return Z.sortKey-re.sortKey});for(var h=0,f=g;h<f.length;h+=1){var v=f[h],w=v.geometry,k=v.index,L=v.sourceLayerIndex;if(this.hasPattern){var O=Wc("line",this.layers,v,this.zoom,n);this.patternFeatures.push(O)}else this.addFeature(v,w,k,s,{});n.featureIndex.insert(e[k].feature,w,k,L,this.index)}},wo.prototype.update=function(e,n,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,s)},wo.prototype.addFeatures=function(e,n,s){for(var p=0,g=this.patternFeatures;p<g.length;p+=1){var x=g[p];this.addFeature(x,x.geometry,x.index,n,s)}},wo.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},wo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},wo.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Cp)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,kh),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},wo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},wo.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},wo.prototype.addFeature=function(e,n,s,p,g){var x=this.layers[0].layout,T=x.get("line-join").evaluate(e,{}),D=x.get("line-cap"),j=x.get("line-miter-limit"),ee=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var oe=0,le=n;oe<le.length;oe+=1)this.addLine(le[oe],e,T,D,j,ee);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,g,p)},wo.prototype.addLine=function(e,n,s,p,g,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var T=0;T<e.length-1;T++)this.totalDistance+=e[T].dist(e[T+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var D=Bc[n.type]==="Polygon",j=e.length;j>=2&&e[j-1].equals(e[j-2]);)j--;for(var ee=0;ee<j-1&&e[ee].equals(e[ee+1]);)ee++;if(!(j<(D?3:2))){s==="bevel"&&(g=1.05);var oe,le=this.overscaling<=16?122880/(512*this.overscaling):0,ye=this.segments.prepareSegment(10*j,this.layoutVertexArray,this.indexArray),i=void 0,t=void 0,a=void 0,h=void 0;this.e1=this.e2=-1,D&&(h=e[ee].sub(oe=e[j-2])._unit()._perp());for(var f=ee;f<j;f++)if(!(t=f===j-1?D?e[ee+1]:void 0:e[f+1])||!e[f].equals(t)){h&&(a=h),oe&&(i=oe),oe=e[f],h=t?t.sub(oe)._unit()._perp():a;var v=(a=a||h).add(h);v.x===0&&v.y===0||v._unit();var w=a.x*h.x+a.y*h.y,k=v.x*h.x+v.y*h.y,L=k!==0?1/k:1/0,O=2*Math.sqrt(2-2*k),Z=k<Ph&&i&&t,re=a.x*h.y-a.y*h.x>0;if(Z&&f>ee){var he=oe.dist(i);if(he>2*le){var de=oe.sub(oe.sub(i)._mult(le/he)._round());this.updateDistance(i,de),this.addCurrentVertex(de,a,0,0,ye),i=de}}var me=i&&t,Ue=me?s:D?"butt":p;if(me&&Ue==="round"&&(L<x?Ue="miter":L<=2&&(Ue="fakeround")),Ue==="miter"&&L>g&&(Ue="bevel"),Ue==="bevel"&&(L>2&&(Ue="flipbevel"),L<g&&(Ue="miter")),i&&this.updateDistance(i,oe),Ue==="miter")v._mult(L),this.addCurrentVertex(oe,v,0,0,ye);else if(Ue==="flipbevel"){if(L>100)v=h.mult(-1);else{var Qe=L*a.add(h).mag()/a.sub(h).mag();v._perp()._mult(Qe*(re?-1:1))}this.addCurrentVertex(oe,v,0,0,ye),this.addCurrentVertex(oe,v.mult(-1),0,0,ye)}else if(Ue==="bevel"||Ue==="fakeround"){var Ye=-Math.sqrt(L*L-1),ot=re?Ye:0,nt=re?0:Ye;if(i&&this.addCurrentVertex(oe,a,ot,nt,ye),Ue==="fakeround")for(var At=Math.round(180*O/Math.PI/20),Et=1;Et<At;Et++){var ft=Et/At;if(ft!==.5){var $t=ft-.5;ft+=ft*$t*(ft-1)*((1.0904+w*(w*(3.55645-1.43519*w)-3.2452))*$t*$t+(.848013+w*(.215638*w-1.06021)))}var nr=h.sub(a)._mult(ft)._add(a)._unit()._mult(re?-1:1);this.addHalfVertex(oe,nr.x,nr.y,!1,re,0,ye)}t&&this.addCurrentVertex(oe,h,-ot,-nt,ye)}else if(Ue==="butt")this.addCurrentVertex(oe,v,0,0,ye);else if(Ue==="square"){var Xt=i?1:-1;this.addCurrentVertex(oe,v,Xt,Xt,ye)}else Ue==="round"&&(i&&(this.addCurrentVertex(oe,a,0,0,ye),this.addCurrentVertex(oe,a,1,1,ye,!0)),t&&(this.addCurrentVertex(oe,h,-1,-1,ye,!0),this.addCurrentVertex(oe,h,0,0,ye)));if(Z&&f<j-1){var qt=oe.dist(t);if(qt>2*le){var Kt=oe.add(t.sub(oe)._mult(le/qt)._round());this.updateDistance(oe,Kt),this.addCurrentVertex(Kt,h,0,0,ye),oe=Kt}}}}},wo.prototype.addCurrentVertex=function(e,n,s,p,g,x){x===void 0&&(x=!1);var T=n.y*p-n.x,D=-n.y-n.x*p;this.addHalfVertex(e,n.x+n.y*s,n.y-n.x*s,x,!1,s,g),this.addHalfVertex(e,T,D,x,!0,-p,g),this.distance>jo/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,n,s,p,g,x))},wo.prototype.addHalfVertex=function(e,n,s,p,g,x,T){var D=.5*(this.lineClips?this.scaledDistance*(jo-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(p?1:0),(e.y<<1)+(g?1:0),Math.round(63*n)+128,Math.round(63*s)+128,1+(x===0?0:x<0?-1:1)|(63&D)<<2,D>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var j=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,j),T.primitiveLength++),g?this.e2=j:this.e1=j},wo.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},wo.prototype.updateDistance=function(e,n){this.distance+=e.dist(n),this.updateScaledDistance()},fr("LineBucket",wo,{omit:["layers","patternFeatures"]});var $l=new eo({"line-cap":new kr(Ee.layout_line["line-cap"]),"line-join":new cr(Ee.layout_line["line-join"]),"line-miter-limit":new kr(Ee.layout_line["line-miter-limit"]),"line-round-limit":new kr(Ee.layout_line["line-round-limit"]),"line-sort-key":new cr(Ee.layout_line["line-sort-key"])}),bl={paint:new eo({"line-opacity":new cr(Ee.paint_line["line-opacity"]),"line-color":new cr(Ee.paint_line["line-color"]),"line-translate":new kr(Ee.paint_line["line-translate"]),"line-translate-anchor":new kr(Ee.paint_line["line-translate-anchor"]),"line-width":new cr(Ee.paint_line["line-width"]),"line-gap-width":new cr(Ee.paint_line["line-gap-width"]),"line-offset":new cr(Ee.paint_line["line-offset"]),"line-blur":new cr(Ee.paint_line["line-blur"]),"line-dasharray":new qi(Ee.paint_line["line-dasharray"]),"line-pattern":new Wn(Ee.paint_line["line-pattern"]),"line-gradient":new Ca(Ee.paint_line["line-gradient"])}),layout:$l},uA=new(function(e){function n(){e.apply(this,arguments)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.possiblyEvaluate=function(s,p){return p=new pi(Math.floor(p.zoom),{now:p.now,fadeDuration:p.fadeDuration,zoomHistory:p.zoomHistory,transition:p.transition}),e.prototype.possiblyEvaluate.call(this,s,p)},n.prototype.evaluate=function(s,p,g,x){return p=Bt({},p,{zoom:Math.floor(p.zoom)}),e.prototype.evaluate.call(this,s,p,g,x)},n}(cr))(bl.paint.properties["line-width"].specification);uA.useIntegerZoom=!0;var Jc=function(e){function n(s){e.call(this,s,bl),this.gradientVersion=0}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype._handleSpecialPaintPropertyUpdate=function(s){s==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof ca,this.gradientVersion=(this.gradientVersion+1)%ze)},n.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},n.prototype.recalculate=function(s,p){e.prototype.recalculate.call(this,s,p),this.paint._values["line-floorwidth"]=uA.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,s)},n.prototype.createBucket=function(s){return new wo(s)},n.prototype.queryRadius=function(s){var p=s,g=ql(Vs("line-width",this,p),Vs("line-gap-width",this,p)),x=Vs("line-offset",this,p);return g/2+Math.abs(x)+xo(this.paint.get("line-translate"))},n.prototype.queryIntersectsFeature=function(s,p,g,x,T,D,j){var ee=Ns(s,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),D.angle,j),oe=j/2*ql(this.paint.get("line-width").evaluate(p,g),this.paint.get("line-gap-width").evaluate(p,g)),le=this.paint.get("line-offset").evaluate(p,g);return le&&(x=function(ye,i){for(var t=[],a=new Y(0,0),h=0;h<ye.length;h++){for(var f=ye[h],v=[],w=0;w<f.length;w++){var k=f[w],L=f[w+1],O=w===0?a:k.sub(f[w-1])._unit()._perp(),Z=w===f.length-1?a:L.sub(k)._unit()._perp(),re=O._add(Z)._unit();re._mult(1/(re.x*Z.x+re.y*Z.y)),v.push(re._mult(i)._add(k))}t.push(v)}return t}(x,le*j)),function(ye,i,t){for(var a=0;a<i.length;a++){var h=i[a];if(ye.length>=3){for(var f=0;f<h.length;f++)if(bs(ye,h[f]))return!0}if(Ko(ye,h,t))return!0}return!1}(ee,x,oe)},n.prototype.isTileClipped=function(){return!0},n}(y);function ql(e,n){return n>0?n+2*e:e}var Cc=_([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),nh=_([{name:"a_projected_pos",components:3,type:"Float32"}],4),Qh=(_([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),_([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Eu=(_([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),_([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Yc=_([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Dh(e,n,s){return e.sections.forEach(function(p){p.text=function(g,x,T){var D=x.layout.get("text-transform").evaluate(T,{});return D==="uppercase"?g=g.toLocaleUpperCase():D==="lowercase"&&(g=g.toLocaleLowerCase()),Xn.applyArabicShaping&&(g=Xn.applyArabicShaping(g)),g}(p.text,n,s)}),e}_([{name:"triangle",components:3,type:"Uint16"}]),_([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),_([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),_([{type:"Float32",name:"offsetX"}]),_([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Ec={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},Hn=function(e,n,s,p,g){var x,T,D=8*g-p-1,j=(1<<D)-1,ee=j>>1,oe=-7,le=s?g-1:0,ye=s?-1:1,i=e[n+le];for(le+=ye,x=i&(1<<-oe)-1,i>>=-oe,oe+=D;oe>0;x=256*x+e[n+le],le+=ye,oe-=8);for(T=x&(1<<-oe)-1,x>>=-oe,oe+=p;oe>0;T=256*T+e[n+le],le+=ye,oe-=8);if(x===0)x=1-ee;else{if(x===j)return T?NaN:1/0*(i?-1:1);T+=Math.pow(2,p),x-=ee}return(i?-1:1)*T*Math.pow(2,x-p)},oh=function(e,n,s,p,g,x){var T,D,j,ee=8*x-g-1,oe=(1<<ee)-1,le=oe>>1,ye=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,i=p?0:x-1,t=p?1:-1,a=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(D=isNaN(n)?1:0,T=oe):(T=Math.floor(Math.log(n)/Math.LN2),n*(j=Math.pow(2,-T))<1&&(T--,j*=2),(n+=T+le>=1?ye/j:ye*Math.pow(2,1-le))*j>=2&&(T++,j/=2),T+le>=oe?(D=0,T=oe):T+le>=1?(D=(n*j-1)*Math.pow(2,g),T+=le):(D=n*Math.pow(2,le-1)*Math.pow(2,g),T=0));g>=8;e[s+i]=255&D,i+=t,D/=256,g-=8);for(T=T<<g|D,ee+=g;ee>0;e[s+i]=255&T,i+=t,T/=256,ee-=8);e[s+i-t]|=128*a},Ic=Vn;function Vn(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Vn.Varint=0,Vn.Fixed64=1,Vn.Bytes=2,Vn.Fixed32=5;var ah=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Zl(e){return e.type===Vn.Bytes?e.readVarint()+e.pos:e.pos+1}function hA(e,n,s){return s?4294967296*n+(e>>>0):4294967296*(n>>>0)+(e>>>0)}function Lh(e,n,s){var p=n<=16383?1:n<=2097151?2:n<=268435455?3:Math.floor(Math.log(n)/(7*Math.LN2));s.realloc(p);for(var g=s.pos-1;g>=e;g--)s.buf[g+p]=s.buf[g]}function Ep(e,n){for(var s=0;s<e.length;s++)n.writeVarint(e[s])}function Ip(e,n){for(var s=0;s<e.length;s++)n.writeSVarint(e[s])}function zh(e,n){for(var s=0;s<e.length;s++)n.writeFloat(e[s])}function Sp(e,n){for(var s=0;s<e.length;s++)n.writeDouble(e[s])}function sh(e,n){for(var s=0;s<e.length;s++)n.writeBoolean(e[s])}function ac(e,n){for(var s=0;s<e.length;s++)n.writeFixed32(e[s])}function aa(e,n){for(var s=0;s<e.length;s++)n.writeSFixed32(e[s])}function lh(e,n){for(var s=0;s<e.length;s++)n.writeFixed64(e[s])}function Rh(e,n){for(var s=0;s<e.length;s++)n.writeSFixed64(e[s])}function Sc(e,n){return(e[n]|e[n+1]<<8|e[n+2]<<16)+16777216*e[n+3]}function fn(e,n,s){e[s]=n,e[s+1]=n>>>8,e[s+2]=n>>>16,e[s+3]=n>>>24}function pA(e,n){return(e[n]|e[n+1]<<8|e[n+2]<<16)+(e[n+3]<<24)}function Ah(e,n,s){e===1&&s.readMessage(Oh,n)}function Oh(e,n,s){if(e===3){var p=s.readMessage(Hh,{}),g=p.width,x=p.height,T=p.left,D=p.top,j=p.advance;n.push({id:p.id,bitmap:new JA({width:g+6,height:x+6},p.bitmap),metrics:{width:g,height:x,left:T,top:D,advance:j}})}}function Hh(e,n,s){e===1?n.id=s.readVarint():e===2?n.bitmap=s.readBytes():e===3?n.width=s.readVarint():e===4?n.height=s.readVarint():e===5?n.left=s.readSVarint():e===6?n.top=s.readSVarint():e===7&&(n.advance=s.readVarint())}function cl(e){for(var n=0,s=0,p=0,g=e;p<g.length;p+=1){var x=g[p];n+=x.w*x.h,s=Math.max(s,x.w)}e.sort(function(a,h){return h.h-a.h});for(var T=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),s),h:1/0}],D=0,j=0,ee=0,oe=e;ee<oe.length;ee+=1)for(var le=oe[ee],ye=T.length-1;ye>=0;ye--){var i=T[ye];if(!(le.w>i.w||le.h>i.h)){if(le.x=i.x,le.y=i.y,j=Math.max(j,le.y+le.h),D=Math.max(D,le.x+le.w),le.w===i.w&&le.h===i.h){var t=T.pop();ye<T.length&&(T[ye]=t)}else le.h===i.h?(i.x+=le.w,i.w-=le.w):le.w===i.w?(i.y+=le.h,i.h-=le.h):(T.push({x:i.x+le.w,y:i.y,w:i.w-le.w,h:le.h}),i.y+=le.h,i.h-=le.h);break}}return{w:D,h:j,fill:n/(D*j)||0}}Vn.prototype={destroy:function(){this.buf=null},readFields:function(e,n,s){for(s=s||this.length;this.pos<s;){var p=this.readVarint(),g=p>>3,x=this.pos;this.type=7&p,e(g,n,this),this.pos===x&&this.skip(p)}return n},readMessage:function(e,n){return this.readFields(e,n,this.readVarint()+this.pos)},readFixed32:function(){var e=Sc(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=pA(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Sc(this.buf,this.pos)+4294967296*Sc(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=Sc(this.buf,this.pos)+4294967296*pA(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=Hn(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=Hn(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var n,s,p=this.buf;return n=127&(s=p[this.pos++]),s<128?n:(n|=(127&(s=p[this.pos++]))<<7,s<128?n:(n|=(127&(s=p[this.pos++]))<<14,s<128?n:(n|=(127&(s=p[this.pos++]))<<21,s<128?n:function(g,x,T){var D,j,ee=T.buf;if(D=(112&(j=ee[T.pos++]))>>4,j<128||(D|=(127&(j=ee[T.pos++]))<<3,j<128)||(D|=(127&(j=ee[T.pos++]))<<10,j<128)||(D|=(127&(j=ee[T.pos++]))<<17,j<128)||(D|=(127&(j=ee[T.pos++]))<<24,j<128)||(D|=(1&(j=ee[T.pos++]))<<31,j<128))return hA(g,D,x);throw new Error("Expected varint not more than 10 bytes")}(n|=(15&(s=p[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,n=this.pos;return this.pos=e,e-n>=12&&ah?function(s,p,g){return ah.decode(s.subarray(p,g))}(this.buf,n,e):function(s,p,g){for(var x="",T=p;T<g;){var D,j,ee,oe=s[T],le=null,ye=oe>239?4:oe>223?3:oe>191?2:1;if(T+ye>g)break;ye===1?oe<128&&(le=oe):ye===2?(192&(D=s[T+1]))==128&&(le=(31&oe)<<6|63&D)<=127&&(le=null):ye===3?(j=s[T+2],(192&(D=s[T+1]))==128&&(192&j)==128&&((le=(15&oe)<<12|(63&D)<<6|63&j)<=2047||le>=55296&&le<=57343)&&(le=null)):ye===4&&(j=s[T+2],ee=s[T+3],(192&(D=s[T+1]))==128&&(192&j)==128&&(192&ee)==128&&((le=(15&oe)<<18|(63&D)<<12|(63&j)<<6|63&ee)<=65535||le>=1114112)&&(le=null)),le===null?(le=65533,ye=1):le>65535&&(le-=65536,x+=String.fromCharCode(le>>>10&1023|55296),le=56320|1023&le),x+=String.fromCharCode(le),T+=ye}return x}(this.buf,n,e)},readBytes:function(){var e=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,e);return this.pos=e,n},readPackedVarint:function(e,n){if(this.type!==Vn.Bytes)return e.push(this.readVarint(n));var s=Zl(this);for(e=e||[];this.pos<s;)e.push(this.readVarint(n));return e},readPackedSVarint:function(e){if(this.type!==Vn.Bytes)return e.push(this.readSVarint());var n=Zl(this);for(e=e||[];this.pos<n;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==Vn.Bytes)return e.push(this.readBoolean());var n=Zl(this);for(e=e||[];this.pos<n;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==Vn.Bytes)return e.push(this.readFloat());var n=Zl(this);for(e=e||[];this.pos<n;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==Vn.Bytes)return e.push(this.readDouble());var n=Zl(this);for(e=e||[];this.pos<n;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==Vn.Bytes)return e.push(this.readFixed32());var n=Zl(this);for(e=e||[];this.pos<n;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==Vn.Bytes)return e.push(this.readSFixed32());var n=Zl(this);for(e=e||[];this.pos<n;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==Vn.Bytes)return e.push(this.readFixed64());var n=Zl(this);for(e=e||[];this.pos<n;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==Vn.Bytes)return e.push(this.readSFixed64());var n=Zl(this);for(e=e||[];this.pos<n;)e.push(this.readSFixed64());return e},skip:function(e){var n=7&e;if(n===Vn.Varint)for(;this.buf[this.pos++]>127;);else if(n===Vn.Bytes)this.pos=this.readVarint()+this.pos;else if(n===Vn.Fixed32)this.pos+=4;else{if(n!==Vn.Fixed64)throw new Error("Unimplemented type: "+n);this.pos+=8}},writeTag:function(e,n){this.writeVarint(e<<3|n)},realloc:function(e){for(var n=this.length||16;n<this.pos+e;)n*=2;if(n!==this.length){var s=new Uint8Array(n);s.set(this.buf),this.buf=s,this.length=n}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),fn(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),fn(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),fn(this.buf,-1&e,this.pos),fn(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),fn(this.buf,-1&e,this.pos),fn(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(n,s){var p,g;if(n>=0?(p=n%4294967296|0,g=n/4294967296|0):(g=~(-n/4294967296),4294967295^(p=~(-n%4294967296))?p=p+1|0:(p=0,g=g+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");s.realloc(10),function(x,T,D){D.buf[D.pos++]=127&x|128,x>>>=7,D.buf[D.pos++]=127&x|128,x>>>=7,D.buf[D.pos++]=127&x|128,x>>>=7,D.buf[D.pos++]=127&x|128,D.buf[D.pos]=127&(x>>>=7)}(p,0,s),function(x,T){var D=(7&x)<<4;T.buf[T.pos++]|=D|((x>>>=3)?128:0),x&&(T.buf[T.pos++]=127&x|((x>>>=7)?128:0),x&&(T.buf[T.pos++]=127&x|((x>>>=7)?128:0),x&&(T.buf[T.pos++]=127&x|((x>>>=7)?128:0),x&&(T.buf[T.pos++]=127&x|((x>>>=7)?128:0),x&&(T.buf[T.pos++]=127&x)))))}(g,s)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var n=this.pos;this.pos=function(p,g,x){for(var T,D,j=0;j<g.length;j++){if((T=g.charCodeAt(j))>55295&&T<57344){if(!D){T>56319||j+1===g.length?(p[x++]=239,p[x++]=191,p[x++]=189):D=T;continue}if(T<56320){p[x++]=239,p[x++]=191,p[x++]=189,D=T;continue}T=D-55296<<10|T-56320|65536,D=null}else D&&(p[x++]=239,p[x++]=191,p[x++]=189,D=null);T<128?p[x++]=T:(T<2048?p[x++]=T>>6|192:(T<65536?p[x++]=T>>12|224:(p[x++]=T>>18|240,p[x++]=T>>12&63|128),p[x++]=T>>6&63|128),p[x++]=63&T|128)}return x}(this.buf,e,this.pos);var s=this.pos-n;s>=128&&Lh(n,s,this),this.pos=n-1,this.writeVarint(s),this.pos+=s},writeFloat:function(e){this.realloc(4),oh(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),oh(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var n=e.length;this.writeVarint(n),this.realloc(n);for(var s=0;s<n;s++)this.buf[this.pos++]=e[s]},writeRawMessage:function(e,n){this.pos++;var s=this.pos;e(n,this);var p=this.pos-s;p>=128&&Lh(s,p,this),this.pos=s-1,this.writeVarint(p),this.pos+=p},writeMessage:function(e,n,s){this.writeTag(e,Vn.Bytes),this.writeRawMessage(n,s)},writePackedVarint:function(e,n){n.length&&this.writeMessage(e,Ep,n)},writePackedSVarint:function(e,n){n.length&&this.writeMessage(e,Ip,n)},writePackedBoolean:function(e,n){n.length&&this.writeMessage(e,sh,n)},writePackedFloat:function(e,n){n.length&&this.writeMessage(e,zh,n)},writePackedDouble:function(e,n){n.length&&this.writeMessage(e,Sp,n)},writePackedFixed32:function(e,n){n.length&&this.writeMessage(e,ac,n)},writePackedSFixed32:function(e,n){n.length&&this.writeMessage(e,aa,n)},writePackedFixed64:function(e,n){n.length&&this.writeMessage(e,lh,n)},writePackedSFixed64:function(e,n){n.length&&this.writeMessage(e,Rh,n)},writeBytesField:function(e,n){this.writeTag(e,Vn.Bytes),this.writeBytes(n)},writeFixed32Field:function(e,n){this.writeTag(e,Vn.Fixed32),this.writeFixed32(n)},writeSFixed32Field:function(e,n){this.writeTag(e,Vn.Fixed32),this.writeSFixed32(n)},writeFixed64Field:function(e,n){this.writeTag(e,Vn.Fixed64),this.writeFixed64(n)},writeSFixed64Field:function(e,n){this.writeTag(e,Vn.Fixed64),this.writeSFixed64(n)},writeVarintField:function(e,n){this.writeTag(e,Vn.Varint),this.writeVarint(n)},writeSVarintField:function(e,n){this.writeTag(e,Vn.Varint),this.writeSVarint(n)},writeStringField:function(e,n){this.writeTag(e,Vn.Bytes),this.writeString(n)},writeFloatField:function(e,n){this.writeTag(e,Vn.Fixed32),this.writeFloat(n)},writeDoubleField:function(e,n){this.writeTag(e,Vn.Fixed64),this.writeDouble(n)},writeBooleanField:function(e,n){this.writeVarintField(e,Boolean(n))}};var dA=function(e,n){var s=n.pixelRatio,p=n.version,g=n.stretchX,x=n.stretchY,T=n.content;this.paddedRect=e,this.pixelRatio=s,this.stretchX=g,this.stretchY=x,this.content=T,this.version=p},DA={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};DA.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},DA.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},DA.tlbr.get=function(){return this.tl.concat(this.br)},DA.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(dA.prototype,DA);var eu=function(e,n){var s={},p={};this.haveRenderCallbacks=[];var g=[];this.addImages(e,s,g),this.addImages(n,p,g);var x=cl(g),T=new Ha({width:x.w||1,height:x.h||1});for(var D in e){var j=e[D],ee=s[D].paddedRect;Ha.copy(j.data,T,{x:0,y:0},{x:ee.x+1,y:ee.y+1},j.data)}for(var oe in n){var le=n[oe],ye=p[oe].paddedRect,i=ye.x+1,t=ye.y+1,a=le.data.width,h=le.data.height;Ha.copy(le.data,T,{x:0,y:0},{x:i,y:t},le.data),Ha.copy(le.data,T,{x:0,y:h-1},{x:i,y:t-1},{width:a,height:1}),Ha.copy(le.data,T,{x:0,y:0},{x:i,y:t+h},{width:a,height:1}),Ha.copy(le.data,T,{x:a-1,y:0},{x:i-1,y:t},{width:1,height:h}),Ha.copy(le.data,T,{x:0,y:0},{x:i+a,y:t},{width:1,height:h})}this.image=T,this.iconPositions=s,this.patternPositions=p};eu.prototype.addImages=function(e,n,s){for(var p in e){var g=e[p],x={x:0,y:0,w:g.data.width+2,h:g.data.height+2};s.push(x),n[p]=new dA(x,g),g.hasRenderCallback&&this.haveRenderCallbacks.push(p)}},eu.prototype.patchUpdatedImages=function(e,n){for(var s in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[s],e.getImage(s),n),this.patchUpdatedImage(this.patternPositions[s],e.getImage(s),n)},eu.prototype.patchUpdatedImage=function(e,n,s){if(e&&n&&e.version!==n.version){e.version=n.version;var p=e.tl;s.update(n.data,void 0,{x:p[0],y:p[1]})}},fr("ImagePosition",dA),fr("ImageAtlas",eu);var yr={horizontal:1,vertical:2,horizontalOnly:3},Bl=function(){this.scale=1,this.fontStack="",this.imageName=null};Bl.forText=function(e,n){var s=new Bl;return s.scale=e||1,s.fontStack=n,s},Bl.forImage=function(e){var n=new Bl;return n.imageName=e,n};var Zo=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function as(e,n,s,p,g,x,T,D,j,ee,oe,le,ye,i,t,a){var h,f=Zo.fromFeature(e,g);le===yr.vertical&&f.verticalizePunctuation();var v=Xn.processBidirectionalText,w=Xn.processStyledBidirectionalText;if(v&&f.sections.length===1){h=[];for(var k=0,L=v(f.toString(),Ac(f,ee,x,n,p,i,t));k<L.length;k+=1){var O=L[k],Z=new Zo;Z.text=O,Z.sections=f.sections;for(var re=0;re<O.length;re++)Z.sectionIndex.push(0);h.push(Z)}}else if(w){h=[];for(var he=0,de=w(f.text,f.sectionIndex,Ac(f,ee,x,n,p,i,t));he<de.length;he+=1){var me=de[he],Ue=new Zo;Ue.text=me[0],Ue.sectionIndex=me[1],Ue.sections=f.sections,h.push(Ue)}}else h=function(ot,nt){for(var At=[],Et=ot.text,ft=0,$t=0,nr=nt;$t<nr.length;$t+=1){var Xt=nr[$t];At.push(ot.substring(ft,Xt)),ft=Xt}return ft<Et.length&&At.push(ot.substring(ft,Et.length)),At}(f,Ac(f,ee,x,n,p,i,t));var Qe=[],Ye={positionedLines:Qe,text:f.toString(),top:oe[1],bottom:oe[1],left:oe[0],right:oe[0],writingMode:le,iconsInText:!1,verticalizable:!1};return function(ot,nt,At,Et,ft,$t,nr,Xt,qt,Kt,Wt,Yt){for(var Ot=0,Ir=-17,gr=0,Jr=0,yi=Xt==="right"?1:Xt==="left"?0:.5,Ui=0,jr=0,zi=ft;jr<zi.length;jr+=1){var _i=zi[jr];_i.trim();var Yr=_i.getMaxScale(),wn=24*(Yr-1),bn={positionedGlyphs:[],lineOffset:0};ot.positionedLines[Ui]=bn;var Qi=bn.positionedGlyphs,mn=0;if(_i.length()){for(var on=0;on<_i.length();on++){var ui=_i.getSection(on),Fo=_i.getSectionIndex(on),so=_i.getCharCode(on),$o=0,An=null,Mn=null,Yn=null,Mi=24,Fa=!(qt===yr.horizontal||!Wt&&!sA(so)||Wt&&(Iu[so]||(Jo=so,Gt.Arabic(Jo)||Gt["Arabic Supplement"](Jo)||Gt["Arabic Extended-A"](Jo)||Gt["Arabic Presentation Forms-A"](Jo)||Gt["Arabic Presentation Forms-B"](Jo))));if(ui.imageName){var Wo=Et[ui.imageName];if(!Wo)continue;Yn=ui.imageName,ot.iconsInText=ot.iconsInText||!0,Mn=Wo.paddedRect;var Qo=Wo.displaySize;ui.scale=24*ui.scale/Yt,$o=wn+(24-Qo[1]*ui.scale),Mi=(An={width:Qo[0],height:Qo[1],left:1,top:-3,advance:Fa?Qo[1]:Qo[0]}).advance;var As=Fa?Qo[0]*ui.scale-24*Yr:Qo[1]*ui.scale-24*Yr;As>0&&As>mn&&(mn=As)}else{var hl=At[ui.fontStack],Is=hl&&hl[so];if(Is&&Is.rect)Mn=Is.rect,An=Is.metrics;else{var Il=nt[ui.fontStack],Ks=Il&&Il[so];if(!Ks)continue;An=Ks.metrics}$o=24*(Yr-ui.scale)}Fa?(ot.verticalizable=!0,Qi.push({glyph:so,imageName:Yn,x:Ot,y:Ir+$o,vertical:Fa,scale:ui.scale,fontStack:ui.fontStack,sectionIndex:Fo,metrics:An,rect:Mn}),Ot+=Mi*ui.scale+Kt):(Qi.push({glyph:so,imageName:Yn,x:Ot,y:Ir+$o,vertical:Fa,scale:ui.scale,fontStack:ui.fontStack,sectionIndex:Fo,metrics:An,rect:Mn}),Ot+=An.advance*ui.scale+Kt)}Qi.length!==0&&(gr=Math.max(Ot-Kt,gr),Tp(Qi,0,Qi.length-1,yi,mn)),Ot=0;var Ss=$t*Yr+mn;bn.lineOffset=Math.max(mn,wn),Ir+=Ss,Jr=Math.max(Ss,Jr),++Ui}else Ir+=$t,++Ui}var Jo,Sl=Ir- -17,RA=ch(nr),hc=RA.horizontalAlign,Dc=RA.verticalAlign;(function(ku,Xl,Pu,au,Qu,Du,yh,_h,Xh){var Lu,Wh=(Xl-Pu)*Qu;Lu=Du!==yh?-_h*au- -17:(-au*Xh+.5)*yh;for(var zu=0,vh=ku;zu<vh.length;zu+=1)for(var su=0,Gs=vh[zu].positionedGlyphs;su<Gs.length;su+=1){var pc=Gs[su];pc.x+=Wh,pc.y+=Lu}})(ot.positionedLines,yi,hc,Dc,gr,Jr,$t,Sl,ft.length),ot.top+=-Dc*Sl,ot.bottom=ot.top+Sl,ot.left+=-hc*gr,ot.right=ot.left+gr}(Ye,n,s,p,h,T,D,j,le,ee,ye,a),!function(ot){for(var nt=0,At=ot;nt<At.length;nt+=1)if(At[nt].positionedGlyphs.length!==0)return!1;return!0}(Qe)&&Ye}Zo.fromFeature=function(e,n){for(var s=new Zo,p=0;p<e.sections.length;p++){var g=e.sections[p];g.image?s.addImageSection(g):s.addTextSection(g,n)}return s},Zo.prototype.length=function(){return this.text.length},Zo.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},Zo.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},Zo.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},Zo.prototype.verticalizePunctuation=function(){this.text=function(e){for(var n="",s=0;s<e.length;s++){var p=e.charCodeAt(s+1)||null,g=e.charCodeAt(s-1)||null;n+=p&&ol(p)&&!Ec[e[s+1]]||g&&ol(g)&&!Ec[e[s-1]]||!Ec[e[s]]?e[s]:Ec[e[s]]}return n}(this.text)},Zo.prototype.trim=function(){for(var e=0,n=0;n<this.text.length&&Iu[this.text.charCodeAt(n)];n++)e++;for(var s=this.text.length,p=this.text.length-1;p>=0&&p>=e&&Iu[this.text.charCodeAt(p)];p--)s--;this.text=this.text.substring(e,s),this.sectionIndex=this.sectionIndex.slice(e,s)},Zo.prototype.substring=function(e,n){var s=new Zo;return s.text=this.text.substring(e,n),s.sectionIndex=this.sectionIndex.slice(e,n),s.sections=this.sections,s},Zo.prototype.toString=function(){return this.text},Zo.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(n,s){return Math.max(n,e.sections[s].scale)},0)},Zo.prototype.addTextSection=function(e,n){this.text+=e.text,this.sections.push(Bl.forText(e.scale,e.fontStack||n));for(var s=this.sections.length-1,p=0;p<e.text.length;++p)this.sectionIndex.push(s)},Zo.prototype.addImageSection=function(e){var n=e.image?e.image.name:"";if(n.length!==0){var s=this.getNextImageSectionCharCode();s?(this.text+=String.fromCharCode(s),this.sections.push(Bl.forImage(n)),this.sectionIndex.push(this.sections.length-1)):rr("Reached maximum number of images 6401")}else rr("Can't add FormattedSection with an empty image.")},Zo.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Iu={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},rn={};function tu(e,n,s,p,g,x){if(n.imageName){var T=p[n.imageName];return T?T.displaySize[0]*n.scale*24/x+g:0}var D=s[n.fontStack],j=D&&D[e];return j?j.metrics.advance*n.scale+g:0}function Vh(e,n,s,p){var g=Math.pow(e-n,2);return p?e<n?g/2:2*g:g+Math.abs(s)*s}function sc(e,n,s){var p=0;return e===10&&(p-=1e4),s&&(p+=150),e!==40&&e!==65288||(p+=50),n!==41&&n!==65289||(p+=50),p}function lc(e,n,s,p,g,x){for(var T=null,D=Vh(n,s,g,x),j=0,ee=p;j<ee.length;j+=1){var oe=ee[j],le=Vh(n-oe.x,s,g,x)+oe.badness;le<=D&&(T=oe,D=le)}return{index:e,x:n,priorBreak:T,badness:D}}function Ac(e,n,s,p,g,x,T){if(x!=="point")return[];if(!e)return[];for(var D,j=[],ee=function(h,f,v,w,k,L){for(var O=0,Z=0;Z<h.length();Z++){var re=h.getSection(Z);O+=tu(h.getCharCode(Z),re,w,k,f,L)}return O/Math.max(1,Math.ceil(O/v))}(e,n,s,p,g,T),oe=e.text.indexOf("\u200B")>=0,le=0,ye=0;ye<e.length();ye++){var i=e.getSection(ye),t=e.getCharCode(ye);if(Iu[t]||(le+=tu(t,i,p,g,n,T)),ye<e.length()-1){var a=!((D=t)<11904||!(Gt["Bopomofo Extended"](D)||Gt.Bopomofo(D)||Gt["CJK Compatibility Forms"](D)||Gt["CJK Compatibility Ideographs"](D)||Gt["CJK Compatibility"](D)||Gt["CJK Radicals Supplement"](D)||Gt["CJK Strokes"](D)||Gt["CJK Symbols and Punctuation"](D)||Gt["CJK Unified Ideographs Extension A"](D)||Gt["CJK Unified Ideographs"](D)||Gt["Enclosed CJK Letters and Months"](D)||Gt["Halfwidth and Fullwidth Forms"](D)||Gt.Hiragana(D)||Gt["Ideographic Description Characters"](D)||Gt["Kangxi Radicals"](D)||Gt["Katakana Phonetic Extensions"](D)||Gt.Katakana(D)||Gt["Vertical Forms"](D)||Gt["Yi Radicals"](D)||Gt["Yi Syllables"](D)));(rn[t]||a||i.imageName)&&j.push(lc(ye+1,le,ee,j,sc(t,e.getCharCode(ye+1),a&&oe),!1))}}return function h(f){return f?h(f.priorBreak).concat(f.index):[]}(lc(e.length(),le,ee,j,0,!0))}function ch(e){var n=.5,s=.5;switch(e){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:n,verticalAlign:s}}function Tp(e,n,s,p,g){if(p||g)for(var x=e[s],T=(e[s].x+x.metrics.advance*x.scale)*p,D=n;D<=s;D++)e[D].x-=T,e[D].y+=g}function uh(e,n,s,p,g,x){var T,D=e.image;if(D.content){var j=D.content,ee=D.pixelRatio||1;T=[j[0]/ee,j[1]/ee,D.displaySize[0]-j[2]/ee,D.displaySize[1]-j[3]/ee]}var oe,le,ye,i,t=n.left*x,a=n.right*x;s==="width"||s==="both"?(i=g[0]+t-p[3],le=g[0]+a+p[1]):le=(i=g[0]+(t+a-D.displaySize[0])/2)+D.displaySize[0];var h=n.top*x,f=n.bottom*x;return s==="height"||s==="both"?(oe=g[1]+h-p[0],ye=g[1]+f+p[2]):ye=(oe=g[1]+(h+f-D.displaySize[1])/2)+D.displaySize[1],{image:D,top:oe,right:le,bottom:ye,left:i,collisionPadding:T}}rn[10]=!0,rn[32]=!0,rn[38]=!0,rn[40]=!0,rn[41]=!0,rn[43]=!0,rn[45]=!0,rn[47]=!0,rn[173]=!0,rn[183]=!0,rn[8203]=!0,rn[8208]=!0,rn[8211]=!0,rn[8231]=!0;var cc=function(e){function n(s,p,g,x){e.call(this,s,p),this.angle=g,x!==void 0&&(this.segment=x)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.clone=function(){return new n(this.x,this.y,this.angle,this.segment)},n}(Y);function Tc(e,n){var s=n.expression;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new pi(e+1))};if(s.kind==="source")return{kind:"source"};for(var p=s.zoomStops,g=s.interpolationType,x=0;x<p.length&&p[x]<=e;)x++;for(var T=x=Math.max(0,x-1);T<p.length&&p[T]<e+1;)T++;T=Math.min(p.length-1,T);var D=p[x],j=p[T];return s.kind==="composite"?{kind:"composite",minZoom:D,maxZoom:j,interpolationType:g}:{kind:"camera",minZoom:D,maxZoom:j,minSize:s.evaluate(new pi(D)),maxSize:s.evaluate(new pi(j)),interpolationType:g}}function hh(e,n,s){var p=n.uSize,g=s.lowerSize;return e.kind==="source"?g/128:e.kind==="composite"?Li(g/128,s.upperSize/128,n.uSizeT):p}function Fc(e,n){var s=0,p=0;if(e.kind==="constant")p=e.layoutSize;else if(e.kind!=="source"){var g=e.interpolationType,x=g?_t(Ro.interpolationFactor(g,n,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?p=Li(e.minSize,e.maxSize,x):s=x}return{uSizeT:s,uSize:p}}fr("Anchor",cc);var Uc=Object.freeze({__proto__:null,getSizeData:Tc,evaluateSizeForFeature:hh,evaluateSizeForZoom:Fc,SIZE_PACK_FACTOR:128});function fA(e,n,s,p,g){if(n.segment===void 0)return!0;for(var x=n,T=n.segment+1,D=0;D>-s/2;){if(--T<0)return!1;D-=e[T].dist(x),x=e[T]}D+=e[T].dist(e[T+1]),T++;for(var j=[],ee=0;D<s/2;){var oe=e[T],le=e[T+1];if(!le)return!1;var ye=e[T-1].angleTo(oe)-oe.angleTo(le);for(ye=Math.abs((ye+3*Math.PI)%(2*Math.PI)-Math.PI),j.push({distance:D,angleDelta:ye}),ee+=ye;D-j[0].distance>p;)ee-=j.shift().angleDelta;if(ee>g)return!1;T++,D+=oe.dist(le)}return!0}function Mc(e){for(var n=0,s=0;s<e.length-1;s++)n+=e[s].dist(e[s+1]);return n}function ru(e,n,s){return e?.6*n*s:0}function ph(e,n){return Math.max(e?e.right-e.left:0,n?n.right-n.left:0)}function Nh(e,n,s,p,g,x){for(var T=ru(s,g,x),D=ph(s,p)*x,j=0,ee=Mc(e)/2,oe=0;oe<e.length-1;oe++){var le=e[oe],ye=e[oe+1],i=le.dist(ye);if(j+i>ee){var t=(ee-j)/i,a=Li(le.x,ye.x,t),h=Li(le.y,ye.y,t),f=new cc(a,h,ye.angleTo(le),oe);return f._round(),!T||fA(e,f,D,T,n)?f:void 0}j+=i}}function Kh(e,n,s,p,g,x,T,D,j){var ee=ru(p,x,T),oe=ph(p,g),le=oe*T,ye=e[0].x===0||e[0].x===j||e[0].y===0||e[0].y===j;return n-le<n/4&&(n=le+n/4),function i(t,a,h,f,v,w,k,L,O){for(var Z=w/2,re=Mc(t),he=0,de=a-h,me=[],Ue=0;Ue<t.length-1;Ue++){for(var Qe=t[Ue],Ye=t[Ue+1],ot=Qe.dist(Ye),nt=Ye.angleTo(Qe);de+h<he+ot;){var At=((de+=h)-he)/ot,Et=Li(Qe.x,Ye.x,At),ft=Li(Qe.y,Ye.y,At);if(Et>=0&&Et<O&&ft>=0&&ft<O&&de-Z>=0&&de+Z<=re){var $t=new cc(Et,ft,nt,Ue);$t._round(),f&&!fA(t,$t,w,f,v)||me.push($t)}}he+=ot}return L||me.length||k||(me=i(t,he/2,h,f,v,w,k,!0,O)),me}(e,ye?n/2*D%n:(oe/2+2*x)*T*D%n,n,ee,s,le,ye,!1,j)}function Gh(e,n,s,p,g){for(var x=[],T=0;T<e.length;T++)for(var D=e[T],j=void 0,ee=0;ee<D.length-1;ee++){var oe=D[ee],le=D[ee+1];oe.x<n&&le.x<n||(oe.x<n?oe=new Y(n,oe.y+(n-oe.x)/(le.x-oe.x)*(le.y-oe.y))._round():le.x<n&&(le=new Y(n,oe.y+(n-oe.x)/(le.x-oe.x)*(le.y-oe.y))._round()),oe.y<s&&le.y<s||(oe.y<s?oe=new Y(oe.x+(s-oe.y)/(le.y-oe.y)*(le.x-oe.x),s)._round():le.y<s&&(le=new Y(oe.x+(s-oe.y)/(le.y-oe.y)*(le.x-oe.x),s)._round()),oe.x>=p&&le.x>=p||(oe.x>=p?oe=new Y(p,oe.y+(p-oe.x)/(le.x-oe.x)*(le.y-oe.y))._round():le.x>=p&&(le=new Y(p,oe.y+(p-oe.x)/(le.x-oe.x)*(le.y-oe.y))._round()),oe.y>=g&&le.y>=g||(oe.y>=g?oe=new Y(oe.x+(g-oe.y)/(le.y-oe.y)*(le.x-oe.x),g)._round():le.y>=g&&(le=new Y(oe.x+(g-oe.y)/(le.y-oe.y)*(le.x-oe.x),g)._round()),j&&oe.equals(j[j.length-1])||x.push(j=[oe]),j.push(le)))))}return x}function kc(e,n,s,p){var g=[],x=e.image,T=x.pixelRatio,D=x.paddedRect.w-2,j=x.paddedRect.h-2,ee=e.right-e.left,oe=e.bottom-e.top,le=x.stretchX||[[0,D]],ye=x.stretchY||[[0,j]],i=function(Et,ft){return Et+ft[1]-ft[0]},t=le.reduce(i,0),a=ye.reduce(i,0),h=D-t,f=j-a,v=0,w=t,k=0,L=a,O=0,Z=h,re=0,he=f;if(x.content&&p){var de=x.content;v=Ja(le,0,de[0]),k=Ja(ye,0,de[1]),w=Ja(le,de[0],de[2]),L=Ja(ye,de[1],de[3]),O=de[0]-v,re=de[1]-k,Z=de[2]-de[0]-w,he=de[3]-de[1]-L}var me=function(Et,ft,$t,nr){var Xt=mA(Et.stretch-v,w,ee,e.left),qt=Su(Et.fixed-O,Z,Et.stretch,t),Kt=mA(ft.stretch-k,L,oe,e.top),Wt=Su(ft.fixed-re,he,ft.stretch,a),Yt=mA($t.stretch-v,w,ee,e.left),Ot=Su($t.fixed-O,Z,$t.stretch,t),Ir=mA(nr.stretch-k,L,oe,e.top),gr=Su(nr.fixed-re,he,nr.stretch,a),Jr=new Y(Xt,Kt),yi=new Y(Yt,Kt),Ui=new Y(Yt,Ir),jr=new Y(Xt,Ir),zi=new Y(qt/T,Wt/T),_i=new Y(Ot/T,gr/T),Yr=n*Math.PI/180;if(Yr){var wn=Math.sin(Yr),bn=Math.cos(Yr),Qi=[bn,-wn,wn,bn];Jr._matMult(Qi),yi._matMult(Qi),jr._matMult(Qi),Ui._matMult(Qi)}var mn=Et.stretch+Et.fixed,on=ft.stretch+ft.fixed;return{tl:Jr,tr:yi,bl:jr,br:Ui,tex:{x:x.paddedRect.x+1+mn,y:x.paddedRect.y+1+on,w:$t.stretch+$t.fixed-mn,h:nr.stretch+nr.fixed-on},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:zi,pixelOffsetBR:_i,minFontScaleX:Z/T/ee,minFontScaleY:he/T/oe,isSDF:s}};if(p&&(x.stretchX||x.stretchY))for(var Ue=iu(le,h,t),Qe=iu(ye,f,a),Ye=0;Ye<Ue.length-1;Ye++)for(var ot=Ue[Ye],nt=Ue[Ye+1],At=0;At<Qe.length-1;At++)g.push(me(ot,Qe[At],nt,Qe[At+1]));else g.push(me({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:D+1},{fixed:0,stretch:j+1}));return g}function Ja(e,n,s){for(var p=0,g=0,x=e;g<x.length;g+=1){var T=x[g];p+=Math.max(n,Math.min(s,T[1]))-Math.max(n,Math.min(s,T[0]))}return p}function iu(e,n,s){for(var p=[{fixed:-1,stretch:0}],g=0,x=e;g<x.length;g+=1){var T=x[g],D=T[0],j=T[1],ee=p[p.length-1];p.push({fixed:D-ee.stretch,stretch:ee.stretch}),p.push({fixed:D-ee.stretch,stretch:ee.stretch+(j-D)})}return p.push({fixed:n+1,stretch:s}),p}function mA(e,n,s,p){return e/n*s+p}function Su(e,n,s,p){return e-n*s/p}var Tu=function(e,n,s,p,g,x,T,D,j,ee){if(this.boxStartIndex=e.length,j){var oe=x.top,le=x.bottom,ye=x.collisionPadding;ye&&(oe-=ye[1],le+=ye[3]);var i=le-oe;i>0&&(i=Math.max(10,i),this.circleDiameter=i)}else{var t=x.top*T-D,a=x.bottom*T+D,h=x.left*T-D,f=x.right*T+D,v=x.collisionPadding;if(v&&(h-=v[0]*T,t-=v[1]*T,f+=v[2]*T,a+=v[3]*T),ee){var w=new Y(h,t),k=new Y(f,t),L=new Y(h,a),O=new Y(f,a),Z=ee*Math.PI/180;w._rotate(Z),k._rotate(Z),L._rotate(Z),O._rotate(Z),h=Math.min(w.x,k.x,L.x,O.x),f=Math.max(w.x,k.x,L.x,O.x),t=Math.min(w.y,k.y,L.y,O.y),a=Math.max(w.y,k.y,L.y,O.y)}e.emplaceBack(n.x,n.y,h,t,f,a,s,p,g)}this.boxEndIndex=e.length},gA=function(e,n){if(e===void 0&&(e=[]),n===void 0&&(n=Cs),this.data=e,this.length=this.data.length,this.compare=n,this.length>0)for(var s=(this.length>>1)-1;s>=0;s--)this._down(s)};function Cs(e,n){return e<n?-1:e>n?1:0}function nu(e,n,s){n===void 0&&(n=1),s===void 0&&(s=!1);for(var p=1/0,g=1/0,x=-1/0,T=-1/0,D=e[0],j=0;j<D.length;j++){var ee=D[j];(!j||ee.x<p)&&(p=ee.x),(!j||ee.y<g)&&(g=ee.y),(!j||ee.x>x)&&(x=ee.x),(!j||ee.y>T)&&(T=ee.y)}var oe=Math.min(x-p,T-g),le=oe/2,ye=new gA([],LA);if(oe===0)return new Y(p,g);for(var i=p;i<x;i+=oe)for(var t=g;t<T;t+=oe)ye.push(new ul(i+le,t+le,le,e));for(var a=function(v){for(var w=0,k=0,L=0,O=v[0],Z=0,re=O.length,he=re-1;Z<re;he=Z++){var de=O[Z],me=O[he],Ue=de.x*me.y-me.x*de.y;k+=(de.x+me.x)*Ue,L+=(de.y+me.y)*Ue,w+=3*Ue}return new ul(k/w,L/w,0,v)}(e),h=ye.length;ye.length;){var f=ye.pop();(f.d>a.d||!a.d)&&(a=f,s&&console.log("found best %d after %d probes",Math.round(1e4*f.d)/1e4,h)),f.max-a.d<=n||(ye.push(new ul(f.p.x-(le=f.h/2),f.p.y-le,le,e)),ye.push(new ul(f.p.x+le,f.p.y-le,le,e)),ye.push(new ul(f.p.x-le,f.p.y+le,le,e)),ye.push(new ul(f.p.x+le,f.p.y+le,le,e)),h+=4)}return s&&(console.log("num probes: "+h),console.log("best distance: "+a.d)),a.p}function LA(e,n){return n.max-e.max}function ul(e,n,s,p){this.p=new Y(e,n),this.h=s,this.d=function(g,x){for(var T=!1,D=1/0,j=0;j<x.length;j++)for(var ee=x[j],oe=0,le=ee.length,ye=le-1;oe<le;ye=oe++){var i=ee[oe],t=ee[ye];i.y>g.y!=t.y>g.y&&g.x<(t.x-i.x)*(g.y-i.y)/(t.y-i.y)+i.x&&(T=!T),D=Math.min(D,IA(g,i,t))}return(T?1:-1)*Math.sqrt(D)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}gA.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},gA.prototype.pop=function(){if(this.length!==0){var e=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),e}},gA.prototype.peek=function(){return this.data[0]},gA.prototype._up=function(e){for(var n=this.data,s=this.compare,p=n[e];e>0;){var g=e-1>>1,x=n[g];if(s(p,x)>=0)break;n[e]=x,e=g}n[e]=p},gA.prototype._down=function(e){for(var n=this.data,s=this.compare,p=this.length>>1,g=n[e];e<p;){var x=1+(e<<1),T=n[x],D=x+1;if(D<this.length&&s(n[D],T)<0&&(x=D,T=n[D]),s(T,g)>=0)break;n[e]=T,e=x}n[e]=g};var Fu=Number.POSITIVE_INFINITY;function dh(e,n){return n[1]!==Fu?function(s,p,g){var x=0,T=0;switch(p=Math.abs(p),g=Math.abs(g),s){case"top-right":case"top-left":case"top":T=g-7;break;case"bottom-right":case"bottom-left":case"bottom":T=7-g}switch(s){case"top-right":case"bottom-right":case"right":x=-p;break;case"top-left":case"bottom-left":case"left":x=p}return[x,T]}(e,n[0],n[1]):function(s,p){var g=0,x=0;p<0&&(p=0);var T=p/Math.sqrt(2);switch(s){case"top-right":case"top-left":x=T-7;break;case"bottom-right":case"bottom-left":x=7-T;break;case"bottom":x=7-p;break;case"top":x=p-7}switch(s){case"top-right":case"bottom-right":g=-T;break;case"top-left":case"bottom-left":g=T;break;case"left":g=p;break;case"right":g=-p}return[g,x]}(e,n[0])}function ou(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function jh(e,n,s,p,g,x,T,D,j,ee,oe,le,ye,i,t){var a=function(k,L,O,Z,re,he,de,me){for(var Ue=Z.layout.get("text-rotate").evaluate(he,{})*Math.PI/180,Qe=[],Ye=0,ot=L.positionedLines;Ye<ot.length;Ye+=1)for(var nt=ot[Ye],At=0,Et=nt.positionedGlyphs;At<Et.length;At+=1){var ft=Et[At];if(ft.rect){var $t=ft.rect||{},nr=4,Xt=!0,qt=1,Kt=0,Wt=(re||me)&&ft.vertical,Yt=ft.metrics.advance*ft.scale/2;if(me&&L.verticalizable&&(Kt=nt.lineOffset/2-(ft.imageName?-(24-ft.metrics.width*ft.scale)/2:24*(ft.scale-1))),ft.imageName){var Ot=de[ft.imageName];Xt=Ot.sdf,nr=1/(qt=Ot.pixelRatio)}var Ir=re?[ft.x+Yt,ft.y]:[0,0],gr=re?[0,0]:[ft.x+Yt+O[0],ft.y+O[1]-Kt],Jr=[0,0];Wt&&(Jr=gr,gr=[0,0]);var yi=(ft.metrics.left-nr)*ft.scale-Yt+gr[0],Ui=(-ft.metrics.top-nr)*ft.scale+gr[1],jr=yi+$t.w*ft.scale/qt,zi=Ui+$t.h*ft.scale/qt,_i=new Y(yi,Ui),Yr=new Y(jr,Ui),wn=new Y(yi,zi),bn=new Y(jr,zi);if(Wt){var Qi=new Y(-Yt,Yt- -17),mn=-Math.PI/2,on=12-Yt,ui=new Y(22-on,-(ft.imageName?on:0)),Fo=new(Function.prototype.bind.apply(Y,[null].concat(Jr)));_i._rotateAround(mn,Qi)._add(ui)._add(Fo),Yr._rotateAround(mn,Qi)._add(ui)._add(Fo),wn._rotateAround(mn,Qi)._add(ui)._add(Fo),bn._rotateAround(mn,Qi)._add(ui)._add(Fo)}if(Ue){var so=Math.sin(Ue),$o=Math.cos(Ue),An=[$o,-so,so,$o];_i._matMult(An),Yr._matMult(An),wn._matMult(An),bn._matMult(An)}var Mn=new Y(0,0),Yn=new Y(0,0);Qe.push({tl:_i,tr:Yr,bl:wn,br:bn,tex:$t,writingMode:L.writingMode,glyphOffset:Ir,sectionIndex:ft.sectionIndex,isSDF:Xt,pixelOffsetTL:Mn,pixelOffsetBR:Yn,minFontScaleX:0,minFontScaleY:0})}}return Qe}(0,s,D,g,x,T,p,e.allowVerticalPlacement),h=e.textSizeData,f=null;h.kind==="source"?(f=[128*g.layout.get("text-size").evaluate(T,{})])[0]>32640&&rr(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):h.kind==="composite"&&((f=[128*i.compositeTextSizes[0].evaluate(T,{},t),128*i.compositeTextSizes[1].evaluate(T,{},t)])[0]>32640||f[1]>32640)&&rr(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,a,f,D,x,T,ee,n,j.lineStartIndex,j.lineLength,ye,t);for(var v=0,w=oe;v<w.length;v+=1)le[w[v]]=e.text.placedSymbolArray.length-1;return 4*a.length}function fh(e){for(var n in e)return e[n];return null}function $h(e,n,s,p){var g=e.compareText;if(n in g){for(var x=g[n],T=x.length-1;T>=0;T--)if(p.dist(x[T])<s)return!0}else g[n]=[];return g[n].push(p),!1}var qh=nc.VectorTileFeature.types,Zh=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function uc(e,n,s,p,g,x,T,D,j,ee,oe,le,ye){var i=D?Math.min(32640,Math.round(D[0])):0,t=D?Math.min(32640,Math.round(D[1])):0;e.emplaceBack(n,s,Math.round(32*p),Math.round(32*g),x,T,(i<<1)+(j?1:0),t,16*ee,16*oe,256*le,256*ye)}function Uu(e,n,s){e.emplaceBack(n.x,n.y,s),e.emplaceBack(n.x,n.y,s),e.emplaceBack(n.x,n.y,s),e.emplaceBack(n.x,n.y,s)}function Mu(e){for(var n=0,s=e.sections;n<s.length;n+=1)if(lA(s[n].text))return!0;return!1}var yA=function(e){this.layoutVertexArray=new Ce,this.indexArray=new $e,this.programConfigurations=e,this.segments=new Ie,this.dynamicLayoutVertexArray=new je,this.opacityVertexArray=new De,this.placedSymbolArray=new d};yA.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},yA.prototype.upload=function(e,n,s,p){this.isEmpty()||(s&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Cc.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,nh.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Zh,!0),this.opacityVertexBuffer.itemSize=1),(s||p)&&this.programConfigurations.upload(e))},yA.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},fr("SymbolBuffers",yA);var zA=function(e,n,s){this.layoutVertexArray=new e,this.layoutAttributes=n,this.indexArray=new s,this.segments=new Ie,this.collisionVertexArray=new vt};zA.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Qh.members,!0)},zA.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},fr("CollisionBuffers",zA);var vn=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(x){return x.id}),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ga([]),this.placementViewportMatrix=ga([]);var n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Tc(this.zoom,n["text-size"]),this.iconSizeData=Tc(this.zoom,n["icon-size"]);var s=this.layers[0].layout,p=s.get("symbol-sort-key"),g=s.get("symbol-z-order");this.canOverlap=s.get("text-allow-overlap")||s.get("icon-allow-overlap")||s.get("text-ignore-placement")||s.get("icon-ignore-placement"),this.sortFeaturesByKey=g!=="viewport-y"&&p.constantOr(1)!==void 0,this.sortFeaturesByY=(g==="viewport-y"||g==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,s.get("symbol-placement")==="point"&&(this.writingModes=s.get("text-writing-mode").map(function(x){return yr[x]})),this.stateDependentLayerIds=this.layers.filter(function(x){return x.isStateDependent()}).map(function(x){return x.id}),this.sourceID=e.sourceID};vn.prototype.createArrays=function(){this.text=new yA(new Dr(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new yA(new Dr(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new Q,this.lineVertexArray=new R,this.symbolInstances=new M},vn.prototype.calculateGlyphDependencies=function(e,n,s,p,g){for(var x=0;x<e.length;x++)if(n[e.charCodeAt(x)]=!0,(s||p)&&g){var T=Ec[e.charAt(x)];T&&(n[T.charCodeAt(0)]=!0)}},vn.prototype.populate=function(e,n,s){var p=this.layers[0],g=p.layout,x=g.get("text-font"),T=g.get("text-field"),D=g.get("icon-image"),j=(T.value.kind!=="constant"||T.value.value instanceof Bi&&!T.value.value.isEmpty()||T.value.value.toString().length>0)&&(x.value.kind!=="constant"||x.value.value.length>0),ee=D.value.kind!=="constant"||!!D.value.value||Object.keys(D.parameters).length>0,oe=g.get("symbol-sort-key");if(this.features=[],j||ee){for(var le=n.iconDependencies,ye=n.glyphDependencies,i=n.availableImages,t=new pi(this.zoom),a=0,h=e;a<h.length;a+=1){var f=h[a],v=f.feature,w=f.id,k=f.index,L=f.sourceLayerIndex,O=p._featureFilter.needGeometry,Z=vo(v,O);if(p._featureFilter.filter(t,Z,s)){O||(Z.geometry=Un(v));var re=void 0;if(j){var he=p.getValueAndResolveTokens("text-field",Z,s,i),de=Bi.factory(he);Mu(de)&&(this.hasRTLText=!0),(!this.hasRTLText||EA()==="unavailable"||this.hasRTLText&&Xn.isParsed())&&(re=Dh(de,p,Z))}var me=void 0;if(ee){var Ue=p.getValueAndResolveTokens("icon-image",Z,s,i);me=Ue instanceof hi?Ue:hi.fromString(Ue)}if(re||me){var Qe=this.sortFeaturesByKey?oe.evaluate(Z,{},s):void 0;if(this.features.push({id:w,text:re,icon:me,index:k,sourceLayerIndex:L,geometry:Z.geometry,properties:v.properties,type:qh[v.type],sortKey:Qe}),me&&(le[me.name]=!0),re){var Ye=x.evaluate(Z,{},s).join(","),ot=g.get("text-rotation-alignment")==="map"&&g.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(yr.vertical)>=0;for(var nt=0,At=re.sections;nt<At.length;nt+=1){var Et=At[nt];if(Et.image)le[Et.image.name]=!0;else{var ft=ws(re.toString()),$t=Et.fontStack||Ye,nr=ye[$t]=ye[$t]||{};this.calculateGlyphDependencies(Et.text,nr,ot,this.allowVerticalPlacement,ft)}}}}}}g.get("symbol-placement")==="line"&&(this.features=function(Xt){var qt={},Kt={},Wt=[],Yt=0;function Ot(Qi){Wt.push(Xt[Qi]),Yt++}function Ir(Qi,mn,on){var ui=Kt[Qi];return delete Kt[Qi],Kt[mn]=ui,Wt[ui].geometry[0].pop(),Wt[ui].geometry[0]=Wt[ui].geometry[0].concat(on[0]),ui}function gr(Qi,mn,on){var ui=qt[mn];return delete qt[mn],qt[Qi]=ui,Wt[ui].geometry[0].shift(),Wt[ui].geometry[0]=on[0].concat(Wt[ui].geometry[0]),ui}function Jr(Qi,mn,on){var ui=on?mn[0][mn[0].length-1]:mn[0][0];return Qi+":"+ui.x+":"+ui.y}for(var yi=0;yi<Xt.length;yi++){var Ui=Xt[yi],jr=Ui.geometry,zi=Ui.text?Ui.text.toString():null;if(zi){var _i=Jr(zi,jr),Yr=Jr(zi,jr,!0);if(_i in Kt&&Yr in qt&&Kt[_i]!==qt[Yr]){var wn=gr(_i,Yr,jr),bn=Ir(_i,Yr,Wt[wn].geometry);delete qt[_i],delete Kt[Yr],Kt[Jr(zi,Wt[bn].geometry,!0)]=bn,Wt[wn].geometry=null}else _i in Kt?Ir(_i,Yr,jr):Yr in qt?gr(_i,Yr,jr):(Ot(yi),qt[_i]=Yt-1,Kt[Yr]=Yt-1)}else Ot(yi)}return Wt.filter(function(Qi){return Qi.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Xt,qt){return Xt.sortKey-qt.sortKey})}},vn.prototype.update=function(e,n,s){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,n,this.layers,s),this.icon.programConfigurations.updatePaintArrays(e,n,this.layers,s))},vn.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},vn.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},vn.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},vn.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},vn.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},vn.prototype.addToLineVertexArray=function(e,n){var s=this.lineVertexArray.length;if(e.segment!==void 0){for(var p=e.dist(n[e.segment+1]),g=e.dist(n[e.segment]),x={},T=e.segment+1;T<n.length;T++)x[T]={x:n[T].x,y:n[T].y,tileUnitDistanceFromAnchor:p},T<n.length-1&&(p+=n[T+1].dist(n[T]));for(var D=e.segment||0;D>=0;D--)x[D]={x:n[D].x,y:n[D].y,tileUnitDistanceFromAnchor:g},D>0&&(g+=n[D-1].dist(n[D]));for(var j=0;j<n.length;j++){var ee=x[j];this.lineVertexArray.emplaceBack(ee.x,ee.y,ee.tileUnitDistanceFromAnchor)}}return{lineStartIndex:s,lineLength:this.lineVertexArray.length-s}},vn.prototype.addSymbols=function(e,n,s,p,g,x,T,D,j,ee,oe,le){for(var ye=e.indexArray,i=e.layoutVertexArray,t=e.segments.prepareSegment(4*n.length,i,ye,this.canOverlap?x.sortKey:void 0),a=this.glyphOffsetArray.length,h=t.vertexLength,f=this.allowVerticalPlacement&&T===yr.vertical?Math.PI/2:0,v=x.text&&x.text.sections,w=0;w<n.length;w++){var k=n[w],L=k.tl,O=k.tr,Z=k.bl,re=k.br,he=k.tex,de=k.pixelOffsetTL,me=k.pixelOffsetBR,Ue=k.minFontScaleX,Qe=k.minFontScaleY,Ye=k.glyphOffset,ot=k.isSDF,nt=k.sectionIndex,At=t.vertexLength,Et=Ye[1];uc(i,D.x,D.y,L.x,Et+L.y,he.x,he.y,s,ot,de.x,de.y,Ue,Qe),uc(i,D.x,D.y,O.x,Et+O.y,he.x+he.w,he.y,s,ot,me.x,de.y,Ue,Qe),uc(i,D.x,D.y,Z.x,Et+Z.y,he.x,he.y+he.h,s,ot,de.x,me.y,Ue,Qe),uc(i,D.x,D.y,re.x,Et+re.y,he.x+he.w,he.y+he.h,s,ot,me.x,me.y,Ue,Qe),Uu(e.dynamicLayoutVertexArray,D,f),ye.emplaceBack(At,At+1,At+2),ye.emplaceBack(At+1,At+2,At+3),t.vertexLength+=4,t.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ye[0]),w!==n.length-1&&nt===n[w+1].sectionIndex||e.programConfigurations.populatePaintArrays(i.length,x,x.index,{},le,v&&v[nt])}e.placedSymbolArray.emplaceBack(D.x,D.y,a,this.glyphOffsetArray.length-a,h,j,ee,D.segment,s?s[0]:0,s?s[1]:0,p[0],p[1],T,0,!1,0,oe)},vn.prototype._addCollisionDebugVertex=function(e,n,s,p,g,x){return n.emplaceBack(0,0),e.emplaceBack(s.x,s.y,p,g,Math.round(x.x),Math.round(x.y))},vn.prototype.addCollisionDebugVertices=function(e,n,s,p,g,x,T){var D=g.segments.prepareSegment(4,g.layoutVertexArray,g.indexArray),j=D.vertexLength,ee=g.layoutVertexArray,oe=g.collisionVertexArray,le=T.anchorX,ye=T.anchorY;this._addCollisionDebugVertex(ee,oe,x,le,ye,new Y(e,n)),this._addCollisionDebugVertex(ee,oe,x,le,ye,new Y(s,n)),this._addCollisionDebugVertex(ee,oe,x,le,ye,new Y(s,p)),this._addCollisionDebugVertex(ee,oe,x,le,ye,new Y(e,p)),D.vertexLength+=4;var i=g.indexArray;i.emplaceBack(j,j+1),i.emplaceBack(j+1,j+2),i.emplaceBack(j+2,j+3),i.emplaceBack(j+3,j),D.primitiveLength+=4},vn.prototype.addDebugCollisionBoxes=function(e,n,s,p){for(var g=e;g<n;g++){var x=this.collisionBoxArray.get(g);this.addCollisionDebugVertices(x.x1,x.y1,x.x2,x.y2,p?this.textCollisionBox:this.iconCollisionBox,x.anchorPoint,s)}},vn.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new zA(lt,Eu.members,St),this.iconCollisionBox=new zA(lt,Eu.members,St);for(var e=0;e<this.symbolInstances.length;e++){var n=this.symbolInstances.get(e);this.addDebugCollisionBoxes(n.textBoxStartIndex,n.textBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.iconBoxStartIndex,n.iconBoxEndIndex,n,!1),this.addDebugCollisionBoxes(n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex,n,!1)}},vn.prototype._deserializeCollisionBoxesForSymbol=function(e,n,s,p,g,x,T,D,j){for(var ee={},oe=n;oe<s;oe++){var le=e.get(oe);ee.textBox={x1:le.x1,y1:le.y1,x2:le.x2,y2:le.y2,anchorPointX:le.anchorPointX,anchorPointY:le.anchorPointY},ee.textFeatureIndex=le.featureIndex;break}for(var ye=p;ye<g;ye++){var i=e.get(ye);ee.verticalTextBox={x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2,anchorPointX:i.anchorPointX,anchorPointY:i.anchorPointY},ee.verticalTextFeatureIndex=i.featureIndex;break}for(var t=x;t<T;t++){var a=e.get(t);ee.iconBox={x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2,anchorPointX:a.anchorPointX,anchorPointY:a.anchorPointY},ee.iconFeatureIndex=a.featureIndex;break}for(var h=D;h<j;h++){var f=e.get(h);ee.verticalIconBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},ee.verticalIconFeatureIndex=f.featureIndex;break}return ee},vn.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var n=0;n<this.symbolInstances.length;n++){var s=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,s.textBoxStartIndex,s.textBoxEndIndex,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex))}},vn.prototype.hasTextData=function(){return this.text.segments.get().length>0},vn.prototype.hasIconData=function(){return this.icon.segments.get().length>0},vn.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},vn.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},vn.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},vn.prototype.addIndicesForPlacedSymbol=function(e,n){for(var s=e.placedSymbolArray.get(n),p=s.vertexStartIndex+4*s.numGlyphs,g=s.vertexStartIndex;g<p;g+=4)e.indexArray.emplaceBack(g,g+1,g+2),e.indexArray.emplaceBack(g+1,g+2,g+3)},vn.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var n=Math.sin(e),s=Math.cos(e),p=[],g=[],x=[],T=0;T<this.symbolInstances.length;++T){x.push(T);var D=this.symbolInstances.get(T);p.push(0|Math.round(n*D.anchorX+s*D.anchorY)),g.push(D.featureIndex)}return x.sort(function(j,ee){return p[j]-p[ee]||g[ee]-g[j]}),x},vn.prototype.addToSortKeyRanges=function(e,n){var s=this.sortKeyRanges[this.sortKeyRanges.length-1];s&&s.sortKey===n?s.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:e,symbolInstanceEnd:e+1})},vn.prototype.sortFeatures=function(e){var n=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var s=0,p=this.symbolInstanceIndexes;s<p.length;s+=1){var g=this.symbolInstances.get(p[s]);this.featureSortOrder.push(g.featureIndex),[g.rightJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.leftJustifiedTextSymbolIndex].forEach(function(x,T,D){x>=0&&D.indexOf(x)===T&&n.addIndicesForPlacedSymbol(n.text,x)}),g.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,g.verticalPlacedTextSymbolIndex),g.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,g.placedIconSymbolIndex),g.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,g.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},fr("SymbolBucket",vn,{omit:["layers","collisionBoxArray","features","compareText"]}),vn.MAX_GLYPHS=65535,vn.addDynamicAttributes=Uu;var Fp=new eo({"symbol-placement":new kr(Ee.layout_symbol["symbol-placement"]),"symbol-spacing":new kr(Ee.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new kr(Ee.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new cr(Ee.layout_symbol["symbol-sort-key"]),"symbol-z-order":new kr(Ee.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new kr(Ee.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new kr(Ee.layout_symbol["icon-ignore-placement"]),"icon-optional":new kr(Ee.layout_symbol["icon-optional"]),"icon-rotation-alignment":new kr(Ee.layout_symbol["icon-rotation-alignment"]),"icon-size":new cr(Ee.layout_symbol["icon-size"]),"icon-text-fit":new kr(Ee.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new kr(Ee.layout_symbol["icon-text-fit-padding"]),"icon-image":new cr(Ee.layout_symbol["icon-image"]),"icon-rotate":new cr(Ee.layout_symbol["icon-rotate"]),"icon-padding":new kr(Ee.layout_symbol["icon-padding"]),"icon-keep-upright":new kr(Ee.layout_symbol["icon-keep-upright"]),"icon-offset":new cr(Ee.layout_symbol["icon-offset"]),"icon-anchor":new cr(Ee.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new kr(Ee.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new kr(Ee.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new kr(Ee.layout_symbol["text-rotation-alignment"]),"text-field":new cr(Ee.layout_symbol["text-field"]),"text-font":new cr(Ee.layout_symbol["text-font"]),"text-size":new cr(Ee.layout_symbol["text-size"]),"text-max-width":new cr(Ee.layout_symbol["text-max-width"]),"text-line-height":new kr(Ee.layout_symbol["text-line-height"]),"text-letter-spacing":new cr(Ee.layout_symbol["text-letter-spacing"]),"text-justify":new cr(Ee.layout_symbol["text-justify"]),"text-radial-offset":new cr(Ee.layout_symbol["text-radial-offset"]),"text-variable-anchor":new kr(Ee.layout_symbol["text-variable-anchor"]),"text-anchor":new cr(Ee.layout_symbol["text-anchor"]),"text-max-angle":new kr(Ee.layout_symbol["text-max-angle"]),"text-writing-mode":new kr(Ee.layout_symbol["text-writing-mode"]),"text-rotate":new cr(Ee.layout_symbol["text-rotate"]),"text-padding":new kr(Ee.layout_symbol["text-padding"]),"text-keep-upright":new kr(Ee.layout_symbol["text-keep-upright"]),"text-transform":new cr(Ee.layout_symbol["text-transform"]),"text-offset":new cr(Ee.layout_symbol["text-offset"]),"text-allow-overlap":new kr(Ee.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new kr(Ee.layout_symbol["text-ignore-placement"]),"text-optional":new kr(Ee.layout_symbol["text-optional"])}),mh={paint:new eo({"icon-opacity":new cr(Ee.paint_symbol["icon-opacity"]),"icon-color":new cr(Ee.paint_symbol["icon-color"]),"icon-halo-color":new cr(Ee.paint_symbol["icon-halo-color"]),"icon-halo-width":new cr(Ee.paint_symbol["icon-halo-width"]),"icon-halo-blur":new cr(Ee.paint_symbol["icon-halo-blur"]),"icon-translate":new kr(Ee.paint_symbol["icon-translate"]),"icon-translate-anchor":new kr(Ee.paint_symbol["icon-translate-anchor"]),"text-opacity":new cr(Ee.paint_symbol["text-opacity"]),"text-color":new cr(Ee.paint_symbol["text-color"],{runtimeType:ct,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new cr(Ee.paint_symbol["text-halo-color"]),"text-halo-width":new cr(Ee.paint_symbol["text-halo-width"]),"text-halo-blur":new cr(Ee.paint_symbol["text-halo-blur"]),"text-translate":new kr(Ee.paint_symbol["text-translate"]),"text-translate-anchor":new kr(Ee.paint_symbol["text-translate-anchor"])}),layout:Fp},Pc=function(e){this.type=e.property.overrides?e.property.overrides.runtimeType:Me,this.defaultValue=e};Pc.prototype.evaluate=function(e){if(e.formattedSection){var n=this.defaultValue.property.overrides;if(n&&n.hasOverride(e.formattedSection))return n.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},Pc.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},Pc.prototype.outputDefined=function(){return!1},Pc.prototype.serialize=function(){return null},fr("FormatSectionOverride",Pc,{omit:["defaultValue"]});var Qc=function(e){function n(s){e.call(this,s,mh)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.recalculate=function(s,p){if(e.prototype.recalculate.call(this,s,p),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var g=this.layout.get("text-writing-mode");if(g){for(var x=[],T=0,D=g;T<D.length;T+=1){var j=D[T];x.indexOf(j)<0&&x.push(j)}this.layout._values["text-writing-mode"]=x}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},n.prototype.getValueAndResolveTokens=function(s,p,g,x){var T=this.layout.get(s).evaluate(p,{},g,x),D=this._unevaluatedLayout._values[s];return D.isDataDriven()||gs(D.value)||!T?T:function(j,ee){return ee.replace(/{([^{}]+)}/g,function(oe,le){return le in j?String(j[le]):""})}(p.properties,T)},n.prototype.createBucket=function(s){return new vn(s)},n.prototype.queryRadius=function(){return 0},n.prototype.queryIntersectsFeature=function(){return!1},n.prototype._setPaintOverrides=function(){for(var s=0,p=mh.paint.overridableProperties;s<p.length;s+=1){var g=p[s];if(n.hasPaintOverride(this.layout,g)){var x,T=this.paint.get(g),D=new Pc(T),j=new Da(D,T.property.specification);x=T.value.kind==="constant"||T.value.kind==="source"?new Ys("source",j):new _s("composite",j,T.value.zoomStops,T.value._interpolationType),this.paint._values[g]=new oo(T.property,x,T.parameters)}}},n.prototype._handleOverridablePaintPropertyUpdate=function(s,p,g){return!(!this.layout||p.isDataDriven()||g.isDataDriven())&&n.hasPaintOverride(this.layout,s)},n.hasPaintOverride=function(s,p){var g=s.get("text-field"),x=mh.paint.properties[p],T=!1,D=function(oe){for(var le=0,ye=oe;le<ye.length;le+=1)if(x.overrides&&x.overrides.hasOverride(ye[le]))return void(T=!0)};if(g.value.kind==="constant"&&g.value.value instanceof Bi)D(g.value.value.sections);else if(g.value.kind==="source"){var j=function(oe){T||(oe instanceof Eo&&zn(oe.value)===xt?D(oe.value.sections):oe instanceof go?D(oe.sections):oe.eachChild(j))},ee=g.value;ee._styleExpression&&j(ee._styleExpression.expression)}return T},n}(y),gh={paint:new eo({"background-color":new kr(Ee.paint_background["background-color"]),"background-pattern":new qi(Ee.paint_background["background-pattern"]),"background-opacity":new kr(Ee.paint_background["background-opacity"])})},I=function(e){function n(s){e.call(this,s,gh)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n}(y),B={paint:new eo({"raster-opacity":new kr(Ee.paint_raster["raster-opacity"]),"raster-hue-rotate":new kr(Ee.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new kr(Ee.paint_raster["raster-brightness-min"]),"raster-brightness-max":new kr(Ee.paint_raster["raster-brightness-max"]),"raster-saturation":new kr(Ee.paint_raster["raster-saturation"]),"raster-contrast":new kr(Ee.paint_raster["raster-contrast"]),"raster-resampling":new kr(Ee.paint_raster["raster-resampling"]),"raster-fade-duration":new kr(Ee.paint_raster["raster-fade-duration"])})},U=function(e){function n(s){e.call(this,s,B)}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n}(y),F=function(e){function n(s){e.call(this,s,{}),this.implementation=s}return e&&(n.__proto__=e),(n.prototype=Object.create(e&&e.prototype)).constructor=n,n.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},n.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},n.prototype.recalculate=function(){},n.prototype.updateTransitions=function(){},n.prototype.hasTransition=function(){},n.prototype.serialize=function(){},n.prototype.onAdd=function(s){this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)},n.prototype.onRemove=function(s){this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)},n}(y),G={circle:Ia,heatmap:gu,hillshade:Sa,fill:PA,"fill-extrusion":Bp,line:Jc,symbol:Qc,background:I,raster:U},ue=be.HTMLImageElement,_e=be.HTMLCanvasElement,Ge=be.HTMLVideoElement,Ve=be.ImageData,ut=be.ImageBitmap,pt=function(e,n,s,p){this.context=e,this.format=s,this.texture=e.gl.createTexture(),this.update(n,p)};pt.prototype.update=function(e,n,s){var p=e.width,g=e.height,x=!(this.size&&this.size[0]===p&&this.size[1]===g||s),T=this.context,D=T.gl;if(this.useMipmap=Boolean(n&&n.useMipmap),D.bindTexture(D.TEXTURE_2D,this.texture),T.pixelStoreUnpackFlipY.set(!1),T.pixelStoreUnpack.set(1),T.pixelStoreUnpackPremultiplyAlpha.set(this.format===D.RGBA&&(!n||n.premultiply!==!1)),x)this.size=[p,g],e instanceof ue||e instanceof _e||e instanceof Ge||e instanceof Ve||ut&&e instanceof ut?D.texImage2D(D.TEXTURE_2D,0,this.format,this.format,D.UNSIGNED_BYTE,e):D.texImage2D(D.TEXTURE_2D,0,this.format,p,g,0,this.format,D.UNSIGNED_BYTE,e.data);else{var j=s||{x:0,y:0},ee=j.x,oe=j.y;e instanceof ue||e instanceof _e||e instanceof Ge||e instanceof Ve||ut&&e instanceof ut?D.texSubImage2D(D.TEXTURE_2D,0,ee,oe,D.RGBA,D.UNSIGNED_BYTE,e):D.texSubImage2D(D.TEXTURE_2D,0,ee,oe,p,g,D.RGBA,D.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&D.generateMipmap(D.TEXTURE_2D)},pt.prototype.bind=function(e,n,s){var p=this.context.gl;p.bindTexture(p.TEXTURE_2D,this.texture),s!==p.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(s=p.LINEAR),e!==this.filter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,e),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,s||e),this.filter=e),n!==this.wrap&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,n),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,n),this.wrap=n)},pt.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},pt.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Pt=function(e){var n=this;this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){n._triggered=!1,n._callback()})};Pt.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},Pt.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Qt=function(e,n,s){this.target=e,this.parent=n,this.mapId=s,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},dr(["receive","process"],this),this.invoker=new Pt(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=br()?e:be};function Fr(e,n,s){var p=2*Math.PI*6378137/256/Math.pow(2,s);return[e*p-2*Math.PI*6378137/2,n*p-2*Math.PI*6378137/2]}Qt.prototype.send=function(e,n,s,p,g){var x=this;g===void 0&&(g=!1);var T=Math.round(1e18*Math.random()).toString(36).substring(0,10);s&&(this.callbacks[T]=s);var D=di(this.globalScope)?void 0:[];return this.target.postMessage({id:T,type:e,hasCallback:!!s,targetMapId:p,mustQueue:g,sourceMapId:this.mapId,data:ra(n,D)},D),{cancel:function(){s&&delete x.callbacks[T],x.target.postMessage({id:T,type:"<cancel>",targetMapId:p,sourceMapId:x.mapId})}}},Qt.prototype.receive=function(e){var n=e.data,s=n.id;if(s&&(!n.targetMapId||this.mapId===n.targetMapId))if(n.type==="<cancel>"){delete this.tasks[s];var p=this.cancelCallbacks[s];delete this.cancelCallbacks[s],p&&p()}else br()||n.mustQueue?(this.tasks[s]=n,this.taskQueue.push(s),this.invoker.trigger()):this.processTask(s,n)},Qt.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),n=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),n&&this.processTask(e,n)}},Qt.prototype.processTask=function(e,n){var s=this;if(n.type==="<response>"){var p=this.callbacks[e];delete this.callbacks[e],p&&(n.error?p(ia(n.error)):p(null,ia(n.data)))}else{var g=!1,x=di(this.globalScope)?void 0:[],T=n.hasCallback?function(oe,le){g=!0,delete s.cancelCallbacks[e],s.target.postMessage({id:e,type:"<response>",sourceMapId:s.mapId,error:oe?ra(oe):null,data:ra(le,x)},x)}:function(oe){g=!0},D=null,j=ia(n.data);if(this.parent[n.type])D=this.parent[n.type](n.sourceMapId,j,T);else if(this.parent.getWorkerSource){var ee=n.type.split(".");D=this.parent.getWorkerSource(n.sourceMapId,ee[0],j.source)[ee[1]](j,T)}else T(new Error("Could not find function "+n.type));!g&&D&&D.cancel&&(this.cancelCallbacks[e]=D.cancel)}},Qt.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Nt=function(e,n){e&&(n?this.setSouthWest(e).setNorthEast(n):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))};Nt.prototype.setNorthEast=function(e){return this._ne=e instanceof tr?new tr(e.lng,e.lat):tr.convert(e),this},Nt.prototype.setSouthWest=function(e){return this._sw=e instanceof tr?new tr(e.lng,e.lat):tr.convert(e),this},Nt.prototype.extend=function(e){var n,s,p=this._sw,g=this._ne;if(e instanceof tr)n=e,s=e;else{if(!(e instanceof Nt))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Nt.convert(e)):this.extend(tr.convert(e)):this;if(s=e._ne,!(n=e._sw)||!s)return this}return p||g?(p.lng=Math.min(n.lng,p.lng),p.lat=Math.min(n.lat,p.lat),g.lng=Math.max(s.lng,g.lng),g.lat=Math.max(s.lat,g.lat)):(this._sw=new tr(n.lng,n.lat),this._ne=new tr(s.lng,s.lat)),this},Nt.prototype.getCenter=function(){return new tr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Nt.prototype.getSouthWest=function(){return this._sw},Nt.prototype.getNorthEast=function(){return this._ne},Nt.prototype.getNorthWest=function(){return new tr(this.getWest(),this.getNorth())},Nt.prototype.getSouthEast=function(){return new tr(this.getEast(),this.getSouth())},Nt.prototype.getWest=function(){return this._sw.lng},Nt.prototype.getSouth=function(){return this._sw.lat},Nt.prototype.getEast=function(){return this._ne.lng},Nt.prototype.getNorth=function(){return this._ne.lat},Nt.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Nt.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Nt.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Nt.prototype.contains=function(e){var n=tr.convert(e),s=n.lng,p=n.lat,g=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(g=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&g},Nt.convert=function(e){return!e||e instanceof Nt?e:new Nt(e)};var tr=function(e,n){if(isNaN(e)||isNaN(n))throw new Error("Invalid LngLat object: ("+e+", "+n+")");if(this.lng=+e,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};tr.prototype.wrap=function(){return new tr(yt(this.lng,-180,180),this.lat)},tr.prototype.toArray=function(){return[this.lng,this.lat]},tr.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},tr.prototype.distanceTo=function(e){var n=Math.PI/180,s=this.lat*n,p=e.lat*n,g=Math.sin(s)*Math.sin(p)+Math.cos(s)*Math.cos(p)*Math.cos((e.lng-this.lng)*n);return 63710088e-1*Math.acos(Math.min(g,1))},tr.prototype.toBounds=function(e){e===void 0&&(e=0);var n=360*e/40075017,s=n/Math.cos(Math.PI/180*this.lat);return new Nt(new tr(this.lng-s,this.lat-n),new tr(this.lng+s,this.lat+n))},tr.convert=function(e){if(e instanceof tr)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new tr(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new tr(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var ji=2*Math.PI*63710088e-1;function ci(e){return ji*Math.cos(e*Math.PI/180)}function oi(e){return(180+e)/360}function Gn(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Ii(e,n){return e/ci(n)}function Si(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var ai=function(e,n,s){s===void 0&&(s=0),this.x=+e,this.y=+n,this.z=+s};ai.fromLngLat=function(e,n){n===void 0&&(n=0);var s=tr.convert(e);return new ai(oi(s.lng),Gn(s.lat),Ii(n,s.lat))},ai.prototype.toLngLat=function(){return new tr(360*this.x-180,Si(this.y))},ai.prototype.toAltitude=function(){return this.z*ci(Si(this.y))},ai.prototype.meterInMercatorCoordinateUnits=function(){return 1/ji*(e=Si(this.y),1/Math.cos(e*Math.PI/180));var e};var nn=function(e,n,s){this.z=e,this.x=n,this.y=s,this.key=Fi(0,e,e,n,s)};nn.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},nn.prototype.url=function(e,n){var s,p,g,x,T,D=(p=this.y,g=this.z,x=Fr(256*(s=this.x),256*(p=Math.pow(2,g)-p-1),g),T=Fr(256*(s+1),256*(p+1),g),x[0]+","+x[1]+","+T[0]+","+T[1]),j=function(ee,oe,le){for(var ye,i="",t=ee;t>0;t--)i+=(oe&(ye=1<<t-1)?1:0)+(le&ye?2:0);return i}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(n==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",j).replace("{bbox-epsg-3857}",D)},nn.prototype.getTilePoint=function(e){var n=Math.pow(2,this.z);return new Y(8192*(e.x*n-this.x),8192*(e.y*n-this.y))},nn.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var xn=function(e,n){this.wrap=e,this.canonical=n,this.key=Fi(e,n.z,n.z,n.x,n.y)},Qr=function(e,n,s,p,g){this.overscaledZ=e,this.wrap=n,this.canonical=new nn(s,+p,+g),this.key=Fi(n,e,s,p,g)};function Fi(e,n,s,p,g){(e*=2)<0&&(e=-1*e-1);var x=1<<s;return(x*x*e+x*g+p).toString(36)+s.toString(36)+n.toString(36)}Qr.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},Qr.prototype.scaledTo=function(e){var n=this.canonical.z-e;return e>this.canonical.z?new Qr(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Qr(e,this.wrap,e,this.canonical.x>>n,this.canonical.y>>n)},Qr.prototype.calculateScaledKey=function(e,n){var s=this.canonical.z-e;return e>this.canonical.z?Fi(this.wrap*+n,e,this.canonical.z,this.canonical.x,this.canonical.y):Fi(this.wrap*+n,e,e,this.canonical.x>>s,this.canonical.y>>s)},Qr.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var n=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>n&&e.canonical.y===this.canonical.y>>n},Qr.prototype.children=function(e){if(this.overscaledZ>=e)return[new Qr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var n=this.canonical.z+1,s=2*this.canonical.x,p=2*this.canonical.y;return[new Qr(n,this.wrap,n,s,p),new Qr(n,this.wrap,n,s+1,p),new Qr(n,this.wrap,n,s,p+1),new Qr(n,this.wrap,n,s+1,p+1)]},Qr.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},Qr.prototype.wrapped=function(){return new Qr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Qr.prototype.unwrapTo=function(e){return new Qr(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},Qr.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Qr.prototype.toUnwrapped=function(){return new xn(this.wrap,this.canonical)},Qr.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Qr.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new ai(e.x-this.wrap,e.y))},fr("CanonicalTileID",nn),fr("OverscaledTileID",Qr,{omit:["posMatrix"]});var fo=function(e,n,s){if(this.uid=e,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(s&&s!=="mapbox"&&s!=="terrarium")return rr('"'+s+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=n.height;var p=this.dim=n.height-2;this.data=new Uint32Array(n.data.buffer),this.encoding=s||"mapbox";for(var g=0;g<p;g++)this.data[this._idx(-1,g)]=this.data[this._idx(0,g)],this.data[this._idx(p,g)]=this.data[this._idx(p-1,g)],this.data[this._idx(g,-1)]=this.data[this._idx(g,0)],this.data[this._idx(g,p)]=this.data[this._idx(g,p-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(p,-1)]=this.data[this._idx(p-1,0)],this.data[this._idx(-1,p)]=this.data[this._idx(0,p-1)],this.data[this._idx(p,p)]=this.data[this._idx(p-1,p-1)]};fo.prototype.get=function(e,n){var s=new Uint8Array(this.data.buffer),p=4*this._idx(e,n);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(s[p],s[p+1],s[p+2])},fo.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},fo.prototype._idx=function(e,n){if(e<-1||e>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(e+1)},fo.prototype._unpackMapbox=function(e,n,s){return(256*e*256+256*n+s)/10-1e4},fo.prototype._unpackTerrarium=function(e,n,s){return 256*e+n+s/256-32768},fo.prototype.getPixels=function(){return new Ha({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},fo.prototype.backfillBorder=function(e,n,s){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var p=n*this.dim,g=n*this.dim+this.dim,x=s*this.dim,T=s*this.dim+this.dim;switch(n){case-1:p=g-1;break;case 1:g=p+1}switch(s){case-1:x=T-1;break;case 1:T=x+1}for(var D=-n*this.dim,j=-s*this.dim,ee=x;ee<T;ee++)for(var oe=p;oe<g;oe++)this.data[this._idx(oe,ee)]=e.data[this._idx(oe+D,ee+j)]},fr("DEMData",fo);var Va=function(e){this._stringToNumber={},this._numberToString=[];for(var n=0;n<e.length;n++){var s=e[n];this._stringToNumber[s]=n,this._numberToString[n]=s}};Va.prototype.encode=function(e){return this._stringToNumber[e]},Va.prototype.decode=function(e){return this._numberToString[e]};var jn=function(e,n,s,p,g){this.type="Feature",this._vectorTileFeature=e,e._z=n,e._x=s,e._y=p,this.properties=e.properties,this.id=g},Ta={geometry:{configurable:!0}};Ta.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Ta.geometry.set=function(e){this._geometry=e},jn.prototype.toJSON=function(){var e={geometry:this.geometry};for(var n in this)n!=="_geometry"&&n!=="_vectorTileFeature"&&(e[n]=this[n]);return e},Object.defineProperties(jn.prototype,Ta);var Es=function(){this.state={},this.stateChanges={},this.deletedStates={}};Es.prototype.updateState=function(e,n,s){var p=String(n);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][p]=this.stateChanges[e][p]||{},Bt(this.stateChanges[e][p],s),this.deletedStates[e]===null)for(var g in this.deletedStates[e]={},this.state[e])g!==p&&(this.deletedStates[e][g]=null);else if(this.deletedStates[e]&&this.deletedStates[e][p]===null)for(var x in this.deletedStates[e][p]={},this.state[e][p])s[x]||(this.deletedStates[e][p][x]=null);else for(var T in s)this.deletedStates[e]&&this.deletedStates[e][p]&&this.deletedStates[e][p][T]===null&&delete this.deletedStates[e][p][T]},Es.prototype.removeFeatureState=function(e,n,s){if(this.deletedStates[e]!==null){var p=String(n);if(this.deletedStates[e]=this.deletedStates[e]||{},s&&n!==void 0)this.deletedStates[e][p]!==null&&(this.deletedStates[e][p]=this.deletedStates[e][p]||{},this.deletedStates[e][p][s]=null);else if(n!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][p])for(s in this.deletedStates[e][p]={},this.stateChanges[e][p])this.deletedStates[e][p][s]=null;else this.deletedStates[e][p]=null;else this.deletedStates[e]=null}},Es.prototype.getState=function(e,n){var s=String(n),p=Bt({},(this.state[e]||{})[s],(this.stateChanges[e]||{})[s]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var g=this.deletedStates[e][n];if(g===null)return{};for(var x in g)delete p[x]}return p},Es.prototype.initializeTileState=function(e,n){e.setFeatureState(this.state,n)},Es.prototype.coalesceChanges=function(e,n){var s={};for(var p in this.stateChanges){this.state[p]=this.state[p]||{};var g={};for(var x in this.stateChanges[p])this.state[p][x]||(this.state[p][x]={}),Bt(this.state[p][x],this.stateChanges[p][x]),g[x]=this.state[p][x];s[p]=g}for(var T in this.deletedStates){this.state[T]=this.state[T]||{};var D={};if(this.deletedStates[T]===null)for(var j in this.state[T])D[j]={},this.state[T][j]={};else for(var ee in this.deletedStates[T]){if(this.deletedStates[T][ee]===null)this.state[T][ee]={};else for(var oe=0,le=Object.keys(this.deletedStates[T][ee]);oe<le.length;oe+=1)delete this.state[T][ee][le[oe]];D[ee]=this.state[T][ee]}s[T]=s[T]||{},Bt(s[T],D)}if(this.stateChanges={},this.deletedStates={},Object.keys(s).length!==0)for(var ye in e)e[ye].setFeatureState(s,n)};var Xo=function(e,n){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new xa(8192,16,0),this.grid3D=new xa(8192,16,0),this.featureIndexArray=new Ae,this.promoteId=n};function ss(e,n,s,p,g){return ur(e,function(x,T){var D=n instanceof Ba?n.get(T):null;return D&&D.evaluate?D.evaluate(s,p,g):D})}function Cl(e){for(var n=1/0,s=1/0,p=-1/0,g=-1/0,x=0,T=e;x<T.length;x+=1){var D=T[x];n=Math.min(n,D.x),s=Math.min(s,D.y),p=Math.max(p,D.x),g=Math.max(g,D.y)}return{minX:n,minY:s,maxX:p,maxY:g}}function El(e,n){return n-e}Xo.prototype.insert=function(e,n,s,p,g,x){var T=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(s,p,g);for(var D=x?this.grid3D:this.grid,j=0;j<n.length;j++){for(var ee=n[j],oe=[1/0,1/0,-1/0,-1/0],le=0;le<ee.length;le++){var ye=ee[le];oe[0]=Math.min(oe[0],ye.x),oe[1]=Math.min(oe[1],ye.y),oe[2]=Math.max(oe[2],ye.x),oe[3]=Math.max(oe[3],ye.y)}oe[0]<8192&&oe[1]<8192&&oe[2]>=0&&oe[3]>=0&&D.insert(T,oe[0],oe[1],oe[2],oe[3])}},Xo.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new nc.VectorTile(new Ic(this.rawTileData)).layers,this.sourceLayerCoder=new Va(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Xo.prototype.query=function(e,n,s,p){var g=this;this.loadVTLayers();for(var x=e.params||{},T=8192/e.tileSize/e.scale,D=iA(x.filter),j=e.queryGeometry,ee=e.queryPadding*T,oe=Cl(j),le=this.grid.query(oe.minX-ee,oe.minY-ee,oe.maxX+ee,oe.maxY+ee),ye=Cl(e.cameraQueryGeometry),i=this.grid3D.query(ye.minX-ee,ye.minY-ee,ye.maxX+ee,ye.maxY+ee,function(k,L,O,Z){return function(re,he,de,me,Ue){for(var Qe=0,Ye=re;Qe<Ye.length;Qe+=1){var ot=Ye[Qe];if(he<=ot.x&&de<=ot.y&&me>=ot.x&&Ue>=ot.y)return!0}var nt=[new Y(he,de),new Y(he,Ue),new Y(me,Ue),new Y(me,de)];if(re.length>2){for(var At=0,Et=nt;At<Et.length;At+=1)if(bs(re,Et[At]))return!0}for(var ft=0;ft<re.length-1;ft++)if(wl(re[ft],re[ft+1],nt))return!0;return!1}(e.cameraQueryGeometry,k-ee,L-ee,O+ee,Z+ee)}),t=0,a=i;t<a.length;t+=1)le.push(a[t]);le.sort(El);for(var h,f={},v=function(k){var L=le[k];if(L!==h){h=L;var O=g.featureIndexArray.get(L),Z=null;g.loadMatchingFeature(f,O.bucketIndex,O.sourceLayerIndex,O.featureIndex,D,x.layers,x.availableImages,n,s,p,function(re,he,de){return Z||(Z=Un(re)),he.queryIntersectsFeature(j,re,de,Z,g.z,e.transform,T,e.pixelPosMatrix)})}},w=0;w<le.length;w++)v(w);return f},Xo.prototype.loadMatchingFeature=function(e,n,s,p,g,x,T,D,j,ee,oe){var le=this.bucketLayerIDs[n];if(!x||function(re,he){for(var de=0;de<re.length;de++)if(he.indexOf(re[de])>=0)return!0;return!1}(x,le)){var ye=this.sourceLayerCoder.decode(s),i=this.vtLayers[ye].feature(p);if(g.needGeometry){var t=vo(i,!0);if(!g.filter(new pi(this.tileID.overscaledZ),t,this.tileID.canonical))return}else if(!g.filter(new pi(this.tileID.overscaledZ),i))return;for(var a=this.getId(i,ye),h=0;h<le.length;h++){var f=le[h];if(!(x&&x.indexOf(f)<0)){var v=D[f];if(v){var w={};a!==void 0&&ee&&(w=ee.getState(v.sourceLayer||"_geojsonTileLayer",a));var k=Bt({},j[f]);k.paint=ss(k.paint,v.paint,i,w,T),k.layout=ss(k.layout,v.layout,i,w,T);var L=!oe||oe(i,v,w);if(L){var O=new jn(i,this.z,this.x,this.y,a);O.layer=k;var Z=e[f];Z===void 0&&(Z=e[f]=[]),Z.push({featureIndex:p,feature:O,intersectionZ:L})}}}}}},Xo.prototype.lookupSymbolFeatures=function(e,n,s,p,g,x,T,D){var j={};this.loadVTLayers();for(var ee=iA(g),oe=0,le=e;oe<le.length;oe+=1)this.loadMatchingFeature(j,s,p,le[oe],ee,x,T,D,n);return j},Xo.prototype.hasLayer=function(e){for(var n=0,s=this.bucketLayerIDs;n<s.length;n+=1)for(var p=0,g=s[n];p<g.length;p+=1)if(e===g[p])return!0;return!1},Xo.prototype.getId=function(e,n){var s=e.id;return this.promoteId&&typeof(s=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[n]])=="boolean"&&(s=Number(s)),s},fr("FeatureIndex",Xo,{omit:["rawTileData","sourceLayerCoder"]});var $n=function(e,n){this.tileID=e,this.uid=It(),this.uses=0,this.tileSize=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};$n.prototype.registerFadeDuration=function(e){var n=e+this.timeAdded;n<cn.now()||this.fadeEndTime&&n<this.fadeEndTime||(this.fadeEndTime=n)},$n.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},$n.prototype.loadVectorData=function(e,n,s){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var p in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(ee,oe){var le={};if(!oe)return le;for(var ye=function(){var a=t[i],h=a.layerIds.map(function(w){return oe.getLayer(w)}).filter(Boolean);if(h.length!==0){a.layers=h,a.stateDependentLayerIds&&(a.stateDependentLayers=a.stateDependentLayerIds.map(function(w){return h.filter(function(k){return k.id===w})[0]}));for(var f=0,v=h;f<v.length;f+=1)le[v[f].id]=a}},i=0,t=ee;i<t.length;i+=1)ye();return le}(e.buckets,n.style),this.hasSymbolBuckets=!1,this.buckets){var g=this.buckets[p];if(g instanceof vn){if(this.hasSymbolBuckets=!0,!s)break;g.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var x in this.buckets){var T=this.buckets[x];if(T instanceof vn&&T.hasRTLText){this.hasRTLText=!0,Xn.isLoading()||Xn.isLoaded()||EA()!=="deferred"||is();break}}for(var D in this.queryPadding=0,this.buckets){var j=this.buckets[D];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(D).queryRadius(j))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new u},$n.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},$n.prototype.getBucket=function(e){return this.buckets[e.id]},$n.prototype.upload=function(e){for(var n in this.buckets){var s=this.buckets[n];s.uploadPending()&&s.upload(e)}var p=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new pt(e,this.imageAtlas.image,p.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new pt(e,this.glyphAtlasImage,p.ALPHA),this.glyphAtlasImage=null)},$n.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},$n.prototype.queryRenderedFeatures=function(e,n,s,p,g,x,T,D,j,ee){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:p,cameraQueryGeometry:g,scale:x,tileSize:this.tileSize,pixelPosMatrix:ee,transform:D,params:T,queryPadding:this.queryPadding*j},e,n,s):{}},$n.prototype.querySourceFeatures=function(e,n){var s=this.latestFeatureIndex;if(s&&s.rawTileData){var p=s.loadVTLayers(),g=n?n.sourceLayer:"",x=p._geojsonTileLayer||p[g];if(x)for(var T=iA(n&&n.filter),D=this.tileID.canonical,j=D.z,ee=D.x,oe=D.y,le={z:j,x:ee,y:oe},ye=0;ye<x.length;ye++){var i=x.feature(ye);if(T.needGeometry){var t=vo(i,!0);if(!T.filter(new pi(this.tileID.overscaledZ),t,this.tileID.canonical))continue}else if(!T.filter(new pi(this.tileID.overscaledZ),i))continue;var a=s.getId(i,g),h=new jn(i,j,ee,oe,a);h.tile=le,e.push(h)}}},$n.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},$n.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},$n.prototype.setExpiryData=function(e){var n=this.expirationTime;if(e.cacheControl){var s=Or(e.cacheControl);s["max-age"]&&(this.expirationTime=Date.now()+1e3*s["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var p=Date.now(),g=!1;if(this.expirationTime>p)g=!1;else if(n)if(this.expirationTime<n)g=!0;else{var x=this.expirationTime-n;x?this.expirationTime=p+Math.max(x,3e4):g=!0}else g=!0;g?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},$n.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},$n.prototype.setFeatureState=function(e,n){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var s=this.latestFeatureIndex.loadVTLayers();for(var p in this.buckets)if(n.style.hasLayer(p)){var g=this.buckets[p],x=g.layers[0].sourceLayer||"_geojsonTileLayer",T=s[x],D=e[x];if(T&&D&&Object.keys(D).length!==0){g.update(D,T,this.imageAtlas&&this.imageAtlas.patternPositions||{});var j=n&&n.style&&n.style.getLayer(p);j&&(this.queryPadding=Math.max(this.queryPadding,j.queryRadius(g)))}}}},$n.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},$n.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<cn.now()},$n.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},$n.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=cn.now()+e},$n.prototype.setDependencies=function(e,n){for(var s={},p=0,g=n;p<g.length;p+=1)s[g[p]]=!0;this.dependencies[e]=s},$n.prototype.hasDependency=function(e,n){for(var s=0,p=e;s<p.length;s+=1){var g=this.dependencies[p[s]];if(g){for(var x=0,T=n;x<T.length;x+=1)if(g[T[x]])return!0}}return!1};var ls=be.performance,sa=function(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},ls.mark(this._marks.start)};sa.prototype.finish=function(){ls.mark(this._marks.end);var e=ls.getEntriesByName(this._marks.measure);return e.length===0&&(ls.measure(this._marks.measure,this._marks.start,this._marks.end),e=ls.getEntriesByName(this._marks.measure),ls.clearMarks(this._marks.start),ls.clearMarks(this._marks.end),ls.clearMeasures(this._marks.measure)),e},o.Actor=Qt,o.AlphaImage=JA,o.CanonicalTileID=nn,o.CollisionBoxArray=u,o.Color=Tr,o.DEMData=fo,o.DataConstantProperty=kr,o.DictionaryCoder=Va,o.EXTENT=8192,o.ErrorEvent=We,o.EvaluationParameters=pi,o.Event=Re,o.Evented=st,o.FeatureIndex=Xo,o.FillBucket=Bs,o.FillExtrusionBucket=os,o.ImageAtlas=eu,o.ImagePosition=dA,o.LineBucket=wo,o.LngLat=tr,o.LngLatBounds=Nt,o.MercatorCoordinate=ai,o.ONE_EM=24,o.OverscaledTileID=Qr,o.Point=Y,o.Point$1=Y,o.Properties=eo,o.Protobuf=Ic,o.RGBAImage=Ha,o.RequestManager=an,o.RequestPerformance=sa,o.ResourceType=Nr,o.SegmentVector=Ie,o.SourceFeatureState=Es,o.StructArrayLayout1ui2=mr,o.StructArrayLayout2f1f2i16=ht,o.StructArrayLayout2i4=z,o.StructArrayLayout3ui6=$e,o.StructArrayLayout4i8=N,o.SymbolBucket=vn,o.Texture=pt,o.Tile=$n,o.Transitionable=no,o.Uniform1f=Vt,o.Uniform1i=Tt,o.Uniform2f=Ht,o.Uniform3f=hr,o.Uniform4f=Er,o.UniformColor=Mr,o.UniformMatrix4f=gi,o.UnwrappedTileID=xn,o.ValidationError=X,o.WritingMode=yr,o.ZoomHistory=aA,o.add=function(e,n,s){return e[0]=n[0]+s[0],e[1]=n[1]+s[1],e[2]=n[2]+s[2],e},o.addDynamicAttributes=Uu,o.asyncAll=function(e,n,s){if(!e.length)return s(null,[]);var p=e.length,g=new Array(e.length),x=null;e.forEach(function(T,D){n(T,function(j,ee){j&&(x=j),g[D]=ee,--p==0&&s(x,g)})})},o.bezier=it,o.bindAll=dr,o.browser=cn,o.cacheEntryPossiblyAdded=function(e){++er>bo&&(e.getActor().send("enforceCacheSizeLimit",bi),er=0)},o.clamp=_t,o.clearTileCache=function(e){var n=be.caches.delete("mapbox-tiles");e&&n.catch(e).then(function(){return e()})},o.clipLine=Gh,o.clone=function(e){var n=new tn(16);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n},o.clone$1=Rr,o.clone$2=function(e){var n=new tn(3);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n},o.collisionCircleLayout=Yc,o.config=wi,o.create=function(){var e=new tn(16);return tn!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},o.create$1=function(){var e=new tn(9);return tn!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},o.create$2=function(){var e=new tn(4);return tn!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},o.createCommonjsModule=q,o.createExpression=ys,o.createLayout=_,o.createStyleLayer=function(e){return e.type==="custom"?new F(e):new G[e.type](e)},o.cross=function(e,n,s){var p=n[0],g=n[1],x=n[2],T=s[0],D=s[1],j=s[2];return e[0]=g*j-x*D,e[1]=x*T-p*j,e[2]=p*D-g*T,e},o.deepEqual=function e(n,s){if(Array.isArray(n)){if(!Array.isArray(s)||n.length!==s.length)return!1;for(var p=0;p<n.length;p++)if(!e(n[p],s[p]))return!1;return!0}if(typeof n=="object"&&n!==null&&s!==null){if(typeof s!="object"||Object.keys(n).length!==Object.keys(s).length)return!1;for(var g in n)if(!e(n[g],s[g]))return!1;return!0}return n===s},o.dot=function(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]},o.dot$1=function(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]+e[3]*n[3]},o.ease=tt,o.emitValidationErrors=pr,o.endsWith=Xr,o.enforceCacheSizeLimit=function(e){ro(),$i&&$i.then(function(n){n.keys().then(function(s){for(var p=0;p<s.length-e;p++)n.delete(s[p])})})},o.evaluateSizeForFeature=hh,o.evaluateSizeForZoom=Fc,o.evaluateVariableOffset=dh,o.evented=CA,o.extend=Bt,o.featureFilter=iA,o.filterObject=_r,o.fromRotation=function(e,n){var s=Math.sin(n),p=Math.cos(n);return e[0]=p,e[1]=s,e[2]=0,e[3]=-s,e[4]=p,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},o.getAnchorAlignment=ch,o.getAnchorJustification=ou,o.getArrayBuffer=ka,o.getImage=fe,o.getJSON=function(e,n){return In(Bt(e,{type:"json"}),n)},o.getRTLTextPluginStatus=EA,o.getReferrer=mo,o.getVideo=function(e,n){var s,p,g=be.document.createElement("video");g.muted=!0,g.onloadstart=function(){n(null,g)};for(var x=0;x<e.length;x++){var T=be.document.createElement("source");s=e[x],p=void 0,(p=be.document.createElement("a")).href=s,(p.protocol!==be.document.location.protocol||p.host!==be.document.location.host)&&(g.crossOrigin="Anonymous"),T.src=e[x],g.appendChild(T)}return{cancel:function(){}}},o.identity=ga,o.invert=function(e,n){var s=n[0],p=n[1],g=n[2],x=n[3],T=n[4],D=n[5],j=n[6],ee=n[7],oe=n[8],le=n[9],ye=n[10],i=n[11],t=n[12],a=n[13],h=n[14],f=n[15],v=s*D-p*T,w=s*j-g*T,k=s*ee-x*T,L=p*j-g*D,O=p*ee-x*D,Z=g*ee-x*j,re=oe*a-le*t,he=oe*h-ye*t,de=oe*f-i*t,me=le*h-ye*a,Ue=le*f-i*a,Qe=ye*f-i*h,Ye=v*Qe-w*Ue+k*me+L*de-O*he+Z*re;return Ye?(e[0]=(D*Qe-j*Ue+ee*me)*(Ye=1/Ye),e[1]=(g*Ue-p*Qe-x*me)*Ye,e[2]=(a*Z-h*O+f*L)*Ye,e[3]=(ye*O-le*Z-i*L)*Ye,e[4]=(j*de-T*Qe-ee*he)*Ye,e[5]=(s*Qe-g*de+x*he)*Ye,e[6]=(h*k-t*Z-f*w)*Ye,e[7]=(oe*Z-ye*k+i*w)*Ye,e[8]=(T*Ue-D*de+ee*re)*Ye,e[9]=(p*de-s*Ue-x*re)*Ye,e[10]=(t*O-a*k+f*v)*Ye,e[11]=(le*k-oe*O-i*v)*Ye,e[12]=(D*he-T*me-j*re)*Ye,e[13]=(s*me-p*he+g*re)*Ye,e[14]=(a*w-t*L-h*v)*Ye,e[15]=(oe*L-le*w+ye*v)*Ye,e):null},o.isChar=Gt,o.isMapboxURL=qn,o.keysDifference=function(e,n){var s=[];for(var p in e)p in n||s.push(p);return s},o.makeRequest=In,o.mapObject=ur,o.mercatorXfromLng=oi,o.mercatorYfromLat=Gn,o.mercatorZfromAltitude=Ii,o.mul=Nc,o.multiply=na,o.mvt=nc,o.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},o.normalize=function(e,n){var s=n[0],p=n[1],g=n[2],x=s*s+p*p+g*g;return x>0&&(x=1/Math.sqrt(x)),e[0]=n[0]*x,e[1]=n[1]*x,e[2]=n[2]*x,e},o.number=Li,o.offscreenCanvasSupported=Vr,o.ortho=function(e,n,s,p,g,x,T){var D=1/(n-s),j=1/(p-g),ee=1/(x-T);return e[0]=-2*D,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*j,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*ee,e[11]=0,e[12]=(n+s)*D,e[13]=(g+p)*j,e[14]=(T+x)*ee,e[15]=1,e},o.parseGlyphPBF=function(e){return new Ic(e).readFields(Ah,[])},o.pbf=Ic,o.performSymbolLayout=function(e,n,s,p,g,x,T){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var D=e.layers[0].layout,j=e.layers[0]._unevaluatedLayout._values,ee={};if(e.textSizeData.kind==="composite"){var oe=e.textSizeData,le=oe.maxZoom;ee.compositeTextSizes=[j["text-size"].possiblyEvaluate(new pi(oe.minZoom),T),j["text-size"].possiblyEvaluate(new pi(le),T)]}if(e.iconSizeData.kind==="composite"){var ye=e.iconSizeData,i=ye.maxZoom;ee.compositeIconSizes=[j["icon-size"].possiblyEvaluate(new pi(ye.minZoom),T),j["icon-size"].possiblyEvaluate(new pi(i),T)]}ee.layoutTextSize=j["text-size"].possiblyEvaluate(new pi(e.zoom+1),T),ee.layoutIconSize=j["icon-size"].possiblyEvaluate(new pi(e.zoom+1),T),ee.textMaxSize=j["text-size"].possiblyEvaluate(new pi(18));for(var t=24*D.get("text-line-height"),a=D.get("text-rotation-alignment")==="map"&&D.get("symbol-placement")!=="point",h=D.get("text-keep-upright"),f=D.get("text-size"),v=function(){var L=k[w],O=D.get("text-font").evaluate(L,{},T).join(","),Z=f.evaluate(L,{},T),re=ee.layoutTextSize.evaluate(L,{},T),he=ee.layoutIconSize.evaluate(L,{},T),de={horizontal:{},vertical:void 0},me=L.text,Ue=[0,0];if(me){var Qe=me.toString(),Ye=24*D.get("text-letter-spacing").evaluate(L,{},T),ot=function(jr){for(var zi=0,_i=jr;zi<_i.length;zi+=1)if(Yr=_i[zi].charCodeAt(0),Gt.Arabic(Yr)||Gt["Arabic Supplement"](Yr)||Gt["Arabic Extended-A"](Yr)||Gt["Arabic Presentation Forms-A"](Yr)||Gt["Arabic Presentation Forms-B"](Yr))return!1;var Yr;return!0}(Qe)?Ye:0,nt=D.get("text-anchor").evaluate(L,{},T),At=D.get("text-variable-anchor");if(!At){var Et=D.get("text-radial-offset").evaluate(L,{},T);Ue=Et?dh(nt,[24*Et,Fu]):D.get("text-offset").evaluate(L,{},T).map(function(jr){return 24*jr})}var ft=a?"center":D.get("text-justify").evaluate(L,{},T),$t=D.get("symbol-placement"),nr=$t==="point"?24*D.get("text-max-width").evaluate(L,{},T):0,Xt=function(){e.allowVerticalPlacement&&ws(Qe)&&(de.vertical=as(me,n,s,g,O,nr,t,nt,"left",ot,Ue,yr.vertical,!0,$t,re,Z))};if(!a&&At){for(var qt=ft==="auto"?At.map(function(jr){return ou(jr)}):[ft],Kt=!1,Wt=0;Wt<qt.length;Wt++){var Yt=qt[Wt];if(!de.horizontal[Yt])if(Kt)de.horizontal[Yt]=de.horizontal[0];else{var Ot=as(me,n,s,g,O,nr,t,"center",Yt,ot,Ue,yr.horizontal,!1,$t,re,Z);Ot&&(de.horizontal[Yt]=Ot,Kt=Ot.positionedLines.length===1)}}Xt()}else{ft==="auto"&&(ft=ou(nt));var Ir=as(me,n,s,g,O,nr,t,nt,ft,ot,Ue,yr.horizontal,!1,$t,re,Z);Ir&&(de.horizontal[ft]=Ir),Xt(),ws(Qe)&&a&&h&&(de.vertical=as(me,n,s,g,O,nr,t,nt,ft,ot,Ue,yr.vertical,!1,$t,re,Z))}}var gr=void 0,Jr=!1;if(L.icon&&L.icon.name){var yi=p[L.icon.name];yi&&(gr=function(jr,zi,_i){var Yr=ch(_i),wn=zi[0]-jr.displaySize[0]*Yr.horizontalAlign,bn=zi[1]-jr.displaySize[1]*Yr.verticalAlign;return{image:jr,top:bn,bottom:bn+jr.displaySize[1],left:wn,right:wn+jr.displaySize[0]}}(g[L.icon.name],D.get("icon-offset").evaluate(L,{},T),D.get("icon-anchor").evaluate(L,{},T)),Jr=yi.sdf,e.sdfIcons===void 0?e.sdfIcons=yi.sdf:e.sdfIcons!==yi.sdf&&rr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(yi.pixelRatio!==e.pixelRatio||D.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var Ui=fh(de.horizontal)||de.vertical;e.iconsInText=!!Ui&&Ui.iconsInText,(Ui||gr)&&function(jr,zi,_i,Yr,wn,bn,Qi,mn,on,ui,Fo){var so=bn.textMaxSize.evaluate(zi,{});so===void 0&&(so=Qi);var $o,An=jr.layers[0].layout,Mn=An.get("icon-offset").evaluate(zi,{},Fo),Yn=fh(_i.horizontal),Mi=Qi/24,Fa=jr.tilePixelRatio*Mi,Wo=jr.tilePixelRatio*so/24,Qo=jr.tilePixelRatio*mn,As=jr.tilePixelRatio*An.get("symbol-spacing"),hl=An.get("text-padding")*jr.tilePixelRatio,Is=An.get("icon-padding")*jr.tilePixelRatio,Il=An.get("text-max-angle")/180*Math.PI,Ks=An.get("text-rotation-alignment")==="map"&&An.get("symbol-placement")!=="point",Ss=An.get("icon-rotation-alignment")==="map"&&An.get("symbol-placement")!=="point",Jo=An.get("symbol-placement"),Sl=As/2,RA=An.get("icon-text-fit");Yr&&RA!=="none"&&(jr.allowVerticalPlacement&&_i.vertical&&($o=uh(Yr,_i.vertical,RA,An.get("icon-text-fit-padding"),Mn,Mi)),Yn&&(Yr=uh(Yr,Yn,RA,An.get("icon-text-fit-padding"),Mn,Mi)));var hc=function(Gp,_A){_A.x<0||_A.x>=8192||_A.y<0||_A.y>=8192||function(Yo,dc,u_,Ou,Qd,$f,jp,Lc,$p,Up,qp,Zp,Dd,qf,Mp,Zf,Xf,Wf,Jf,Yf,Jl,Xp,em,zc,h_){var tm,xh,Yh,ep,tp,rp=Yo.addToLineVertexArray(dc,u_),rm=0,im=0,nm=0,om=0,Ld=-1,zd=-1,Au={},am=ke(""),Rd=0,Od=0;if(Lc._unevaluatedLayout.getValue("text-radial-offset")===void 0?(Rd=(tm=Lc.layout.get("text-offset").evaluate(Jl,{},zc).map(function(Pp){return 24*Pp}))[0],Od=tm[1]):(Rd=24*Lc.layout.get("text-radial-offset").evaluate(Jl,{},zc),Od=Fu),Yo.allowVerticalPlacement&&Ou.vertical){var sm=Lc.layout.get("text-rotate").evaluate(Jl,{},zc)+90;ep=new Tu($p,dc,Up,qp,Zp,Ou.vertical,Dd,qf,Mp,sm),jp&&(tp=new Tu($p,dc,Up,qp,Zp,jp,Xf,Wf,Mp,sm))}if(Qd){var Hd=Lc.layout.get("icon-rotate").evaluate(Jl,{}),lm=Lc.layout.get("icon-text-fit")!=="none",Am=kc(Qd,Hd,em,lm),Vd=jp?kc(jp,Hd,em,lm):void 0;Yh=new Tu($p,dc,Up,qp,Zp,Qd,Xf,Wf,!1,Hd),rm=4*Am.length;var cm=Yo.iconSizeData,kp=null;cm.kind==="source"?(kp=[128*Lc.layout.get("icon-size").evaluate(Jl,{})])[0]>32640&&rr(Yo.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):cm.kind==="composite"&&((kp=[128*Xp.compositeIconSizes[0].evaluate(Jl,{},zc),128*Xp.compositeIconSizes[1].evaluate(Jl,{},zc)])[0]>32640||kp[1]>32640)&&rr(Yo.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Yo.addSymbols(Yo.icon,Am,kp,Yf,Jf,Jl,!1,dc,rp.lineStartIndex,rp.lineLength,-1,zc),Ld=Yo.icon.placedSymbolArray.length-1,Vd&&(im=4*Vd.length,Yo.addSymbols(Yo.icon,Vd,kp,Yf,Jf,Jl,yr.vertical,dc,rp.lineStartIndex,rp.lineLength,-1,zc),zd=Yo.icon.placedSymbolArray.length-1)}for(var um in Ou.horizontal){var Wp=Ou.horizontal[um];if(!xh){am=ke(Wp.text);var p_=Lc.layout.get("text-rotate").evaluate(Jl,{},zc);xh=new Tu($p,dc,Up,qp,Zp,Wp,Dd,qf,Mp,p_)}var hm=Wp.positionedLines.length===1;if(nm+=jh(Yo,dc,Wp,$f,Lc,Mp,Jl,Zf,rp,Ou.vertical?yr.horizontal:yr.horizontalOnly,hm?Object.keys(Ou.horizontal):[um],Au,Ld,Xp,zc),hm)break}Ou.vertical&&(om+=jh(Yo,dc,Ou.vertical,$f,Lc,Mp,Jl,Zf,rp,yr.vertical,["vertical"],Au,zd,Xp,zc));var d_=xh?xh.boxStartIndex:Yo.collisionBoxArray.length,f_=xh?xh.boxEndIndex:Yo.collisionBoxArray.length,m_=ep?ep.boxStartIndex:Yo.collisionBoxArray.length,g_=ep?ep.boxEndIndex:Yo.collisionBoxArray.length,y_=Yh?Yh.boxStartIndex:Yo.collisionBoxArray.length,__=Yh?Yh.boxEndIndex:Yo.collisionBoxArray.length,v_=tp?tp.boxStartIndex:Yo.collisionBoxArray.length,x_=tp?tp.boxEndIndex:Yo.collisionBoxArray.length,Rc=-1,Jp=function(Pp,dm){return Pp&&Pp.circleDiameter?Math.max(Pp.circleDiameter,dm):dm};Rc=Jp(xh,Rc),Rc=Jp(ep,Rc),Rc=Jp(Yh,Rc);var pm=(Rc=Jp(tp,Rc))>-1?1:0;pm&&(Rc*=h_/24),Yo.glyphOffsetArray.length>=vn.MAX_GLYPHS&&rr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Jl.sortKey!==void 0&&Yo.addToSortKeyRanges(Yo.symbolInstances.length,Jl.sortKey),Yo.symbolInstances.emplaceBack(dc.x,dc.y,Au.right>=0?Au.right:-1,Au.center>=0?Au.center:-1,Au.left>=0?Au.left:-1,Au.vertical||-1,Ld,zd,am,d_,f_,m_,g_,y_,__,v_,x_,Up,nm,om,rm,im,pm,0,Dd,Rd,Od,Rc)}(jr,_A,Gp,_i,Yr,wn,$o,jr.layers[0],jr.collisionBoxArray,zi.index,zi.sourceLayerIndex,jr.index,Fa,hl,Ks,on,Qo,Is,Ss,Mn,zi,bn,ui,Fo,Qi)};if(Jo==="line")for(var Dc=0,ku=Gh(zi.geometry,0,0,8192,8192);Dc<ku.length;Dc+=1)for(var Xl=ku[Dc],Pu=0,au=Kh(Xl,As,Il,_i.vertical||Yn,Yr,24,Wo,jr.overscaling,8192);Pu<au.length;Pu+=1){var Qu=au[Pu];Yn&&$h(jr,Yn.text,Sl,Qu)||hc(Xl,Qu)}else if(Jo==="line-center")for(var Du=0,yh=zi.geometry;Du<yh.length;Du+=1){var _h=yh[Du];if(_h.length>1){var Xh=Nh(_h,Il,_i.vertical||Yn,Yr,24,Wo);Xh&&hc(_h,Xh)}}else if(zi.type==="Polygon")for(var Lu=0,Wh=Xc(zi.geometry,0);Lu<Wh.length;Lu+=1){var zu=Wh[Lu],vh=nu(zu,16);hc(zu[0],new cc(vh.x,vh.y,0))}else if(zi.type==="LineString")for(var su=0,Gs=zi.geometry;su<Gs.length;su+=1){var pc=Gs[su];hc(pc,new cc(pc[0].x,pc[0].y,0))}else if(zi.type==="Point")for(var Jh=0,Ts=zi.geometry;Jh<Ts.length;Jh+=1)for(var Wl=0,Ru=Ts[Jh];Wl<Ru.length;Wl+=1){var lu=Ru[Wl];hc([lu],new cc(lu.x,lu.y,0))}}(e,L,de,gr,p,ee,re,he,Ue,Jr,T)},w=0,k=e.features;w<k.length;w+=1)v();x&&e.generateCollisionDebugBuffers()},o.perspective=function(e,n,s,p,g){var x,T=1/Math.tan(n/2);return e[0]=T/s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=T,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,g!=null&&g!==1/0?(e[10]=(g+p)*(x=1/(p-g)),e[14]=2*g*p*x):(e[10]=-1,e[14]=-2*p),e},o.pick=function(e,n){for(var s={},p=0;p<n.length;p++){var g=n[p];g in e&&(s[g]=e[g])}return s},o.plugin=Xn,o.polygonIntersectsPolygon=ns,o.postMapLoadEvent=lo,o.postTurnstileEvent=ir,o.potpack=cl,o.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.register=fr,o.registerForPluginStateChange=function(e){return e({pluginStatus:Hi,pluginURL:Oa}),CA.on("pluginStateChange",e),e},o.renderColorRamp=Gc,o.rotate=function(e,n,s){var p=n[0],g=n[1],x=n[2],T=n[3],D=Math.sin(s),j=Math.cos(s);return e[0]=p*j+x*D,e[1]=g*j+T*D,e[2]=p*-D+x*j,e[3]=g*-D+T*j,e},o.rotateX=function(e,n,s){var p=Math.sin(s),g=Math.cos(s),x=n[4],T=n[5],D=n[6],j=n[7],ee=n[8],oe=n[9],le=n[10],ye=n[11];return n!==e&&(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[4]=x*g+ee*p,e[5]=T*g+oe*p,e[6]=D*g+le*p,e[7]=j*g+ye*p,e[8]=ee*g-x*p,e[9]=oe*g-T*p,e[10]=le*g-D*p,e[11]=ye*g-j*p,e},o.rotateZ=function(e,n,s){var p=Math.sin(s),g=Math.cos(s),x=n[0],T=n[1],D=n[2],j=n[3],ee=n[4],oe=n[5],le=n[6],ye=n[7];return n!==e&&(e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15]),e[0]=x*g+ee*p,e[1]=T*g+oe*p,e[2]=D*g+le*p,e[3]=j*g+ye*p,e[4]=ee*g-x*p,e[5]=oe*g-T*p,e[6]=le*g-D*p,e[7]=ye*g-j*p,e},o.scale=function(e,n,s){var p=s[0],g=s[1],x=s[2];return e[0]=n[0]*p,e[1]=n[1]*p,e[2]=n[2]*p,e[3]=n[3]*p,e[4]=n[4]*g,e[5]=n[5]*g,e[6]=n[6]*g,e[7]=n[7]*g,e[8]=n[8]*x,e[9]=n[9]*x,e[10]=n[10]*x,e[11]=n[11]*x,e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e},o.scale$1=function(e,n,s){return e[0]=n[0]*s,e[1]=n[1]*s,e[2]=n[2]*s,e[3]=n[3]*s,e},o.scale$2=function(e,n,s){return e[0]=n[0]*s,e[1]=n[1]*s,e[2]=n[2]*s,e},o.setCacheLimits=function(e,n){bi=e,bo=n},o.setRTLTextPlugin=function(e,n,s){if(s===void 0&&(s=!1),Hi==="deferred"||Hi==="loading"||Hi==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");Oa=cn.resolveURL(e),Hi="deferred",da=n,Kl(),s||is()},o.sphericalToCartesian=function(e){var n=e[0],s=e[1],p=e[2];return s+=90,s*=Math.PI/180,p*=Math.PI/180,{x:n*Math.cos(s)*Math.sin(p),y:n*Math.sin(s)*Math.sin(p),z:n*Math.cos(p)}},o.sqrLen=function(e){var n=e[0],s=e[1];return n*n+s*s},o.styleSpec=Ee,o.sub=function(e,n,s){return e[0]=n[0]-s[0],e[1]=n[1]-s[1],e[2]=n[2]-s[2],e},o.symbolSize=Uc,o.transformMat3=function(e,n,s){var p=n[0],g=n[1],x=n[2];return e[0]=p*s[0]+g*s[3]+x*s[6],e[1]=p*s[1]+g*s[4]+x*s[7],e[2]=p*s[2]+g*s[5]+x*s[8],e},o.transformMat4=yc,o.translate=function(e,n,s){var p,g,x,T,D,j,ee,oe,le,ye,i,t,a=s[0],h=s[1],f=s[2];return n===e?(e[12]=n[0]*a+n[4]*h+n[8]*f+n[12],e[13]=n[1]*a+n[5]*h+n[9]*f+n[13],e[14]=n[2]*a+n[6]*h+n[10]*f+n[14],e[15]=n[3]*a+n[7]*h+n[11]*f+n[15]):(g=n[1],x=n[2],T=n[3],D=n[4],j=n[5],ee=n[6],oe=n[7],le=n[8],ye=n[9],i=n[10],t=n[11],e[0]=p=n[0],e[1]=g,e[2]=x,e[3]=T,e[4]=D,e[5]=j,e[6]=ee,e[7]=oe,e[8]=le,e[9]=ye,e[10]=i,e[11]=t,e[12]=p*a+D*h+le*f+n[12],e[13]=g*a+j*h+ye*f+n[13],e[14]=x*a+ee*h+i*f+n[14],e[15]=T*a+oe*h+t*f+n[15]),e},o.triggerPluginCompletionEvent=al,o.uniqueId=It,o.validateCustomStyleLayer=function(e){var n=[],s=e.id;return s===void 0&&n.push({message:"layers."+s+': missing required property "id"'}),e.render===void 0&&n.push({message:"layers."+s+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&n.push({message:"layers."+s+': property "renderingMode" must be either "2d" or "3d"'}),n},o.validateLight=_l,o.validateStyle=yl,o.values=function(e){var n=[];for(var s in e)n.push(e[s]);return n},o.vectorTile=nc,o.version="1.13.2",o.warnOnce=rr,o.webpSupported=Vi,o.window=be,o.wrap=yt}),V(["./shared"],function(o){function q(ne){var fe=typeof ne;if(fe==="number"||fe==="boolean"||fe==="string"||ne==null)return JSON.stringify(ne);if(Array.isArray(ne)){for(var xe="[",Fe=0,Re=ne;Fe<Re.length;Fe+=1)xe+=q(Re[Fe])+",";return xe+"]"}for(var We=Object.keys(ne).sort(),st="{",Ee=0;Ee<We.length;Ee++)st+=JSON.stringify(We[Ee])+":"+q(ne[We[Ee]])+",";return st+"}"}function K(ne){for(var fe="",xe=0,Fe=o.refProperties;xe<Fe.length;xe+=1)fe+="/"+q(ne[Fe[xe]]);return fe}var ae=function(ne){this.keyCache={},ne&&this.replace(ne)};ae.prototype.replace=function(ne){this._layerConfigs={},this._layers={},this.update(ne,[])},ae.prototype.update=function(ne,fe){for(var xe=this,Fe=0,Re=ne;Fe<Re.length;Fe+=1){var We=Re[Fe];this._layerConfigs[We.id]=We;var st=this._layers[We.id]=o.createStyleLayer(We);st._featureFilter=o.featureFilter(st.filter),this.keyCache[We.id]&&delete this.keyCache[We.id]}for(var Ee=0,X=fe;Ee<X.length;Ee+=1){var H=X[Ee];delete this.keyCache[H],delete this._layerConfigs[H],delete this._layers[H]}this.familiesBySource={};for(var te=0,pe=function(Je,ct){for(var we={},Pe=0;Pe<Je.length;Pe++){var dt=ct&&ct[Je[Pe].id]||K(Je[Pe]);ct&&(ct[Je[Pe].id]=dt);var xt=we[dt];xt||(xt=we[dt]=[]),xt.push(Je[Pe])}var Lt=[];for(var zt in we)Lt.push(we[zt]);return Lt}(o.values(this._layerConfigs),this.keyCache);te<pe.length;te+=1){var se=pe[te].map(function(Je){return xe._layers[Je.id]}),Se=se[0];if(Se.visibility!=="none"){var Ne=Se.source||"",Me=this.familiesBySource[Ne];Me||(Me=this.familiesBySource[Ne]={});var ve=Se.sourceLayer||"_geojsonTileLayer",Oe=Me[ve];Oe||(Oe=Me[ve]=[]),Oe.push(se)}}};var Y=function(ne){var fe={},xe=[];for(var Fe in ne){var Re=ne[Fe],We=fe[Fe]={};for(var st in Re){var Ee=Re[+st];if(Ee&&Ee.bitmap.width!==0&&Ee.bitmap.height!==0){var X={x:0,y:0,w:Ee.bitmap.width+2,h:Ee.bitmap.height+2};xe.push(X),We[st]={rect:X,metrics:Ee.metrics}}}}var H=o.potpack(xe),te=new o.AlphaImage({width:H.w||1,height:H.h||1});for(var pe in ne){var se=ne[pe];for(var Se in se){var Ne=se[+Se];if(Ne&&Ne.bitmap.width!==0&&Ne.bitmap.height!==0){var Me=fe[pe][Se].rect;o.AlphaImage.copy(Ne.bitmap,te,{x:0,y:0},{x:Me.x+1,y:Me.y+1},Ne.bitmap)}}}this.image=te,this.positions=fe};o.register("GlyphAtlas",Y);var ie=function(ne){this.tileID=new o.OverscaledTileID(ne.tileID.overscaledZ,ne.tileID.wrap,ne.tileID.canonical.z,ne.tileID.canonical.x,ne.tileID.canonical.y),this.uid=ne.uid,this.zoom=ne.zoom,this.pixelRatio=ne.pixelRatio,this.tileSize=ne.tileSize,this.source=ne.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ne.showCollisionBoxes,this.collectResourceTiming=!!ne.collectResourceTiming,this.returnDependencies=!!ne.returnDependencies,this.promoteId=ne.promoteId};function be(ne,fe,xe){for(var Fe=new o.EvaluationParameters(fe),Re=0,We=ne;Re<We.length;Re+=1)We[Re].recalculate(Fe,xe)}function ze(ne,fe){var xe=o.getArrayBuffer(ne.request,function(Fe,Re,We,st){Fe?fe(Fe):Re&&fe(null,{vectorTile:new o.vectorTile.VectorTile(new o.pbf(Re)),rawData:Re,cacheControl:We,expires:st})});return function(){xe.cancel(),fe()}}ie.prototype.parse=function(ne,fe,xe,Fe,Re){var We=this;this.status="parsing",this.data=ne,this.collisionBoxArray=new o.CollisionBoxArray;var st=new o.DictionaryCoder(Object.keys(ne.layers).sort()),Ee=new o.FeatureIndex(this.tileID,this.promoteId);Ee.bucketLayerIDs=[];var X,H,te,pe,se={},Se={featureIndex:Ee,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:xe},Ne=fe.familiesBySource[this.source];for(var Me in Ne){var ve=ne.layers[Me];if(ve){ve.version===1&&o.warnOnce('Vector tile source "'+this.source+'" layer "'+Me+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Oe=st.encode(Me),Je=[],ct=0;ct<ve.length;ct++){var we=ve.feature(ct),Pe=Ee.getId(we,Me);Je.push({feature:we,id:Pe,index:ct,sourceLayerIndex:Oe})}for(var dt=0,xt=Ne[Me];dt<xt.length;dt+=1){var Lt=xt[dt],zt=Lt[0];zt.minzoom&&this.zoom<Math.floor(zt.minzoom)||zt.maxzoom&&this.zoom>=zt.maxzoom||zt.visibility!=="none"&&(be(Lt,this.zoom,xe),(se[zt.id]=zt.createBucket({index:Ee.bucketLayerIDs.length,layers:Lt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Oe,sourceID:this.source})).populate(Je,Se,this.tileID.canonical),Ee.bucketLayerIDs.push(Lt.map(function(vr){return vr.id})))}}}var Jt=o.mapObject(Se.glyphDependencies,function(vr){return Object.keys(vr).map(Number)});Object.keys(Jt).length?Fe.send("getGlyphs",{uid:this.uid,stacks:Jt},function(vr,Sr){X||(X=vr,H=Sr,Br.call(We))}):H={};var or=Object.keys(Se.iconDependencies);or.length?Fe.send("getImages",{icons:or,source:this.source,tileID:this.tileID,type:"icons"},function(vr,Sr){X||(X=vr,te=Sr,Br.call(We))}):te={};var Ar=Object.keys(Se.patternDependencies);function Br(){if(X)return Re(X);if(H&&te&&pe){var vr=new Y(H),Sr=new o.ImageAtlas(te,pe);for(var Tr in se){var li=se[Tr];li instanceof o.SymbolBucket?(be(li.layers,this.zoom,xe),o.performSymbolLayout(li,H,vr.positions,te,Sr.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):li.hasPattern&&(li instanceof o.LineBucket||li instanceof o.FillBucket||li instanceof o.FillExtrusionBucket)&&(be(li.layers,this.zoom,xe),li.addFeatures(Se,this.tileID.canonical,Sr.patternPositions))}this.status="done",Re(null,{buckets:o.values(se).filter(function(Co){return!Co.isEmpty()}),featureIndex:Ee,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:vr.image,imageAtlas:Sr,glyphMap:this.returnDependencies?H:null,iconMap:this.returnDependencies?te:null,glyphPositions:this.returnDependencies?vr.positions:null})}}Ar.length?Fe.send("getImages",{icons:Ar,source:this.source,tileID:this.tileID,type:"patterns"},function(vr,Sr){X||(X=vr,pe=Sr,Br.call(We))}):pe={},Br.call(this)};var it=function(ne,fe,xe,Fe){this.actor=ne,this.layerIndex=fe,this.availableImages=xe,this.loadVectorData=Fe||ze,this.loading={},this.loaded={}};it.prototype.loadTile=function(ne,fe){var xe=this,Fe=ne.uid;this.loading||(this.loading={});var Re=!!(ne&&ne.request&&ne.request.collectResourceTiming)&&new o.RequestPerformance(ne.request),We=this.loading[Fe]=new ie(ne);We.abort=this.loadVectorData(ne,function(st,Ee){if(delete xe.loading[Fe],st||!Ee)return We.status="done",xe.loaded[Fe]=We,fe(st);var X=Ee.rawData,H={};Ee.expires&&(H.expires=Ee.expires),Ee.cacheControl&&(H.cacheControl=Ee.cacheControl);var te={};if(Re){var pe=Re.finish();pe&&(te.resourceTiming=JSON.parse(JSON.stringify(pe)))}We.vectorTile=Ee.vectorTile,We.parse(Ee.vectorTile,xe.layerIndex,xe.availableImages,xe.actor,function(se,Se){if(se||!Se)return fe(se);fe(null,o.extend({rawTileData:X.slice(0)},Se,H,te))}),xe.loaded=xe.loaded||{},xe.loaded[Fe]=We})},it.prototype.reloadTile=function(ne,fe){var xe=this,Fe=this.loaded,Re=ne.uid,We=this;if(Fe&&Fe[Re]){var st=Fe[Re];st.showCollisionBoxes=ne.showCollisionBoxes;var Ee=function(X,H){var te=st.reloadCallback;te&&(delete st.reloadCallback,st.parse(st.vectorTile,We.layerIndex,xe.availableImages,We.actor,te)),fe(X,H)};st.status==="parsing"?st.reloadCallback=Ee:st.status==="done"&&(st.vectorTile?st.parse(st.vectorTile,this.layerIndex,this.availableImages,this.actor,Ee):Ee())}},it.prototype.abortTile=function(ne,fe){var xe=this.loading,Fe=ne.uid;xe&&xe[Fe]&&xe[Fe].abort&&(xe[Fe].abort(),delete xe[Fe]),fe()},it.prototype.removeTile=function(ne,fe){var xe=this.loaded,Fe=ne.uid;xe&&xe[Fe]&&delete xe[Fe],fe()};var tt=o.window.ImageBitmap,_t=function(){this.loaded={}};function yt(ne,fe){if(ne.length!==0){Bt(ne[0],fe);for(var xe=1;xe<ne.length;xe++)Bt(ne[xe],!fe)}}function Bt(ne,fe){for(var xe=0,Fe=0,Re=ne.length,We=Re-1;Fe<Re;We=Fe++)xe+=(ne[Fe][0]-ne[We][0])*(ne[We][1]+ne[Fe][1]);xe>=0!=!!fe&&ne.reverse()}_t.prototype.loadTile=function(ne,fe){var xe=ne.uid,Fe=ne.encoding,Re=ne.rawImageData,We=tt&&Re instanceof tt?this.getImageData(Re):Re,st=new o.DEMData(xe,We,Fe);this.loaded=this.loaded||{},this.loaded[xe]=st,fe(null,st)},_t.prototype.getImageData=function(ne){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ne.width,ne.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=ne.width,this.offscreenCanvas.height=ne.height,this.offscreenCanvasContext.drawImage(ne,0,0,ne.width,ne.height);var fe=this.offscreenCanvasContext.getImageData(-1,-1,ne.width+2,ne.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new o.RGBAImage({width:fe.width,height:fe.height},fe.data)},_t.prototype.removeTile=function(ne){var fe=this.loaded,xe=ne.uid;fe&&fe[xe]&&delete fe[xe]};var rt=o.vectorTile.VectorTileFeature.prototype.toGeoJSON,It=function(ne){this._feature=ne,this.extent=o.EXTENT,this.type=ne.type,this.properties=ne.tags,"id"in ne&&!isNaN(ne.id)&&(this.id=parseInt(ne.id,10))};It.prototype.loadGeometry=function(){if(this._feature.type===1){for(var ne=[],fe=0,xe=this._feature.geometry;fe<xe.length;fe+=1){var Fe=xe[fe];ne.push([new o.Point$1(Fe[0],Fe[1])])}return ne}for(var Re=[],We=0,st=this._feature.geometry;We<st.length;We+=1){for(var Ee=[],X=0,H=st[We];X<H.length;X+=1){var te=H[X];Ee.push(new o.Point$1(te[0],te[1]))}Re.push(Ee)}return Re},It.prototype.toGeoJSON=function(ne,fe,xe){return rt.call(this,ne,fe,xe)};var gt=function(ne){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.EXTENT,this.length=ne.length,this._features=ne};gt.prototype.feature=function(ne){return new It(this._features[ne])};var Zt=o.vectorTile.VectorTileFeature,dr=Xr;function Xr(ne,fe){this.options=fe||{},this.features=ne,this.length=ne.length}function ur(ne,fe){this.id=typeof ne.id=="number"?ne.id:void 0,this.type=ne.type,this.rawGeometry=ne.type===1?[ne.geometry]:ne.geometry,this.properties=ne.tags,this.extent=fe||4096}Xr.prototype.feature=function(ne){return new ur(this.features[ne],this.options.extent)},ur.prototype.loadGeometry=function(){var ne=this.rawGeometry;this.geometry=[];for(var fe=0;fe<ne.length;fe++){for(var xe=ne[fe],Fe=[],Re=0;Re<xe.length;Re++)Fe.push(new o.Point$1(xe[Re][0],xe[Re][1]));this.geometry.push(Fe)}return this.geometry},ur.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ne=this.geometry,fe=1/0,xe=-1/0,Fe=1/0,Re=-1/0,We=0;We<ne.length;We++)for(var st=ne[We],Ee=0;Ee<st.length;Ee++){var X=st[Ee];fe=Math.min(fe,X.x),xe=Math.max(xe,X.x),Fe=Math.min(Fe,X.y),Re=Math.max(Re,X.y)}return[fe,Fe,xe,Re]},ur.prototype.toGeoJSON=Zt.prototype.toGeoJSON;var _r=ei,Rr=dr;function ei(ne){var fe=new o.pbf;return function(xe,Fe){for(var Re in xe.layers)Fe.writeMessage(3,rr,xe.layers[Re])}(ne,fe),fe.finish()}function rr(ne,fe){var xe;fe.writeVarintField(15,ne.version||1),fe.writeStringField(1,ne.name||""),fe.writeVarintField(5,ne.extent||4096);var Fe={keys:[],values:[],keycache:{},valuecache:{}};for(xe=0;xe<ne.length;xe++)Fe.feature=ne.feature(xe),fe.writeMessage(2,kt,Fe);var Re=Fe.keys;for(xe=0;xe<Re.length;xe++)fe.writeStringField(3,Re[xe]);var We=Fe.values;for(xe=0;xe<We.length;xe++)fe.writeMessage(4,di,We[xe])}function kt(ne,fe){var xe=ne.feature;xe.id!==void 0&&fe.writeVarintField(1,xe.id),fe.writeMessage(2,Rt,ne),fe.writeVarintField(3,xe.type),fe.writeMessage(4,Kr,xe)}function Rt(ne,fe){var xe=ne.feature,Fe=ne.keys,Re=ne.values,We=ne.keycache,st=ne.valuecache;for(var Ee in xe.properties){var X=We[Ee];X===void 0&&(Fe.push(Ee),We[Ee]=X=Fe.length-1),fe.writeVarint(X);var H=xe.properties[Ee],te=typeof H;te!=="string"&&te!=="boolean"&&te!=="number"&&(H=JSON.stringify(H));var pe=te+":"+H,se=st[pe];se===void 0&&(Re.push(H),st[pe]=se=Re.length-1),fe.writeVarint(se)}}function br(ne,fe){return(fe<<3)+(7&ne)}function Or(ne){return ne<<1^ne>>31}function Kr(ne,fe){for(var xe=ne.loadGeometry(),Fe=ne.type,Re=0,We=0,st=xe.length,Ee=0;Ee<st;Ee++){var X=xe[Ee],H=1;Fe===1&&(H=X.length),fe.writeVarint(br(1,H));for(var te=Fe===3?X.length-1:X.length,pe=0;pe<te;pe++){pe===1&&Fe!==1&&fe.writeVarint(br(2,te-1));var se=X[pe].x-Re,Se=X[pe].y-We;fe.writeVarint(Or(se)),fe.writeVarint(Or(Se)),Re+=se,We+=Se}Fe===3&&fe.writeVarint(br(7,1))}}function di(ne,fe){var xe=typeof ne;xe==="string"?fe.writeStringField(1,ne):xe==="boolean"?fe.writeBooleanField(7,ne):xe==="number"&&(ne%1!=0?fe.writeDoubleField(3,ne):ne<0?fe.writeSVarintField(6,ne):fe.writeVarintField(5,ne))}function ri(ne,fe,xe,Fe){ii(ne,xe,Fe),ii(fe,2*xe,2*Fe),ii(fe,2*xe+1,2*Fe+1)}function ii(ne,fe,xe){var Fe=ne[fe];ne[fe]=ne[xe],ne[xe]=Fe}function ki(ne,fe,xe,Fe){var Re=ne-xe,We=fe-Fe;return Re*Re+We*We}_r.fromVectorTileJs=ei,_r.fromGeojsonVt=function(ne,fe){fe=fe||{};var xe={};for(var Fe in ne)xe[Fe]=new dr(ne[Fe].features,fe),xe[Fe].name=Fe,xe[Fe].version=fe.version,xe[Fe].extent=fe.extent;return ei({layers:xe})},_r.GeoJSONWrapper=Rr;var kn=function(ne){return ne[0]},Zi=function(ne){return ne[1]},Bn=function(ne,fe,xe,Fe,Re){fe===void 0&&(fe=kn),xe===void 0&&(xe=Zi),Fe===void 0&&(Fe=64),Re===void 0&&(Re=Float64Array),this.nodeSize=Fe,this.points=ne;for(var We=ne.length<65536?Uint16Array:Uint32Array,st=this.ids=new We(ne.length),Ee=this.coords=new Re(2*ne.length),X=0;X<ne.length;X++)st[X]=X,Ee[2*X]=fe(ne[X]),Ee[2*X+1]=xe(ne[X]);(function H(te,pe,se,Se,Ne,Me){if(!(Ne-Se<=se)){var ve=Se+Ne>>1;(function Oe(Je,ct,we,Pe,dt,xt){for(;dt>Pe;){if(dt-Pe>600){var Lt=dt-Pe+1,zt=we-Pe+1,Jt=Math.log(Lt),or=.5*Math.exp(2*Jt/3),Ar=.5*Math.sqrt(Jt*or*(Lt-or)/Lt)*(zt-Lt/2<0?-1:1);Oe(Je,ct,we,Math.max(Pe,Math.floor(we-zt*or/Lt+Ar)),Math.min(dt,Math.floor(we+(Lt-zt)*or/Lt+Ar)),xt)}var Br=ct[2*we+xt],vr=Pe,Sr=dt;for(ri(Je,ct,Pe,we),ct[2*dt+xt]>Br&&ri(Je,ct,Pe,dt);vr<Sr;){for(ri(Je,ct,vr,Sr),vr++,Sr--;ct[2*vr+xt]<Br;)vr++;for(;ct[2*Sr+xt]>Br;)Sr--}ct[2*Pe+xt]===Br?ri(Je,ct,Pe,Sr):ri(Je,ct,++Sr,dt),Sr<=we&&(Pe=Sr+1),we<=Sr&&(dt=Sr-1)}})(te,pe,ve,Se,Ne,Me%2),H(te,pe,se,Se,ve-1,Me+1),H(te,pe,se,ve+1,Ne,Me+1)}})(st,Ee,Fe,0,st.length-1,0)};Bn.prototype.range=function(ne,fe,xe,Fe){return function(Re,We,st,Ee,X,H,te){for(var pe,se,Se=[0,Re.length-1,0],Ne=[];Se.length;){var Me=Se.pop(),ve=Se.pop(),Oe=Se.pop();if(ve-Oe<=te)for(var Je=Oe;Je<=ve;Je++)se=We[2*Je+1],(pe=We[2*Je])>=st&&pe<=X&&se>=Ee&&se<=H&&Ne.push(Re[Je]);else{var ct=Math.floor((Oe+ve)/2);se=We[2*ct+1],(pe=We[2*ct])>=st&&pe<=X&&se>=Ee&&se<=H&&Ne.push(Re[ct]);var we=(Me+1)%2;(Me===0?st<=pe:Ee<=se)&&(Se.push(Oe),Se.push(ct-1),Se.push(we)),(Me===0?X>=pe:H>=se)&&(Se.push(ct+1),Se.push(ve),Se.push(we))}}return Ne}(this.ids,this.coords,ne,fe,xe,Fe,this.nodeSize)},Bn.prototype.within=function(ne,fe,xe){return function(Fe,Re,We,st,Ee,X){for(var H=[0,Fe.length-1,0],te=[],pe=Ee*Ee;H.length;){var se=H.pop(),Se=H.pop(),Ne=H.pop();if(Se-Ne<=X)for(var Me=Ne;Me<=Se;Me++)ki(Re[2*Me],Re[2*Me+1],We,st)<=pe&&te.push(Fe[Me]);else{var ve=Math.floor((Ne+Se)/2),Oe=Re[2*ve],Je=Re[2*ve+1];ki(Oe,Je,We,st)<=pe&&te.push(Fe[ve]);var ct=(se+1)%2;(se===0?We-Ee<=Oe:st-Ee<=Je)&&(H.push(Ne),H.push(ve-1),H.push(ct)),(se===0?We+Ee>=Oe:st+Ee>=Je)&&(H.push(ve+1),H.push(Se),H.push(ct))}}return te}(this.ids,this.coords,ne,fe,xe,this.nodeSize)};var la={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(ne){return ne}},Xi=function(ne){this.options=Pn(Object.create(la),ne),this.trees=new Array(this.options.maxZoom+1)};function cn(ne,fe,xe,Fe,Re){return{x:ne,y:fe,zoom:1/0,id:xe,parentId:-1,numPoints:Fe,properties:Re}}function wi(ne,fe){var xe=ne.geometry.coordinates,Fe=xe[1];return{x:Wi(xe[0]),y:ni(Fe),zoom:1/0,index:fe,parentId:-1}}function Vi(ne){return{type:"Feature",id:ne.id,properties:Ln(ne),geometry:{type:"Point",coordinates:[(Fe=ne.x,360*(Fe-.5)),(fe=ne.y,xe=(180-360*fe)*Math.PI/180,360*Math.atan(Math.exp(xe))/Math.PI-90)]}};var fe,xe,Fe}function Ln(ne){var fe=ne.numPoints,xe=fe>=1e4?Math.round(fe/1e3)+"k":fe>=1e3?Math.round(fe/100)/10+"k":fe;return Pn(Pn({},ne.properties),{cluster:!0,cluster_id:ne.id,point_count:fe,point_count_abbreviated:xe})}function Wi(ne){return ne/360+.5}function ni(ne){var fe=Math.sin(ne*Math.PI/180),xe=.5-.25*Math.log((1+fe)/(1-fe))/Math.PI;return xe<0?0:xe>1?1:xe}function Pn(ne,fe){for(var xe in fe)ne[xe]=fe[xe];return ne}function an(ne){return ne.x}function qn(ne){return ne.y}function un(ne,fe,xe,Fe,Re,We){var st=Re-xe,Ee=We-Fe;if(st!==0||Ee!==0){var X=((ne-xe)*st+(fe-Fe)*Ee)/(st*st+Ee*Ee);X>1?(xe=Re,Fe=We):X>0&&(xe+=st*X,Fe+=Ee*X)}return(st=ne-xe)*st+(Ee=fe-Fe)*Ee}function Wr(ne,fe,xe,Fe){var Re={id:ne===void 0?null:ne,type:fe,geometry:xe,tags:Fe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(We){var st=We.geometry,Ee=We.type;if(Ee==="Point"||Ee==="MultiPoint"||Ee==="LineString")Nn(We,st);else if(Ee==="Polygon"||Ee==="MultiLineString")for(var X=0;X<st.length;X++)Nn(We,st[X]);else if(Ee==="MultiPolygon")for(X=0;X<st.length;X++)for(var H=0;H<st[X].length;H++)Nn(We,st[X][H])}(Re),Re}function Nn(ne,fe){for(var xe=0;xe<fe.length;xe+=3)ne.minX=Math.min(ne.minX,fe[xe]),ne.minY=Math.min(ne.minY,fe[xe+1]),ne.maxX=Math.max(ne.maxX,fe[xe]),ne.maxY=Math.max(ne.maxY,fe[xe+1])}function Ri(ne,fe,xe,Fe){if(fe.geometry){var Re=fe.geometry.coordinates,We=fe.geometry.type,st=Math.pow(xe.tolerance/((1<<xe.maxZoom)*xe.extent),2),Ee=[],X=fe.id;if(xe.promoteId?X=fe.properties[xe.promoteId]:xe.generateId&&(X=Fe||0),We==="Point")Hr(Re,Ee);else if(We==="MultiPoint")for(var H=0;H<Re.length;H++)Hr(Re[H],Ee);else if(We==="LineString")Ji(Re,Ee,st,!1);else if(We==="MultiLineString"){if(xe.lineMetrics){for(H=0;H<Re.length;H++)Ji(Re[H],Ee=[],st,!1),ne.push(Wr(X,"LineString",Ee,fe.properties));return}Cn(Re,Ee,st,!1)}else if(We==="Polygon")Cn(Re,Ee,st,!0);else{if(We!=="MultiPolygon"){if(We==="GeometryCollection"){for(H=0;H<fe.geometry.geometries.length;H++)Ri(ne,{id:X,geometry:fe.geometry.geometries[H],properties:fe.properties},xe,Fe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(H=0;H<Re.length;H++){var te=[];Cn(Re[H],te,st,!0),Ee.push(te)}}ne.push(Wr(X,We,Ee,fe.properties))}}function Hr(ne,fe){fe.push($i(ne[0])),fe.push(yn(ne[1])),fe.push(0)}function Ji(ne,fe,xe,Fe){for(var Re,We,st=0,Ee=0;Ee<ne.length;Ee++){var X=$i(ne[Ee][0]),H=yn(ne[Ee][1]);fe.push(X),fe.push(H),fe.push(0),Ee>0&&(st+=Fe?(Re*H-X*We)/2:Math.sqrt(Math.pow(X-Re,2)+Math.pow(H-We,2))),Re=X,We=H}var te=fe.length-3;fe[2]=1,function pe(se,Se,Ne,Me){for(var ve,Oe=Me,Je=Ne-Se>>1,ct=Ne-Se,we=se[Se],Pe=se[Se+1],dt=se[Ne],xt=se[Ne+1],Lt=Se+3;Lt<Ne;Lt+=3){var zt=un(se[Lt],se[Lt+1],we,Pe,dt,xt);if(zt>Oe)ve=Lt,Oe=zt;else if(zt===Oe){var Jt=Math.abs(Lt-Je);Jt<ct&&(ve=Lt,ct=Jt)}}Oe>Me&&(ve-Se>3&&pe(se,Se,ve,Me),se[ve+2]=Oe,Ne-ve>3&&pe(se,ve,Ne,Me))}(fe,0,te,xe),fe[te+2]=1,fe.size=Math.abs(st),fe.start=0,fe.end=fe.size}function Cn(ne,fe,xe,Fe){for(var Re=0;Re<ne.length;Re++){var We=[];Ji(ne[Re],We,xe,Fe),fe.push(We)}}function $i(ne){return ne/360+.5}function yn(ne){var fe=Math.sin(ne*Math.PI/180),xe=.5-.25*Math.log((1+fe)/(1-fe))/Math.PI;return xe<0?0:xe>1?1:xe}function En(ne,fe,xe,Fe,Re,We,st,Ee){if(Fe/=fe,We>=(xe/=fe)&&st<Fe)return ne;if(st<xe||We>=Fe)return null;for(var X=[],H=0;H<ne.length;H++){var te=ne[H],pe=te.geometry,se=te.type,Se=Re===0?te.minX:te.minY,Ne=Re===0?te.maxX:te.maxY;if(Se>=xe&&Ne<Fe)X.push(te);else if(!(Ne<xe||Se>=Fe)){var Me=[];if(se==="Point"||se==="MultiPoint")Ut(pe,Me,xe,Fe,Re);else if(se==="LineString")ir(pe,Me,xe,Fe,Re,!1,Ee.lineMetrics);else if(se==="MultiLineString")lo(pe,Me,xe,Fe,Re,!1);else if(se==="Polygon")lo(pe,Me,xe,Fe,Re,!0);else if(se==="MultiPolygon")for(var ve=0;ve<pe.length;ve++){var Oe=[];lo(pe[ve],Oe,xe,Fe,Re,!0),Oe.length&&Me.push(Oe)}if(Me.length){if(Ee.lineMetrics&&se==="LineString"){for(ve=0;ve<Me.length;ve++)X.push(Wr(te.id,se,Me[ve],te.tags));continue}se!=="LineString"&&se!=="MultiLineString"||(Me.length===1?(se="LineString",Me=Me[0]):se="MultiLineString"),se!=="Point"&&se!=="MultiPoint"||(se=Me.length===3?"Point":"MultiPoint"),X.push(Wr(te.id,se,Me,te.tags))}}}return X.length?X:null}function Ut(ne,fe,xe,Fe,Re){for(var We=0;We<ne.length;We+=3){var st=ne[We+Re];st>=xe&&st<=Fe&&(fe.push(ne[We]),fe.push(ne[We+1]),fe.push(ne[We+2]))}}function ir(ne,fe,xe,Fe,Re,We,st){for(var Ee,X,H=Ma(ne),te=Re===0?bo:ro,pe=ne.start,se=0;se<ne.length-3;se+=3){var Se=ne[se],Ne=ne[se+1],Me=ne[se+2],ve=ne[se+3],Oe=ne[se+4],Je=Re===0?Se:Ne,ct=Re===0?ve:Oe,we=!1;st&&(Ee=Math.sqrt(Math.pow(Se-ve,2)+Math.pow(Ne-Oe,2))),Je<xe?ct>xe&&(X=te(H,Se,Ne,ve,Oe,xe),st&&(H.start=pe+Ee*X)):Je>Fe?ct<Fe&&(X=te(H,Se,Ne,ve,Oe,Fe),st&&(H.start=pe+Ee*X)):bi(H,Se,Ne,Me),ct<xe&&Je>=xe&&(X=te(H,Se,Ne,ve,Oe,xe),we=!0),ct>Fe&&Je<=Fe&&(X=te(H,Se,Ne,ve,Oe,Fe),we=!0),!We&&we&&(st&&(H.end=pe+Ee*X),fe.push(H),H=Ma(ne)),st&&(pe+=Ee)}var Pe=ne.length-3;Se=ne[Pe],Ne=ne[Pe+1],Me=ne[Pe+2],(Je=Re===0?Se:Ne)>=xe&&Je<=Fe&&bi(H,Se,Ne,Me),Pe=H.length-3,We&&Pe>=3&&(H[Pe]!==H[0]||H[Pe+1]!==H[1])&&bi(H,H[0],H[1],H[2]),H.length&&fe.push(H)}function Ma(ne){var fe=[];return fe.size=ne.size,fe.start=ne.start,fe.end=ne.end,fe}function lo(ne,fe,xe,Fe,Re,We){for(var st=0;st<ne.length;st++)ir(ne[st],fe,xe,Fe,Re,We,!1)}function bi(ne,fe,xe,Fe){ne.push(fe),ne.push(xe),ne.push(Fe)}function bo(ne,fe,xe,Fe,Re,We){var st=(We-fe)/(Fe-fe);return ne.push(We),ne.push(xe+(Re-xe)*st),ne.push(1),st}function ro(ne,fe,xe,Fe,Re,We){var st=(We-xe)/(Re-xe);return ne.push(fe+(Fe-fe)*st),ne.push(We),ne.push(1),st}function Ao(ne,fe){for(var xe=[],Fe=0;Fe<ne.length;Fe++){var Re,We=ne[Fe],st=We.type;if(st==="Point"||st==="MultiPoint"||st==="LineString")Re=Bo(We.geometry,fe);else if(st==="MultiLineString"||st==="Polygon"){Re=[];for(var Ee=0;Ee<We.geometry.length;Ee++)Re.push(Bo(We.geometry[Ee],fe))}else if(st==="MultiPolygon")for(Re=[],Ee=0;Ee<We.geometry.length;Ee++){for(var X=[],H=0;H<We.geometry[Ee].length;H++)X.push(Bo(We.geometry[Ee][H],fe));Re.push(X)}xe.push(Wr(We.id,st,Re,We.tags))}return xe}function Bo(ne,fe){var xe=[];xe.size=ne.size,ne.start!==void 0&&(xe.start=ne.start,xe.end=ne.end);for(var Fe=0;Fe<ne.length;Fe+=3)xe.push(ne[Fe]+fe,ne[Fe+1],ne[Fe+2]);return xe}function er(ne,fe){if(ne.transformed)return ne;var xe,Fe,Re,We=1<<ne.z,st=ne.x,Ee=ne.y;for(xe=0;xe<ne.features.length;xe++){var X=ne.features[xe],H=X.geometry,te=X.type;if(X.geometry=[],te===1)for(Fe=0;Fe<H.length;Fe+=2)X.geometry.push(Vr(H[Fe],H[Fe+1],fe,We,st,Ee));else for(Fe=0;Fe<H.length;Fe++){var pe=[];for(Re=0;Re<H[Fe].length;Re+=2)pe.push(Vr(H[Fe][Re],H[Fe][Re+1],fe,We,st,Ee));X.geometry.push(pe)}}return ne.transformed=!0,ne}function Vr(ne,fe,xe,Fe,Re,We){return[Math.round(xe*(ne*Fe-Re)),Math.round(xe*(fe*Fe-We))]}function Nr(ne,fe,xe,Fe,Re){for(var We=fe===Re.maxZoom?0:Re.tolerance/((1<<fe)*Re.extent),st={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:xe,y:Fe,z:fe,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ee=0;Ee<ne.length;Ee++){st.numFeatures++,_n(st,ne[Ee],We,Re);var X=ne[Ee].minX,H=ne[Ee].minY,te=ne[Ee].maxX,pe=ne[Ee].maxY;X<st.minX&&(st.minX=X),H<st.minY&&(st.minY=H),te>st.maxX&&(st.maxX=te),pe>st.maxY&&(st.maxY=pe)}return st}function _n(ne,fe,xe,Fe){var Re=fe.geometry,We=fe.type,st=[];if(We==="Point"||We==="MultiPoint")for(var Ee=0;Ee<Re.length;Ee+=3)st.push(Re[Ee]),st.push(Re[Ee+1]),ne.numPoints++,ne.numSimplified++;else if(We==="LineString")Qn(st,Re,ne,xe,!1,!1);else if(We==="MultiLineString"||We==="Polygon")for(Ee=0;Ee<Re.length;Ee++)Qn(st,Re[Ee],ne,xe,We==="Polygon",Ee===0);else if(We==="MultiPolygon")for(var X=0;X<Re.length;X++){var H=Re[X];for(Ee=0;Ee<H.length;Ee++)Qn(st,H[Ee],ne,xe,!0,Ee===0)}if(st.length){var te=fe.tags||null;if(We==="LineString"&&Fe.lineMetrics){for(var pe in te={},fe.tags)te[pe]=fe.tags[pe];te.mapbox_clip_start=Re.start/Re.size,te.mapbox_clip_end=Re.end/Re.size}var se={geometry:st,type:We==="Polygon"||We==="MultiPolygon"?3:We==="LineString"||We==="MultiLineString"?2:1,tags:te};fe.id!==null&&(se.id=fe.id),ne.features.push(se)}}function Qn(ne,fe,xe,Fe,Re,We){var st=Fe*Fe;if(Fe>0&&fe.size<(Re?st:Fe))xe.numPoints+=fe.length/3;else{for(var Ee=[],X=0;X<fe.length;X+=3)(Fe===0||fe[X+2]>st)&&(xe.numSimplified++,Ee.push(fe[X]),Ee.push(fe[X+1])),xe.numPoints++;Re&&function(H,te){for(var pe=0,se=0,Se=H.length,Ne=Se-2;se<Se;Ne=se,se+=2)pe+=(H[se]-H[Ne])*(H[se+1]+H[Ne+1]);if(pe>0===te)for(se=0,Se=H.length;se<Se/2;se+=2){var Me=H[se],ve=H[se+1];H[se]=H[Se-2-se],H[se+1]=H[Se-1-se],H[Se-2-se]=Me,H[Se-1-se]=ve}}(Ee,We),ne.push(Ee)}}function Gr(ne,fe){var xe=(fe=this.options=function(Re,We){for(var st in We)Re[st]=We[st];return Re}(Object.create(this.options),fe)).debug;if(xe&&console.time("preprocess data"),fe.maxZoom<0||fe.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(fe.promoteId&&fe.generateId)throw new Error("promoteId and generateId cannot be used together.");var Fe=function(Re,We){var st=[];if(Re.type==="FeatureCollection")for(var Ee=0;Ee<Re.features.length;Ee++)Ri(st,Re.features[Ee],We,Ee);else Ri(st,Re.type==="Feature"?Re:{geometry:Re},We);return st}(ne,fe);this.tiles={},this.tileCoords=[],xe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",fe.indexMaxZoom,fe.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Fe=function(Re,We){var st=We.buffer/We.extent,Ee=Re,X=En(Re,1,-1-st,st,0,-1,2,We),H=En(Re,1,1-st,2+st,0,-1,2,We);return(X||H)&&(Ee=En(Re,1,-st,1+st,0,-1,2,We)||[],X&&(Ee=Ao(X,1).concat(Ee)),H&&(Ee=Ee.concat(Ao(H,-1)))),Ee}(Fe,fe)).length&&this.splitTile(Fe,0,0,0),xe&&(Fe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function mo(ne,fe,xe){return 32*((1<<ne)*xe+fe)+ne}function In(ne,fe){var xe=ne.tileID.canonical;if(!this._geoJSONIndex)return fe(null,null);var Fe=this._geoJSONIndex.getTile(xe.z,xe.x,xe.y);if(!Fe)return fe(null,null);var Re=new gt(Fe.features),We=_r(Re);We.byteOffset===0&&We.byteLength===We.buffer.byteLength||(We=new Uint8Array(We)),fe(null,{vectorTile:Re,rawData:We.buffer})}Xi.prototype.load=function(ne){var fe=this.options,xe=fe.log,Fe=fe.minZoom,Re=fe.maxZoom,We=fe.nodeSize;xe&&console.time("total time");var st="prepare "+ne.length+" points";xe&&console.time(st),this.points=ne;for(var Ee=[],X=0;X<ne.length;X++)ne[X].geometry&&Ee.push(wi(ne[X],X));this.trees[Re+1]=new Bn(Ee,an,qn,We,Float32Array),xe&&console.timeEnd(st);for(var H=Re;H>=Fe;H--){var te=+Date.now();Ee=this._cluster(Ee,H),this.trees[H]=new Bn(Ee,an,qn,We,Float32Array),xe&&console.log("z%d: %d clusters in %dms",H,Ee.length,+Date.now()-te)}return xe&&console.timeEnd("total time"),this},Xi.prototype.getClusters=function(ne,fe){var xe=((ne[0]+180)%360+360)%360-180,Fe=Math.max(-90,Math.min(90,ne[1])),Re=ne[2]===180?180:((ne[2]+180)%360+360)%360-180,We=Math.max(-90,Math.min(90,ne[3]));if(ne[2]-ne[0]>=360)xe=-180,Re=180;else if(xe>Re){var st=this.getClusters([xe,Fe,180,We],fe),Ee=this.getClusters([-180,Fe,Re,We],fe);return st.concat(Ee)}for(var X=this.trees[this._limitZoom(fe)],H=[],te=0,pe=X.range(Wi(xe),ni(We),Wi(Re),ni(Fe));te<pe.length;te+=1){var se=X.points[pe[te]];H.push(se.numPoints?Vi(se):this.points[se.index])}return H},Xi.prototype.getChildren=function(ne){var fe=this._getOriginId(ne),xe=this._getOriginZoom(ne),Fe="No cluster with the specified id.",Re=this.trees[xe];if(!Re)throw new Error(Fe);var We=Re.points[fe];if(!We)throw new Error(Fe);for(var st=this.options.radius/(this.options.extent*Math.pow(2,xe-1)),Ee=[],X=0,H=Re.within(We.x,We.y,st);X<H.length;X+=1){var te=Re.points[H[X]];te.parentId===ne&&Ee.push(te.numPoints?Vi(te):this.points[te.index])}if(Ee.length===0)throw new Error(Fe);return Ee},Xi.prototype.getLeaves=function(ne,fe,xe){var Fe=[];return this._appendLeaves(Fe,ne,fe=fe||10,xe=xe||0,0),Fe},Xi.prototype.getTile=function(ne,fe,xe){var Fe=this.trees[this._limitZoom(ne)],Re=Math.pow(2,ne),We=this.options,st=We.radius/We.extent,Ee=(xe-st)/Re,X=(xe+1+st)/Re,H={features:[]};return this._addTileFeatures(Fe.range((fe-st)/Re,Ee,(fe+1+st)/Re,X),Fe.points,fe,xe,Re,H),fe===0&&this._addTileFeatures(Fe.range(1-st/Re,Ee,1,X),Fe.points,Re,xe,Re,H),fe===Re-1&&this._addTileFeatures(Fe.range(0,Ee,st/Re,X),Fe.points,-1,xe,Re,H),H.features.length?H:null},Xi.prototype.getClusterExpansionZoom=function(ne){for(var fe=this._getOriginZoom(ne)-1;fe<=this.options.maxZoom;){var xe=this.getChildren(ne);if(fe++,xe.length!==1)break;ne=xe[0].properties.cluster_id}return fe},Xi.prototype._appendLeaves=function(ne,fe,xe,Fe,Re){for(var We=0,st=this.getChildren(fe);We<st.length;We+=1){var Ee=st[We],X=Ee.properties;if(X&&X.cluster?Re+X.point_count<=Fe?Re+=X.point_count:Re=this._appendLeaves(ne,X.cluster_id,xe,Fe,Re):Re<Fe?Re++:ne.push(Ee),ne.length===xe)break}return Re},Xi.prototype._addTileFeatures=function(ne,fe,xe,Fe,Re,We){for(var st=0,Ee=ne;st<Ee.length;st+=1){var X=fe[Ee[st]],H=X.numPoints,te={type:1,geometry:[[Math.round(this.options.extent*(X.x*Re-xe)),Math.round(this.options.extent*(X.y*Re-Fe))]],tags:H?Ln(X):this.points[X.index].properties},pe=void 0;H?pe=X.id:this.options.generateId?pe=X.index:this.points[X.index].id&&(pe=this.points[X.index].id),pe!==void 0&&(te.id=pe),We.features.push(te)}},Xi.prototype._limitZoom=function(ne){return Math.max(this.options.minZoom,Math.min(+ne,this.options.maxZoom+1))},Xi.prototype._cluster=function(ne,fe){for(var xe=[],Fe=this.options,Re=Fe.reduce,We=Fe.minPoints,st=Fe.radius/(Fe.extent*Math.pow(2,fe)),Ee=0;Ee<ne.length;Ee++){var X=ne[Ee];if(!(X.zoom<=fe)){X.zoom=fe;for(var H=this.trees[fe+1],te=H.within(X.x,X.y,st),pe=X.numPoints||1,se=pe,Se=0,Ne=te;Se<Ne.length;Se+=1){var Me=H.points[Ne[Se]];Me.zoom>fe&&(se+=Me.numPoints||1)}if(se>=We){for(var ve=X.x*pe,Oe=X.y*pe,Je=Re&&pe>1?this._map(X,!0):null,ct=(Ee<<5)+(fe+1)+this.points.length,we=0,Pe=te;we<Pe.length;we+=1){var dt=H.points[Pe[we]];if(!(dt.zoom<=fe)){dt.zoom=fe;var xt=dt.numPoints||1;ve+=dt.x*xt,Oe+=dt.y*xt,dt.parentId=ct,Re&&(Je||(Je=this._map(X,!0)),Re(Je,this._map(dt)))}}X.parentId=ct,xe.push(cn(ve/se,Oe/se,ct,se,Je))}else if(xe.push(X),se>1)for(var Lt=0,zt=te;Lt<zt.length;Lt+=1){var Jt=H.points[zt[Lt]];Jt.zoom<=fe||(Jt.zoom=fe,xe.push(Jt))}}}return xe},Xi.prototype._getOriginId=function(ne){return ne-this.points.length>>5},Xi.prototype._getOriginZoom=function(ne){return(ne-this.points.length)%32},Xi.prototype._map=function(ne,fe){if(ne.numPoints)return fe?Pn({},ne.properties):ne.properties;var xe=this.points[ne.index].properties,Fe=this.options.map(xe);return fe&&Fe===xe?Pn({},Fe):Fe},Gr.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Gr.prototype.splitTile=function(ne,fe,xe,Fe,Re,We,st){for(var Ee=[ne,fe,xe,Fe],X=this.options,H=X.debug;Ee.length;){Fe=Ee.pop(),xe=Ee.pop(),fe=Ee.pop(),ne=Ee.pop();var te=1<<fe,pe=mo(fe,xe,Fe),se=this.tiles[pe];if(!se&&(H>1&&console.time("creation"),se=this.tiles[pe]=Nr(ne,fe,xe,Fe,X),this.tileCoords.push({z:fe,x:xe,y:Fe}),H)){H>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",fe,xe,Fe,se.numFeatures,se.numPoints,se.numSimplified),console.timeEnd("creation"));var Se="z"+fe;this.stats[Se]=(this.stats[Se]||0)+1,this.total++}if(se.source=ne,Re){if(fe===X.maxZoom||fe===Re)continue;var Ne=1<<Re-fe;if(xe!==Math.floor(We/Ne)||Fe!==Math.floor(st/Ne))continue}else if(fe===X.indexMaxZoom||se.numPoints<=X.indexMaxPoints)continue;if(se.source=null,ne.length!==0){H>1&&console.time("clipping");var Me,ve,Oe,Je,ct,we,Pe=.5*X.buffer/X.extent,dt=.5-Pe,xt=.5+Pe,Lt=1+Pe;Me=ve=Oe=Je=null,ct=En(ne,te,xe-Pe,xe+xt,0,se.minX,se.maxX,X),we=En(ne,te,xe+dt,xe+Lt,0,se.minX,se.maxX,X),ne=null,ct&&(Me=En(ct,te,Fe-Pe,Fe+xt,1,se.minY,se.maxY,X),ve=En(ct,te,Fe+dt,Fe+Lt,1,se.minY,se.maxY,X),ct=null),we&&(Oe=En(we,te,Fe-Pe,Fe+xt,1,se.minY,se.maxY,X),Je=En(we,te,Fe+dt,Fe+Lt,1,se.minY,se.maxY,X),we=null),H>1&&console.timeEnd("clipping"),Ee.push(Me||[],fe+1,2*xe,2*Fe),Ee.push(ve||[],fe+1,2*xe,2*Fe+1),Ee.push(Oe||[],fe+1,2*xe+1,2*Fe),Ee.push(Je||[],fe+1,2*xe+1,2*Fe+1)}}},Gr.prototype.getTile=function(ne,fe,xe){var Fe=this.options,Re=Fe.extent,We=Fe.debug;if(ne<0||ne>24)return null;var st=1<<ne,Ee=mo(ne,fe=(fe%st+st)%st,xe);if(this.tiles[Ee])return er(this.tiles[Ee],Re);We>1&&console.log("drilling down to z%d-%d-%d",ne,fe,xe);for(var X,H=ne,te=fe,pe=xe;!X&&H>0;)H--,te=Math.floor(te/2),pe=Math.floor(pe/2),X=this.tiles[mo(H,te,pe)];return X&&X.source?(We>1&&console.log("found parent tile z%d-%d-%d",H,te,pe),We>1&&console.time("drilling down"),this.splitTile(X.source,H,te,pe,ne,fe,xe),We>1&&console.timeEnd("drilling down"),this.tiles[Ee]?er(this.tiles[Ee],Re):null):null};var ka=function(ne){function fe(xe,Fe,Re,We){ne.call(this,xe,Fe,Re,In),We&&(this.loadGeoJSON=We)}return ne&&(fe.__proto__=ne),(fe.prototype=Object.create(ne&&ne.prototype)).constructor=fe,fe.prototype.loadData=function(xe,Fe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=Fe,this._pendingLoadDataParams=xe,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},fe.prototype._loadData=function(){var xe=this;if(this._pendingCallback&&this._pendingLoadDataParams){var Fe=this._pendingCallback,Re=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var We=!!(Re&&Re.request&&Re.request.collectResourceTiming)&&new o.RequestPerformance(Re.request);this.loadGeoJSON(Re,function(st,Ee){if(st||!Ee)return Fe(st);if(typeof Ee!="object")return Fe(new Error("Input data given to '"+Re.source+"' is not a valid GeoJSON object."));(function se(Se,Ne){var Me,ve=Se&&Se.type;if(ve==="FeatureCollection")for(Me=0;Me<Se.features.length;Me++)se(Se.features[Me],Ne);else if(ve==="GeometryCollection")for(Me=0;Me<Se.geometries.length;Me++)se(Se.geometries[Me],Ne);else if(ve==="Feature")se(Se.geometry,Ne);else if(ve==="Polygon")yt(Se.coordinates,Ne);else if(ve==="MultiPolygon")for(Me=0;Me<Se.coordinates.length;Me++)yt(Se.coordinates[Me],Ne);return Se})(Ee,!0);try{if(Re.filter){var X=o.createExpression(Re.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(X.result==="error")throw new Error(X.value.map(function(se){return se.key+": "+se.message}).join(", "));var H=Ee.features.filter(function(se){return X.value.evaluate({zoom:0},se)});Ee={type:"FeatureCollection",features:H}}xe._geoJSONIndex=Re.cluster?new Xi(function(se){var Se=se.superclusterOptions,Ne=se.clusterProperties;if(!Ne||!Se)return Se;for(var Me={},ve={},Oe={accumulated:null,zoom:0},Je={properties:null},ct=Object.keys(Ne),we=0,Pe=ct;we<Pe.length;we+=1){var dt=Pe[we],xt=Ne[dt],Lt=xt[0],zt=o.createExpression(xt[1]),Jt=o.createExpression(typeof Lt=="string"?[Lt,["accumulated"],["get",dt]]:Lt);Me[dt]=zt.value,ve[dt]=Jt.value}return Se.map=function(or){Je.properties=or;for(var Ar={},Br=0,vr=ct;Br<vr.length;Br+=1){var Sr=vr[Br];Ar[Sr]=Me[Sr].evaluate(Oe,Je)}return Ar},Se.reduce=function(or,Ar){Je.properties=Ar;for(var Br=0,vr=ct;Br<vr.length;Br+=1){var Sr=vr[Br];Oe.accumulated=or[Sr],or[Sr]=ve[Sr].evaluate(Oe,Je)}},Se}(Re)).load(Ee.features):function(se,Se){return new Gr(se,Se)}(Ee,Re.geojsonVtOptions)}catch(se){return Fe(se)}xe.loaded={};var te={};if(We){var pe=We.finish();pe&&(te.resourceTiming={},te.resourceTiming[Re.source]=JSON.parse(JSON.stringify(pe)))}Fe(null,te)})}},fe.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},fe.prototype.reloadTile=function(xe,Fe){var Re=this.loaded;return Re&&Re[xe.uid]?ne.prototype.reloadTile.call(this,xe,Fe):this.loadTile(xe,Fe)},fe.prototype.loadGeoJSON=function(xe,Fe){if(xe.request)o.getJSON(xe.request,Fe);else{if(typeof xe.data!="string")return Fe(new Error("Input data given to '"+xe.source+"' is not a valid GeoJSON object."));try{return Fe(null,JSON.parse(xe.data))}catch{return Fe(new Error("Input data given to '"+xe.source+"' is not a valid GeoJSON object."))}}},fe.prototype.removeSource=function(xe,Fe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),Fe()},fe.prototype.getClusterExpansionZoom=function(xe,Fe){try{Fe(null,this._geoJSONIndex.getClusterExpansionZoom(xe.clusterId))}catch(Re){Fe(Re)}},fe.prototype.getClusterChildren=function(xe,Fe){try{Fe(null,this._geoJSONIndex.getChildren(xe.clusterId))}catch(Re){Fe(Re)}},fe.prototype.getClusterLeaves=function(xe,Fe){try{Fe(null,this._geoJSONIndex.getLeaves(xe.clusterId,xe.limit,xe.offset))}catch(Re){Fe(Re)}},fe}(it),mi=function(ne){var fe=this;this.self=ne,this.actor=new o.Actor(ne,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:it,geojson:ka},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(xe,Fe){if(fe.workerSourceTypes[xe])throw new Error('Worker source with name "'+xe+'" already registered.');fe.workerSourceTypes[xe]=Fe},this.self.registerRTLTextPlugin=function(xe){if(o.plugin.isParsed())throw new Error("RTL text plugin already registered.");o.plugin.applyArabicShaping=xe.applyArabicShaping,o.plugin.processBidirectionalText=xe.processBidirectionalText,o.plugin.processStyledBidirectionalText=xe.processStyledBidirectionalText}};return mi.prototype.setReferrer=function(ne,fe){this.referrer=fe},mi.prototype.setImages=function(ne,fe,xe){for(var Fe in this.availableImages[ne]=fe,this.workerSources[ne]){var Re=this.workerSources[ne][Fe];for(var We in Re)Re[We].availableImages=fe}xe()},mi.prototype.setLayers=function(ne,fe,xe){this.getLayerIndex(ne).replace(fe),xe()},mi.prototype.updateLayers=function(ne,fe,xe){this.getLayerIndex(ne).update(fe.layers,fe.removedIds),xe()},mi.prototype.loadTile=function(ne,fe,xe){this.getWorkerSource(ne,fe.type,fe.source).loadTile(fe,xe)},mi.prototype.loadDEMTile=function(ne,fe,xe){this.getDEMWorkerSource(ne,fe.source).loadTile(fe,xe)},mi.prototype.reloadTile=function(ne,fe,xe){this.getWorkerSource(ne,fe.type,fe.source).reloadTile(fe,xe)},mi.prototype.abortTile=function(ne,fe,xe){this.getWorkerSource(ne,fe.type,fe.source).abortTile(fe,xe)},mi.prototype.removeTile=function(ne,fe,xe){this.getWorkerSource(ne,fe.type,fe.source).removeTile(fe,xe)},mi.prototype.removeDEMTile=function(ne,fe){this.getDEMWorkerSource(ne,fe.source).removeTile(fe)},mi.prototype.removeSource=function(ne,fe,xe){if(this.workerSources[ne]&&this.workerSources[ne][fe.type]&&this.workerSources[ne][fe.type][fe.source]){var Fe=this.workerSources[ne][fe.type][fe.source];delete this.workerSources[ne][fe.type][fe.source],Fe.removeSource!==void 0?Fe.removeSource(fe,xe):xe()}},mi.prototype.loadWorkerSource=function(ne,fe,xe){try{this.self.importScripts(fe.url),xe()}catch(Fe){xe(Fe.toString())}},mi.prototype.syncRTLPluginState=function(ne,fe,xe){try{o.plugin.setState(fe);var Fe=o.plugin.getPluginURL();if(o.plugin.isLoaded()&&!o.plugin.isParsed()&&Fe!=null){this.self.importScripts(Fe);var Re=o.plugin.isParsed();xe(Re?void 0:new Error("RTL Text Plugin failed to import scripts from "+Fe),Re)}}catch(We){xe(We.toString())}},mi.prototype.getAvailableImages=function(ne){var fe=this.availableImages[ne];return fe||(fe=[]),fe},mi.prototype.getLayerIndex=function(ne){var fe=this.layerIndexes[ne];return fe||(fe=this.layerIndexes[ne]=new ae),fe},mi.prototype.getWorkerSource=function(ne,fe,xe){var Fe=this;return this.workerSources[ne]||(this.workerSources[ne]={}),this.workerSources[ne][fe]||(this.workerSources[ne][fe]={}),this.workerSources[ne][fe][xe]||(this.workerSources[ne][fe][xe]=new this.workerSourceTypes[fe]({send:function(Re,We,st){Fe.actor.send(Re,We,st,ne)}},this.getLayerIndex(ne),this.getAvailableImages(ne))),this.workerSources[ne][fe][xe]},mi.prototype.getDEMWorkerSource=function(ne,fe){return this.demWorkerSources[ne]||(this.demWorkerSources[ne]={}),this.demWorkerSources[ne][fe]||(this.demWorkerSources[ne][fe]=new _t),this.demWorkerSources[ne][fe]},mi.prototype.enforceCacheSizeLimit=function(ne,fe){o.enforceCacheSizeLimit(fe)},typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new mi(self)),mi}),V(["./shared"],function(o){var q=o.createCommonjsModule(function(l){function u(b){return!A(b)}function A(b){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var Q,R,J=new Blob([""],{type:"text/javascript"}),Ae=URL.createObjectURL(J);try{R=new Worker(Ae),Q=!0}catch{Q=!1}return R&&R.terminate(),URL.revokeObjectURL(Ae),Q}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var Q=document.createElement("canvas");Q.width=Q.height=1;var R=Q.getContext("2d");if(!R)return!1;var J=R.getImageData(0,0,1,1);return J&&J.width===Q.width}()?(d[M=b&&b.failIfMajorPerformanceCaveat]===void 0&&(d[M]=function(Q){var R=function(Ae){var Be=document.createElement("canvas"),Ie=Object.create(u.webGLContextAttributes);return Ie.failIfMajorPerformanceCaveat=Ae,Be.probablySupportsContext?Be.probablySupportsContext("webgl",Ie)||Be.probablySupportsContext("experimental-webgl",Ie):Be.supportsContext?Be.supportsContext("webgl",Ie)||Be.supportsContext("experimental-webgl",Ie):Be.getContext("webgl",Ie)||Be.getContext("experimental-webgl",Ie)}(Q);if(!R)return!1;var J=R.createShader(R.VERTEX_SHADER);return!(!J||R.isContextLost())&&(R.shaderSource(J,"void main() {}"),R.compileShader(J),R.getShaderParameter(J,R.COMPILE_STATUS)===!0)}(M)),d[M]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var M}l.exports?l.exports=u:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=u,window.mapboxgl.notSupportedReason=A);var d={};u.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),K={create:function(l,u,A){var d=o.window.document.createElement(l);return u!==void 0&&(d.className=u),A&&A.appendChild(d),d},createNS:function(l,u){return o.window.document.createElementNS(l,u)}},ae=o.window.document&&o.window.document.documentElement.style;function Y(l){if(!ae)return l[0];for(var u=0;u<l.length;u++)if(l[u]in ae)return l[u];return l[0]}var ie,be=Y(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);K.disableDrag=function(){ae&&be&&(ie=ae[be],ae[be]="none")},K.enableDrag=function(){ae&&be&&(ae[be]=ie)};var ze=Y(["transform","WebkitTransform"]);K.setTransform=function(l,u){l.style[ze]=u};var it=!1;try{var tt=Object.defineProperty({},"passive",{get:function(){it=!0}});o.window.addEventListener("test",tt,tt),o.window.removeEventListener("test",tt,tt)}catch{it=!1}K.addEventListener=function(l,u,A,d){d===void 0&&(d={}),l.addEventListener(u,A,"passive"in d&&it?d:d.capture)},K.removeEventListener=function(l,u,A,d){d===void 0&&(d={}),l.removeEventListener(u,A,"passive"in d&&it?d:d.capture)};var _t=function(l){l.preventDefault(),l.stopPropagation(),o.window.removeEventListener("click",_t,!0)};function yt(l){var u=l.userImage;return!!(u&&u.render&&u.render())&&(l.data.replace(new Uint8Array(u.data.buffer)),!0)}K.suppressClick=function(){o.window.addEventListener("click",_t,!0),o.window.setTimeout(function(){o.window.removeEventListener("click",_t,!0)},0)},K.mousePos=function(l,u){var A=l.getBoundingClientRect();return new o.Point(u.clientX-A.left-l.clientLeft,u.clientY-A.top-l.clientTop)},K.touchPos=function(l,u){for(var A=l.getBoundingClientRect(),d=[],b=0;b<u.length;b++)d.push(new o.Point(u[b].clientX-A.left-l.clientLeft,u[b].clientY-A.top-l.clientTop));return d},K.mouseButton=function(l){return o.window.InstallTrigger!==void 0&&l.button===2&&l.ctrlKey&&o.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:l.button},K.remove=function(l){l.parentNode&&l.parentNode.removeChild(l)};var Bt=function(l){function u(){l.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.RGBAImage({width:1,height:1}),this.dirty=!0}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.isLoaded=function(){return this.loaded},u.prototype.setLoaded=function(A){if(this.loaded!==A&&(this.loaded=A,A)){for(var d=0,b=this.requestors;d<b.length;d+=1){var M=b[d];this._notify(M.ids,M.callback)}this.requestors=[]}},u.prototype.getImage=function(A){return this.images[A]},u.prototype.addImage=function(A,d){this._validate(A,d)&&(this.images[A]=d)},u.prototype._validate=function(A,d){var b=!0;return this._validateStretch(d.stretchX,d.data&&d.data.width)||(this.fire(new o.ErrorEvent(new Error('Image "'+A+'" has invalid "stretchX" value'))),b=!1),this._validateStretch(d.stretchY,d.data&&d.data.height)||(this.fire(new o.ErrorEvent(new Error('Image "'+A+'" has invalid "stretchY" value'))),b=!1),this._validateContent(d.content,d)||(this.fire(new o.ErrorEvent(new Error('Image "'+A+'" has invalid "content" value'))),b=!1),b},u.prototype._validateStretch=function(A,d){if(!A)return!0;for(var b=0,M=0,Q=A;M<Q.length;M+=1){var R=Q[M];if(R[0]<b||R[1]<R[0]||d<R[1])return!1;b=R[1]}return!0},u.prototype._validateContent=function(A,d){return!(A&&(A.length!==4||A[0]<0||d.data.width<A[0]||A[1]<0||d.data.height<A[1]||A[2]<0||d.data.width<A[2]||A[3]<0||d.data.height<A[3]||A[2]<A[0]||A[3]<A[1]))},u.prototype.updateImage=function(A,d){d.version=this.images[A].version+1,this.images[A]=d,this.updatedImages[A]=!0},u.prototype.removeImage=function(A){var d=this.images[A];delete this.images[A],delete this.patterns[A],d.userImage&&d.userImage.onRemove&&d.userImage.onRemove()},u.prototype.listImages=function(){return Object.keys(this.images)},u.prototype.getImages=function(A,d){var b=!0;if(!this.isLoaded())for(var M=0,Q=A;M<Q.length;M+=1)this.images[Q[M]]||(b=!1);this.isLoaded()||b?this._notify(A,d):this.requestors.push({ids:A,callback:d})},u.prototype._notify=function(A,d){for(var b={},M=0,Q=A;M<Q.length;M+=1){var R=Q[M];this.images[R]||this.fire(new o.Event("styleimagemissing",{id:R}));var J=this.images[R];J?b[R]={data:J.data.clone(),pixelRatio:J.pixelRatio,sdf:J.sdf,version:J.version,stretchX:J.stretchX,stretchY:J.stretchY,content:J.content,hasRenderCallback:Boolean(J.userImage&&J.userImage.render)}:o.warnOnce('Image "'+R+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}d(null,b)},u.prototype.getPixelSize=function(){var A=this.atlasImage;return{width:A.width,height:A.height}},u.prototype.getPattern=function(A){var d=this.patterns[A],b=this.getImage(A);if(!b)return null;if(d&&d.position.version===b.version)return d.position;if(d)d.position.version=b.version;else{var M={w:b.data.width+2,h:b.data.height+2,x:0,y:0},Q=new o.ImagePosition(M,b);this.patterns[A]={bin:M,position:Q}}return this._updatePatternAtlas(),this.patterns[A].position},u.prototype.bind=function(A){var d=A.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.Texture(A,this.atlasImage,d.RGBA),this.atlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE)},u.prototype._updatePatternAtlas=function(){var A=[];for(var d in this.patterns)A.push(this.patterns[d].bin);var b=o.potpack(A),M=b.w,Q=b.h,R=this.atlasImage;for(var J in R.resize({width:M||1,height:Q||1}),this.patterns){var Ae=this.patterns[J].bin,Be=Ae.x+1,Ie=Ae.y+1,Te=this.images[J].data,He=Te.width,Le=Te.height;o.RGBAImage.copy(Te,R,{x:0,y:0},{x:Be,y:Ie},{width:He,height:Le}),o.RGBAImage.copy(Te,R,{x:0,y:Le-1},{x:Be,y:Ie-1},{width:He,height:1}),o.RGBAImage.copy(Te,R,{x:0,y:0},{x:Be,y:Ie+Le},{width:He,height:1}),o.RGBAImage.copy(Te,R,{x:He-1,y:0},{x:Be-1,y:Ie},{width:1,height:Le}),o.RGBAImage.copy(Te,R,{x:0,y:0},{x:Be+He,y:Ie},{width:1,height:Le})}this.dirty=!0},u.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},u.prototype.dispatchRenderCallbacks=function(A){for(var d=0,b=A;d<b.length;d+=1){var M=b[d];if(!this.callbackDispatchedThisFrame[M]){this.callbackDispatchedThisFrame[M]=!0;var Q=this.images[M];yt(Q)&&this.updateImage(M,Q)}}},u}(o.Evented),rt=Zt,It=Zt,gt=1e20;function Zt(l,u,A,d,b,M){this.fontSize=l||24,this.buffer=u===void 0?3:u,this.cutoff=d||.25,this.fontFamily=b||"sans-serif",this.fontWeight=M||"normal",this.radius=A||8;var Q=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=Q,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(Q*Q),this.gridInner=new Float64Array(Q*Q),this.f=new Float64Array(Q),this.d=new Float64Array(Q),this.z=new Float64Array(Q+1),this.v=new Int16Array(Q),this.middle=Math.round(Q/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function dr(l,u,A,d,b,M,Q){for(var R=0;R<u;R++){for(var J=0;J<A;J++)d[J]=l[J*u+R];for(Xr(d,b,M,Q,A),J=0;J<A;J++)l[J*u+R]=b[J]}for(J=0;J<A;J++){for(R=0;R<u;R++)d[R]=l[J*u+R];for(Xr(d,b,M,Q,u),R=0;R<u;R++)l[J*u+R]=Math.sqrt(b[R])}}function Xr(l,u,A,d,b){A[0]=0,d[0]=-gt,d[1]=+gt;for(var M=1,Q=0;M<b;M++){for(var R=(l[M]+M*M-(l[A[Q]]+A[Q]*A[Q]))/(2*M-2*A[Q]);R<=d[Q];)Q--,R=(l[M]+M*M-(l[A[Q]]+A[Q]*A[Q]))/(2*M-2*A[Q]);A[++Q]=M,d[Q]=R,d[Q+1]=+gt}for(M=0,Q=0;M<b;M++){for(;d[Q+1]<M;)Q++;u[M]=(M-A[Q])*(M-A[Q])+l[A[Q]]}}Zt.prototype.draw=function(l){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(l,this.buffer,this.middle);for(var u=this.ctx.getImageData(0,0,this.size,this.size),A=new Uint8ClampedArray(this.size*this.size),d=0;d<this.size*this.size;d++){var b=u.data[4*d+3]/255;this.gridOuter[d]=b===1?0:b===0?gt:Math.pow(Math.max(0,.5-b),2),this.gridInner[d]=b===1?gt:b===0?0:Math.pow(Math.max(0,b-.5),2)}for(dr(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),dr(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),d=0;d<this.size*this.size;d++)A[d]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[d]-this.gridInner[d])/this.radius+this.cutoff))));return A},rt.default=It;var ur=function(l,u){this.requestManager=l,this.localIdeographFontFamily=u,this.entries={}};ur.prototype.setURL=function(l){this.url=l},ur.prototype.getGlyphs=function(l,u){var A=this,d=[];for(var b in l)for(var M=0,Q=l[b];M<Q.length;M+=1)d.push({stack:b,id:Q[M]});o.asyncAll(d,function(R,J){var Ae=R.stack,Be=R.id,Ie=A.entries[Ae];Ie||(Ie=A.entries[Ae]={glyphs:{},requests:{},ranges:{}});var Te=Ie.glyphs[Be];if(Te===void 0){if(Te=A._tinySDF(Ie,Ae,Be))return Ie.glyphs[Be]=Te,void J(null,{stack:Ae,id:Be,glyph:Te});var He=Math.floor(Be/256);if(256*He>65535)J(new Error("glyphs > 65535 not supported"));else if(Ie.ranges[He])J(null,{stack:Ae,id:Be,glyph:Te});else{var Le=Ie.requests[He];Le||(Le=Ie.requests[He]=[],ur.loadGlyphRange(Ae,He,A.url,A.requestManager,function(qe,ke){if(ke){for(var Xe in ke)A._doesCharSupportLocalGlyph(+Xe)||(Ie.glyphs[+Xe]=ke[+Xe]);Ie.ranges[He]=!0}for(var et=0,at=Le;et<at.length;et+=1)(0,at[et])(qe,ke);delete Ie.requests[He]})),Le.push(function(qe,ke){qe?J(qe):ke&&J(null,{stack:Ae,id:Be,glyph:ke[Be]||null})})}}else J(null,{stack:Ae,id:Be,glyph:Te})},function(R,J){if(R)u(R);else if(J){for(var Ae={},Be=0,Ie=J;Be<Ie.length;Be+=1){var Te=Ie[Be],He=Te.stack,Le=Te.id,qe=Te.glyph;(Ae[He]||(Ae[He]={}))[Le]=qe&&{id:qe.id,bitmap:qe.bitmap.clone(),metrics:qe.metrics}}u(null,Ae)}})},ur.prototype._doesCharSupportLocalGlyph=function(l){return!!this.localIdeographFontFamily&&(o.isChar["CJK Unified Ideographs"](l)||o.isChar["Hangul Syllables"](l)||o.isChar.Hiragana(l)||o.isChar.Katakana(l))},ur.prototype._tinySDF=function(l,u,A){var d=this.localIdeographFontFamily;if(d&&this._doesCharSupportLocalGlyph(A)){var b=l.tinySDF;if(!b){var M="400";/bold/i.test(u)?M="900":/medium/i.test(u)?M="500":/light/i.test(u)&&(M="200"),b=l.tinySDF=new ur.TinySDF(24,3,8,.25,d,M)}return{id:A,bitmap:new o.AlphaImage({width:30,height:30},b.draw(String.fromCharCode(A))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},ur.loadGlyphRange=function(l,u,A,d,b){var M=256*u,Q=M+255,R=d.transformRequest(d.normalizeGlyphsURL(A).replace("{fontstack}",l).replace("{range}",M+"-"+Q),o.ResourceType.Glyphs);o.getArrayBuffer(R,function(J,Ae){if(J)b(J);else if(Ae){for(var Be={},Ie=0,Te=o.parseGlyphPBF(Ae);Ie<Te.length;Ie+=1){var He=Te[Ie];Be[He.id]=He}b(null,Be)}})},ur.TinySDF=rt;var _r=function(){this.specification=o.styleSpec.light.position};_r.prototype.possiblyEvaluate=function(l,u){return o.sphericalToCartesian(l.expression.evaluate(u))},_r.prototype.interpolate=function(l,u,A){return{x:o.number(l.x,u.x,A),y:o.number(l.y,u.y,A),z:o.number(l.z,u.z,A)}};var Rr=new o.Properties({anchor:new o.DataConstantProperty(o.styleSpec.light.anchor),position:new _r,color:new o.DataConstantProperty(o.styleSpec.light.color),intensity:new o.DataConstantProperty(o.styleSpec.light.intensity)}),ei=function(l){function u(A){l.call(this),this._transitionable=new o.Transitionable(Rr),this.setLight(A),this._transitioning=this._transitionable.untransitioned()}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getLight=function(){return this._transitionable.serialize()},u.prototype.setLight=function(A,d){if(d===void 0&&(d={}),!this._validate(o.validateLight,A,d))for(var b in A){var M=A[b];o.endsWith(b,"-transition")?this._transitionable.setTransition(b.slice(0,-11),M):this._transitionable.setValue(b,M)}},u.prototype.updateTransitions=function(A){this._transitioning=this._transitionable.transitioned(A,this._transitioning)},u.prototype.hasTransition=function(){return this._transitioning.hasTransition()},u.prototype.recalculate=function(A){this.properties=this._transitioning.possiblyEvaluate(A)},u.prototype._validate=function(A,d,b){return(!b||b.validate!==!1)&&o.emitValidationErrors(this,A.call(o.validateStyle,o.extend({value:d,style:{glyphs:!0,sprite:!0},styleSpec:o.styleSpec})))},u}(o.Evented),rr=function(l,u){this.width=l,this.height=u,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};rr.prototype.getDash=function(l,u){var A=l.join(",")+String(u);return this.dashEntry[A]||(this.dashEntry[A]=this.addDash(l,u)),this.dashEntry[A]},rr.prototype.getDashRanges=function(l,u,A){var d=[],b=l.length%2==1?-l[l.length-1]*A:0,M=l[0]*A,Q=!0;d.push({left:b,right:M,isDash:Q,zeroLength:l[0]===0});for(var R=l[0],J=1;J<l.length;J++){var Ae=l[J];d.push({left:b=R*A,right:M=(R+=Ae)*A,isDash:Q=!Q,zeroLength:Ae===0})}return d},rr.prototype.addRoundDash=function(l,u,A){for(var d=u/2,b=-A;b<=A;b++)for(var M=this.width*(this.nextRow+A+b),Q=0,R=l[Q],J=0;J<this.width;J++){J/R.right>1&&(R=l[++Q]);var Ae=Math.abs(J-R.left),Be=Math.abs(J-R.right),Ie=Math.min(Ae,Be),Te=void 0,He=b/A*(d+1);if(R.isDash){var Le=d-Math.abs(He);Te=Math.sqrt(Ie*Ie+Le*Le)}else Te=d-Math.sqrt(Ie*Ie+He*He);this.data[M+J]=Math.max(0,Math.min(255,Te+128))}},rr.prototype.addRegularDash=function(l){for(var u=l.length-1;u>=0;--u){var A=l[u],d=l[u+1];A.zeroLength?l.splice(u,1):d&&d.isDash===A.isDash&&(d.left=A.left,l.splice(u,1))}var b=l[0],M=l[l.length-1];b.isDash===M.isDash&&(b.left=M.left-this.width,M.right=b.right+this.width);for(var Q=this.width*this.nextRow,R=0,J=l[R],Ae=0;Ae<this.width;Ae++){Ae/J.right>1&&(J=l[++R]);var Be=Math.abs(Ae-J.left),Ie=Math.abs(Ae-J.right),Te=Math.min(Be,Ie);this.data[Q+Ae]=Math.max(0,Math.min(255,(J.isDash?Te:-Te)+128))}},rr.prototype.addDash=function(l,u){var A=u?7:0,d=2*A+1;if(this.nextRow+d>this.height)return o.warnOnce("LineAtlas out of space"),null;for(var b=0,M=0;M<l.length;M++)b+=l[M];if(b!==0){var Q=this.width/b,R=this.getDashRanges(l,this.width,Q);u?this.addRoundDash(R,Q,A):this.addRegularDash(R)}var J={y:(this.nextRow+A+.5)/this.height,height:2*A/this.height,width:b};return this.nextRow+=d,this.dirty=!0,J},rr.prototype.bind=function(l){var u=l.gl;this.texture?(u.bindTexture(u.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,u.texSubImage2D(u.TEXTURE_2D,0,0,0,this.width,this.height,u.ALPHA,u.UNSIGNED_BYTE,this.data))):(this.texture=u.createTexture(),u.bindTexture(u.TEXTURE_2D,this.texture),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texImage2D(u.TEXTURE_2D,0,u.ALPHA,this.width,this.height,0,u.ALPHA,u.UNSIGNED_BYTE,this.data))};var kt=function l(u,A){this.workerPool=u,this.actors=[],this.currentActor=0,this.id=o.uniqueId();for(var d=this.workerPool.acquire(this.id),b=0;b<d.length;b++){var M=new l.Actor(d[b],A,this.id);M.name="Worker "+b,this.actors.push(M)}};function Rt(l,u,A){var d=function(b,M){if(b)return A(b);if(M){var Q=o.pick(o.extend(M,l),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);M.vector_layers&&(Q.vectorLayers=M.vector_layers,Q.vectorLayerIds=Q.vectorLayers.map(function(R){return R.id})),Q.tiles=u.canonicalizeTileset(Q,l.url),A(null,Q)}};return l.url?o.getJSON(u.transformRequest(u.normalizeSourceURL(l.url),o.ResourceType.Source),d):o.browser.frame(function(){return d(null,l)})}kt.prototype.broadcast=function(l,u,A){o.asyncAll(this.actors,function(d,b){d.send(l,u,b)},A=A||function(){})},kt.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},kt.prototype.remove=function(){this.actors.forEach(function(l){l.remove()}),this.actors=[],this.workerPool.release(this.id)},kt.Actor=o.Actor;var br=function(l,u,A){this.bounds=o.LngLatBounds.convert(this.validateBounds(l)),this.minzoom=u||0,this.maxzoom=A||24};br.prototype.validateBounds=function(l){return Array.isArray(l)&&l.length===4?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]},br.prototype.contains=function(l){var u=Math.pow(2,l.z),A=Math.floor(o.mercatorXfromLng(this.bounds.getWest())*u),d=Math.floor(o.mercatorYfromLat(this.bounds.getNorth())*u),b=Math.ceil(o.mercatorXfromLng(this.bounds.getEast())*u),M=Math.ceil(o.mercatorYfromLat(this.bounds.getSouth())*u);return l.x>=A&&l.x<b&&l.y>=d&&l.y<M};var Or=function(l){function u(A,d,b,M){if(l.call(this),this.id=A,this.dispatcher=b,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.extend(this,o.pick(d,["url","scheme","tileSize","promoteId"])),this._options=o.extend({type:"vector"},d),this._collectResourceTiming=d.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(M)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.load=function(){var A=this;this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Rt(this._options,this.map._requestManager,function(d,b){A._tileJSONRequest=null,A._loaded=!0,d?A.fire(new o.ErrorEvent(d)):b&&(o.extend(A,b),b.bounds&&(A.tileBounds=new br(b.bounds,A.minzoom,A.maxzoom)),o.postTurnstileEvent(b.tiles,A.map._requestManager._customAccessToken),o.postMapLoadEvent(b.tiles,A.map._getMapId(),A.map._requestManager._skuToken,A.map._requestManager._customAccessToken),A.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),A.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})},u.prototype.loaded=function(){return this._loaded},u.prototype.hasTile=function(A){return!this.tileBounds||this.tileBounds.contains(A.canonical)},u.prototype.onAdd=function(A){this.map=A,this.load()},u.prototype.setSourceProperty=function(A){this._tileJSONRequest&&this._tileJSONRequest.cancel(),A(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},u.prototype.setTiles=function(A){var d=this;return this.setSourceProperty(function(){d._options.tiles=A}),this},u.prototype.setUrl=function(A){var d=this;return this.setSourceProperty(function(){d.url=A,d._options.url=A}),this},u.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},u.prototype.serialize=function(){return o.extend({},this._options)},u.prototype.loadTile=function(A,d){var b=this.map._requestManager.normalizeTileURL(A.tileID.canonical.url(this.tiles,this.scheme)),M={request:this.map._requestManager.transformRequest(b,o.ResourceType.Tile),uid:A.uid,tileID:A.tileID,zoom:A.tileID.overscaledZ,tileSize:this.tileSize*A.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:o.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function Q(R,J){return delete A.request,A.aborted?d(null):R&&R.status!==404?d(R):(J&&J.resourceTiming&&(A.resourceTiming=J.resourceTiming),this.map._refreshExpiredTiles&&J&&A.setExpiryData(J),A.loadVectorData(J,this.map.painter),o.cacheEntryPossiblyAdded(this.dispatcher),d(null),void(A.reloadCallback&&(this.loadTile(A,A.reloadCallback),A.reloadCallback=null)))}M.request.collectResourceTiming=this._collectResourceTiming,A.actor&&A.state!=="expired"?A.state==="loading"?A.reloadCallback=d:A.request=A.actor.send("reloadTile",M,Q.bind(this)):(A.actor=this.dispatcher.getActor(),A.request=A.actor.send("loadTile",M,Q.bind(this)))},u.prototype.abortTile=function(A){A.request&&(A.request.cancel(),delete A.request),A.actor&&A.actor.send("abortTile",{uid:A.uid,type:this.type,source:this.id},void 0)},u.prototype.unloadTile=function(A){A.unloadVectorData(),A.actor&&A.actor.send("removeTile",{uid:A.uid,type:this.type,source:this.id},void 0)},u.prototype.hasTransition=function(){return!1},u}(o.Evented),Kr=function(l){function u(A,d,b,M){l.call(this),this.id=A,this.dispatcher=b,this.setEventedParent(M),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.extend({type:"raster"},d),o.extend(this,o.pick(d,["url","scheme","tileSize"]))}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.load=function(){var A=this;this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Rt(this._options,this.map._requestManager,function(d,b){A._tileJSONRequest=null,A._loaded=!0,d?A.fire(new o.ErrorEvent(d)):b&&(o.extend(A,b),b.bounds&&(A.tileBounds=new br(b.bounds,A.minzoom,A.maxzoom)),o.postTurnstileEvent(b.tiles),o.postMapLoadEvent(b.tiles,A.map._getMapId(),A.map._requestManager._skuToken),A.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),A.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})},u.prototype.loaded=function(){return this._loaded},u.prototype.onAdd=function(A){this.map=A,this.load()},u.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},u.prototype.serialize=function(){return o.extend({},this._options)},u.prototype.hasTile=function(A){return!this.tileBounds||this.tileBounds.contains(A.canonical)},u.prototype.loadTile=function(A,d){var b=this,M=this.map._requestManager.normalizeTileURL(A.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);A.request=o.getImage(this.map._requestManager.transformRequest(M,o.ResourceType.Tile),function(Q,R){if(delete A.request,A.aborted)A.state="unloaded",d(null);else if(Q)A.state="errored",d(Q);else if(R){b.map._refreshExpiredTiles&&A.setExpiryData(R),delete R.cacheControl,delete R.expires;var J=b.map.painter.context,Ae=J.gl;A.texture=b.map.painter.getTileTexture(R.width),A.texture?A.texture.update(R,{useMipmap:!0}):(A.texture=new o.Texture(J,R,Ae.RGBA,{useMipmap:!0}),A.texture.bind(Ae.LINEAR,Ae.CLAMP_TO_EDGE,Ae.LINEAR_MIPMAP_NEAREST),J.extTextureFilterAnisotropic&&Ae.texParameterf(Ae.TEXTURE_2D,J.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,J.extTextureFilterAnisotropicMax)),A.state="loaded",o.cacheEntryPossiblyAdded(b.dispatcher),d(null)}})},u.prototype.abortTile=function(A,d){A.request&&(A.request.cancel(),delete A.request),d()},u.prototype.unloadTile=function(A,d){A.texture&&this.map.painter.saveTileTexture(A.texture),d()},u.prototype.hasTransition=function(){return!1},u}(o.Evented),di=function(l){function u(A,d,b,M){l.call(this,A,d,b,M),this.type="raster-dem",this.maxzoom=22,this._options=o.extend({type:"raster-dem"},d),this.encoding=d.encoding||"mapbox"}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},u.prototype.loadTile=function(A,d){var b=this.map._requestManager.normalizeTileURL(A.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function M(Q,R){Q&&(A.state="errored",d(Q)),R&&(A.dem=R,A.needsHillshadePrepare=!0,A.state="loaded",d(null))}A.request=o.getImage(this.map._requestManager.transformRequest(b,o.ResourceType.Tile),function(Q,R){if(delete A.request,A.aborted)A.state="unloaded",d(null);else if(Q)A.state="errored",d(Q);else if(R){this.map._refreshExpiredTiles&&A.setExpiryData(R),delete R.cacheControl,delete R.expires;var J=o.window.ImageBitmap&&R instanceof o.window.ImageBitmap&&o.offscreenCanvasSupported()?R:o.browser.getImageData(R,1),Ae={uid:A.uid,coord:A.tileID,source:this.id,rawImageData:J,encoding:this.encoding};A.actor&&A.state!=="expired"||(A.actor=this.dispatcher.getActor(),A.actor.send("loadDEMTile",Ae,M.bind(this)))}}.bind(this)),A.neighboringTiles=this._getNeighboringTiles(A.tileID)},u.prototype._getNeighboringTiles=function(A){var d=A.canonical,b=Math.pow(2,d.z),M=(d.x-1+b)%b,Q=d.x===0?A.wrap-1:A.wrap,R=(d.x+1+b)%b,J=d.x+1===b?A.wrap+1:A.wrap,Ae={};return Ae[new o.OverscaledTileID(A.overscaledZ,Q,d.z,M,d.y).key]={backfilled:!1},Ae[new o.OverscaledTileID(A.overscaledZ,J,d.z,R,d.y).key]={backfilled:!1},d.y>0&&(Ae[new o.OverscaledTileID(A.overscaledZ,Q,d.z,M,d.y-1).key]={backfilled:!1},Ae[new o.OverscaledTileID(A.overscaledZ,A.wrap,d.z,d.x,d.y-1).key]={backfilled:!1},Ae[new o.OverscaledTileID(A.overscaledZ,J,d.z,R,d.y-1).key]={backfilled:!1}),d.y+1<b&&(Ae[new o.OverscaledTileID(A.overscaledZ,Q,d.z,M,d.y+1).key]={backfilled:!1},Ae[new o.OverscaledTileID(A.overscaledZ,A.wrap,d.z,d.x,d.y+1).key]={backfilled:!1},Ae[new o.OverscaledTileID(A.overscaledZ,J,d.z,R,d.y+1).key]={backfilled:!1}),Ae},u.prototype.unloadTile=function(A){A.demTexture&&this.map.painter.saveTileTexture(A.demTexture),A.fbo&&(A.fbo.destroy(),delete A.fbo),A.dem&&delete A.dem,delete A.neighboringTiles,A.state="unloaded",A.actor&&A.actor.send("removeDEMTile",{uid:A.uid,source:this.id})},u}(Kr),ri=function(l){function u(A,d,b,M){l.call(this),this.id=A,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=b.getActor(),this.setEventedParent(M),this._data=d.data,this._options=o.extend({},d),this._collectResourceTiming=d.collectResourceTiming,this._resourceTiming=[],d.maxzoom!==void 0&&(this.maxzoom=d.maxzoom),d.type&&(this.type=d.type),d.attribution&&(this.attribution=d.attribution),this.promoteId=d.promoteId;var Q=o.EXTENT/this.tileSize;this.workerOptions=o.extend({source:this.id,cluster:d.cluster||!1,geojsonVtOptions:{buffer:(d.buffer!==void 0?d.buffer:128)*Q,tolerance:(d.tolerance!==void 0?d.tolerance:.375)*Q,extent:o.EXTENT,maxZoom:this.maxzoom,lineMetrics:d.lineMetrics||!1,generateId:d.generateId||!1},superclusterOptions:{maxZoom:d.clusterMaxZoom!==void 0?Math.min(d.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,d.clusterMinPoints||2),extent:o.EXTENT,radius:(d.clusterRadius||50)*Q,log:!1,generateId:d.generateId||!1},clusterProperties:d.clusterProperties,filter:d.filter},d.workerOptions)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.load=function(){var A=this;this.fire(new o.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(d){if(d)A.fire(new o.ErrorEvent(d));else{var b={dataType:"source",sourceDataType:"metadata"};A._collectResourceTiming&&A._resourceTiming&&A._resourceTiming.length>0&&(b.resourceTiming=A._resourceTiming,A._resourceTiming=[]),A.fire(new o.Event("data",b))}})},u.prototype.onAdd=function(A){this.map=A,this.load()},u.prototype.setData=function(A){var d=this;return this._data=A,this.fire(new o.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(b){if(b)d.fire(new o.ErrorEvent(b));else{var M={dataType:"source",sourceDataType:"content"};d._collectResourceTiming&&d._resourceTiming&&d._resourceTiming.length>0&&(M.resourceTiming=d._resourceTiming,d._resourceTiming=[]),d.fire(new o.Event("data",M))}}),this},u.prototype.getClusterExpansionZoom=function(A,d){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:A,source:this.id},d),this},u.prototype.getClusterChildren=function(A,d){return this.actor.send("geojson.getClusterChildren",{clusterId:A,source:this.id},d),this},u.prototype.getClusterLeaves=function(A,d,b,M){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:A,limit:d,offset:b},M),this},u.prototype._updateWorkerData=function(A){var d=this;this._loaded=!1;var b=o.extend({},this.workerOptions),M=this._data;typeof M=="string"?(b.request=this.map._requestManager.transformRequest(o.browser.resolveURL(M),o.ResourceType.Source),b.request.collectResourceTiming=this._collectResourceTiming):b.data=JSON.stringify(M),this.actor.send(this.type+".loadData",b,function(Q,R){d._removed||R&&R.abandoned||(d._loaded=!0,R&&R.resourceTiming&&R.resourceTiming[d.id]&&(d._resourceTiming=R.resourceTiming[d.id].slice(0)),d.actor.send(d.type+".coalesce",{source:b.source},null),A(Q))})},u.prototype.loaded=function(){return this._loaded},u.prototype.loadTile=function(A,d){var b=this,M=A.actor?"reloadTile":"loadTile";A.actor=this.actor,A.request=this.actor.send(M,{type:this.type,uid:A.uid,tileID:A.tileID,zoom:A.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:o.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(Q,R){return delete A.request,A.unloadVectorData(),A.aborted?d(null):Q?d(Q):(A.loadVectorData(R,b.map.painter,M==="reloadTile"),d(null))})},u.prototype.abortTile=function(A){A.request&&(A.request.cancel(),delete A.request),A.aborted=!0},u.prototype.unloadTile=function(A){A.unloadVectorData(),this.actor.send("removeTile",{uid:A.uid,type:this.type,source:this.id})},u.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},u.prototype.serialize=function(){return o.extend({},this._options,{type:this.type,data:this._data})},u.prototype.hasTransition=function(){return!1},u}(o.Evented),ii=o.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),ki=function(l){function u(A,d,b,M){l.call(this),this.id=A,this.dispatcher=b,this.coordinates=d.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(M),this.options=d}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.load=function(A,d){var b=this;this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this.url=this.options.url,o.getImage(this.map._requestManager.transformRequest(this.url,o.ResourceType.Image),function(M,Q){b._loaded=!0,M?b.fire(new o.ErrorEvent(M)):Q&&(b.image=Q,A&&(b.coordinates=A),d&&d(),b._finishLoading())})},u.prototype.loaded=function(){return this._loaded},u.prototype.updateImage=function(A){var d=this;return this.image&&A.url?(this.options.url=A.url,this.load(A.coordinates,function(){d.texture=null}),this):this},u.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})))},u.prototype.onAdd=function(A){this.map=A,this.load()},u.prototype.setCoordinates=function(A){var d=this;this.coordinates=A;var b=A.map(o.MercatorCoordinate.fromLngLat);this.tileID=function(Q){for(var R=1/0,J=1/0,Ae=-1/0,Be=-1/0,Ie=0,Te=Q;Ie<Te.length;Ie+=1){var He=Te[Ie];R=Math.min(R,He.x),J=Math.min(J,He.y),Ae=Math.max(Ae,He.x),Be=Math.max(Be,He.y)}var Le=Math.max(Ae-R,Be-J),qe=Math.max(0,Math.floor(-Math.log(Le)/Math.LN2)),ke=Math.pow(2,qe);return new o.CanonicalTileID(qe,Math.floor((R+Ae)/2*ke),Math.floor((J+Be)/2*ke))}(b),this.minzoom=this.maxzoom=this.tileID.z;var M=b.map(function(Q){return d.tileID.getTilePoint(Q)._round()});return this._boundsArray=new o.StructArrayLayout4i8,this._boundsArray.emplaceBack(M[0].x,M[0].y,0,0),this._boundsArray.emplaceBack(M[1].x,M[1].y,o.EXTENT,0),this._boundsArray.emplaceBack(M[3].x,M[3].y,0,o.EXTENT),this._boundsArray.emplaceBack(M[2].x,M[2].y,o.EXTENT,o.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})),this},u.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var A=this.map.painter.context,d=A.gl;for(var b in this.boundsBuffer||(this.boundsBuffer=A.createVertexBuffer(this._boundsArray,ii.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new o.Texture(A,this.image,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE)),this.tiles){var M=this.tiles[b];M.state!=="loaded"&&(M.state="loaded",M.texture=this.texture)}}},u.prototype.loadTile=function(A,d){this.tileID&&this.tileID.equals(A.tileID.canonical)?(this.tiles[String(A.tileID.wrap)]=A,A.buckets={},d(null)):(A.state="errored",d(null))},u.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},u.prototype.hasTransition=function(){return!1},u}(o.Evented),kn=function(l){function u(A,d,b,M){l.call(this,A,d,b,M),this.roundZoom=!0,this.type="video",this.options=d}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.load=function(){var A=this;this._loaded=!1;var d=this.options;this.urls=[];for(var b=0,M=d.urls;b<M.length;b+=1)this.urls.push(this.map._requestManager.transformRequest(M[b],o.ResourceType.Source).url);o.getVideo(this.urls,function(Q,R){A._loaded=!0,Q?A.fire(new o.ErrorEvent(Q)):R&&(A.video=R,A.video.loop=!0,A.video.addEventListener("playing",function(){A.map.triggerRepaint()}),A.map&&A.video.play(),A._finishLoading())})},u.prototype.pause=function(){this.video&&this.video.pause()},u.prototype.play=function(){this.video&&this.video.play()},u.prototype.seek=function(A){if(this.video){var d=this.video.seekable;A<d.start(0)||A>d.end(0)?this.fire(new o.ErrorEvent(new o.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+d.start(0)+" and "+d.end(0)+"-second mark."))):this.video.currentTime=A}},u.prototype.getVideo=function(){return this.video},u.prototype.onAdd=function(A){this.map||(this.map=A,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},u.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var A=this.map.painter.context,d=A.gl;for(var b in this.boundsBuffer||(this.boundsBuffer=A.createVertexBuffer(this._boundsArray,ii.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE),d.texSubImage2D(d.TEXTURE_2D,0,0,0,d.RGBA,d.UNSIGNED_BYTE,this.video)):(this.texture=new o.Texture(A,this.video,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE)),this.tiles){var M=this.tiles[b];M.state!=="loaded"&&(M.state="loaded",M.texture=this.texture)}}},u.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},u.prototype.hasTransition=function(){return this.video&&!this.video.paused},u}(ki),Zi=function(l){function u(A,d,b,M){l.call(this,A,d,b,M),d.coordinates?Array.isArray(d.coordinates)&&d.coordinates.length===4&&!d.coordinates.some(function(Q){return!Array.isArray(Q)||Q.length!==2||Q.some(function(R){return typeof R!="number"})})||this.fire(new o.ErrorEvent(new o.ValidationError("sources."+A,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.ErrorEvent(new o.ValidationError("sources."+A,null,'missing required property "coordinates"'))),d.animate&&typeof d.animate!="boolean"&&this.fire(new o.ErrorEvent(new o.ValidationError("sources."+A,null,'optional "animate" property must be a boolean value'))),d.canvas?typeof d.canvas=="string"||d.canvas instanceof o.window.HTMLCanvasElement||this.fire(new o.ErrorEvent(new o.ValidationError("sources."+A,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.ErrorEvent(new o.ValidationError("sources."+A,null,'missing required property "canvas"'))),this.options=d,this.animate=d.animate===void 0||d.animate}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof o.window.HTMLCanvasElement?this.options.canvas:o.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},u.prototype.getCanvas=function(){return this.canvas},u.prototype.onAdd=function(A){this.map=A,this.load(),this.canvas&&this.animate&&this.play()},u.prototype.onRemove=function(){this.pause()},u.prototype.prepare=function(){var A=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,A=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,A=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var d=this.map.painter.context,b=d.gl;for(var M in this.boundsBuffer||(this.boundsBuffer=d.createVertexBuffer(this._boundsArray,ii.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(A||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.Texture(d,this.canvas,b.RGBA,{premultiply:!0}),this.tiles){var Q=this.tiles[M];Q.state!=="loaded"&&(Q.state="loaded",Q.texture=this.texture)}}},u.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},u.prototype.hasTransition=function(){return this._playing},u.prototype._hasInvalidDimensions=function(){for(var A=0,d=[this.canvas.width,this.canvas.height];A<d.length;A+=1){var b=d[A];if(isNaN(b)||b<=0)return!0}return!1},u}(ki),Bn={vector:Or,raster:Kr,"raster-dem":di,geojson:ri,video:kn,image:ki,canvas:Zi};function la(l,u){var A=o.identity([]);return o.translate(A,A,[1,1,0]),o.scale(A,A,[.5*l.width,.5*l.height,1]),o.multiply(A,A,l.calculatePosMatrix(u.toUnwrapped()))}function Xi(l,u,A,d,b,M){var Q=function(qe,ke,Xe){if(qe)for(var et=0,at=qe;et<at.length;et+=1){var mt=ke[at[et]];if(mt&&mt.source===Xe&&mt.type==="fill-extrusion")return!0}else for(var Ze in ke){var bt=ke[Ze];if(bt.source===Xe&&bt.type==="fill-extrusion")return!0}return!1}(b&&b.layers,u,l.id),R=M.maxPitchScaleFactor(),J=l.tilesIn(d,R,Q);J.sort(cn);for(var Ae=[],Be=0,Ie=J;Be<Ie.length;Be+=1){var Te=Ie[Be];Ae.push({wrappedTileID:Te.tileID.wrapped().key,queryResults:Te.tile.queryRenderedFeatures(u,A,l._state,Te.queryGeometry,Te.cameraQueryGeometry,Te.scale,b,M,R,la(l.transform,Te.tileID))})}var He=function(qe){for(var ke={},Xe={},et=0,at=qe;et<at.length;et+=1){var mt=at[et],Ze=mt.queryResults,bt=mt.wrappedTileID,Tt=Xe[bt]=Xe[bt]||{};for(var Vt in Ze)for(var Ht=Ze[Vt],hr=Tt[Vt]=Tt[Vt]||{},Er=ke[Vt]=ke[Vt]||[],Mr=0,Ur=Ht;Mr<Ur.length;Mr+=1){var gi=Ur[Mr];hr[gi.featureIndex]||(hr[gi.featureIndex]=!0,Er.push(gi))}}return ke}(Ae);for(var Le in He)He[Le].forEach(function(qe){var ke=qe.feature,Xe=l.getFeatureState(ke.layer["source-layer"],ke.id);ke.source=ke.layer.source,ke.layer["source-layer"]&&(ke.sourceLayer=ke.layer["source-layer"]),ke.state=Xe});return He}function cn(l,u){var A=l.tileID,d=u.tileID;return A.overscaledZ-d.overscaledZ||A.canonical.y-d.canonical.y||A.wrap-d.wrap||A.canonical.x-d.canonical.x}var wi=function(l,u){this.max=l,this.onRemove=u,this.reset()};wi.prototype.reset=function(){for(var l in this.data)for(var u=0,A=this.data[l];u<A.length;u+=1){var d=A[u];d.timeout&&clearTimeout(d.timeout),this.onRemove(d.value)}return this.data={},this.order=[],this},wi.prototype.add=function(l,u,A){var d=this,b=l.wrapped().key;this.data[b]===void 0&&(this.data[b]=[]);var M={value:u,timeout:void 0};if(A!==void 0&&(M.timeout=setTimeout(function(){d.remove(l,M)},A)),this.data[b].push(M),this.order.push(b),this.order.length>this.max){var Q=this._getAndRemoveByKey(this.order[0]);Q&&this.onRemove(Q)}return this},wi.prototype.has=function(l){return l.wrapped().key in this.data},wi.prototype.getAndRemove=function(l){return this.has(l)?this._getAndRemoveByKey(l.wrapped().key):null},wi.prototype._getAndRemoveByKey=function(l){var u=this.data[l].shift();return u.timeout&&clearTimeout(u.timeout),this.data[l].length===0&&delete this.data[l],this.order.splice(this.order.indexOf(l),1),u.value},wi.prototype.getByKey=function(l){var u=this.data[l];return u?u[0].value:null},wi.prototype.get=function(l){return this.has(l)?this.data[l.wrapped().key][0].value:null},wi.prototype.remove=function(l,u){if(!this.has(l))return this;var A=l.wrapped().key,d=u===void 0?0:this.data[A].indexOf(u),b=this.data[A][d];return this.data[A].splice(d,1),b.timeout&&clearTimeout(b.timeout),this.data[A].length===0&&delete this.data[A],this.onRemove(b.value),this.order.splice(this.order.indexOf(A),1),this},wi.prototype.setMaxSize=function(l){for(this.max=l;this.order.length>this.max;){var u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this},wi.prototype.filter=function(l){var u=[];for(var A in this.data)for(var d=0,b=this.data[A];d<b.length;d+=1){var M=b[d];l(M.value)||u.push(M)}for(var Q=0,R=u;Q<R.length;Q+=1){var J=R[Q];this.remove(J.value.tileID,J)}};var Vi=function(l,u,A){this.context=l;var d=l.gl;this.buffer=d.createBuffer(),this.dynamicDraw=Boolean(A),this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),d.bufferData(d.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer};Vi.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Vi.prototype.updateData=function(l){var u=this.context.gl;this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)},Vi.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Ln={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Wi=function(l,u,A,d){this.length=u.length,this.attributes=A,this.itemSize=u.bytesPerElement,this.dynamicDraw=d,this.context=l;var b=l.gl;this.buffer=b.createBuffer(),l.bindVertexBuffer.set(this.buffer),b.bufferData(b.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer};Wi.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Wi.prototype.updateData=function(l){var u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,l.arrayBuffer)},Wi.prototype.enableAttributes=function(l,u){for(var A=0;A<this.attributes.length;A++){var d=u.attributes[this.attributes[A].name];d!==void 0&&l.enableVertexAttribArray(d)}},Wi.prototype.setVertexAttribPointers=function(l,u,A){for(var d=0;d<this.attributes.length;d++){var b=this.attributes[d],M=u.attributes[b.name];M!==void 0&&l.vertexAttribPointer(M,b.components,l[Ln[b.type]],!1,this.itemSize,b.offset+this.itemSize*(A||0))}},Wi.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var ni=function(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};ni.prototype.get=function(){return this.current},ni.prototype.set=function(l){},ni.prototype.getDefault=function(){return this.default},ni.prototype.setDefault=function(){this.set(this.default)};var Pn=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){return o.Color.transparent},u.prototype.set=function(A){var d=this.current;(A.r!==d.r||A.g!==d.g||A.b!==d.b||A.a!==d.a||this.dirty)&&(this.gl.clearColor(A.r,A.g,A.b,A.a),this.current=A,this.dirty=!1)},u}(ni),an=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){return 1},u.prototype.set=function(A){(A!==this.current||this.dirty)&&(this.gl.clearDepth(A),this.current=A,this.dirty=!1)},u}(ni),qn=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){return 0},u.prototype.set=function(A){(A!==this.current||this.dirty)&&(this.gl.clearStencil(A),this.current=A,this.dirty=!1)},u}(ni),un=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){return[!0,!0,!0,!0]},u.prototype.set=function(A){var d=this.current;(A[0]!==d[0]||A[1]!==d[1]||A[2]!==d[2]||A[3]!==d[3]||this.dirty)&&(this.gl.colorMask(A[0],A[1],A[2],A[3]),this.current=A,this.dirty=!1)},u}(ni),Wr=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){return!0},u.prototype.set=function(A){(A!==this.current||this.dirty)&&(this.gl.depthMask(A),this.current=A,this.dirty=!1)},u}(ni),Nn=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){return 255},u.prototype.set=function(A){(A!==this.current||this.dirty)&&(this.gl.stencilMask(A),this.current=A,this.dirty=!1)},u}(ni),Ri=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},u.prototype.set=function(A){var d=this.current;(A.func!==d.func||A.ref!==d.ref||A.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(A.func,A.ref,A.mask),this.current=A,this.dirty=!1)},u}(ni),Hr=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){var A=this.gl;return[A.KEEP,A.KEEP,A.KEEP]},u.prototype.set=function(A){var d=this.current;(A[0]!==d[0]||A[1]!==d[1]||A[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(A[0],A[1],A[2]),this.current=A,this.dirty=!1)},u}(ni),Ji=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){return!1},u.prototype.set=function(A){if(A!==this.current||this.dirty){var d=this.gl;A?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=A,this.dirty=!1}},u}(ni),Cn=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){return[0,1]},u.prototype.set=function(A){var d=this.current;(A[0]!==d[0]||A[1]!==d[1]||this.dirty)&&(this.gl.depthRange(A[0],A[1]),this.current=A,this.dirty=!1)},u}(ni),$i=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){return!1},u.prototype.set=function(A){if(A!==this.current||this.dirty){var d=this.gl;A?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=A,this.dirty=!1}},u}(ni),yn=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){return this.gl.LESS},u.prototype.set=function(A){(A!==this.current||this.dirty)&&(this.gl.depthFunc(A),this.current=A,this.dirty=!1)},u}(ni),En=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){return!1},u.prototype.set=function(A){if(A!==this.current||this.dirty){var d=this.gl;A?d.enable(d.BLEND):d.disable(d.BLEND),this.current=A,this.dirty=!1}},u}(ni),Ut=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){var A=this.gl;return[A.ONE,A.ZERO]},u.prototype.set=function(A){var d=this.current;(A[0]!==d[0]||A[1]!==d[1]||this.dirty)&&(this.gl.blendFunc(A[0],A[1]),this.current=A,this.dirty=!1)},u}(ni),ir=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){return o.Color.transparent},u.prototype.set=function(A){var d=this.current;(A.r!==d.r||A.g!==d.g||A.b!==d.b||A.a!==d.a||this.dirty)&&(this.gl.blendColor(A.r,A.g,A.b,A.a),this.current=A,this.dirty=!1)},u}(ni),Ma=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){return this.gl.FUNC_ADD},u.prototype.set=function(A){(A!==this.current||this.dirty)&&(this.gl.blendEquation(A),this.current=A,this.dirty=!1)},u}(ni),lo=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){return!1},u.prototype.set=function(A){if(A!==this.current||this.dirty){var d=this.gl;A?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=A,this.dirty=!1}},u}(ni),bi=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){return this.gl.BACK},u.prototype.set=function(A){(A!==this.current||this.dirty)&&(this.gl.cullFace(A),this.current=A,this.dirty=!1)},u}(ni),bo=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){return this.gl.CCW},u.prototype.set=function(A){(A!==this.current||this.dirty)&&(this.gl.frontFace(A),this.current=A,this.dirty=!1)},u}(ni),ro=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){return null},u.prototype.set=function(A){(A!==this.current||this.dirty)&&(this.gl.useProgram(A),this.current=A,this.dirty=!1)},u}(ni),Ao=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){return this.gl.TEXTURE0},u.prototype.set=function(A){(A!==this.current||this.dirty)&&(this.gl.activeTexture(A),this.current=A,this.dirty=!1)},u}(ni),Bo=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){var A=this.gl;return[0,0,A.drawingBufferWidth,A.drawingBufferHeight]},u.prototype.set=function(A){var d=this.current;(A[0]!==d[0]||A[1]!==d[1]||A[2]!==d[2]||A[3]!==d[3]||this.dirty)&&(this.gl.viewport(A[0],A[1],A[2],A[3]),this.current=A,this.dirty=!1)},u}(ni),er=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){return null},u.prototype.set=function(A){if(A!==this.current||this.dirty){var d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,A),this.current=A,this.dirty=!1}},u}(ni),Vr=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){return null},u.prototype.set=function(A){if(A!==this.current||this.dirty){var d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,A),this.current=A,this.dirty=!1}},u}(ni),Nr=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){return null},u.prototype.set=function(A){if(A!==this.current||this.dirty){var d=this.gl;d.bindTexture(d.TEXTURE_2D,A),this.current=A,this.dirty=!1}},u}(ni),_n=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){return null},u.prototype.set=function(A){if(A!==this.current||this.dirty){var d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,A),this.current=A,this.dirty=!1}},u}(ni),Qn=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){return null},u.prototype.set=function(A){var d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,A),this.current=A,this.dirty=!1},u}(ni),Gr=function(l){function u(A){l.call(this,A),this.vao=A.extVertexArrayObject}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){return null},u.prototype.set=function(A){this.vao&&(A!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(A),this.current=A,this.dirty=!1)},u}(ni),mo=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){return 4},u.prototype.set=function(A){if(A!==this.current||this.dirty){var d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,A),this.current=A,this.dirty=!1}},u}(ni),In=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){return!1},u.prototype.set=function(A){if(A!==this.current||this.dirty){var d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,A),this.current=A,this.dirty=!1}},u}(ni),ka=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){return!1},u.prototype.set=function(A){if(A!==this.current||this.dirty){var d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,A),this.current=A,this.dirty=!1}},u}(ni),mi=function(l){function u(A,d){l.call(this,A),this.context=A,this.parent=d}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getDefault=function(){return null},u}(ni),ne=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.setDirty=function(){this.dirty=!0},u.prototype.set=function(A){if(A!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,A,0),this.current=A,this.dirty=!1}},u}(mi),fe=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.set=function(A){if(A!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,A),this.current=A,this.dirty=!1}},u}(mi),xe=function(l,u,A,d){this.context=l,this.width=u,this.height=A;var b=this.framebuffer=l.gl.createFramebuffer();this.colorAttachment=new ne(l,b),d&&(this.depthAttachment=new fe(l,b))};xe.prototype.destroy=function(){var l=this.context.gl,u=this.colorAttachment.get();if(u&&l.deleteTexture(u),this.depthAttachment){var A=this.depthAttachment.get();A&&l.deleteRenderbuffer(A)}l.deleteFramebuffer(this.framebuffer)};var Fe=function(l,u,A){this.func=l,this.mask=u,this.range=A};Fe.ReadOnly=!1,Fe.ReadWrite=!0,Fe.disabled=new Fe(519,Fe.ReadOnly,[0,1]);var Re=function(l,u,A,d,b,M){this.test=l,this.ref=u,this.mask=A,this.fail=d,this.depthFail=b,this.pass=M};Re.disabled=new Re({func:519,mask:0},0,0,7680,7680,7680);var We=function(l,u,A){this.blendFunction=l,this.blendColor=u,this.mask=A};We.disabled=new We(We.Replace=[1,0],o.Color.transparent,[!1,!1,!1,!1]),We.unblended=new We(We.Replace,o.Color.transparent,[!0,!0,!0,!0]),We.alphaBlended=new We([1,771],o.Color.transparent,[!0,!0,!0,!0]);var st=function(l,u,A){this.enable=l,this.mode=u,this.frontFace=A};st.disabled=new st(!1,1029,2305),st.backCCW=new st(!0,1029,2305);var Ee=function(l){this.gl=l,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Pn(this),this.clearDepth=new an(this),this.clearStencil=new qn(this),this.colorMask=new un(this),this.depthMask=new Wr(this),this.stencilMask=new Nn(this),this.stencilFunc=new Ri(this),this.stencilOp=new Hr(this),this.stencilTest=new Ji(this),this.depthRange=new Cn(this),this.depthTest=new $i(this),this.depthFunc=new yn(this),this.blend=new En(this),this.blendFunc=new Ut(this),this.blendColor=new ir(this),this.blendEquation=new Ma(this),this.cullFace=new lo(this),this.cullFaceSide=new bi(this),this.frontFace=new bo(this),this.program=new ro(this),this.activeTexture=new Ao(this),this.viewport=new Bo(this),this.bindFramebuffer=new er(this),this.bindRenderbuffer=new Vr(this),this.bindTexture=new Nr(this),this.bindVertexBuffer=new _n(this),this.bindElementBuffer=new Qn(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Gr(this),this.pixelStoreUnpack=new mo(this),this.pixelStoreUnpackPremultiplyAlpha=new In(this),this.pixelStoreUnpackFlipY=new ka(this),this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=l.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(l.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=l.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=l.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE)};Ee.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Ee.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Ee.prototype.createIndexBuffer=function(l,u){return new Vi(this,l,u)},Ee.prototype.createVertexBuffer=function(l,u,A){return new Wi(this,l,u,A)},Ee.prototype.createRenderbuffer=function(l,u,A){var d=this.gl,b=d.createRenderbuffer();return this.bindRenderbuffer.set(b),d.renderbufferStorage(d.RENDERBUFFER,l,u,A),this.bindRenderbuffer.set(null),b},Ee.prototype.createFramebuffer=function(l,u,A){return new xe(this,l,u,A)},Ee.prototype.clear=function(l){var u=l.color,A=l.depth,d=this.gl,b=0;u&&(b|=d.COLOR_BUFFER_BIT,this.clearColor.set(u),this.colorMask.set([!0,!0,!0,!0])),A!==void 0&&(b|=d.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(A),this.depthMask.set(!0)),d.clear(b)},Ee.prototype.setCullFace=function(l){l.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))},Ee.prototype.setDepthMode=function(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)},Ee.prototype.setStencilMode=function(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)},Ee.prototype.setColorMode=function(l){o.deepEqual(l.blendFunction,We.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor)),this.colorMask.set(l.mask)},Ee.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var X=function(l){function u(A,d,b){var M=this;l.call(this),this.id=A,this.dispatcher=b,this.on("data",function(Q){Q.dataType==="source"&&Q.sourceDataType==="metadata"&&(M._sourceLoaded=!0),M._sourceLoaded&&!M._paused&&Q.dataType==="source"&&Q.sourceDataType==="content"&&(M.reload(),M.transform&&M.update(M.transform))}),this.on("error",function(){M._sourceErrored=!0}),this._source=function(Q,R,J,Ae){var Be=new Bn[R.type](Q,R,J,Ae);if(Be.id!==Q)throw new Error("Expected Source id to be "+Q+" instead of "+Be.id);return o.bindAll(["load","abort","unload","serialize","prepare"],Be),Be}(A,d,b,this),this._tiles={},this._cache=new wi(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new o.SourceFeatureState}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.onAdd=function(A){this.map=A,this._maxTileCacheSize=A?A._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(A)},u.prototype.onRemove=function(A){this._source&&this._source.onRemove&&this._source.onRemove(A)},u.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var A in this._tiles){var d=this._tiles[A];if(d.state!=="loaded"&&d.state!=="errored")return!1}return!0},u.prototype.getSource=function(){return this._source},u.prototype.pause=function(){this._paused=!0},u.prototype.resume=function(){if(this._paused){var A=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,A&&this.reload(),this.transform&&this.update(this.transform)}},u.prototype._loadTile=function(A,d){return this._source.loadTile(A,d)},u.prototype._unloadTile=function(A){if(this._source.unloadTile)return this._source.unloadTile(A,function(){})},u.prototype._abortTile=function(A){if(this._source.abortTile)return this._source.abortTile(A,function(){})},u.prototype.serialize=function(){return this._source.serialize()},u.prototype.prepare=function(A){for(var d in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var b=this._tiles[d];b.upload(A),b.prepare(this.map.style.imageManager)}},u.prototype.getIds=function(){return o.values(this._tiles).map(function(A){return A.tileID}).sort(H).map(function(A){return A.key})},u.prototype.getRenderableIds=function(A){var d=this,b=[];for(var M in this._tiles)this._isIdRenderable(M,A)&&b.push(this._tiles[M]);return A?b.sort(function(Q,R){var J=Q.tileID,Ae=R.tileID,Be=new o.Point(J.canonical.x,J.canonical.y)._rotate(d.transform.angle),Ie=new o.Point(Ae.canonical.x,Ae.canonical.y)._rotate(d.transform.angle);return J.overscaledZ-Ae.overscaledZ||Ie.y-Be.y||Ie.x-Be.x}).map(function(Q){return Q.tileID.key}):b.map(function(Q){return Q.tileID}).sort(H).map(function(Q){return Q.key})},u.prototype.hasRenderableParent=function(A){var d=this.findLoadedParent(A,0);return!!d&&this._isIdRenderable(d.tileID.key)},u.prototype._isIdRenderable=function(A,d){return this._tiles[A]&&this._tiles[A].hasData()&&!this._coveredTiles[A]&&(d||!this._tiles[A].holdingForFade())},u.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var A in this._cache.reset(),this._tiles)this._tiles[A].state!=="errored"&&this._reloadTile(A,"reloading")},u.prototype._reloadTile=function(A,d){var b=this._tiles[A];b&&(b.state!=="loading"&&(b.state=d),this._loadTile(b,this._tileLoaded.bind(this,b,A,d)))},u.prototype._tileLoaded=function(A,d,b,M){if(M)return A.state="errored",void(M.status!==404?this._source.fire(new o.ErrorEvent(M,{tile:A})):this.update(this.transform));A.timeAdded=o.browser.now(),b==="expired"&&(A.refreshedUponExpiration=!0),this._setTileReloadTimer(d,A),this.getSource().type==="raster-dem"&&A.dem&&this._backfillDEM(A),this._state.initializeTileState(A,this.map?this.map.painter:null),this._source.fire(new o.Event("data",{dataType:"source",tile:A,coord:A.tileID}))},u.prototype._backfillDEM=function(A){for(var d=this.getRenderableIds(),b=0;b<d.length;b++){var M=d[b];if(A.neighboringTiles&&A.neighboringTiles[M]){var Q=this.getTileByID(M);R(A,Q),R(Q,A)}}function R(J,Ae){J.needsHillshadePrepare=!0;var Be=Ae.tileID.canonical.x-J.tileID.canonical.x,Ie=Ae.tileID.canonical.y-J.tileID.canonical.y,Te=Math.pow(2,J.tileID.canonical.z),He=Ae.tileID.key;Be===0&&Ie===0||Math.abs(Ie)>1||(Math.abs(Be)>1&&(Math.abs(Be+Te)===1?Be+=Te:Math.abs(Be-Te)===1&&(Be-=Te)),Ae.dem&&J.dem&&(J.dem.backfillBorder(Ae.dem,Be,Ie),J.neighboringTiles&&J.neighboringTiles[He]&&(J.neighboringTiles[He].backfilled=!0)))}},u.prototype.getTile=function(A){return this.getTileByID(A.key)},u.prototype.getTileByID=function(A){return this._tiles[A]},u.prototype._retainLoadedChildren=function(A,d,b,M){for(var Q in this._tiles){var R=this._tiles[Q];if(!(M[Q]||!R.hasData()||R.tileID.overscaledZ<=d||R.tileID.overscaledZ>b)){for(var J=R.tileID;R&&R.tileID.overscaledZ>d+1;){var Ae=R.tileID.scaledTo(R.tileID.overscaledZ-1);(R=this._tiles[Ae.key])&&R.hasData()&&(J=Ae)}for(var Be=J;Be.overscaledZ>d;)if(A[(Be=Be.scaledTo(Be.overscaledZ-1)).key]){M[J.key]=J;break}}}},u.prototype.findLoadedParent=function(A,d){if(A.key in this._loadedParentTiles){var b=this._loadedParentTiles[A.key];return b&&b.tileID.overscaledZ>=d?b:null}for(var M=A.overscaledZ-1;M>=d;M--){var Q=A.scaledTo(M),R=this._getLoadedTile(Q);if(R)return R}},u.prototype._getLoadedTile=function(A){var d=this._tiles[A.key];return d&&d.hasData()?d:this._cache.getByKey(A.wrapped().key)},u.prototype.updateCacheSize=function(A){var d=Math.ceil(A.width/this._source.tileSize)+1,b=Math.ceil(A.height/this._source.tileSize)+1,M=Math.floor(d*b*5),Q=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,M):M;this._cache.setMaxSize(Q)},u.prototype.handleWrapJump=function(A){var d=Math.round((A-(this._prevLng===void 0?A:this._prevLng))/360);if(this._prevLng=A,d){var b={};for(var M in this._tiles){var Q=this._tiles[M];Q.tileID=Q.tileID.unwrapTo(Q.tileID.wrap+d),b[Q.tileID.key]=Q}for(var R in this._tiles=b,this._timers)clearTimeout(this._timers[R]),delete this._timers[R];for(var J in this._tiles)this._setTileReloadTimer(J,this._tiles[J])}},u.prototype.update=function(A){var d=this;if(this.transform=A,this._sourceLoaded&&!this._paused){var b;this.updateCacheSize(A),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?b=A.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Tt){return new o.OverscaledTileID(Tt.canonical.z,Tt.wrap,Tt.canonical.z,Tt.canonical.x,Tt.canonical.y)}):(b=A.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(b=b.filter(function(Tt){return d._source.hasTile(Tt)}))):b=[];var M=A.coveringZoomLevel(this._source),Q=Math.max(M-u.maxOverzooming,this._source.minzoom),R=Math.max(M+u.maxUnderzooming,this._source.minzoom),J=this._updateRetainedTiles(b,M);if(te(this._source.type)){for(var Ae={},Be={},Ie=0,Te=Object.keys(J);Ie<Te.length;Ie+=1){var He=Te[Ie],Le=J[He],qe=this._tiles[He];if(qe&&!(qe.fadeEndTime&&qe.fadeEndTime<=o.browser.now())){var ke=this.findLoadedParent(Le,Q);ke&&(this._addTile(ke.tileID),Ae[ke.tileID.key]=ke.tileID),Be[He]=Le}}for(var Xe in this._retainLoadedChildren(Be,M,R,J),Ae)J[Xe]||(this._coveredTiles[Xe]=!0,J[Xe]=Ae[Xe])}for(var et in J)this._tiles[et].clearFadeHold();for(var at=0,mt=o.keysDifference(this._tiles,J);at<mt.length;at+=1){var Ze=mt[at],bt=this._tiles[Ze];bt.hasSymbolBuckets&&!bt.holdingForFade()?bt.setHoldDuration(this.map._fadeDuration):bt.hasSymbolBuckets&&!bt.symbolFadeFinished()||this._removeTile(Ze)}this._updateLoadedParentTileCache()}},u.prototype.releaseSymbolFadeTiles=function(){for(var A in this._tiles)this._tiles[A].holdingForFade()&&this._removeTile(A)},u.prototype._updateRetainedTiles=function(A,d){for(var b={},M={},Q=Math.max(d-u.maxOverzooming,this._source.minzoom),R=Math.max(d+u.maxUnderzooming,this._source.minzoom),J={},Ae=0,Be=A;Ae<Be.length;Ae+=1){var Ie=Be[Ae],Te=this._addTile(Ie);b[Ie.key]=Ie,Te.hasData()||d<this._source.maxzoom&&(J[Ie.key]=Ie)}this._retainLoadedChildren(J,d,R,b);for(var He=0,Le=A;He<Le.length;He+=1){var qe=Le[He],ke=this._tiles[qe.key];if(!ke.hasData()){if(d+1>this._source.maxzoom){var Xe=qe.children(this._source.maxzoom)[0],et=this.getTile(Xe);if(et&&et.hasData()){b[Xe.key]=Xe;continue}}else{var at=qe.children(this._source.maxzoom);if(b[at[0].key]&&b[at[1].key]&&b[at[2].key]&&b[at[3].key])continue}for(var mt=ke.wasRequested(),Ze=qe.overscaledZ-1;Ze>=Q;--Ze){var bt=qe.scaledTo(Ze);if(M[bt.key]||(M[bt.key]=!0,!(ke=this.getTile(bt))&&mt&&(ke=this._addTile(bt)),ke&&(b[bt.key]=bt,mt=ke.wasRequested(),ke.hasData())))break}}}return b},u.prototype._updateLoadedParentTileCache=function(){for(var A in this._loadedParentTiles={},this._tiles){for(var d=[],b=void 0,M=this._tiles[A].tileID;M.overscaledZ>0;){if(M.key in this._loadedParentTiles){b=this._loadedParentTiles[M.key];break}d.push(M.key);var Q=M.scaledTo(M.overscaledZ-1);if(b=this._getLoadedTile(Q))break;M=Q}for(var R=0,J=d;R<J.length;R+=1)this._loadedParentTiles[J[R]]=b}},u.prototype._addTile=function(A){var d=this._tiles[A.key];if(d)return d;(d=this._cache.getAndRemove(A))&&(this._setTileReloadTimer(A.key,d),d.tileID=A,this._state.initializeTileState(d,this.map?this.map.painter:null),this._cacheTimers[A.key]&&(clearTimeout(this._cacheTimers[A.key]),delete this._cacheTimers[A.key],this._setTileReloadTimer(A.key,d)));var b=Boolean(d);return b||(d=new o.Tile(A,this._source.tileSize*A.overscaleFactor()),this._loadTile(d,this._tileLoaded.bind(this,d,A.key,d.state))),d?(d.uses++,this._tiles[A.key]=d,b||this._source.fire(new o.Event("dataloading",{tile:d,coord:d.tileID,dataType:"source"})),d):null},u.prototype._setTileReloadTimer=function(A,d){var b=this;A in this._timers&&(clearTimeout(this._timers[A]),delete this._timers[A]);var M=d.getExpiryTimeout();M&&(this._timers[A]=setTimeout(function(){b._reloadTile(A,"expired"),delete b._timers[A]},M))},u.prototype._removeTile=function(A){var d=this._tiles[A];d&&(d.uses--,delete this._tiles[A],this._timers[A]&&(clearTimeout(this._timers[A]),delete this._timers[A]),d.uses>0||(d.hasData()&&d.state!=="reloading"?this._cache.add(d.tileID,d,d.getExpiryTimeout()):(d.aborted=!0,this._abortTile(d),this._unloadTile(d))))},u.prototype.clearTiles=function(){for(var A in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(A);this._cache.reset()},u.prototype.tilesIn=function(A,d,b){var M=this,Q=[],R=this.transform;if(!R)return Q;for(var J=b?R.getCameraQueryGeometry(A):A,Ae=A.map(function(Ze){return R.pointCoordinate(Ze)}),Be=J.map(function(Ze){return R.pointCoordinate(Ze)}),Ie=this.getIds(),Te=1/0,He=1/0,Le=-1/0,qe=-1/0,ke=0,Xe=Be;ke<Xe.length;ke+=1){var et=Xe[ke];Te=Math.min(Te,et.x),He=Math.min(He,et.y),Le=Math.max(Le,et.x),qe=Math.max(qe,et.y)}for(var at=function(Ze){var bt=M._tiles[Ie[Ze]];if(!bt.holdingForFade()){var Tt=bt.tileID,Vt=Math.pow(2,R.zoom-bt.tileID.overscaledZ),Ht=d*bt.queryPadding*o.EXTENT/bt.tileSize/Vt,hr=[Tt.getTilePoint(new o.MercatorCoordinate(Te,He)),Tt.getTilePoint(new o.MercatorCoordinate(Le,qe))];if(hr[0].x-Ht<o.EXTENT&&hr[0].y-Ht<o.EXTENT&&hr[1].x+Ht>=0&&hr[1].y+Ht>=0){var Er=Ae.map(function(Ur){return Tt.getTilePoint(Ur)}),Mr=Be.map(function(Ur){return Tt.getTilePoint(Ur)});Q.push({tile:bt,tileID:Tt,queryGeometry:Er,cameraQueryGeometry:Mr,scale:Vt})}}},mt=0;mt<Ie.length;mt++)at(mt);return Q},u.prototype.getVisibleCoordinates=function(A){for(var d=this,b=this.getRenderableIds(A).map(function(J){return d._tiles[J].tileID}),M=0,Q=b;M<Q.length;M+=1){var R=Q[M];R.posMatrix=this.transform.calculatePosMatrix(R.toUnwrapped())}return b},u.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(te(this._source.type))for(var A in this._tiles){var d=this._tiles[A];if(d.fadeEndTime!==void 0&&d.fadeEndTime>=o.browser.now())return!0}return!1},u.prototype.setFeatureState=function(A,d,b){this._state.updateState(A=A||"_geojsonTileLayer",d,b)},u.prototype.removeFeatureState=function(A,d,b){this._state.removeFeatureState(A=A||"_geojsonTileLayer",d,b)},u.prototype.getFeatureState=function(A,d){return this._state.getState(A=A||"_geojsonTileLayer",d)},u.prototype.setDependencies=function(A,d,b){var M=this._tiles[A];M&&M.setDependencies(d,b)},u.prototype.reloadTilesForDependencies=function(A,d){for(var b in this._tiles)this._tiles[b].hasDependency(A,d)&&this._reloadTile(b,"reloading");this._cache.filter(function(M){return!M.hasDependency(A,d)})},u}(o.Evented);function H(l,u){var A=Math.abs(2*l.wrap)-+(l.wrap<0),d=Math.abs(2*u.wrap)-+(u.wrap<0);return l.overscaledZ-u.overscaledZ||d-A||u.canonical.y-l.canonical.y||u.canonical.x-l.canonical.x}function te(l){return l==="raster"||l==="image"||l==="video"}function pe(){return new o.window.Worker(sr.workerUrl)}X.maxOverzooming=10,X.maxUnderzooming=3;var se="mapboxgl_preloaded_worker_pool",Se=function(){this.active={}};Se.prototype.acquire=function(l){if(!this.workers)for(this.workers=[];this.workers.length<Se.workerCount;)this.workers.push(new pe);return this.active[l]=!0,this.workers.slice()},Se.prototype.release=function(l){delete this.active[l],this.numActive()===0&&(this.workers.forEach(function(u){u.terminate()}),this.workers=null)},Se.prototype.isPreloaded=function(){return!!this.active[se]},Se.prototype.numActive=function(){return Object.keys(this.active).length};var Ne,Me=Math.floor(o.browser.hardwareConcurrency/2);function ve(){return Ne||(Ne=new Se),Ne}function Oe(l,u){var A={};for(var d in l)d!=="ref"&&(A[d]=l[d]);return o.refProperties.forEach(function(b){b in u&&(A[b]=u[b])}),A}function Je(l){l=l.slice();for(var u=Object.create(null),A=0;A<l.length;A++)u[l[A].id]=l[A];for(var d=0;d<l.length;d++)"ref"in l[d]&&(l[d]=Oe(l[d],u[l[d].ref]));return l}Se.workerCount=Math.max(Math.min(Me,6),1);var ct={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function we(l,u,A){A.push({command:ct.addSource,args:[l,u[l]]})}function Pe(l,u,A){u.push({command:ct.removeSource,args:[l]}),A[l]=!0}function dt(l,u,A,d){Pe(l,A,d),we(l,u,A)}function xt(l,u,A){var d;for(d in l[A])if(l[A].hasOwnProperty(d)&&d!=="data"&&!o.deepEqual(l[A][d],u[A][d]))return!1;for(d in u[A])if(u[A].hasOwnProperty(d)&&d!=="data"&&!o.deepEqual(l[A][d],u[A][d]))return!1;return!0}function Lt(l,u,A,d,b,M){var Q;for(Q in u=u||{},l=l||{})l.hasOwnProperty(Q)&&(o.deepEqual(l[Q],u[Q])||A.push({command:M,args:[d,Q,u[Q],b]}));for(Q in u)u.hasOwnProperty(Q)&&!l.hasOwnProperty(Q)&&(o.deepEqual(l[Q],u[Q])||A.push({command:M,args:[d,Q,u[Q],b]}))}function zt(l){return l.id}function Jt(l,u){return l[u.id]=u,l}var or=function(l,u){this.reset(l,u)};or.prototype.reset=function(l,u){this.points=l||[],this._distances=[0];for(var A=1;A<this.points.length;A++)this._distances[A]=this._distances[A-1]+this.points[A].dist(this.points[A-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding},or.prototype.lerp=function(l){if(this.points.length===1)return this.points[0];l=o.clamp(l,0,1);for(var u=1,A=this._distances[u],d=l*this.paddedLength+this.padding;A<d&&u<this._distances.length;)A=this._distances[++u];var b=u-1,M=this._distances[b],Q=A-M,R=Q>0?(d-M)/Q:0;return this.points[b].mult(1-R).add(this.points[u].mult(R))};var Ar=function(l,u,A){var d=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(l/A),this.yCellCount=Math.ceil(u/A);for(var M=0;M<this.xCellCount*this.yCellCount;M++)d.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=u,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0};function Br(l,u,A,d,b){var M=o.create();return u?(o.scale(M,M,[1/b,1/b,1]),A||o.rotateZ(M,M,d.angle)):o.multiply(M,d.labelPlaneMatrix,l),M}function vr(l,u,A,d,b){if(u){var M=o.clone(l);return o.scale(M,M,[b,b,1]),A||o.rotateZ(M,M,-d.angle),M}return d.glCoordMatrix}function Sr(l,u){var A=[l.x,l.y,0,1];fi(A,A,u);var d=A[3];return{point:new o.Point(A[0]/d,A[1]/d),signedDistanceFromCamera:d}}function Tr(l,u){return .5+l/u*.5}function li(l,u){var A=l[0]/l[3],d=l[1]/l[3];return A>=-u[0]&&A<=u[0]&&d>=-u[1]&&d<=u[1]}function Co(l,u,A,d,b,M,Q,R){var J=d?l.textSizeData:l.iconSizeData,Ae=o.evaluateSizeForZoom(J,A.transform.zoom),Be=[256/A.width*2+1,256/A.height*2+1],Ie=d?l.text.dynamicLayoutVertexArray:l.icon.dynamicLayoutVertexArray;Ie.clear();for(var Te=l.lineVertexArray,He=d?l.text.placedSymbolArray:l.icon.placedSymbolArray,Le=A.transform.width/A.transform.height,qe=!1,ke=0;ke<He.length;ke++){var Xe=He.get(ke);if(Xe.hidden||Xe.writingMode===o.WritingMode.vertical&&!qe)Eo(Xe.numGlyphs,Ie);else{qe=!1;var et=[Xe.anchorX,Xe.anchorY,0,1];if(o.transformMat4(et,et,u),li(et,Be)){var at=Tr(A.transform.cameraToCenterDistance,et[3]),mt=o.evaluateSizeForFeature(J,Ae,Xe),Ze=Q?mt/at:mt*at,bt=new o.Point(Xe.anchorX,Xe.anchorY),Tt=Sr(bt,b).point,Vt={},Ht=Na(Xe,Ze,!1,R,u,b,M,l.glyphOffsetArray,Te,Ie,Tt,bt,Vt,Le);qe=Ht.useVertical,(Ht.notEnoughRoom||qe||Ht.needsFlipping&&Na(Xe,Ze,!0,R,u,b,M,l.glyphOffsetArray,Te,Ie,Tt,bt,Vt,Le).notEnoughRoom)&&Eo(Xe.numGlyphs,Ie)}else Eo(Xe.numGlyphs,Ie)}}d?l.text.dynamicLayoutVertexBuffer.updateData(Ie):l.icon.dynamicLayoutVertexBuffer.updateData(Ie)}function Bi(l,u,A,d,b,M,Q,R,J,Ae,Be){var Ie=R.glyphStartIndex+R.numGlyphs,Te=R.lineStartIndex,He=R.lineStartIndex+R.lineLength,Le=u.getoffsetX(R.glyphStartIndex),qe=u.getoffsetX(Ie-1),ke=zn(l*Le,A,d,b,M,Q,R.segment,Te,He,J,Ae,Be);if(!ke)return null;var Xe=zn(l*qe,A,d,b,M,Q,R.segment,Te,He,J,Ae,Be);return Xe?{first:ke,last:Xe}:null}function hi(l,u,A,d){return l===o.WritingMode.horizontal&&Math.abs(A.y-u.y)>Math.abs(A.x-u.x)*d?{useVertical:!0}:(l===o.WritingMode.vertical?u.y<A.y:u.x>A.x)?{needsFlipping:!0}:null}function Na(l,u,A,d,b,M,Q,R,J,Ae,Be,Ie,Te,He){var Le,qe=u/24,ke=l.lineOffsetX*qe,Xe=l.lineOffsetY*qe;if(l.numGlyphs>1){var et=l.glyphStartIndex+l.numGlyphs,at=l.lineStartIndex,mt=l.lineStartIndex+l.lineLength,Ze=Bi(qe,R,ke,Xe,A,Be,Ie,l,J,M,Te);if(!Ze)return{notEnoughRoom:!0};var bt=Sr(Ze.first.point,Q).point,Tt=Sr(Ze.last.point,Q).point;if(d&&!A){var Vt=hi(l.writingMode,bt,Tt,He);if(Vt)return Vt}Le=[Ze.first];for(var Ht=l.glyphStartIndex+1;Ht<et-1;Ht++)Le.push(zn(qe*R.getoffsetX(Ht),ke,Xe,A,Be,Ie,l.segment,at,mt,J,M,Te));Le.push(Ze.last)}else{if(d&&!A){var hr=Sr(Ie,b).point,Er=l.lineStartIndex+l.segment+1,Mr=new o.Point(J.getx(Er),J.gety(Er)),Ur=Sr(Mr,b),gi=Ur.signedDistanceFromCamera>0?Ur.point:Pa(Ie,Mr,hr,1,b),lr=hi(l.writingMode,hr,gi,He);if(lr)return lr}var zr=zn(qe*R.getoffsetX(l.glyphStartIndex),ke,Xe,A,Be,Ie,l.segment,l.lineStartIndex,l.lineStartIndex+l.lineLength,J,M,Te);if(!zr)return{notEnoughRoom:!0};Le=[zr]}for(var $r=0,qr=Le;$r<qr.length;$r+=1){var Zr=qr[$r];o.addDynamicAttributes(Ae,Zr.point,Zr.angle)}return{}}function Pa(l,u,A,d,b){var M=Sr(l.add(l.sub(u)._unit()),b).point,Q=A.sub(M);return A.add(Q._mult(d/Q.mag()))}function zn(l,u,A,d,b,M,Q,R,J,Ae,Be,Ie){var Te=d?l-u:l+u,He=Te>0?1:-1,Le=0;d&&(He*=-1,Le=Math.PI),He<0&&(Le+=Math.PI);for(var qe=He>0?R+Q:R+Q+1,ke=b,Xe=b,et=0,at=0,mt=Math.abs(Te),Ze=[];et+at<=mt;){if((qe+=He)<R||qe>=J)return null;if(Xe=ke,Ze.push(ke),(ke=Ie[qe])===void 0){var bt=new o.Point(Ae.getx(qe),Ae.gety(qe)),Tt=Sr(bt,Be);if(Tt.signedDistanceFromCamera>0)ke=Ie[qe]=Tt.point;else{var Vt=qe-He;ke=Pa(et===0?M:new o.Point(Ae.getx(Vt),Ae.gety(Vt)),bt,Xe,mt-et+1,Be)}}et+=at,at=Xe.dist(ke)}var Ht=(mt-et)/at,hr=ke.sub(Xe),Er=hr.mult(Ht)._add(Xe);Er._add(hr._unit()._perp()._mult(A*He));var Mr=Le+Math.atan2(ke.y-Xe.y,ke.x-Xe.x);return Ze.push(Er),{point:Er,angle:Mr,path:Ze}}Ar.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Ar.prototype.insert=function(l,u,A,d,b){this._forEachCell(u,A,d,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(u),this.bboxes.push(A),this.bboxes.push(d),this.bboxes.push(b)},Ar.prototype.insertCircle=function(l,u,A,d){this._forEachCell(u-d,A-d,u+d,A+d,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(u),this.circles.push(A),this.circles.push(d)},Ar.prototype._insertBoxCell=function(l,u,A,d,b,M){this.boxCells[b].push(M)},Ar.prototype._insertCircleCell=function(l,u,A,d,b,M){this.circleCells[b].push(M)},Ar.prototype._query=function(l,u,A,d,b,M){if(A<0||l>this.width||d<0||u>this.height)return!b&&[];var Q=[];if(l<=0&&u<=0&&this.width<=A&&this.height<=d){if(b)return!0;for(var R=0;R<this.boxKeys.length;R++)Q.push({key:this.boxKeys[R],x1:this.bboxes[4*R],y1:this.bboxes[4*R+1],x2:this.bboxes[4*R+2],y2:this.bboxes[4*R+3]});for(var J=0;J<this.circleKeys.length;J++){var Ae=this.circles[3*J],Be=this.circles[3*J+1],Ie=this.circles[3*J+2];Q.push({key:this.circleKeys[J],x1:Ae-Ie,y1:Be-Ie,x2:Ae+Ie,y2:Be+Ie})}return M?Q.filter(M):Q}return this._forEachCell(l,u,A,d,this._queryCell,Q,{hitTest:b,seenUids:{box:{},circle:{}}},M),b?Q.length>0:Q},Ar.prototype._queryCircle=function(l,u,A,d,b){var M=l-A,Q=l+A,R=u-A,J=u+A;if(Q<0||M>this.width||J<0||R>this.height)return!d&&[];var Ae=[];return this._forEachCell(M,R,Q,J,this._queryCellCircle,Ae,{hitTest:d,circle:{x:l,y:u,radius:A},seenUids:{box:{},circle:{}}},b),d?Ae.length>0:Ae},Ar.prototype.query=function(l,u,A,d,b){return this._query(l,u,A,d,!1,b)},Ar.prototype.hitTest=function(l,u,A,d,b){return this._query(l,u,A,d,!0,b)},Ar.prototype.hitTestCircle=function(l,u,A,d){return this._queryCircle(l,u,A,!0,d)},Ar.prototype._queryCell=function(l,u,A,d,b,M,Q,R){var J=Q.seenUids,Ae=this.boxCells[b];if(Ae!==null)for(var Be=this.bboxes,Ie=0,Te=Ae;Ie<Te.length;Ie+=1){var He=Te[Ie];if(!J.box[He]){J.box[He]=!0;var Le=4*He;if(l<=Be[Le+2]&&u<=Be[Le+3]&&A>=Be[Le+0]&&d>=Be[Le+1]&&(!R||R(this.boxKeys[He]))){if(Q.hitTest)return M.push(!0),!0;M.push({key:this.boxKeys[He],x1:Be[Le],y1:Be[Le+1],x2:Be[Le+2],y2:Be[Le+3]})}}}var qe=this.circleCells[b];if(qe!==null)for(var ke=this.circles,Xe=0,et=qe;Xe<et.length;Xe+=1){var at=et[Xe];if(!J.circle[at]){J.circle[at]=!0;var mt=3*at;if(this._circleAndRectCollide(ke[mt],ke[mt+1],ke[mt+2],l,u,A,d)&&(!R||R(this.circleKeys[at]))){if(Q.hitTest)return M.push(!0),!0;var Ze=ke[mt],bt=ke[mt+1],Tt=ke[mt+2];M.push({key:this.circleKeys[at],x1:Ze-Tt,y1:bt-Tt,x2:Ze+Tt,y2:bt+Tt})}}}},Ar.prototype._queryCellCircle=function(l,u,A,d,b,M,Q,R){var J=Q.circle,Ae=Q.seenUids,Be=this.boxCells[b];if(Be!==null)for(var Ie=this.bboxes,Te=0,He=Be;Te<He.length;Te+=1){var Le=He[Te];if(!Ae.box[Le]){Ae.box[Le]=!0;var qe=4*Le;if(this._circleAndRectCollide(J.x,J.y,J.radius,Ie[qe+0],Ie[qe+1],Ie[qe+2],Ie[qe+3])&&(!R||R(this.boxKeys[Le])))return M.push(!0),!0}}var ke=this.circleCells[b];if(ke!==null)for(var Xe=this.circles,et=0,at=ke;et<at.length;et+=1){var mt=at[et];if(!Ae.circle[mt]){Ae.circle[mt]=!0;var Ze=3*mt;if(this._circlesCollide(Xe[Ze],Xe[Ze+1],Xe[Ze+2],J.x,J.y,J.radius)&&(!R||R(this.circleKeys[mt])))return M.push(!0),!0}}},Ar.prototype._forEachCell=function(l,u,A,d,b,M,Q,R){for(var J=this._convertToXCellCoord(l),Ae=this._convertToYCellCoord(u),Be=this._convertToXCellCoord(A),Ie=this._convertToYCellCoord(d),Te=J;Te<=Be;Te++)for(var He=Ae;He<=Ie;He++)if(b.call(this,l,u,A,d,this.xCellCount*He+Te,M,Q,R))return},Ar.prototype._convertToXCellCoord=function(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))},Ar.prototype._convertToYCellCoord=function(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))},Ar.prototype._circlesCollide=function(l,u,A,d,b,M){var Q=d-l,R=b-u,J=A+M;return J*J>Q*Q+R*R},Ar.prototype._circleAndRectCollide=function(l,u,A,d,b,M,Q){var R=(M-d)/2,J=Math.abs(l-(d+R));if(J>R+A)return!1;var Ae=(Q-b)/2,Be=Math.abs(u-(b+Ae));if(Be>Ae+A)return!1;if(J<=R||Be<=Ae)return!0;var Ie=J-R,Te=Be-Ae;return Ie*Ie+Te*Te<=A*A};var js=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Eo(l,u){for(var A=0;A<l;A++){var d=u.length;u.resize(d+4),u.float32.set(js,3*d)}}function fi(l,u,A){var d=u[0],b=u[1];return l[0]=A[0]*d+A[4]*b+A[12],l[1]=A[1]*d+A[5]*b+A[13],l[3]=A[3]*d+A[7]*b+A[15],l}var vi=function(l,u,A){u===void 0&&(u=new Ar(l.width+200,l.height+200,25)),A===void 0&&(A=new Ar(l.width+200,l.height+200,25)),this.transform=l,this.grid=u,this.ignoredGrid=A,this.pitchfactor=Math.cos(l._pitch)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+100,this.screenBottomBoundary=l.height+100,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200};function Ni(l,u,A){return u*(o.EXTENT/(l.tileSize*Math.pow(2,A-l.tileID.overscaledZ)))}vi.prototype.placeCollisionBox=function(l,u,A,d,b){var M=this.projectAndGetPerspectiveRatio(d,l.anchorPointX,l.anchorPointY),Q=A*M.perspectiveRatio,R=l.x1*Q+M.point.x,J=l.y1*Q+M.point.y,Ae=l.x2*Q+M.point.x,Be=l.y2*Q+M.point.y;return!this.isInsideGrid(R,J,Ae,Be)||!u&&this.grid.hitTest(R,J,Ae,Be,b)?{box:[],offscreen:!1}:{box:[R,J,Ae,Be],offscreen:this.isOffscreen(R,J,Ae,Be)}},vi.prototype.placeCollisionCircles=function(l,u,A,d,b,M,Q,R,J,Ae,Be,Ie,Te){var He=[],Le=new o.Point(u.anchorX,u.anchorY),qe=Sr(Le,M),ke=Tr(this.transform.cameraToCenterDistance,qe.signedDistanceFromCamera),Xe=(Ae?b/ke:b*ke)/o.ONE_EM,et=Sr(Le,Q).point,at=Bi(Xe,d,u.lineOffsetX*Xe,u.lineOffsetY*Xe,!1,et,Le,u,A,Q,{}),mt=!1,Ze=!1,bt=!0;if(at){for(var Tt=.5*Ie*ke+Te,Vt=new o.Point(-100,-100),Ht=new o.Point(this.screenRightBoundary,this.screenBottomBoundary),hr=new or,Er=at.first,Mr=at.last,Ur=[],gi=Er.path.length-1;gi>=1;gi--)Ur.push(Er.path[gi]);for(var lr=1;lr<Mr.path.length;lr++)Ur.push(Mr.path[lr]);var zr=2.5*Tt;if(R){var $r=Ur.map(function(Ko){return Sr(Ko,R)});Ur=$r.some(function(Ko){return Ko.signedDistanceFromCamera<=0})?[]:$r.map(function(Ko){return Ko.point})}var qr=[];if(Ur.length>0){for(var Zr=Ur[0].clone(),si=Ur[0].clone(),Lr=1;Lr<Ur.length;Lr++)Zr.x=Math.min(Zr.x,Ur[Lr].x),Zr.y=Math.min(Zr.y,Ur[Lr].y),si.x=Math.max(si.x,Ur[Lr].x),si.y=Math.max(si.y,Ur[Lr].y);qr=Zr.x>=Vt.x&&si.x<=Ht.x&&Zr.y>=Vt.y&&si.y<=Ht.y?[Ur]:si.x<Vt.x||Zr.x>Ht.x||si.y<Vt.y||Zr.y>Ht.y?[]:o.clipLine([Ur],Vt.x,Vt.y,Ht.x,Ht.y)}for(var Dr=0,Kn=qr;Dr<Kn.length;Dr+=1){var dn;hr.reset(Kn[Dr],.25*Tt),dn=hr.length<=.5*Tt?1:Math.ceil(hr.paddedLength/zr)+1;for(var ao=0;ao<dn;ao++){var Vo=ao/Math.max(dn-1,1),Un=hr.lerp(Vo),vo=Un.x+100,Ea=Un.y+100;He.push(vo,Ea,Tt,0);var en=vo-Tt,ns=Ea-Tt,No=vo+Tt,ma=Ea+Tt;if(bt=bt&&this.isOffscreen(en,ns,No,ma),Ze=Ze||this.isInsideGrid(en,ns,No,ma),!l&&this.grid.hitTestCircle(vo,Ea,Tt,Be)&&(mt=!0,!J))return{circles:[],offscreen:!1,collisionDetected:mt}}}}return{circles:!J&&mt||!Ze?[]:He,offscreen:bt,collisionDetected:mt}},vi.prototype.queryRenderedSymbols=function(l){if(l.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var u=[],A=1/0,d=1/0,b=-1/0,M=-1/0,Q=0,R=l;Q<R.length;Q+=1){var J=R[Q],Ae=new o.Point(J.x+100,J.y+100);A=Math.min(A,Ae.x),d=Math.min(d,Ae.y),b=Math.max(b,Ae.x),M=Math.max(M,Ae.y),u.push(Ae)}for(var Be={},Ie={},Te=0,He=this.grid.query(A,d,b,M).concat(this.ignoredGrid.query(A,d,b,M));Te<He.length;Te+=1){var Le=He[Te],qe=Le.key;if(Be[qe.bucketInstanceId]===void 0&&(Be[qe.bucketInstanceId]={}),!Be[qe.bucketInstanceId][qe.featureIndex]){var ke=[new o.Point(Le.x1,Le.y1),new o.Point(Le.x2,Le.y1),new o.Point(Le.x2,Le.y2),new o.Point(Le.x1,Le.y2)];o.polygonIntersectsPolygon(u,ke)&&(Be[qe.bucketInstanceId][qe.featureIndex]=!0,Ie[qe.bucketInstanceId]===void 0&&(Ie[qe.bucketInstanceId]=[]),Ie[qe.bucketInstanceId].push(qe.featureIndex))}}return Ie},vi.prototype.insertCollisionBox=function(l,u,A,d,b){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:A,featureIndex:d,collisionGroupID:b},l[0],l[1],l[2],l[3])},vi.prototype.insertCollisionCircles=function(l,u,A,d,b){for(var M=u?this.ignoredGrid:this.grid,Q={bucketInstanceId:A,featureIndex:d,collisionGroupID:b},R=0;R<l.length;R+=4)M.insertCircle(Q,l[R],l[R+1],l[R+2])},vi.prototype.projectAndGetPerspectiveRatio=function(l,u,A){var d=[u,A,0,1];return fi(d,d,l),{point:new o.Point((d[0]/d[3]+1)/2*this.transform.width+100,(-d[1]/d[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/d[3]*.5}},vi.prototype.isOffscreen=function(l,u,A,d){return A<100||l>=this.screenRightBoundary||d<100||u>this.screenBottomBoundary},vi.prototype.isInsideGrid=function(l,u,A,d){return A>=0&&l<this.gridRightBoundary&&d>=0&&u<this.gridBottomBoundary},vi.prototype.getViewportMatrix=function(){var l=o.identity([]);return o.translate(l,l,[-100,-100,0]),l};var go=function(l,u,A,d){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?u:-u))):d&&A?1:0,this.placed=A};go.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var Uo=function(l,u,A,d,b){this.text=new go(l?l.text:null,u,A,b),this.icon=new go(l?l.icon:null,u,d,b)};Uo.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var ea=function(l,u,A){this.text=l,this.icon=u,this.skipFade=A},Dn=function(){this.invProjMatrix=o.create(),this.viewportMatrix=o.create(),this.circles=[]},Aa=function(l,u,A,d,b){this.bucketInstanceId=l,this.featureIndex=u,this.sourceLayerIndex=A,this.bucketIndex=d,this.tileID=b},co=function(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}};function hn(l,u,A,d,b){var M=o.getAnchorAlignment(l),Q=-(M.horizontalAlign-.5)*u,R=-(M.verticalAlign-.5)*A,J=o.evaluateVariableOffset(l,d);return new o.Point(Q+J[0]*b,R+J[1]*b)}function Io(l,u,A,d,b,M){var Q=l.x1,R=l.x2,J=l.y1,Ae=l.y2,Be=l.anchorPointX,Ie=l.anchorPointY,Te=new o.Point(u,A);return d&&Te._rotate(b?M:-M),{x1:Q+Te.x,y1:J+Te.y,x2:R+Te.x,y2:Ae+Te.y,anchorPointX:Be,anchorPointY:Ie}}co.prototype.get=function(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){var u=++this.maxGroupID;this.collisionGroups[l]={ID:u,predicate:function(A){return A.collisionGroupID===u}}}return this.collisionGroups[l]};var Sn=function(l,u,A,d){this.transform=l.clone(),this.collisionIndex=new vi(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new co(A),this.collisionCircleArrays={},this.prevPlacement=d,d&&(d.prevPlacement=void 0),this.placedOrientations={}};function Ka(l,u,A,d,b){l.emplaceBack(u?1:0,A?1:0,d||0,b||0),l.emplaceBack(u?1:0,A?1:0,d||0,b||0),l.emplaceBack(u?1:0,A?1:0,d||0,b||0),l.emplaceBack(u?1:0,A?1:0,d||0,b||0)}Sn.prototype.getBucketParts=function(l,u,A,d){var b=A.getBucket(u),M=A.latestFeatureIndex;if(b&&M&&u.id===b.layerIds[0]){var Q=A.collisionBoxArray,R=b.layers[0].layout,J=Math.pow(2,this.transform.zoom-A.tileID.overscaledZ),Ae=A.tileSize/o.EXTENT,Be=this.transform.calculatePosMatrix(A.tileID.toUnwrapped()),Ie=R.get("text-pitch-alignment")==="map",Te=R.get("text-rotation-alignment")==="map",He=Ni(A,1,this.transform.zoom),Le=Br(Be,Ie,Te,this.transform,He),qe=null;if(Ie){var ke=vr(Be,Ie,Te,this.transform,He);qe=o.multiply([],this.transform.labelPlaneMatrix,ke)}this.retainedQueryData[b.bucketInstanceId]=new Aa(b.bucketInstanceId,M,b.sourceLayerIndex,b.index,A.tileID);var Xe={bucket:b,layout:R,posMatrix:Be,textLabelPlaneMatrix:Le,labelToScreenMatrix:qe,scale:J,textPixelRatio:Ae,holdingForFade:A.holdingForFade(),collisionBoxArray:Q,partiallyEvaluatedTextSize:o.evaluateSizeForZoom(b.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(b.sourceID)};if(d)for(var et=0,at=b.sortKeyRanges;et<at.length;et+=1){var mt=at[et];l.push({sortKey:mt.sortKey,symbolInstanceStart:mt.symbolInstanceStart,symbolInstanceEnd:mt.symbolInstanceEnd,parameters:Xe})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:b.symbolInstances.length,parameters:Xe})}},Sn.prototype.attemptAnchorPlacement=function(l,u,A,d,b,M,Q,R,J,Ae,Be,Ie,Te,He,Le){var qe,ke=[Ie.textOffset0,Ie.textOffset1],Xe=hn(l,A,d,ke,b),et=this.collisionIndex.placeCollisionBox(Io(u,Xe.x,Xe.y,M,Q,this.transform.angle),Be,R,J,Ae.predicate);if(!Le||this.collisionIndex.placeCollisionBox(Io(Le,Xe.x,Xe.y,M,Q,this.transform.angle),Be,R,J,Ae.predicate).box.length!==0)return et.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[Ie.crossTileID]&&this.prevPlacement.placements[Ie.crossTileID]&&this.prevPlacement.placements[Ie.crossTileID].text&&(qe=this.prevPlacement.variableOffsets[Ie.crossTileID].anchor),this.variableOffsets[Ie.crossTileID]={textOffset:ke,width:A,height:d,anchor:l,textBoxScale:b,prevAnchor:qe},this.markUsedJustification(Te,l,Ie,He),Te.allowVerticalPlacement&&(this.markUsedOrientation(Te,He,Ie),this.placedOrientations[Ie.crossTileID]=He),{shift:Xe,placedGlyphBoxes:et}):void 0},Sn.prototype.placeLayerBucketPart=function(l,u,A){var d=this,b=l.parameters,M=b.bucket,Q=b.layout,R=b.posMatrix,J=b.textLabelPlaneMatrix,Ae=b.labelToScreenMatrix,Be=b.textPixelRatio,Ie=b.holdingForFade,Te=b.collisionBoxArray,He=b.partiallyEvaluatedTextSize,Le=b.collisionGroup,qe=Q.get("text-optional"),ke=Q.get("icon-optional"),Xe=Q.get("text-allow-overlap"),et=Q.get("icon-allow-overlap"),at=Q.get("text-rotation-alignment")==="map",mt=Q.get("text-pitch-alignment")==="map",Ze=Q.get("icon-text-fit")!=="none",bt=Q.get("symbol-z-order")==="viewport-y",Tt=Xe&&(et||!M.hasIconData()||ke),Vt=et&&(Xe||!M.hasTextData()||qe);!M.collisionArrays&&Te&&M.deserializeCollisionBoxes(Te);var Ht=function(lr,zr){if(!u[lr.crossTileID])if(Ie)d.placements[lr.crossTileID]=new ea(!1,!1,!1);else{var $r,qr=!1,Zr=!1,si=!0,Lr=null,Dr={box:null,offscreen:null},Kn={box:null,offscreen:null},dn=null,ao=null,Vo=0,Un=0,vo=0;zr.textFeatureIndex?Vo=zr.textFeatureIndex:lr.useRuntimeCollisionCircles&&(Vo=lr.featureIndex),zr.verticalTextFeatureIndex&&(Un=zr.verticalTextFeatureIndex);var Ea=zr.textBox;if(Ea){var en=function(tn){var ga=o.WritingMode.horizontal;if(M.allowVerticalPlacement&&!tn&&d.prevPlacement){var na=d.prevPlacement.placedOrientations[lr.crossTileID];na&&(d.placedOrientations[lr.crossTileID]=na,d.markUsedOrientation(M,ga=na,lr))}return ga},ns=function(tn,ga){if(M.allowVerticalPlacement&&lr.numVerticalGlyphVertices>0&&zr.verticalTextBox)for(var na=0,ko=M.writingModes;na<ko.length&&(ko[na]===o.WritingMode.vertical?(Dr=ga(),Kn=Dr):Dr=tn(),!(Dr&&Dr.box&&Dr.box.length));na+=1);else Dr=tn()};if(Q.get("text-variable-anchor")){var No=Q.get("text-variable-anchor");if(d.prevPlacement&&d.prevPlacement.variableOffsets[lr.crossTileID]){var ma=d.prevPlacement.variableOffsets[lr.crossTileID];No.indexOf(ma.anchor)>0&&(No=No.filter(function(tn){return tn!==ma.anchor})).unshift(ma.anchor)}var Ko=function(tn,ga,na){for(var ko=tn.x2-tn.x1,Nc=tn.y2-tn.y1,yc=lr.textBoxScale,Ia=Ze&&!et?ga:null,Go={box:[],offscreen:!1},Kc=Xe?2*No.length:No.length,Gl=0;Gl<Kc;++Gl){var XA=d.attemptAnchorPlacement(No[Gl%No.length],tn,ko,Nc,yc,at,mt,Be,R,Le,Gl>=No.length,lr,M,na,Ia);if(XA&&(Go=XA.placedGlyphBoxes)&&Go.box&&Go.box.length){qr=!0,Lr=XA.shift;break}}return Go};ns(function(){return Ko(Ea,zr.iconBox,o.WritingMode.horizontal)},function(){var tn=zr.verticalTextBox;return M.allowVerticalPlacement&&!(Dr&&Dr.box&&Dr.box.length)&&lr.numVerticalGlyphVertices>0&&tn?Ko(tn,zr.verticalIconBox,o.WritingMode.vertical):{box:null,offscreen:null}}),Dr&&(qr=Dr.box,si=Dr.offscreen);var sl=en(Dr&&Dr.box);if(!qr&&d.prevPlacement){var xl=d.prevPlacement.variableOffsets[lr.crossTileID];xl&&(d.variableOffsets[lr.crossTileID]=xl,d.markUsedJustification(M,xl.anchor,lr,sl))}}else{var ll=function(tn,ga){var na=d.collisionIndex.placeCollisionBox(tn,Xe,Be,R,Le.predicate);return na&&na.box&&na.box.length&&(d.markUsedOrientation(M,ga,lr),d.placedOrientations[lr.crossTileID]=ga),na};ns(function(){return ll(Ea,o.WritingMode.horizontal)},function(){var tn=zr.verticalTextBox;return M.allowVerticalPlacement&&lr.numVerticalGlyphVertices>0&&tn?ll(tn,o.WritingMode.vertical):{box:null,offscreen:null}}),en(Dr&&Dr.box&&Dr.box.length)}}if(qr=($r=Dr)&&$r.box&&$r.box.length>0,si=$r&&$r.offscreen,lr.useRuntimeCollisionCircles){var IA=M.text.placedSymbolArray.get(lr.centerJustifiedTextSymbolIndex),AA=o.evaluateSizeForFeature(M.textSizeData,He,IA),bs=Q.get("text-padding");dn=d.collisionIndex.placeCollisionCircles(Xe,IA,M.lineVertexArray,M.glyphOffsetArray,AA,R,J,Ae,A,mt,Le.predicate,lr.collisionCircleDiameter,bs),qr=Xe||dn.circles.length>0&&!dn.collisionDetected,si=si&&dn.offscreen}if(zr.iconFeatureIndex&&(vo=zr.iconFeatureIndex),zr.iconBox){var wl=function(tn){var ga=Ze&&Lr?Io(tn,Lr.x,Lr.y,at,mt,d.transform.angle):tn;return d.collisionIndex.placeCollisionBox(ga,et,Be,R,Le.predicate)};Zr=Kn&&Kn.box&&Kn.box.length&&zr.verticalIconBox?(ao=wl(zr.verticalIconBox)).box.length>0:(ao=wl(zr.iconBox)).box.length>0,si=si&&ao.offscreen}var Vs=qe||lr.numHorizontalGlyphVertices===0&&lr.numVerticalGlyphVertices===0,xo=ke||lr.numIconVertices===0;if(Vs||xo?xo?Vs||(Zr=Zr&&qr):qr=Zr&&qr:Zr=qr=Zr&&qr,qr&&$r&&$r.box&&d.collisionIndex.insertCollisionBox($r.box,Q.get("text-ignore-placement"),M.bucketInstanceId,Kn&&Kn.box&&Un?Un:Vo,Le.ID),Zr&&ao&&d.collisionIndex.insertCollisionBox(ao.box,Q.get("icon-ignore-placement"),M.bucketInstanceId,vo,Le.ID),dn&&(qr&&d.collisionIndex.insertCollisionCircles(dn.circles,Q.get("text-ignore-placement"),M.bucketInstanceId,Vo,Le.ID),A)){var Ns=M.bucketInstanceId,Al=d.collisionCircleArrays[Ns];Al===void 0&&(Al=d.collisionCircleArrays[Ns]=new Dn);for(var Wa=0;Wa<dn.circles.length;Wa+=4)Al.circles.push(dn.circles[Wa+0]),Al.circles.push(dn.circles[Wa+1]),Al.circles.push(dn.circles[Wa+2]),Al.circles.push(dn.collisionDetected?1:0)}d.placements[lr.crossTileID]=new ea(qr||Tt,Zr||Vt,si||M.justReloaded),u[lr.crossTileID]=!0}};if(bt)for(var hr=M.getSortedSymbolIndexes(this.transform.angle),Er=hr.length-1;Er>=0;--Er){var Mr=hr[Er];Ht(M.symbolInstances.get(Mr),M.collisionArrays[Mr])}else for(var Ur=l.symbolInstanceStart;Ur<l.symbolInstanceEnd;Ur++)Ht(M.symbolInstances.get(Ur),M.collisionArrays[Ur]);if(A&&M.bucketInstanceId in this.collisionCircleArrays){var gi=this.collisionCircleArrays[M.bucketInstanceId];o.invert(gi.invProjMatrix,R),gi.viewportMatrix=this.collisionIndex.getViewportMatrix()}M.justReloaded=!1},Sn.prototype.markUsedJustification=function(l,u,A,d){var b;b=d===o.WritingMode.vertical?A.verticalPlacedTextSymbolIndex:{left:A.leftJustifiedTextSymbolIndex,center:A.centerJustifiedTextSymbolIndex,right:A.rightJustifiedTextSymbolIndex}[o.getAnchorJustification(u)];for(var M=0,Q=[A.leftJustifiedTextSymbolIndex,A.centerJustifiedTextSymbolIndex,A.rightJustifiedTextSymbolIndex,A.verticalPlacedTextSymbolIndex];M<Q.length;M+=1){var R=Q[M];R>=0&&(l.text.placedSymbolArray.get(R).crossTileID=b>=0&&R!==b?0:A.crossTileID)}},Sn.prototype.markUsedOrientation=function(l,u,A){for(var d=u===o.WritingMode.horizontal||u===o.WritingMode.horizontalOnly?u:0,b=u===o.WritingMode.vertical?u:0,M=0,Q=[A.leftJustifiedTextSymbolIndex,A.centerJustifiedTextSymbolIndex,A.rightJustifiedTextSymbolIndex];M<Q.length;M+=1)l.text.placedSymbolArray.get(Q[M]).placedOrientation=d;A.verticalPlacedTextSymbolIndex&&(l.text.placedSymbolArray.get(A.verticalPlacedTextSymbolIndex).placedOrientation=b)},Sn.prototype.commit=function(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;var u=this.prevPlacement,A=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;var d=u?u.symbolFadeChange(l):1,b=u?u.opacities:{},M=u?u.variableOffsets:{},Q=u?u.placedOrientations:{};for(var R in this.placements){var J=this.placements[R],Ae=b[R];Ae?(this.opacities[R]=new Uo(Ae,d,J.text,J.icon),A=A||J.text!==Ae.text.placed||J.icon!==Ae.icon.placed):(this.opacities[R]=new Uo(null,d,J.text,J.icon,J.skipFade),A=A||J.text||J.icon)}for(var Be in b){var Ie=b[Be];if(!this.opacities[Be]){var Te=new Uo(Ie,d,!1,!1);Te.isHidden()||(this.opacities[Be]=Te,A=A||Ie.text.placed||Ie.icon.placed)}}for(var He in M)this.variableOffsets[He]||!this.opacities[He]||this.opacities[He].isHidden()||(this.variableOffsets[He]=M[He]);for(var Le in Q)this.placedOrientations[Le]||!this.opacities[Le]||this.opacities[Le].isHidden()||(this.placedOrientations[Le]=Q[Le]);A?this.lastPlacementChangeTime=l:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:l)},Sn.prototype.updateLayerOpacities=function(l,u){for(var A={},d=0,b=u;d<b.length;d+=1){var M=b[d],Q=M.getBucket(l);Q&&M.latestFeatureIndex&&l.id===Q.layerIds[0]&&this.updateBucketOpacities(Q,A,M.collisionBoxArray)}},Sn.prototype.updateBucketOpacities=function(l,u,A){var d=this;l.hasTextData()&&l.text.opacityVertexArray.clear(),l.hasIconData()&&l.icon.opacityVertexArray.clear(),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();var b=l.layers[0].layout,M=new Uo(null,0,!1,!1,!0),Q=b.get("text-allow-overlap"),R=b.get("icon-allow-overlap"),J=b.get("text-variable-anchor"),Ae=b.get("text-rotation-alignment")==="map",Be=b.get("text-pitch-alignment")==="map",Ie=b.get("icon-text-fit")!=="none",Te=new Uo(null,0,Q&&(R||!l.hasIconData()||b.get("icon-optional")),R&&(Q||!l.hasTextData()||b.get("text-optional")),!0);!l.collisionArrays&&A&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(A);for(var He=function(Xe,et,at){for(var mt=0;mt<et/4;mt++)Xe.opacityVertexArray.emplaceBack(at)},Le=function(Xe){var et=l.symbolInstances.get(Xe),at=et.numHorizontalGlyphVertices,mt=et.numVerticalGlyphVertices,Ze=et.crossTileID,bt=d.opacities[Ze];u[Ze]?bt=M:bt||(d.opacities[Ze]=bt=Te),u[Ze]=!0;var Tt=et.numIconVertices>0,Vt=d.placedOrientations[et.crossTileID],Ht=Vt===o.WritingMode.vertical,hr=Vt===o.WritingMode.horizontal||Vt===o.WritingMode.horizontalOnly;if(at>0||mt>0){var Er=ya(bt.text);He(l.text,at,Ht?$s:Er),He(l.text,mt,hr?$s:Er);var Mr=bt.text.isHidden();[et.rightJustifiedTextSymbolIndex,et.centerJustifiedTextSymbolIndex,et.leftJustifiedTextSymbolIndex].forEach(function(Dr){Dr>=0&&(l.text.placedSymbolArray.get(Dr).hidden=Mr||Ht?1:0)}),et.verticalPlacedTextSymbolIndex>=0&&(l.text.placedSymbolArray.get(et.verticalPlacedTextSymbolIndex).hidden=Mr||hr?1:0);var Ur=d.variableOffsets[et.crossTileID];Ur&&d.markUsedJustification(l,Ur.anchor,et,Vt);var gi=d.placedOrientations[et.crossTileID];gi&&(d.markUsedJustification(l,"left",et,gi),d.markUsedOrientation(l,gi,et))}if(Tt){var lr=ya(bt.icon),zr=!(Ie&&et.verticalPlacedIconSymbolIndex&&Ht);et.placedIconSymbolIndex>=0&&(He(l.icon,et.numIconVertices,zr?lr:$s),l.icon.placedSymbolArray.get(et.placedIconSymbolIndex).hidden=bt.icon.isHidden()),et.verticalPlacedIconSymbolIndex>=0&&(He(l.icon,et.numVerticalIconVertices,zr?$s:lr),l.icon.placedSymbolArray.get(et.verticalPlacedIconSymbolIndex).hidden=bt.icon.isHidden())}if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){var $r=l.collisionArrays[Xe];if($r){var qr=new o.Point(0,0);if($r.textBox||$r.verticalTextBox){var Zr=!0;if(J){var si=d.variableOffsets[Ze];si?(qr=hn(si.anchor,si.width,si.height,si.textOffset,si.textBoxScale),Ae&&qr._rotate(Be?d.transform.angle:-d.transform.angle)):Zr=!1}$r.textBox&&Ka(l.textCollisionBox.collisionVertexArray,bt.text.placed,!Zr||Ht,qr.x,qr.y),$r.verticalTextBox&&Ka(l.textCollisionBox.collisionVertexArray,bt.text.placed,!Zr||hr,qr.x,qr.y)}var Lr=Boolean(!hr&&$r.verticalIconBox);$r.iconBox&&Ka(l.iconCollisionBox.collisionVertexArray,bt.icon.placed,Lr,Ie?qr.x:0,Ie?qr.y:0),$r.verticalIconBox&&Ka(l.iconCollisionBox.collisionVertexArray,bt.icon.placed,!Lr,Ie?qr.x:0,Ie?qr.y:0)}}},qe=0;qe<l.symbolInstances.length;qe++)Le(qe);if(l.sortFeatures(this.transform.angle),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.bucketInstanceId in this.collisionCircleArrays){var ke=this.collisionCircleArrays[l.bucketInstanceId];l.placementInvProjMatrix=ke.invProjMatrix,l.placementViewportMatrix=ke.viewportMatrix,l.collisionCircleArray=ke.circles,delete this.collisionCircleArrays[l.bucketInstanceId]}},Sn.prototype.symbolFadeChange=function(l){return this.fadeDuration===0?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Sn.prototype.zoomAdjustment=function(l){return Math.max(0,(this.transform.zoom-l)/1.5)},Sn.prototype.hasTransitions=function(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration},Sn.prototype.stillRecent=function(l,u){var A=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*A>l},Sn.prototype.setStale=function(){this.stale=!0};var Qa=Math.pow(2,25),Fs=Math.pow(2,24),pn=Math.pow(2,17),hs=Math.pow(2,16),kl=Math.pow(2,9),fl=Math.pow(2,8),Us=Math.pow(2,1);function ya(l){if(l.opacity===0&&!l.placed)return 0;if(l.opacity===1&&l.placed)return 4294967295;var u=l.placed?1:0,A=Math.floor(127*l.opacity);return A*Qa+u*Fs+A*pn+u*hs+A*kl+u*fl+A*Us+u}var $s=0,vA=function(l){this._sortAcrossTiles=l.layout.get("symbol-z-order")!=="viewport-y"&&l.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};vA.prototype.continuePlacement=function(l,u,A,d,b){for(var M=this._bucketParts;this._currentTileIndex<l.length;)if(u.getBucketParts(M,d,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,M.sort(function(Q,R){return Q.sortKey-R.sortKey}));this._currentPartIndex<M.length;)if(u.placeLayerBucketPart(M[this._currentPartIndex],this._seenCrossTileIDs,A),this._currentPartIndex++,b())return!0;return!1};var Pl=function(l,u,A,d,b,M,Q){this.placement=new Sn(l,b,M,Q),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=A,this._showCollisionBoxes=d,this._done=!1};Pl.prototype.isDone=function(){return this._done},Pl.prototype.continuePlacement=function(l,u,A){for(var d=this,b=o.browser.now(),M=function(){var J=o.browser.now()-b;return!d._forceFullPlacement&&J>2};this._currentPlacementIndex>=0;){var Q=u[l[this._currentPlacementIndex]],R=this.placement.collisionIndex.transform.zoom;if(Q.type==="symbol"&&(!Q.minzoom||Q.minzoom<=R)&&(!Q.maxzoom||Q.maxzoom>R)){if(this._inProgressLayer||(this._inProgressLayer=new vA(Q)),this._inProgressLayer.continuePlacement(A[Q.source],this.placement,this._showCollisionBoxes,Q,M))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Pl.prototype.commit=function(l){return this.placement.commit(l),this.placement};var xA=512/o.EXTENT/2,Ql=function(l,u,A){this.tileID=l,this.indexedSymbolInstances={},this.bucketInstanceId=A;for(var d=0;d<u.length;d++){var b=u.get(d),M=b.key;this.indexedSymbolInstances[M]||(this.indexedSymbolInstances[M]=[]),this.indexedSymbolInstances[M].push({crossTileID:b.crossTileID,coord:this.getScaledCoordinates(b,l)})}};Ql.prototype.getScaledCoordinates=function(l,u){var A=xA/Math.pow(2,u.canonical.z-this.tileID.canonical.z);return{x:Math.floor((u.canonical.x*o.EXTENT+l.anchorX)*A),y:Math.floor((u.canonical.y*o.EXTENT+l.anchorY)*A)}},Ql.prototype.findMatches=function(l,u,A){for(var d=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z),b=0;b<l.length;b++){var M=l.get(b);if(!M.crossTileID){var Q=this.indexedSymbolInstances[M.key];if(Q)for(var R=this.getScaledCoordinates(M,u),J=0,Ae=Q;J<Ae.length;J+=1){var Be=Ae[J];if(Math.abs(Be.coord.x-R.x)<=d&&Math.abs(Be.coord.y-R.y)<=d&&!A[Be.crossTileID]){A[Be.crossTileID]=!0,M.crossTileID=Be.crossTileID;break}}}}};var _a=function(){this.maxCrossTileID=0};_a.prototype.generate=function(){return++this.maxCrossTileID};var Ya=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Ya.prototype.handleWrapJump=function(l){var u=Math.round((l-this.lng)/360);if(u!==0)for(var A in this.indexes){var d=this.indexes[A],b={};for(var M in d){var Q=d[M];Q.tileID=Q.tileID.unwrapTo(Q.tileID.wrap+u),b[Q.tileID.key]=Q}this.indexes[A]=b}this.lng=l},Ya.prototype.addBucket=function(l,u,A){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(var d=0;d<u.symbolInstances.length;d++)u.symbolInstances.get(d).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]={});var b=this.usedCrossTileIDs[l.overscaledZ];for(var M in this.indexes){var Q=this.indexes[M];if(Number(M)>l.overscaledZ)for(var R in Q){var J=Q[R];J.tileID.isChildOf(l)&&J.findMatches(u.symbolInstances,l,b)}else{var Ae=Q[l.scaledTo(Number(M)).key];Ae&&Ae.findMatches(u.symbolInstances,l,b)}}for(var Be=0;Be<u.symbolInstances.length;Be++){var Ie=u.symbolInstances.get(Be);Ie.crossTileID||(Ie.crossTileID=A.generate(),b[Ie.crossTileID]=!0)}return this.indexes[l.overscaledZ]===void 0&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new Ql(l,u.symbolInstances,u.bucketInstanceId),!0},Ya.prototype.removeBucketCrossTileIDs=function(l,u){for(var A in u.indexedSymbolInstances)for(var d=0,b=u.indexedSymbolInstances[A];d<b.length;d+=1)delete this.usedCrossTileIDs[l][b[d].crossTileID]},Ya.prototype.removeStaleBuckets=function(l){var u=!1;for(var A in this.indexes){var d=this.indexes[A];for(var b in d)l[d[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(A,d[b]),delete d[b],u=!0)}return u};var Ti=function(){this.layerIndexes={},this.crossTileIDs=new _a,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Ti.prototype.addLayer=function(l,u,A){var d=this.layerIndexes[l.id];d===void 0&&(d=this.layerIndexes[l.id]=new Ya);var b=!1,M={};d.handleWrapJump(A);for(var Q=0,R=u;Q<R.length;Q+=1){var J=R[Q],Ae=J.getBucket(l);Ae&&l.id===Ae.layerIds[0]&&(Ae.bucketInstanceId||(Ae.bucketInstanceId=++this.maxBucketInstanceId),d.addBucket(J.tileID,Ae,this.crossTileIDs)&&(b=!0),M[Ae.bucketInstanceId]=!0)}return d.removeStaleBuckets(M)&&(b=!0),b},Ti.prototype.pruneUnusedLayers=function(l){var u={};for(var A in l.forEach(function(d){u[d]=!0}),this.layerIndexes)u[A]||delete this.layerIndexes[A]};var Ms=function(l,u){return o.emitValidationErrors(l,u&&u.filter(function(A){return A.identifier!=="source.canvas"}))},qs=o.pick(ct,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Ga=o.pick(ct,["setCenter","setZoom","setBearing","setPitch"]),uo=function(){var l={},u=o.styleSpec.$version;for(var A in o.styleSpec.$root){var d,b=o.styleSpec.$root[A];b.required&&(d=A==="version"?u:b.type==="array"?[]:{})!=null&&(l[A]=d)}return l}(),ca=function(l){function u(A,d){var b=this;d===void 0&&(d={}),l.call(this),this.map=A,this.dispatcher=new kt(ve(),this),this.imageManager=new Bt,this.imageManager.setEventedParent(this),this.glyphManager=new ur(A._requestManager,d.localIdeographFontFamily),this.lineAtlas=new rr(256,512),this.crossTileSymbolIndex=new Ti,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.getReferrer());var M=this;this._rtlTextPluginCallback=u.registerForPluginStateChange(function(Q){M.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:Q.pluginStatus,pluginURL:Q.pluginURL},function(R,J){if(o.triggerPluginCompletionEvent(R),J&&J.every(function(Be){return Be}))for(var Ae in M.sourceCaches)M.sourceCaches[Ae].reload()})}),this.on("data",function(Q){if(Q.dataType==="source"&&Q.sourceDataType==="metadata"){var R=b.sourceCaches[Q.sourceId];if(R){var J=R.getSource();if(J&&J.vectorLayerIds)for(var Ae in b._layers){var Be=b._layers[Ae];Be.source===J.id&&b._validateLayer(Be)}}}})}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.loadURL=function(A,d){var b=this;d===void 0&&(d={}),this.fire(new o.Event("dataloading",{dataType:"style"}));var M=typeof d.validate=="boolean"?d.validate:!o.isMapboxURL(A);A=this.map._requestManager.normalizeStyleURL(A,d.accessToken);var Q=this.map._requestManager.transformRequest(A,o.ResourceType.Style);this._request=o.getJSON(Q,function(R,J){b._request=null,R?b.fire(new o.ErrorEvent(R)):J&&b._load(J,M)})},u.prototype.loadJSON=function(A,d){var b=this;d===void 0&&(d={}),this.fire(new o.Event("dataloading",{dataType:"style"})),this._request=o.browser.frame(function(){b._request=null,b._load(A,d.validate!==!1)})},u.prototype.loadEmpty=function(){this.fire(new o.Event("dataloading",{dataType:"style"})),this._load(uo,!1)},u.prototype._load=function(A,d){if(!d||!Ms(this,o.validateStyle(A))){for(var b in this._loaded=!0,this.stylesheet=A,A.sources)this.addSource(b,A.sources[b],{validate:!1});A.sprite?this._loadSprite(A.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(A.glyphs);var M=Je(this.stylesheet.layers);this._order=M.map(function(Ae){return Ae.id}),this._layers={},this._serializedLayers={};for(var Q=0,R=M;Q<R.length;Q+=1){var J=R[Q];(J=o.createStyleLayer(J)).setEventedParent(this,{layer:{id:J.id}}),this._layers[J.id]=J,this._serializedLayers[J.id]=J.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ei(this.stylesheet.light),this.fire(new o.Event("data",{dataType:"style"})),this.fire(new o.Event("style.load"))}},u.prototype._loadSprite=function(A){var d=this;this._spriteRequest=function(b,M,Q){var R,J,Ae,Be=o.browser.devicePixelRatio>1?"@2x":"",Ie=o.getJSON(M.transformRequest(M.normalizeSpriteURL(b,Be,".json"),o.ResourceType.SpriteJSON),function(Le,qe){Ie=null,Ae||(Ae=Le,R=qe,He())}),Te=o.getImage(M.transformRequest(M.normalizeSpriteURL(b,Be,".png"),o.ResourceType.SpriteImage),function(Le,qe){Te=null,Ae||(Ae=Le,J=qe,He())});function He(){if(Ae)Q(Ae);else if(R&&J){var Le=o.browser.getImageData(J),qe={};for(var ke in R){var Xe=R[ke],et=Xe.width,at=Xe.height,mt=Xe.x,Ze=Xe.y,bt=Xe.sdf,Tt=Xe.pixelRatio,Vt=Xe.stretchX,Ht=Xe.stretchY,hr=Xe.content,Er=new o.RGBAImage({width:et,height:at});o.RGBAImage.copy(Le,Er,{x:mt,y:Ze},{x:0,y:0},{width:et,height:at}),qe[ke]={data:Er,pixelRatio:Tt,sdf:bt,stretchX:Vt,stretchY:Ht,content:hr}}Q(null,qe)}}return{cancel:function(){Ie&&(Ie.cancel(),Ie=null),Te&&(Te.cancel(),Te=null)}}}(A,this.map._requestManager,function(b,M){if(d._spriteRequest=null,b)d.fire(new o.ErrorEvent(b));else if(M)for(var Q in M)d.imageManager.addImage(Q,M[Q]);d.imageManager.setLoaded(!0),d._availableImages=d.imageManager.listImages(),d.dispatcher.broadcast("setImages",d._availableImages),d.fire(new o.Event("data",{dataType:"style"}))})},u.prototype._validateLayer=function(A){var d=this.sourceCaches[A.source];if(d){var b=A.sourceLayer;if(b){var M=d.getSource();(M.type==="geojson"||M.vectorLayerIds&&M.vectorLayerIds.indexOf(b)===-1)&&this.fire(new o.ErrorEvent(new Error('Source layer "'+b+'" does not exist on source "'+M.id+'" as specified by style layer "'+A.id+'"')))}}},u.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var A in this.sourceCaches)if(!this.sourceCaches[A].loaded())return!1;return!!this.imageManager.isLoaded()},u.prototype._serializeLayers=function(A){for(var d=[],b=0,M=A;b<M.length;b+=1){var Q=this._layers[M[b]];Q.type!=="custom"&&d.push(Q.serialize())}return d},u.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var A in this.sourceCaches)if(this.sourceCaches[A].hasTransition())return!0;for(var d in this._layers)if(this._layers[d].hasTransition())return!0;return!1},u.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},u.prototype.update=function(A){if(this._loaded){var d=this._changed;if(this._changed){var b=Object.keys(this._updatedLayers),M=Object.keys(this._removedLayers);for(var Q in(b.length||M.length)&&this._updateWorkerLayers(b,M),this._updatedSources){var R=this._updatedSources[Q];R==="reload"?this._reloadSource(Q):R==="clear"&&this._clearSource(Q)}for(var J in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[J].updateTransitions(A);this.light.updateTransitions(A),this._resetUpdates()}var Ae={};for(var Be in this.sourceCaches){var Ie=this.sourceCaches[Be];Ae[Be]=Ie.used,Ie.used=!1}for(var Te=0,He=this._order;Te<He.length;Te+=1){var Le=this._layers[He[Te]];Le.recalculate(A,this._availableImages),!Le.isHidden(A.zoom)&&Le.source&&(this.sourceCaches[Le.source].used=!0)}for(var qe in Ae){var ke=this.sourceCaches[qe];Ae[qe]!==ke.used&&ke.fire(new o.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:qe}))}this.light.recalculate(A),this.z=A.zoom,d&&this.fire(new o.Event("data",{dataType:"style"}))}},u.prototype._updateTilesForChangedImages=function(){var A=Object.keys(this._changedImages);if(A.length){for(var d in this.sourceCaches)this.sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],A);this._changedImages={}}},u.prototype._updateWorkerLayers=function(A,d){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(A),removedIds:d})},u.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},u.prototype.setState=function(A){var d=this;if(this._checkLoaded(),Ms(this,o.validateStyle(A)))return!1;(A=o.clone$1(A)).layers=Je(A.layers);var b=function(Q,R){if(!Q)return[{command:ct.setStyle,args:[R]}];var J=[];try{if(!o.deepEqual(Q.version,R.version))return[{command:ct.setStyle,args:[R]}];o.deepEqual(Q.center,R.center)||J.push({command:ct.setCenter,args:[R.center]}),o.deepEqual(Q.zoom,R.zoom)||J.push({command:ct.setZoom,args:[R.zoom]}),o.deepEqual(Q.bearing,R.bearing)||J.push({command:ct.setBearing,args:[R.bearing]}),o.deepEqual(Q.pitch,R.pitch)||J.push({command:ct.setPitch,args:[R.pitch]}),o.deepEqual(Q.sprite,R.sprite)||J.push({command:ct.setSprite,args:[R.sprite]}),o.deepEqual(Q.glyphs,R.glyphs)||J.push({command:ct.setGlyphs,args:[R.glyphs]}),o.deepEqual(Q.transition,R.transition)||J.push({command:ct.setTransition,args:[R.transition]}),o.deepEqual(Q.light,R.light)||J.push({command:ct.setLight,args:[R.light]});var Ae={},Be=[];(function(Te,He,Le,qe){var ke;for(ke in He=He||{},Te=Te||{})Te.hasOwnProperty(ke)&&(He.hasOwnProperty(ke)||Pe(ke,Le,qe));for(ke in He)He.hasOwnProperty(ke)&&(Te.hasOwnProperty(ke)?o.deepEqual(Te[ke],He[ke])||(Te[ke].type==="geojson"&&He[ke].type==="geojson"&&xt(Te,He,ke)?Le.push({command:ct.setGeoJSONSourceData,args:[ke,He[ke].data]}):dt(ke,He,Le,qe)):we(ke,He,Le))})(Q.sources,R.sources,Be,Ae);var Ie=[];Q.layers&&Q.layers.forEach(function(Te){Ae[Te.source]?J.push({command:ct.removeLayer,args:[Te.id]}):Ie.push(Te)}),J=J.concat(Be),function(Te,He,Le){He=He||[];var qe,ke,Xe,et,at,mt,Ze,bt=(Te=Te||[]).map(zt),Tt=He.map(zt),Vt=Te.reduce(Jt,{}),Ht=He.reduce(Jt,{}),hr=bt.slice(),Er=Object.create(null);for(qe=0,ke=0;qe<bt.length;qe++)Ht.hasOwnProperty(Xe=bt[qe])?ke++:(Le.push({command:ct.removeLayer,args:[Xe]}),hr.splice(hr.indexOf(Xe,ke),1));for(qe=0,ke=0;qe<Tt.length;qe++)hr[hr.length-1-qe]!==(Xe=Tt[Tt.length-1-qe])&&(Vt.hasOwnProperty(Xe)?(Le.push({command:ct.removeLayer,args:[Xe]}),hr.splice(hr.lastIndexOf(Xe,hr.length-ke),1)):ke++,Le.push({command:ct.addLayer,args:[Ht[Xe],mt=hr[hr.length-qe]]}),hr.splice(hr.length-qe,0,Xe),Er[Xe]=!0);for(qe=0;qe<Tt.length;qe++)if(et=Vt[Xe=Tt[qe]],at=Ht[Xe],!Er[Xe]&&!o.deepEqual(et,at))if(o.deepEqual(et.source,at.source)&&o.deepEqual(et["source-layer"],at["source-layer"])&&o.deepEqual(et.type,at.type)){for(Ze in Lt(et.layout,at.layout,Le,Xe,null,ct.setLayoutProperty),Lt(et.paint,at.paint,Le,Xe,null,ct.setPaintProperty),o.deepEqual(et.filter,at.filter)||Le.push({command:ct.setFilter,args:[Xe,at.filter]}),o.deepEqual(et.minzoom,at.minzoom)&&o.deepEqual(et.maxzoom,at.maxzoom)||Le.push({command:ct.setLayerZoomRange,args:[Xe,at.minzoom,at.maxzoom]}),et)et.hasOwnProperty(Ze)&&Ze!=="layout"&&Ze!=="paint"&&Ze!=="filter"&&Ze!=="metadata"&&Ze!=="minzoom"&&Ze!=="maxzoom"&&(Ze.indexOf("paint.")===0?Lt(et[Ze],at[Ze],Le,Xe,Ze.slice(6),ct.setPaintProperty):o.deepEqual(et[Ze],at[Ze])||Le.push({command:ct.setLayerProperty,args:[Xe,Ze,at[Ze]]}));for(Ze in at)at.hasOwnProperty(Ze)&&!et.hasOwnProperty(Ze)&&Ze!=="layout"&&Ze!=="paint"&&Ze!=="filter"&&Ze!=="metadata"&&Ze!=="minzoom"&&Ze!=="maxzoom"&&(Ze.indexOf("paint.")===0?Lt(et[Ze],at[Ze],Le,Xe,Ze.slice(6),ct.setPaintProperty):o.deepEqual(et[Ze],at[Ze])||Le.push({command:ct.setLayerProperty,args:[Xe,Ze,at[Ze]]}))}else Le.push({command:ct.removeLayer,args:[Xe]}),mt=hr[hr.lastIndexOf(Xe)+1],Le.push({command:ct.addLayer,args:[at,mt]})}(Ie,R.layers,J)}catch(Te){console.warn("Unable to compute style diff:",Te),J=[{command:ct.setStyle,args:[R]}]}return J}(this.serialize(),A).filter(function(Q){return!(Q.command in Ga)});if(b.length===0)return!1;var M=b.filter(function(Q){return!(Q.command in qs)});if(M.length>0)throw new Error("Unimplemented: "+M.map(function(Q){return Q.command}).join(", ")+".");return b.forEach(function(Q){Q.command!=="setTransition"&&d[Q.command].apply(d,Q.args)}),this.stylesheet=A,!0},u.prototype.addImage=function(A,d){if(this.getImage(A))return this.fire(new o.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(A,d),this._afterImageUpdated(A)},u.prototype.updateImage=function(A,d){this.imageManager.updateImage(A,d)},u.prototype.getImage=function(A){return this.imageManager.getImage(A)},u.prototype.removeImage=function(A){if(!this.getImage(A))return this.fire(new o.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(A),this._afterImageUpdated(A)},u.prototype._afterImageUpdated=function(A){this._availableImages=this.imageManager.listImages(),this._changedImages[A]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))},u.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},u.prototype.addSource=function(A,d,b){var M=this;if(b===void 0&&(b={}),this._checkLoaded(),this.sourceCaches[A]!==void 0)throw new Error("There is already a source with this ID");if(!d.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(d).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(o.validateStyle.source,"sources."+A,d,null,b))){this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);var Q=this.sourceCaches[A]=new X(A,d,this.dispatcher);Q.style=this,Q.setEventedParent(this,function(){return{isSourceLoaded:M.loaded(),source:Q.serialize(),sourceId:A}}),Q.onAdd(this.map),this._changed=!0}},u.prototype.removeSource=function(A){if(this._checkLoaded(),this.sourceCaches[A]===void 0)throw new Error("There is no source with this ID");for(var d in this._layers)if(this._layers[d].source===A)return this.fire(new o.ErrorEvent(new Error('Source "'+A+'" cannot be removed while layer "'+d+'" is using it.')));var b=this.sourceCaches[A];delete this.sourceCaches[A],delete this._updatedSources[A],b.fire(new o.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:A})),b.setEventedParent(null),b.clearTiles(),b.onRemove&&b.onRemove(this.map),this._changed=!0},u.prototype.setGeoJSONSourceData=function(A,d){this._checkLoaded(),this.sourceCaches[A].getSource().setData(d),this._changed=!0},u.prototype.getSource=function(A){return this.sourceCaches[A]&&this.sourceCaches[A].getSource()},u.prototype.addLayer=function(A,d,b){b===void 0&&(b={}),this._checkLoaded();var M=A.id;if(this.getLayer(M))this.fire(new o.ErrorEvent(new Error('Layer with id "'+M+'" already exists on this map')));else{var Q;if(A.type==="custom"){if(Ms(this,o.validateCustomStyleLayer(A)))return;Q=o.createStyleLayer(A)}else{if(typeof A.source=="object"&&(this.addSource(M,A.source),A=o.clone$1(A),A=o.extend(A,{source:M})),this._validate(o.validateStyle.layer,"layers."+M,A,{arrayIndex:-1},b))return;Q=o.createStyleLayer(A),this._validateLayer(Q),Q.setEventedParent(this,{layer:{id:M}}),this._serializedLayers[Q.id]=Q.serialize()}var R=d?this._order.indexOf(d):this._order.length;if(d&&R===-1)this.fire(new o.ErrorEvent(new Error('Layer with id "'+d+'" does not exist on this map.')));else{if(this._order.splice(R,0,M),this._layerOrderChanged=!0,this._layers[M]=Q,this._removedLayers[M]&&Q.source&&Q.type!=="custom"){var J=this._removedLayers[M];delete this._removedLayers[M],J.type!==Q.type?this._updatedSources[Q.source]="clear":(this._updatedSources[Q.source]="reload",this.sourceCaches[Q.source].pause())}this._updateLayer(Q),Q.onAdd&&Q.onAdd(this.map)}}},u.prototype.moveLayer=function(A,d){if(this._checkLoaded(),this._changed=!0,this._layers[A]){if(A!==d){var b=this._order.indexOf(A);this._order.splice(b,1);var M=d?this._order.indexOf(d):this._order.length;d&&M===-1?this.fire(new o.ErrorEvent(new Error('Layer with id "'+d+'" does not exist on this map.'))):(this._order.splice(M,0,A),this._layerOrderChanged=!0)}}else this.fire(new o.ErrorEvent(new Error("The layer '"+A+"' does not exist in the map's style and cannot be moved.")))},u.prototype.removeLayer=function(A){this._checkLoaded();var d=this._layers[A];if(d){d.setEventedParent(null);var b=this._order.indexOf(A);this._order.splice(b,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[A]=d,delete this._layers[A],delete this._serializedLayers[A],delete this._updatedLayers[A],delete this._updatedPaintProps[A],d.onRemove&&d.onRemove(this.map)}else this.fire(new o.ErrorEvent(new Error("The layer '"+A+"' does not exist in the map's style and cannot be removed.")))},u.prototype.getLayer=function(A){return this._layers[A]},u.prototype.hasLayer=function(A){return A in this._layers},u.prototype.setLayerZoomRange=function(A,d,b){this._checkLoaded();var M=this.getLayer(A);M?M.minzoom===d&&M.maxzoom===b||(d!=null&&(M.minzoom=d),b!=null&&(M.maxzoom=b),this._updateLayer(M)):this.fire(new o.ErrorEvent(new Error("The layer '"+A+"' does not exist in the map's style and cannot have zoom extent.")))},u.prototype.setFilter=function(A,d,b){b===void 0&&(b={}),this._checkLoaded();var M=this.getLayer(A);if(M){if(!o.deepEqual(M.filter,d))return d==null?(M.filter=void 0,void this._updateLayer(M)):void(this._validate(o.validateStyle.filter,"layers."+M.id+".filter",d,null,b)||(M.filter=o.clone$1(d),this._updateLayer(M)))}else this.fire(new o.ErrorEvent(new Error("The layer '"+A+"' does not exist in the map's style and cannot be filtered.")))},u.prototype.getFilter=function(A){return o.clone$1(this.getLayer(A).filter)},u.prototype.setLayoutProperty=function(A,d,b,M){M===void 0&&(M={}),this._checkLoaded();var Q=this.getLayer(A);Q?o.deepEqual(Q.getLayoutProperty(d),b)||(Q.setLayoutProperty(d,b,M),this._updateLayer(Q)):this.fire(new o.ErrorEvent(new Error("The layer '"+A+"' does not exist in the map's style and cannot be styled.")))},u.prototype.getLayoutProperty=function(A,d){var b=this.getLayer(A);if(b)return b.getLayoutProperty(d);this.fire(new o.ErrorEvent(new Error("The layer '"+A+"' does not exist in the map's style.")))},u.prototype.setPaintProperty=function(A,d,b,M){M===void 0&&(M={}),this._checkLoaded();var Q=this.getLayer(A);Q?o.deepEqual(Q.getPaintProperty(d),b)||(Q.setPaintProperty(d,b,M)&&this._updateLayer(Q),this._changed=!0,this._updatedPaintProps[A]=!0):this.fire(new o.ErrorEvent(new Error("The layer '"+A+"' does not exist in the map's style and cannot be styled.")))},u.prototype.getPaintProperty=function(A,d){return this.getLayer(A).getPaintProperty(d)},u.prototype.setFeatureState=function(A,d){this._checkLoaded();var b=A.source,M=A.sourceLayer,Q=this.sourceCaches[b];if(Q!==void 0){var R=Q.getSource().type;R==="geojson"&&M?this.fire(new o.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):R!=="vector"||M?(A.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),Q.setFeatureState(M,A.id,d)):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error("The source '"+b+"' does not exist in the map's style.")))},u.prototype.removeFeatureState=function(A,d){this._checkLoaded();var b=A.source,M=this.sourceCaches[b];if(M!==void 0){var Q=M.getSource().type,R=Q==="vector"?A.sourceLayer:void 0;Q!=="vector"||R?d&&typeof A.id!="string"&&typeof A.id!="number"?this.fire(new o.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):M.removeFeatureState(R,A.id,d):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error("The source '"+b+"' does not exist in the map's style.")))},u.prototype.getFeatureState=function(A){this._checkLoaded();var d=A.source,b=A.sourceLayer,M=this.sourceCaches[d];if(M!==void 0){if(M.getSource().type!=="vector"||b)return A.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),M.getFeatureState(b,A.id);this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error("The source '"+d+"' does not exist in the map's style.")))},u.prototype.getTransition=function(){return o.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},u.prototype.serialize=function(){return o.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:o.mapObject(this.sourceCaches,function(A){return A.serialize()}),layers:this._serializeLayers(this._order)},function(A){return A!==void 0})},u.prototype._updateLayer=function(A){this._updatedLayers[A.id]=!0,A.source&&!this._updatedSources[A.source]&&this.sourceCaches[A.source].getSource().type!=="raster"&&(this._updatedSources[A.source]="reload",this.sourceCaches[A.source].pause()),this._changed=!0},u.prototype._flattenAndSortRenderedFeatures=function(A){for(var d=this,b=function(Vt){return d._layers[Vt].type==="fill-extrusion"},M={},Q=[],R=this._order.length-1;R>=0;R--){var J=this._order[R];if(b(J)){M[J]=R;for(var Ae=0,Be=A;Ae<Be.length;Ae+=1){var Ie=Be[Ae][J];if(Ie)for(var Te=0,He=Ie;Te<He.length;Te+=1)Q.push(He[Te])}}}Q.sort(function(Vt,Ht){return Ht.intersectionZ-Vt.intersectionZ});for(var Le=[],qe=this._order.length-1;qe>=0;qe--){var ke=this._order[qe];if(b(ke))for(var Xe=Q.length-1;Xe>=0;Xe--){var et=Q[Xe].feature;if(M[et.layer.id]<qe)break;Le.push(et),Q.pop()}else for(var at=0,mt=A;at<mt.length;at+=1){var Ze=mt[at][ke];if(Ze)for(var bt=0,Tt=Ze;bt<Tt.length;bt+=1)Le.push(Tt[bt].feature)}}return Le},u.prototype.queryRenderedFeatures=function(A,d,b){d&&d.filter&&this._validate(o.validateStyle.filter,"queryRenderedFeatures.filter",d.filter,null,d);var M={};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new o.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var Q=0,R=d.layers;Q<R.length;Q+=1){var J=R[Q],Ae=this._layers[J];if(!Ae)return this.fire(new o.ErrorEvent(new Error("The layer '"+J+"' does not exist in the map's style and cannot be queried for features."))),[];M[Ae.source]=!0}}var Be=[];for(var Ie in d.availableImages=this._availableImages,this.sourceCaches)d.layers&&!M[Ie]||Be.push(Xi(this.sourceCaches[Ie],this._layers,this._serializedLayers,A,d,b));return this.placement&&Be.push(function(Te,He,Le,qe,ke,Xe,et){for(var at={},mt=Xe.queryRenderedSymbols(qe),Ze=[],bt=0,Tt=Object.keys(mt).map(Number);bt<Tt.length;bt+=1)Ze.push(et[Tt[bt]]);Ze.sort(cn);for(var Vt=function(){var Ur=hr[Ht],gi=Ur.featureIndex.lookupSymbolFeatures(mt[Ur.bucketInstanceId],He,Ur.bucketIndex,Ur.sourceLayerIndex,ke.filter,ke.layers,ke.availableImages,Te);for(var lr in gi){var zr=at[lr]=at[lr]||[],$r=gi[lr];$r.sort(function(si,Lr){var Dr=Ur.featureSortOrder;if(Dr){var Kn=Dr.indexOf(si.featureIndex);return Dr.indexOf(Lr.featureIndex)-Kn}return Lr.featureIndex-si.featureIndex});for(var qr=0,Zr=$r;qr<Zr.length;qr+=1)zr.push(Zr[qr])}},Ht=0,hr=Ze;Ht<hr.length;Ht+=1)Vt();var Er=function(Ur){at[Ur].forEach(function(gi){var lr=gi.feature,zr=Le[Te[Ur].source].getFeatureState(lr.layer["source-layer"],lr.id);lr.source=lr.layer.source,lr.layer["source-layer"]&&(lr.sourceLayer=lr.layer["source-layer"]),lr.state=zr})};for(var Mr in at)Er(Mr);return at}(this._layers,this._serializedLayers,this.sourceCaches,A,d,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Be)},u.prototype.querySourceFeatures=function(A,d){d&&d.filter&&this._validate(o.validateStyle.filter,"querySourceFeatures.filter",d.filter,null,d);var b=this.sourceCaches[A];return b?function(M,Q){for(var R=M.getRenderableIds().map(function(He){return M.getTileByID(He)}),J=[],Ae={},Be=0;Be<R.length;Be++){var Ie=R[Be],Te=Ie.tileID.canonical.key;Ae[Te]||(Ae[Te]=!0,Ie.querySourceFeatures(J,Q))}return J}(b,d):[]},u.prototype.addSourceType=function(A,d,b){return u.getSourceType(A)?b(new Error('A source type called "'+A+'" already exists.')):(u.setSourceType(A,d),d.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:A,url:d.workerSourceURL},b):b(null,null))},u.prototype.getLight=function(){return this.light.getLight()},u.prototype.setLight=function(A,d){d===void 0&&(d={}),this._checkLoaded();var b=this.light.getLight(),M=!1;for(var Q in A)if(!o.deepEqual(A[Q],b[Q])){M=!0;break}if(M){var R={now:o.browser.now(),transition:o.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(A,d),this.light.updateTransitions(R)}},u.prototype._validate=function(A,d,b,M,Q){return Q===void 0&&(Q={}),(!Q||Q.validate!==!1)&&Ms(this,A.call(o.validateStyle,o.extend({key:d,style:this.serialize(),value:b,styleSpec:o.styleSpec},M)))},u.prototype._remove=function(){for(var A in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[A].setEventedParent(null);for(var d in this.sourceCaches)this.sourceCaches[d].clearTiles(),this.sourceCaches[d].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},u.prototype._clearSource=function(A){this.sourceCaches[A].clearTiles()},u.prototype._reloadSource=function(A){this.sourceCaches[A].resume(),this.sourceCaches[A].reload()},u.prototype._updateSources=function(A){for(var d in this.sourceCaches)this.sourceCaches[d].update(A)},u.prototype._generateCollisionBoxes=function(){for(var A in this.sourceCaches)this._reloadSource(A)},u.prototype._updatePlacement=function(A,d,b,M,Q){Q===void 0&&(Q=!1);for(var R=!1,J=!1,Ae={},Be=0,Ie=this._order;Be<Ie.length;Be+=1){var Te=this._layers[Ie[Be]];if(Te.type==="symbol"){if(!Ae[Te.source]){var He=this.sourceCaches[Te.source];Ae[Te.source]=He.getRenderableIds(!0).map(function(et){return He.getTileByID(et)}).sort(function(et,at){return at.tileID.overscaledZ-et.tileID.overscaledZ||(et.tileID.isLessThan(at.tileID)?-1:1)})}var Le=this.crossTileSymbolIndex.addLayer(Te,Ae[Te.source],A.center.lng);R=R||Le}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((Q=Q||this._layerOrderChanged||b===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.browser.now(),A.zoom))&&(this.pauseablePlacement=new Pl(A,this._order,Q,d,b,M,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Ae),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.browser.now()),J=!0),R&&this.pauseablePlacement.placement.setStale()),J||R)for(var qe=0,ke=this._order;qe<ke.length;qe+=1){var Xe=this._layers[ke[qe]];Xe.type==="symbol"&&this.placement.updateLayerOpacities(Xe,Ae[Xe.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.browser.now())},u.prototype._releaseSymbolFadeTiles=function(){for(var A in this.sourceCaches)this.sourceCaches[A].releaseSymbolFadeTiles()},u.prototype.getImages=function(A,d,b){this.imageManager.getImages(d.icons,b),this._updateTilesForChangedImages();var M=this.sourceCaches[d.source];M&&M.setDependencies(d.tileID.key,d.type,d.icons)},u.prototype.getGlyphs=function(A,d,b){this.glyphManager.getGlyphs(d.stacks,b)},u.prototype.getResource=function(A,d,b){return o.makeRequest(d,b)},u}(o.Evented);ca.getSourceType=function(l){return Bn[l]},ca.setSourceType=function(l,u){Bn[l]=u},ca.registerForPluginStateChange=o.registerForPluginStateChange;var Li=o.createLayout([{name:"a_pos",type:"Int16",components:2}]),Zs=Ki(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),Yl=Ki(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),wA=Ki(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),NA=Ki(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),Xs=Ki("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),ks=Ki(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Dl=Ki(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),eA=Ki("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),ja=Ki("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Ll=Ki("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),bA=Ki(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),ps=Ki(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),tA=Ki(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),mc=Ki(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),Ro=Ki(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),KA=Ki(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),Ws=Ki(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Js=Ki(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Ps=Ki(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),ds=Ki(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),fs=Ki(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Qs=Ki(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),$a=Ki(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),qa=Ki(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),GA=Ki(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),rA=Ki(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Ki(l,u){var A=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,d=u.match(/attribute ([\w]+) ([\w]+)/g),b=l.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),M=u.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),Q=M?M.concat(b):b,R={};return{fragmentSource:l=l.replace(A,function(J,Ae,Be,Ie,Te){return R[Te]=!0,Ae==="define"?`
#ifndef HAS_UNIFORM_u_`+Te+`
varying `+Be+" "+Ie+" "+Te+`;
#else
uniform `+Be+" "+Ie+" u_"+Te+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+Te+`
    `+Be+" "+Ie+" "+Te+" = u_"+Te+`;
#endif
`}),vertexSource:u=u.replace(A,function(J,Ae,Be,Ie,Te){var He=Ie==="float"?"vec2":"vec4",Le=Te.match(/color/)?"color":He;return R[Te]?Ae==="define"?`
#ifndef HAS_UNIFORM_u_`+Te+`
uniform lowp float u_`+Te+`_t;
attribute `+Be+" "+He+" a_"+Te+`;
varying `+Be+" "+Ie+" "+Te+`;
#else
uniform `+Be+" "+Ie+" u_"+Te+`;
#endif
`:Le==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Te+`
    `+Te+" = a_"+Te+`;
#else
    `+Be+" "+Ie+" "+Te+" = u_"+Te+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Te+`
    `+Te+" = unpack_mix_"+Le+"(a_"+Te+", u_"+Te+`_t);
#else
    `+Be+" "+Ie+" "+Te+" = u_"+Te+`;
#endif
`:Ae==="define"?`
#ifndef HAS_UNIFORM_u_`+Te+`
uniform lowp float u_`+Te+`_t;
attribute `+Be+" "+He+" a_"+Te+`;
#else
uniform `+Be+" "+Ie+" u_"+Te+`;
#endif
`:Le==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Te+`
    `+Be+" "+Ie+" "+Te+" = a_"+Te+`;
#else
    `+Be+" "+Ie+" "+Te+" = u_"+Te+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Te+`
    `+Be+" "+Ie+" "+Te+" = unpack_mix_"+Le+"(a_"+Te+", u_"+Te+`_t);
#else
    `+Be+" "+Ie+" "+Te+" = u_"+Te+`;
#endif
`}),staticAttributes:d,staticUniforms:Q}}var gc=Object.freeze({__proto__:null,prelude:Zs,background:Yl,backgroundPattern:wA,circle:NA,clippingMask:Xs,heatmap:ks,heatmapTexture:Dl,collisionBox:eA,collisionCircle:ja,debug:Ll,fill:bA,fillOutline:ps,fillOutlinePattern:tA,fillPattern:mc,fillExtrusion:Ro,fillExtrusionPattern:KA,hillshadePrepare:Ws,hillshade:Js,line:Ps,lineGradient:ds,linePattern:fs,lineSDF:Qs,raster:$a,symbolIcon:qa,symbolSDF:GA,symbolTextAndIcon:rA}),Ds=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function Rn(l){for(var u=[],A=0;A<l.length;A++)if(l[A]!==null){var d=l[A].split(" ");u.push(d.pop())}return u}Ds.prototype.bind=function(l,u,A,d,b,M,Q,R){this.context=l;for(var J=this.boundPaintVertexBuffers.length!==d.length,Ae=0;!J&&Ae<d.length;Ae++)this.boundPaintVertexBuffers[Ae]!==d[Ae]&&(J=!0);l.extVertexArrayObject&&this.vao&&this.boundProgram===u&&this.boundLayoutVertexBuffer===A&&!J&&this.boundIndexBuffer===b&&this.boundVertexOffset===M&&this.boundDynamicVertexBuffer===Q&&this.boundDynamicVertexBuffer2===R?(l.bindVertexArrayOES.set(this.vao),Q&&Q.bind(),b&&b.dynamicDraw&&b.bind(),R&&R.bind()):this.freshBind(u,A,d,b,M,Q,R)},Ds.prototype.freshBind=function(l,u,A,d,b,M,Q){var R,J=l.numAttributes,Ae=this.context,Be=Ae.gl;if(Ae.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Ae.extVertexArrayObject.createVertexArrayOES(),Ae.bindVertexArrayOES.set(this.vao),R=0,this.boundProgram=l,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=A,this.boundIndexBuffer=d,this.boundVertexOffset=b,this.boundDynamicVertexBuffer=M,this.boundDynamicVertexBuffer2=Q;else{R=Ae.currentNumAttributes||0;for(var Ie=J;Ie<R;Ie++)Be.disableVertexAttribArray(Ie)}u.enableAttributes(Be,l);for(var Te=0,He=A;Te<He.length;Te+=1)He[Te].enableAttributes(Be,l);M&&M.enableAttributes(Be,l),Q&&Q.enableAttributes(Be,l),u.bind(),u.setVertexAttribPointers(Be,l,b);for(var Le=0,qe=A;Le<qe.length;Le+=1){var ke=qe[Le];ke.bind(),ke.setVertexAttribPointers(Be,l,b)}M&&(M.bind(),M.setVertexAttribPointers(Be,l,b)),d&&d.bind(),Q&&(Q.bind(),Q.setVertexAttribPointers(Be,l,b)),Ae.currentNumAttributes=J},Ds.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var jA=function(l,u,A,d,b,M){var Q=l.gl;this.program=Q.createProgram();for(var R=Rn(A.staticAttributes),J=d?d.getBinderAttributes():[],Ae=R.concat(J),Be=A.staticUniforms?Rn(A.staticUniforms):[],Ie=d?d.getBinderUniforms():[],Te=[],He=0,Le=Be.concat(Ie);He<Le.length;He+=1){var qe=Le[He];Te.indexOf(qe)<0&&Te.push(qe)}var ke=d?d.defines():[];M&&ke.push("#define OVERDRAW_INSPECTOR;");var Xe=ke.concat(Zs.fragmentSource,A.fragmentSource).join(`
`),et=ke.concat(Zs.vertexSource,A.vertexSource).join(`
`),at=Q.createShader(Q.FRAGMENT_SHADER);if(Q.isContextLost())this.failedToCreate=!0;else{Q.shaderSource(at,Xe),Q.compileShader(at),Q.attachShader(this.program,at);var mt=Q.createShader(Q.VERTEX_SHADER);if(Q.isContextLost())this.failedToCreate=!0;else{Q.shaderSource(mt,et),Q.compileShader(mt),Q.attachShader(this.program,mt),this.attributes={};var Ze={};this.numAttributes=Ae.length;for(var bt=0;bt<this.numAttributes;bt++)Ae[bt]&&(Q.bindAttribLocation(this.program,bt,Ae[bt]),this.attributes[Ae[bt]]=bt);Q.linkProgram(this.program),Q.deleteShader(mt),Q.deleteShader(at);for(var Tt=0;Tt<Te.length;Tt++){var Vt=Te[Tt];if(Vt&&!Ze[Vt]){var Ht=Q.getUniformLocation(this.program,Vt);Ht&&(Ze[Vt]=Ht)}}this.fixedUniforms=b(l,Ze),this.binderUniforms=d?d.getUniforms(l,Ze):[]}}};function Pi(l,u,A){var d=1/Ni(A,1,u.transform.tileZoom),b=Math.pow(2,A.tileID.overscaledZ),M=A.tileSize*Math.pow(2,u.transform.tileZoom)/b,Q=M*(A.tileID.canonical.x+A.tileID.wrap*b),R=M*A.tileID.canonical.y;return{u_image:0,u_texsize:A.imageAtlasTexture.size,u_scale:[d,l.fromScale,l.toScale],u_fade:l.t,u_pixel_coord_upper:[Q>>16,R>>16],u_pixel_coord_lower:[65535&Q,65535&R]}}jA.prototype.draw=function(l,u,A,d,b,M,Q,R,J,Ae,Be,Ie,Te,He,Le,qe){var ke,Xe=l.gl;if(!this.failedToCreate){for(var et in l.program.set(this.program),l.setDepthMode(A),l.setStencilMode(d),l.setColorMode(b),l.setCullFace(M),this.fixedUniforms)this.fixedUniforms[et].set(Q[et]);He&&He.setUniforms(l,this.binderUniforms,Ie,{zoom:Te});for(var at=(ke={},ke[Xe.LINES]=2,ke[Xe.TRIANGLES]=3,ke[Xe.LINE_STRIP]=1,ke)[u],mt=0,Ze=Be.get();mt<Ze.length;mt+=1){var bt=Ze[mt],Tt=bt.vaos||(bt.vaos={});(Tt[R]||(Tt[R]=new Ds)).bind(l,this,J,He?He.getPaintVertexBuffers():[],Ae,bt.vertexOffset,Le,qe),Xe.drawElements(u,bt.primitiveLength*at,Xe.UNSIGNED_SHORT,bt.primitiveOffset*at*2)}}};var Gi=function(l,u,A,d){var b=u.style.light,M=b.properties.get("position"),Q=[M.x,M.y,M.z],R=o.create$1();b.properties.get("anchor")==="viewport"&&o.fromRotation(R,-u.transform.angle),o.transformMat3(Q,Q,R);var J=b.properties.get("color");return{u_matrix:l,u_lightpos:Q,u_lightintensity:b.properties.get("intensity"),u_lightcolor:[J.r,J.g,J.b],u_vertical_gradient:+A,u_opacity:d}},Yi=function(l,u,A,d,b,M,Q){return o.extend(Gi(l,u,A,d),Pi(M,u,Q),{u_height_factor:-Math.pow(2,b.overscaledZ)/Q.tileSize/8})},sn=function(l){return{u_matrix:l}},ua=function(l,u,A,d){return o.extend(sn(l),Pi(A,u,d))},Za=function(l,u){return{u_matrix:l,u_world:u}},Tn=function(l,u,A,d,b){return o.extend(ua(l,u,A,d),{u_world:b})},$A=function(l,u,A,d){var b,M,Q=l.transform;if(d.paint.get("circle-pitch-alignment")==="map"){var R=Ni(A,1,Q.zoom);b=!0,M=[R,R]}else b=!1,M=Q.pixelsToGLUnits;return{u_camera_to_center_distance:Q.cameraToCenterDistance,u_scale_with_map:+(d.paint.get("circle-pitch-scale")==="map"),u_matrix:l.translatePosMatrix(u.posMatrix,A,d.paint.get("circle-translate"),d.paint.get("circle-translate-anchor")),u_pitch_with_map:+b,u_device_pixel_ratio:o.browser.devicePixelRatio,u_extrude_scale:M}},ms=function(l,u,A){var d=Ni(A,1,u.zoom),b=Math.pow(2,u.zoom-A.tileID.overscaledZ),M=A.tileID.overscaleFactor();return{u_matrix:l,u_camera_to_center_distance:u.cameraToCenterDistance,u_pixels_to_tile_units:d,u_extrude_scale:[u.pixelsToGLUnits[0]/(d*b),u.pixelsToGLUnits[1]/(d*b)],u_overscale_factor:M}},qA=function(l,u,A){return{u_matrix:l,u_inv_matrix:u,u_camera_to_center_distance:A.cameraToCenterDistance,u_viewport_size:[A.width,A.height]}},ha=function(l,u,A){return A===void 0&&(A=1),{u_matrix:l,u_color:u,u_overlay:0,u_overlay_scale:A}},So=function(l){return{u_matrix:l}},zl=function(l,u,A,d){return{u_matrix:l,u_extrude_scale:Ni(u,1,A),u_intensity:d}},ta=function(l,u,A){var d=l.transform;return{u_matrix:Mo(l,u,A),u_ratio:1/Ni(u,1,d.zoom),u_device_pixel_ratio:o.browser.devicePixelRatio,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},Ai=function(l,u,A,d){return o.extend(ta(l,u,A),{u_image:0,u_image_height:d})},Rl=function(l,u,A,d){var b=l.transform,M=es(u,b);return{u_matrix:Mo(l,u,A),u_texsize:u.imageAtlasTexture.size,u_ratio:1/Ni(u,1,b.zoom),u_device_pixel_ratio:o.browser.devicePixelRatio,u_image:0,u_scale:[M,d.fromScale,d.toScale],u_fade:d.t,u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]]}},To=function(l,u,A,d,b){var M=l.lineAtlas,Q=es(u,l.transform),R=A.layout.get("line-cap")==="round",J=M.getDash(d.from,R),Ae=M.getDash(d.to,R),Be=J.width*b.fromScale,Ie=Ae.width*b.toScale;return o.extend(ta(l,u,A),{u_patternscale_a:[Q/Be,-J.height/2],u_patternscale_b:[Q/Ie,-Ae.height/2],u_sdfgamma:M.width/(256*Math.min(Be,Ie)*o.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:J.y,u_tex_y_b:Ae.y,u_mix:b.t})};function es(l,u){return 1/Ni(l,1,u.tileZoom)}function Mo(l,u,A){return l.translatePosMatrix(u.tileID.posMatrix,u,A.paint.get("line-translate"),A.paint.get("line-translate-anchor"))}var Ol=function(l,u,A,d,b){return{u_matrix:l,u_tl_parent:u,u_scale_parent:A,u_buffer_scale:1,u_fade_t:d.mix,u_opacity:d.opacity*b.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:b.paint.get("raster-brightness-min"),u_brightness_high:b.paint.get("raster-brightness-max"),u_saturation_factor:(Q=b.paint.get("raster-saturation"),Q>0?1-1/(1.001-Q):-Q),u_contrast_factor:(M=b.paint.get("raster-contrast"),M>0?1/(1-M):1+M),u_spin_weights:Fn(b.paint.get("raster-hue-rotate"))};var M,Q};function Fn(l){l*=Math.PI/180;var u=Math.sin(l),A=Math.cos(l);return[(2*A+1)/3,(-Math.sqrt(3)*u-A+1)/3,(Math.sqrt(3)*u-A+1)/3]}var Hl,Da=function(l,u,A,d,b,M,Q,R,J,Ae){var Be=b.transform;return{u_is_size_zoom_constant:+(l==="constant"||l==="source"),u_is_size_feature_constant:+(l==="constant"||l==="camera"),u_size_t:u?u.uSizeT:0,u_size:u?u.uSize:0,u_camera_to_center_distance:Be.cameraToCenterDistance,u_pitch:Be.pitch/360*2*Math.PI,u_rotate_symbol:+A,u_aspect_ratio:Be.width/Be.height,u_fade_change:b.options.fadeDuration?b.symbolFadeChange:1,u_matrix:M,u_label_plane_matrix:Q,u_coord_matrix:R,u_is_text:+J,u_pitch_with_map:+d,u_texsize:Ae,u_texture:0}},gs=function(l,u,A,d,b,M,Q,R,J,Ae,Be){var Ie=b.transform;return o.extend(Da(l,u,A,d,b,M,Q,R,J,Ae),{u_gamma_scale:d?Math.cos(Ie._pitch)*Ie.cameraToCenterDistance:1,u_device_pixel_ratio:o.browser.devicePixelRatio,u_is_halo:+Be})},ys=function(l,u,A,d,b,M,Q,R,J,Ae){return o.extend(gs(l,u,A,d,b,M,Q,R,!0,J,!0),{u_texsize_icon:Ae,u_texture_icon:1})},Ys=function(l,u,A){return{u_matrix:l,u_opacity:u,u_color:A}},_s=function(l,u,A,d,b,M){return o.extend(function(Q,R,J,Ae){var Be=J.imageManager.getPattern(Q.from.toString()),Ie=J.imageManager.getPattern(Q.to.toString()),Te=J.imageManager.getPixelSize(),He=Te.width,Le=Te.height,qe=Math.pow(2,Ae.tileID.overscaledZ),ke=Ae.tileSize*Math.pow(2,J.transform.tileZoom)/qe,Xe=ke*(Ae.tileID.canonical.x+Ae.tileID.wrap*qe),et=ke*Ae.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Be.tl,u_pattern_br_a:Be.br,u_pattern_tl_b:Ie.tl,u_pattern_br_b:Ie.br,u_texsize:[He,Le],u_mix:R.t,u_pattern_size_a:Be.displaySize,u_pattern_size_b:Ie.displaySize,u_scale_a:R.fromScale,u_scale_b:R.toScale,u_tile_units_to_pixels:1/Ni(Ae,1,J.transform.tileZoom),u_pixel_coord_upper:[Xe>>16,et>>16],u_pixel_coord_lower:[65535&Xe,65535&et]}}(d,M,A,b),{u_matrix:l,u_opacity:u})},BA={fillExtrusion:function(l,u){return{u_matrix:new o.UniformMatrix4f(l,u.u_matrix),u_lightpos:new o.Uniform3f(l,u.u_lightpos),u_lightintensity:new o.Uniform1f(l,u.u_lightintensity),u_lightcolor:new o.Uniform3f(l,u.u_lightcolor),u_vertical_gradient:new o.Uniform1f(l,u.u_vertical_gradient),u_opacity:new o.Uniform1f(l,u.u_opacity)}},fillExtrusionPattern:function(l,u){return{u_matrix:new o.UniformMatrix4f(l,u.u_matrix),u_lightpos:new o.Uniform3f(l,u.u_lightpos),u_lightintensity:new o.Uniform1f(l,u.u_lightintensity),u_lightcolor:new o.Uniform3f(l,u.u_lightcolor),u_vertical_gradient:new o.Uniform1f(l,u.u_vertical_gradient),u_height_factor:new o.Uniform1f(l,u.u_height_factor),u_image:new o.Uniform1i(l,u.u_image),u_texsize:new o.Uniform2f(l,u.u_texsize),u_pixel_coord_upper:new o.Uniform2f(l,u.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(l,u.u_pixel_coord_lower),u_scale:new o.Uniform3f(l,u.u_scale),u_fade:new o.Uniform1f(l,u.u_fade),u_opacity:new o.Uniform1f(l,u.u_opacity)}},fill:function(l,u){return{u_matrix:new o.UniformMatrix4f(l,u.u_matrix)}},fillPattern:function(l,u){return{u_matrix:new o.UniformMatrix4f(l,u.u_matrix),u_image:new o.Uniform1i(l,u.u_image),u_texsize:new o.Uniform2f(l,u.u_texsize),u_pixel_coord_upper:new o.Uniform2f(l,u.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(l,u.u_pixel_coord_lower),u_scale:new o.Uniform3f(l,u.u_scale),u_fade:new o.Uniform1f(l,u.u_fade)}},fillOutline:function(l,u){return{u_matrix:new o.UniformMatrix4f(l,u.u_matrix),u_world:new o.Uniform2f(l,u.u_world)}},fillOutlinePattern:function(l,u){return{u_matrix:new o.UniformMatrix4f(l,u.u_matrix),u_world:new o.Uniform2f(l,u.u_world),u_image:new o.Uniform1i(l,u.u_image),u_texsize:new o.Uniform2f(l,u.u_texsize),u_pixel_coord_upper:new o.Uniform2f(l,u.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(l,u.u_pixel_coord_lower),u_scale:new o.Uniform3f(l,u.u_scale),u_fade:new o.Uniform1f(l,u.u_fade)}},circle:function(l,u){return{u_camera_to_center_distance:new o.Uniform1f(l,u.u_camera_to_center_distance),u_scale_with_map:new o.Uniform1i(l,u.u_scale_with_map),u_pitch_with_map:new o.Uniform1i(l,u.u_pitch_with_map),u_extrude_scale:new o.Uniform2f(l,u.u_extrude_scale),u_device_pixel_ratio:new o.Uniform1f(l,u.u_device_pixel_ratio),u_matrix:new o.UniformMatrix4f(l,u.u_matrix)}},collisionBox:function(l,u){return{u_matrix:new o.UniformMatrix4f(l,u.u_matrix),u_camera_to_center_distance:new o.Uniform1f(l,u.u_camera_to_center_distance),u_pixels_to_tile_units:new o.Uniform1f(l,u.u_pixels_to_tile_units),u_extrude_scale:new o.Uniform2f(l,u.u_extrude_scale),u_overscale_factor:new o.Uniform1f(l,u.u_overscale_factor)}},collisionCircle:function(l,u){return{u_matrix:new o.UniformMatrix4f(l,u.u_matrix),u_inv_matrix:new o.UniformMatrix4f(l,u.u_inv_matrix),u_camera_to_center_distance:new o.Uniform1f(l,u.u_camera_to_center_distance),u_viewport_size:new o.Uniform2f(l,u.u_viewport_size)}},debug:function(l,u){return{u_color:new o.UniformColor(l,u.u_color),u_matrix:new o.UniformMatrix4f(l,u.u_matrix),u_overlay:new o.Uniform1i(l,u.u_overlay),u_overlay_scale:new o.Uniform1f(l,u.u_overlay_scale)}},clippingMask:function(l,u){return{u_matrix:new o.UniformMatrix4f(l,u.u_matrix)}},heatmap:function(l,u){return{u_extrude_scale:new o.Uniform1f(l,u.u_extrude_scale),u_intensity:new o.Uniform1f(l,u.u_intensity),u_matrix:new o.UniformMatrix4f(l,u.u_matrix)}},heatmapTexture:function(l,u){return{u_matrix:new o.UniformMatrix4f(l,u.u_matrix),u_world:new o.Uniform2f(l,u.u_world),u_image:new o.Uniform1i(l,u.u_image),u_color_ramp:new o.Uniform1i(l,u.u_color_ramp),u_opacity:new o.Uniform1f(l,u.u_opacity)}},hillshade:function(l,u){return{u_matrix:new o.UniformMatrix4f(l,u.u_matrix),u_image:new o.Uniform1i(l,u.u_image),u_latrange:new o.Uniform2f(l,u.u_latrange),u_light:new o.Uniform2f(l,u.u_light),u_shadow:new o.UniformColor(l,u.u_shadow),u_highlight:new o.UniformColor(l,u.u_highlight),u_accent:new o.UniformColor(l,u.u_accent)}},hillshadePrepare:function(l,u){return{u_matrix:new o.UniformMatrix4f(l,u.u_matrix),u_image:new o.Uniform1i(l,u.u_image),u_dimension:new o.Uniform2f(l,u.u_dimension),u_zoom:new o.Uniform1f(l,u.u_zoom),u_unpack:new o.Uniform4f(l,u.u_unpack)}},line:function(l,u){return{u_matrix:new o.UniformMatrix4f(l,u.u_matrix),u_ratio:new o.Uniform1f(l,u.u_ratio),u_device_pixel_ratio:new o.Uniform1f(l,u.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(l,u.u_units_to_pixels)}},lineGradient:function(l,u){return{u_matrix:new o.UniformMatrix4f(l,u.u_matrix),u_ratio:new o.Uniform1f(l,u.u_ratio),u_device_pixel_ratio:new o.Uniform1f(l,u.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(l,u.u_units_to_pixels),u_image:new o.Uniform1i(l,u.u_image),u_image_height:new o.Uniform1f(l,u.u_image_height)}},linePattern:function(l,u){return{u_matrix:new o.UniformMatrix4f(l,u.u_matrix),u_texsize:new o.Uniform2f(l,u.u_texsize),u_ratio:new o.Uniform1f(l,u.u_ratio),u_device_pixel_ratio:new o.Uniform1f(l,u.u_device_pixel_ratio),u_image:new o.Uniform1i(l,u.u_image),u_units_to_pixels:new o.Uniform2f(l,u.u_units_to_pixels),u_scale:new o.Uniform3f(l,u.u_scale),u_fade:new o.Uniform1f(l,u.u_fade)}},lineSDF:function(l,u){return{u_matrix:new o.UniformMatrix4f(l,u.u_matrix),u_ratio:new o.Uniform1f(l,u.u_ratio),u_device_pixel_ratio:new o.Uniform1f(l,u.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(l,u.u_units_to_pixels),u_patternscale_a:new o.Uniform2f(l,u.u_patternscale_a),u_patternscale_b:new o.Uniform2f(l,u.u_patternscale_b),u_sdfgamma:new o.Uniform1f(l,u.u_sdfgamma),u_image:new o.Uniform1i(l,u.u_image),u_tex_y_a:new o.Uniform1f(l,u.u_tex_y_a),u_tex_y_b:new o.Uniform1f(l,u.u_tex_y_b),u_mix:new o.Uniform1f(l,u.u_mix)}},raster:function(l,u){return{u_matrix:new o.UniformMatrix4f(l,u.u_matrix),u_tl_parent:new o.Uniform2f(l,u.u_tl_parent),u_scale_parent:new o.Uniform1f(l,u.u_scale_parent),u_buffer_scale:new o.Uniform1f(l,u.u_buffer_scale),u_fade_t:new o.Uniform1f(l,u.u_fade_t),u_opacity:new o.Uniform1f(l,u.u_opacity),u_image0:new o.Uniform1i(l,u.u_image0),u_image1:new o.Uniform1i(l,u.u_image1),u_brightness_low:new o.Uniform1f(l,u.u_brightness_low),u_brightness_high:new o.Uniform1f(l,u.u_brightness_high),u_saturation_factor:new o.Uniform1f(l,u.u_saturation_factor),u_contrast_factor:new o.Uniform1f(l,u.u_contrast_factor),u_spin_weights:new o.Uniform3f(l,u.u_spin_weights)}},symbolIcon:function(l,u){return{u_is_size_zoom_constant:new o.Uniform1i(l,u.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(l,u.u_is_size_feature_constant),u_size_t:new o.Uniform1f(l,u.u_size_t),u_size:new o.Uniform1f(l,u.u_size),u_camera_to_center_distance:new o.Uniform1f(l,u.u_camera_to_center_distance),u_pitch:new o.Uniform1f(l,u.u_pitch),u_rotate_symbol:new o.Uniform1i(l,u.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(l,u.u_aspect_ratio),u_fade_change:new o.Uniform1f(l,u.u_fade_change),u_matrix:new o.UniformMatrix4f(l,u.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(l,u.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(l,u.u_coord_matrix),u_is_text:new o.Uniform1i(l,u.u_is_text),u_pitch_with_map:new o.Uniform1i(l,u.u_pitch_with_map),u_texsize:new o.Uniform2f(l,u.u_texsize),u_texture:new o.Uniform1i(l,u.u_texture)}},symbolSDF:function(l,u){return{u_is_size_zoom_constant:new o.Uniform1i(l,u.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(l,u.u_is_size_feature_constant),u_size_t:new o.Uniform1f(l,u.u_size_t),u_size:new o.Uniform1f(l,u.u_size),u_camera_to_center_distance:new o.Uniform1f(l,u.u_camera_to_center_distance),u_pitch:new o.Uniform1f(l,u.u_pitch),u_rotate_symbol:new o.Uniform1i(l,u.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(l,u.u_aspect_ratio),u_fade_change:new o.Uniform1f(l,u.u_fade_change),u_matrix:new o.UniformMatrix4f(l,u.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(l,u.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(l,u.u_coord_matrix),u_is_text:new o.Uniform1i(l,u.u_is_text),u_pitch_with_map:new o.Uniform1i(l,u.u_pitch_with_map),u_texsize:new o.Uniform2f(l,u.u_texsize),u_texture:new o.Uniform1i(l,u.u_texture),u_gamma_scale:new o.Uniform1f(l,u.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(l,u.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(l,u.u_is_halo)}},symbolTextAndIcon:function(l,u){return{u_is_size_zoom_constant:new o.Uniform1i(l,u.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(l,u.u_is_size_feature_constant),u_size_t:new o.Uniform1f(l,u.u_size_t),u_size:new o.Uniform1f(l,u.u_size),u_camera_to_center_distance:new o.Uniform1f(l,u.u_camera_to_center_distance),u_pitch:new o.Uniform1f(l,u.u_pitch),u_rotate_symbol:new o.Uniform1i(l,u.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(l,u.u_aspect_ratio),u_fade_change:new o.Uniform1f(l,u.u_fade_change),u_matrix:new o.UniformMatrix4f(l,u.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(l,u.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(l,u.u_coord_matrix),u_is_text:new o.Uniform1i(l,u.u_is_text),u_pitch_with_map:new o.Uniform1i(l,u.u_pitch_with_map),u_texsize:new o.Uniform2f(l,u.u_texsize),u_texsize_icon:new o.Uniform2f(l,u.u_texsize_icon),u_texture:new o.Uniform1i(l,u.u_texture),u_texture_icon:new o.Uniform1i(l,u.u_texture_icon),u_gamma_scale:new o.Uniform1f(l,u.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(l,u.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(l,u.u_is_halo)}},background:function(l,u){return{u_matrix:new o.UniformMatrix4f(l,u.u_matrix),u_opacity:new o.Uniform1f(l,u.u_opacity),u_color:new o.UniformColor(l,u.u_color)}},backgroundPattern:function(l,u){return{u_matrix:new o.UniformMatrix4f(l,u.u_matrix),u_opacity:new o.Uniform1f(l,u.u_opacity),u_image:new o.Uniform1i(l,u.u_image),u_pattern_tl_a:new o.Uniform2f(l,u.u_pattern_tl_a),u_pattern_br_a:new o.Uniform2f(l,u.u_pattern_br_a),u_pattern_tl_b:new o.Uniform2f(l,u.u_pattern_tl_b),u_pattern_br_b:new o.Uniform2f(l,u.u_pattern_br_b),u_texsize:new o.Uniform2f(l,u.u_texsize),u_mix:new o.Uniform1f(l,u.u_mix),u_pattern_size_a:new o.Uniform2f(l,u.u_pattern_size_a),u_pattern_size_b:new o.Uniform2f(l,u.u_pattern_size_b),u_scale_a:new o.Uniform1f(l,u.u_scale_a),u_scale_b:new o.Uniform1f(l,u.u_scale_b),u_pixel_coord_upper:new o.Uniform2f(l,u.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(l,u.u_pixel_coord_lower),u_tile_units_to_pixels:new o.Uniform1f(l,u.u_tile_units_to_pixels)}}};function Oo(l,u,A,d,b,M,Q){for(var R=l.context,J=R.gl,Ae=l.useProgram("collisionBox"),Be=[],Ie=0,Te=0,He=0;He<d.length;He++){var Le=d[He],qe=u.getTile(Le),ke=qe.getBucket(A);if(ke){var Xe=Le.posMatrix;b[0]===0&&b[1]===0||(Xe=l.translatePosMatrix(Le.posMatrix,qe,b,M));var et=Q?ke.textCollisionBox:ke.iconCollisionBox,at=ke.collisionCircleArray;if(at.length>0){var mt=o.create(),Ze=Xe;o.mul(mt,ke.placementInvProjMatrix,l.transform.glCoordMatrix),o.mul(mt,mt,ke.placementViewportMatrix),Be.push({circleArray:at,circleOffset:Te,transform:Ze,invTransform:mt}),Te=Ie+=at.length/4}et&&Ae.draw(R,J.LINES,Fe.disabled,Re.disabled,l.colorModeForRenderPass(),st.disabled,ms(Xe,l.transform,qe),A.id,et.layoutVertexBuffer,et.indexBuffer,et.segments,null,l.transform.zoom,null,null,et.collisionVertexBuffer)}}if(Q&&Be.length){var bt=l.useProgram("collisionCircle"),Tt=new o.StructArrayLayout2f1f2i16;Tt.resize(4*Ie),Tt._trim();for(var Vt=0,Ht=0,hr=Be;Ht<hr.length;Ht+=1)for(var Er=hr[Ht],Mr=0;Mr<Er.circleArray.length/4;Mr++){var Ur=4*Mr,gi=Er.circleArray[Ur+0],lr=Er.circleArray[Ur+1],zr=Er.circleArray[Ur+2],$r=Er.circleArray[Ur+3];Tt.emplace(Vt++,gi,lr,zr,$r,0),Tt.emplace(Vt++,gi,lr,zr,$r,1),Tt.emplace(Vt++,gi,lr,zr,$r,2),Tt.emplace(Vt++,gi,lr,zr,$r,3)}(!Hl||Hl.length<2*Ie)&&(Hl=function(dn){var ao=2*dn,Vo=new o.StructArrayLayout3ui6;Vo.resize(ao),Vo._trim();for(var Un=0;Un<ao;Un++){var vo=6*Un;Vo.uint16[vo+0]=4*Un+0,Vo.uint16[vo+1]=4*Un+1,Vo.uint16[vo+2]=4*Un+2,Vo.uint16[vo+3]=4*Un+2,Vo.uint16[vo+4]=4*Un+3,Vo.uint16[vo+5]=4*Un+0}return Vo}(Ie));for(var qr=R.createIndexBuffer(Hl,!0),Zr=R.createVertexBuffer(Tt,o.collisionCircleLayout.members,!0),si=0,Lr=Be;si<Lr.length;si+=1){var Dr=Lr[si],Kn=qA(Dr.transform,Dr.invTransform,l.transform);bt.draw(R,J.TRIANGLES,Fe.disabled,Re.disabled,l.colorModeForRenderPass(),st.disabled,Kn,A.id,Zr,qr,o.SegmentVector.simpleSegment(0,2*Dr.circleOffset,Dr.circleArray.length,Dr.circleArray.length/2),null,l.transform.zoom,null,null,null)}Zr.destroy(),qr.destroy()}}var ho=o.identity(new Float32Array(16));function ts(l,u,A,d,b,M){var Q=o.getAnchorAlignment(l),R=-(Q.horizontalAlign-.5)*u,J=-(Q.verticalAlign-.5)*A,Ae=o.evaluateVariableOffset(l,d);return new o.Point((R/b+Ae[0])*M,(J/b+Ae[1])*M)}function po(l,u,A,d,b,M,Q,R,J,Ae,Be){var Ie=l.text.placedSymbolArray,Te=l.text.dynamicLayoutVertexArray,He=l.icon.dynamicLayoutVertexArray,Le={};Te.clear();for(var qe=0;qe<Ie.length;qe++){var ke=Ie.get(qe),Xe=ke.hidden||!ke.crossTileID||l.allowVerticalPlacement&&!ke.placedOrientation?null:d[ke.crossTileID];if(Xe){var et=new o.Point(ke.anchorX,ke.anchorY),at=Sr(et,A?R:Q),mt=Tr(M.cameraToCenterDistance,at.signedDistanceFromCamera),Ze=b.evaluateSizeForFeature(l.textSizeData,Ae,ke)*mt/o.ONE_EM;A&&(Ze*=l.tilePixelRatio/J);for(var bt=ts(Xe.anchor,Xe.width,Xe.height,Xe.textOffset,Xe.textBoxScale,Ze),Tt=A?Sr(et.add(bt),Q).point:at.point.add(u?bt.rotate(-M.angle):bt),Vt=l.allowVerticalPlacement&&ke.placedOrientation===o.WritingMode.vertical?Math.PI/2:0,Ht=0;Ht<ke.numGlyphs;Ht++)o.addDynamicAttributes(Te,Tt,Vt);Be&&ke.associatedIconIndex>=0&&(Le[ke.associatedIconIndex]={shiftedAnchor:Tt,angle:Vt})}else Eo(ke.numGlyphs,Te)}if(Be){He.clear();for(var hr=l.icon.placedSymbolArray,Er=0;Er<hr.length;Er++){var Mr=hr.get(Er);if(Mr.hidden)Eo(Mr.numGlyphs,He);else{var Ur=Le[Er];if(Ur)for(var gi=0;gi<Mr.numGlyphs;gi++)o.addDynamicAttributes(He,Ur.shiftedAnchor,Ur.angle);else Eo(Mr.numGlyphs,He)}}l.icon.dynamicLayoutVertexBuffer.updateData(He)}l.text.dynamicLayoutVertexBuffer.updateData(Te)}function La(l,u,A){return A.iconsInText&&u?"symbolTextAndIcon":l?"symbolSDF":"symbolIcon"}function za(l,u,A,d,b,M,Q,R,J,Ae,Be,Ie){for(var Te=l.context,He=Te.gl,Le=l.transform,qe=R==="map",ke=J==="map",Xe=qe&&A.layout.get("symbol-placement")!=="point",et=qe&&!ke&&!Xe,at=A.layout.get("symbol-sort-key").constantOr(1)!==void 0,mt=!1,Ze=l.depthModeForSublayer(0,Fe.ReadOnly),bt=A.layout.get("text-variable-anchor"),Tt=[],Vt=0,Ht=d;Vt<Ht.length;Vt+=1){var hr=Ht[Vt],Er=u.getTile(hr),Mr=Er.getBucket(A);if(Mr){var Ur=b?Mr.text:Mr.icon;if(Ur&&Ur.segments.get().length){var gi=Ur.programConfigurations.get(A.id),lr=b||Mr.sdfIcons,zr=b?Mr.textSizeData:Mr.iconSizeData,$r=ke||Le.pitch!==0,qr=l.useProgram(La(lr,b,Mr),gi),Zr=o.evaluateSizeForZoom(zr,Le.zoom),si=void 0,Lr=[0,0],Dr=void 0,Kn=void 0,dn=null,ao=void 0;if(b)Dr=Er.glyphAtlasTexture,Kn=He.LINEAR,si=Er.glyphAtlasTexture.size,Mr.iconsInText&&(Lr=Er.imageAtlasTexture.size,dn=Er.imageAtlasTexture,ao=$r||l.options.rotating||l.options.zooming||zr.kind==="composite"||zr.kind==="camera"?He.LINEAR:He.NEAREST);else{var Vo=A.layout.get("icon-size").constantOr(0)!==1||Mr.iconsNeedLinear;Dr=Er.imageAtlasTexture,Kn=lr||l.options.rotating||l.options.zooming||Vo||$r?He.LINEAR:He.NEAREST,si=Er.imageAtlasTexture.size}var Un=Ni(Er,1,l.transform.zoom),vo=Br(hr.posMatrix,ke,qe,l.transform,Un),Ea=vr(hr.posMatrix,ke,qe,l.transform,Un),en=bt&&Mr.hasTextData(),ns=A.layout.get("icon-text-fit")!=="none"&&en&&Mr.hasIconData();Xe&&Co(Mr,hr.posMatrix,l,b,vo,Ea,ke,Ae);var No=l.translatePosMatrix(hr.posMatrix,Er,M,Q),ma=Xe||b&&bt||ns?ho:vo,Ko=l.translatePosMatrix(Ea,Er,M,Q,!0),sl=lr&&A.paint.get(b?"text-halo-width":"icon-halo-width").constantOr(1)!==0,xl={program:qr,buffers:Ur,uniformValues:lr?Mr.iconsInText?ys(zr.kind,Zr,et,ke,l,No,ma,Ko,si,Lr):gs(zr.kind,Zr,et,ke,l,No,ma,Ko,b,si,!0):Da(zr.kind,Zr,et,ke,l,No,ma,Ko,b,si),atlasTexture:Dr,atlasTextureIcon:dn,atlasInterpolation:Kn,atlasInterpolationIcon:ao,isSDF:lr,hasHalo:sl};if(at&&Mr.canOverlap){mt=!0;for(var ll=0,IA=Ur.segments.get();ll<IA.length;ll+=1){var AA=IA[ll];Tt.push({segments:new o.SegmentVector([AA]),sortKey:AA.sortKey,state:xl})}}else Tt.push({segments:Ur.segments,sortKey:0,state:xl})}}}mt&&Tt.sort(function(Al,Wa){return Al.sortKey-Wa.sortKey});for(var bs=0,wl=Tt;bs<wl.length;bs+=1){var Vs=wl[bs],xo=Vs.state;if(Te.activeTexture.set(He.TEXTURE0),xo.atlasTexture.bind(xo.atlasInterpolation,He.CLAMP_TO_EDGE),xo.atlasTextureIcon&&(Te.activeTexture.set(He.TEXTURE1),xo.atlasTextureIcon&&xo.atlasTextureIcon.bind(xo.atlasInterpolationIcon,He.CLAMP_TO_EDGE)),xo.isSDF){var Ns=xo.uniformValues;xo.hasHalo&&(Ns.u_is_halo=1,vs(xo.buffers,Vs.segments,A,l,xo.program,Ze,Be,Ie,Ns)),Ns.u_is_halo=0}vs(xo.buffers,Vs.segments,A,l,xo.program,Ze,Be,Ie,xo.uniformValues)}}function vs(l,u,A,d,b,M,Q,R,J){var Ae=d.context;b.draw(Ae,Ae.gl.TRIANGLES,M,Q,R,st.disabled,J,A.id,l.layoutVertexBuffer,l.indexBuffer,u,A.paint,d.transform.zoom,l.programConfigurations.get(A.id),l.dynamicLayoutVertexBuffer,l.opacityVertexBuffer)}function ml(l,u,A,d,b,M,Q){var R,J,Ae,Be,Ie,Te=l.context.gl,He=A.paint.get("fill-pattern"),Le=He&&He.constantOr(1),qe=A.getCrossfadeParameters();Q?(J=Le&&!A.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",R=Te.LINES):(J=Le?"fillPattern":"fill",R=Te.TRIANGLES);for(var ke=0,Xe=d;ke<Xe.length;ke+=1){var et=Xe[ke],at=u.getTile(et);if(!Le||at.patternsLoaded()){var mt=at.getBucket(A);if(mt){var Ze=mt.programConfigurations.get(A.id),bt=l.useProgram(J,Ze);Le&&(l.context.activeTexture.set(Te.TEXTURE0),at.imageAtlasTexture.bind(Te.LINEAR,Te.CLAMP_TO_EDGE),Ze.updatePaintBuffers(qe));var Tt=He.constantOr(null);if(Tt&&at.imageAtlas){var Vt=at.imageAtlas,Ht=Vt.patternPositions[Tt.to.toString()],hr=Vt.patternPositions[Tt.from.toString()];Ht&&hr&&Ze.setConstantPatternPositions(Ht,hr)}var Er=l.translatePosMatrix(et.posMatrix,at,A.paint.get("fill-translate"),A.paint.get("fill-translate-anchor"));if(Q){Be=mt.indexBuffer2,Ie=mt.segments2;var Mr=[Te.drawingBufferWidth,Te.drawingBufferHeight];Ae=J==="fillOutlinePattern"&&Le?Tn(Er,l,qe,at,Mr):Za(Er,Mr)}else Be=mt.indexBuffer,Ie=mt.segments,Ae=Le?ua(Er,l,qe,at):sn(Er);bt.draw(l.context,R,b,l.stencilModeForClipping(et),M,st.disabled,Ae,A.id,mt.layoutVertexBuffer,Be,Ie,A.paint,l.transform.zoom,Ze)}}}}function el(l,u,A,d,b,M,Q){for(var R=l.context,J=R.gl,Ae=A.paint.get("fill-extrusion-pattern"),Be=Ae.constantOr(1),Ie=A.getCrossfadeParameters(),Te=A.paint.get("fill-extrusion-opacity"),He=0,Le=d;He<Le.length;He+=1){var qe=Le[He],ke=u.getTile(qe),Xe=ke.getBucket(A);if(Xe){var et=Xe.programConfigurations.get(A.id),at=l.useProgram(Be?"fillExtrusionPattern":"fillExtrusion",et);Be&&(l.context.activeTexture.set(J.TEXTURE0),ke.imageAtlasTexture.bind(J.LINEAR,J.CLAMP_TO_EDGE),et.updatePaintBuffers(Ie));var mt=Ae.constantOr(null);if(mt&&ke.imageAtlas){var Ze=ke.imageAtlas,bt=Ze.patternPositions[mt.to.toString()],Tt=Ze.patternPositions[mt.from.toString()];bt&&Tt&&et.setConstantPatternPositions(bt,Tt)}var Vt=l.translatePosMatrix(qe.posMatrix,ke,A.paint.get("fill-extrusion-translate"),A.paint.get("fill-extrusion-translate-anchor")),Ht=A.paint.get("fill-extrusion-vertical-gradient"),hr=Be?Yi(Vt,l,Ht,Te,qe,Ie,ke):Gi(Vt,l,Ht,Te);at.draw(R,R.gl.TRIANGLES,b,M,Q,st.backCCW,hr,A.id,Xe.layoutVertexBuffer,Xe.indexBuffer,Xe.segments,A.paint,l.transform.zoom,et)}}}function iA(l,u,A,d,b,M){var Q=l.context,R=Q.gl,J=u.fbo;if(J){var Ae=l.useProgram("hillshade");Q.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,J.colorAttachment.get());var Be=function(Ie,Te,He){var Le=He.paint.get("hillshade-shadow-color"),qe=He.paint.get("hillshade-highlight-color"),ke=He.paint.get("hillshade-accent-color"),Xe=He.paint.get("hillshade-illumination-direction")*(Math.PI/180);He.paint.get("hillshade-illumination-anchor")==="viewport"&&(Xe-=Ie.transform.angle);var et,at,mt,Ze=!Ie.options.moving;return{u_matrix:Ie.transform.calculatePosMatrix(Te.tileID.toUnwrapped(),Ze),u_image:0,u_latrange:(et=Te.tileID,at=Math.pow(2,et.canonical.z),mt=et.canonical.y,[new o.MercatorCoordinate(0,mt/at).toLngLat().lat,new o.MercatorCoordinate(0,(mt+1)/at).toLngLat().lat]),u_light:[He.paint.get("hillshade-exaggeration"),Xe],u_shadow:Le,u_highlight:qe,u_accent:ke}}(l,u,A);Ae.draw(Q,R.TRIANGLES,d,b,M,st.disabled,Be,A.id,l.rasterBoundsBuffer,l.quadTriangleIndexBuffer,l.rasterBoundsSegments)}}function Vl(l,u,A,d,b,M){var Q=l.context,R=Q.gl,J=u.dem;if(J&&J.data){var Ae=J.dim,Be=J.stride,Ie=J.getPixels();if(Q.activeTexture.set(R.TEXTURE1),Q.pixelStoreUnpackPremultiplyAlpha.set(!1),u.demTexture=u.demTexture||l.getTileTexture(Be),u.demTexture){var Te=u.demTexture;Te.update(Ie,{premultiply:!1}),Te.bind(R.NEAREST,R.CLAMP_TO_EDGE)}else u.demTexture=new o.Texture(Q,Ie,R.RGBA,{premultiply:!1}),u.demTexture.bind(R.NEAREST,R.CLAMP_TO_EDGE);Q.activeTexture.set(R.TEXTURE0);var He=u.fbo;if(!He){var Le=new o.Texture(Q,{width:Ae,height:Ae,data:null},R.RGBA);Le.bind(R.LINEAR,R.CLAMP_TO_EDGE),(He=u.fbo=Q.createFramebuffer(Ae,Ae,!0)).colorAttachment.set(Le.texture)}Q.bindFramebuffer.set(He.framebuffer),Q.viewport.set([0,0,Ae,Ae]),l.useProgram("hillshadePrepare").draw(Q,R.TRIANGLES,d,b,M,st.disabled,function(qe,ke){var Xe=ke.stride,et=o.create();return o.ortho(et,0,o.EXTENT,-o.EXTENT,0,0,1),o.translate(et,et,[0,-o.EXTENT,0]),{u_matrix:et,u_image:1,u_dimension:[Xe,Xe],u_zoom:qe.overscaledZ,u_unpack:ke.getUnpackVector()}}(u.tileID,J),A.id,l.rasterBoundsBuffer,l.quadTriangleIndexBuffer,l.rasterBoundsSegments),u.needsHillshadePrepare=!1}}function Ra(l,u,A,d,b){var M=d.paint.get("raster-fade-duration");if(M>0){var Q=o.browser.now(),R=(Q-l.timeAdded)/M,J=u?(Q-u.timeAdded)/M:-1,Ae=A.getSource(),Be=b.coveringZoomLevel({tileSize:Ae.tileSize,roundZoom:Ae.roundZoom}),Ie=!u||Math.abs(u.tileID.overscaledZ-Be)>Math.abs(l.tileID.overscaledZ-Be),Te=Ie&&l.refreshedUponExpiration?1:o.clamp(Ie?R:1-J,0,1);return l.refreshedUponExpiration&&R>=1&&(l.refreshedUponExpiration=!1),u?{opacity:1,mix:1-Te}:{opacity:Te,mix:0}}return{opacity:1,mix:0}}var tl=new o.Color(1,0,0,1),ZA=new o.Color(0,1,0,1),Ls=new o.Color(0,0,1,1),zs=new o.Color(1,0,1,1),pa=new o.Color(0,1,1,1);function gl(l,u,A,d){Nl(l,0,u+A/2,l.transform.width,A,d)}function Zn(l,u,A,d){Nl(l,u-A/2,0,A,l.transform.height,d)}function Nl(l,u,A,d,b,M){var Q=l.context,R=Q.gl;R.enable(R.SCISSOR_TEST),R.scissor(u*o.browser.devicePixelRatio,A*o.browser.devicePixelRatio,d*o.browser.devicePixelRatio,b*o.browser.devicePixelRatio),Q.clear({color:M}),R.disable(R.SCISSOR_TEST)}function Rs(l,u,A){var d=l.context,b=d.gl,M=A.posMatrix,Q=l.useProgram("debug"),R=Fe.disabled,J=Re.disabled,Ae=l.colorModeForRenderPass();d.activeTexture.set(b.TEXTURE0),l.emptyTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),Q.draw(d,b.LINE_STRIP,R,J,Ae,st.disabled,ha(M,o.Color.red),"$debug",l.debugBuffer,l.tileBorderIndexBuffer,l.debugSegments);var Be=u.getTileByID(A.key).latestRawTileData,Ie=Math.floor((Be&&Be.byteLength||0)/1024),Te=u.getTile(A).tileSize,He=512/Math.min(Te,512)*(A.overscaledZ/l.transform.zoom)*.5,Le=A.canonical.toString();A.overscaledZ!==A.canonical.z&&(Le+=" => "+A.overscaledZ),function(qe,ke){qe.initDebugOverlayCanvas();var Xe=qe.debugOverlayCanvas,et=qe.context.gl,at=qe.debugOverlayCanvas.getContext("2d");at.clearRect(0,0,Xe.width,Xe.height),at.shadowColor="white",at.shadowBlur=2,at.lineWidth=1.5,at.strokeStyle="white",at.textBaseline="top",at.font="bold 36px Open Sans, sans-serif",at.fillText(ke,5,5),at.strokeText(ke,5,5),qe.debugOverlayTexture.update(Xe),qe.debugOverlayTexture.bind(et.LINEAR,et.CLAMP_TO_EDGE)}(l,Le+" "+Ie+"kb"),Q.draw(d,b.TRIANGLES,R,J,We.alphaBlended,st.disabled,ha(M,o.Color.transparent,He),"$debug",l.debugBuffer,l.quadTriangleIndexBuffer,l.debugSegments)}var rl={symbol:function(l,u,A,d,b){if(l.renderPass==="translucent"){var M=Re.disabled,Q=l.colorModeForRenderPass();A.layout.get("text-variable-anchor")&&function(R,J,Ae,Be,Ie,Te,He){for(var Le=J.transform,qe=Ie==="map",ke=Te==="map",Xe=0,et=R;Xe<et.length;Xe+=1){var at=et[Xe],mt=Be.getTile(at),Ze=mt.getBucket(Ae);if(Ze&&Ze.text&&Ze.text.segments.get().length){var bt=o.evaluateSizeForZoom(Ze.textSizeData,Le.zoom),Tt=Ni(mt,1,J.transform.zoom),Vt=Br(at.posMatrix,ke,qe,J.transform,Tt),Ht=Ae.layout.get("icon-text-fit")!=="none"&&Ze.hasIconData();if(bt){var hr=Math.pow(2,Le.zoom-mt.tileID.overscaledZ);po(Ze,qe,ke,He,o.symbolSize,Le,Vt,at.posMatrix,hr,bt,Ht)}}}}(d,l,A,u,A.layout.get("text-rotation-alignment"),A.layout.get("text-pitch-alignment"),b),A.paint.get("icon-opacity").constantOr(1)!==0&&za(l,u,A,d,!1,A.paint.get("icon-translate"),A.paint.get("icon-translate-anchor"),A.layout.get("icon-rotation-alignment"),A.layout.get("icon-pitch-alignment"),A.layout.get("icon-keep-upright"),M,Q),A.paint.get("text-opacity").constantOr(1)!==0&&za(l,u,A,d,!0,A.paint.get("text-translate"),A.paint.get("text-translate-anchor"),A.layout.get("text-rotation-alignment"),A.layout.get("text-pitch-alignment"),A.layout.get("text-keep-upright"),M,Q),u.map.showCollisionBoxes&&(Oo(l,u,A,d,A.paint.get("text-translate"),A.paint.get("text-translate-anchor"),!0),Oo(l,u,A,d,A.paint.get("icon-translate"),A.paint.get("icon-translate-anchor"),!1))}},circle:function(l,u,A,d){if(l.renderPass==="translucent"){var b=A.paint.get("circle-opacity"),M=A.paint.get("circle-stroke-width"),Q=A.paint.get("circle-stroke-opacity"),R=A.layout.get("circle-sort-key").constantOr(1)!==void 0;if(b.constantOr(1)!==0||M.constantOr(1)!==0&&Q.constantOr(1)!==0){for(var J=l.context,Ae=J.gl,Be=l.depthModeForSublayer(0,Fe.ReadOnly),Ie=Re.disabled,Te=l.colorModeForRenderPass(),He=[],Le=0;Le<d.length;Le++){var qe=d[Le],ke=u.getTile(qe),Xe=ke.getBucket(A);if(Xe){var et=Xe.programConfigurations.get(A.id),at={programConfiguration:et,program:l.useProgram("circle",et),layoutVertexBuffer:Xe.layoutVertexBuffer,indexBuffer:Xe.indexBuffer,uniformValues:$A(l,qe,ke,A)};if(R)for(var mt=0,Ze=Xe.segments.get();mt<Ze.length;mt+=1){var bt=Ze[mt];He.push({segments:new o.SegmentVector([bt]),sortKey:bt.sortKey,state:at})}else He.push({segments:Xe.segments,sortKey:0,state:at})}}R&&He.sort(function(Er,Mr){return Er.sortKey-Mr.sortKey});for(var Tt=0,Vt=He;Tt<Vt.length;Tt+=1){var Ht=Vt[Tt],hr=Ht.state;hr.program.draw(J,Ae.TRIANGLES,Be,Ie,Te,st.disabled,hr.uniformValues,A.id,hr.layoutVertexBuffer,hr.indexBuffer,Ht.segments,A.paint,l.transform.zoom,hr.programConfiguration)}}}},heatmap:function(l,u,A,d){if(A.paint.get("heatmap-opacity")!==0)if(l.renderPass==="offscreen"){var b=l.context,M=b.gl,Q=Re.disabled,R=new We([M.ONE,M.ONE],o.Color.transparent,[!0,!0,!0,!0]);(function(He,Le,qe){var ke=He.gl;He.activeTexture.set(ke.TEXTURE1),He.viewport.set([0,0,Le.width/4,Le.height/4]);var Xe=qe.heatmapFbo;if(Xe)ke.bindTexture(ke.TEXTURE_2D,Xe.colorAttachment.get()),He.bindFramebuffer.set(Xe.framebuffer);else{var et=ke.createTexture();ke.bindTexture(ke.TEXTURE_2D,et),ke.texParameteri(ke.TEXTURE_2D,ke.TEXTURE_WRAP_S,ke.CLAMP_TO_EDGE),ke.texParameteri(ke.TEXTURE_2D,ke.TEXTURE_WRAP_T,ke.CLAMP_TO_EDGE),ke.texParameteri(ke.TEXTURE_2D,ke.TEXTURE_MIN_FILTER,ke.LINEAR),ke.texParameteri(ke.TEXTURE_2D,ke.TEXTURE_MAG_FILTER,ke.LINEAR),Xe=qe.heatmapFbo=He.createFramebuffer(Le.width/4,Le.height/4,!1),function(at,mt,Ze,bt){var Tt=at.gl;Tt.texImage2D(Tt.TEXTURE_2D,0,Tt.RGBA,mt.width/4,mt.height/4,0,Tt.RGBA,at.extRenderToTextureHalfFloat?at.extTextureHalfFloat.HALF_FLOAT_OES:Tt.UNSIGNED_BYTE,null),bt.colorAttachment.set(Ze)}(He,Le,et,Xe)}})(b,l,A),b.clear({color:o.Color.transparent});for(var J=0;J<d.length;J++){var Ae=d[J];if(!u.hasRenderableParent(Ae)){var Be=u.getTile(Ae),Ie=Be.getBucket(A);if(Ie){var Te=Ie.programConfigurations.get(A.id);l.useProgram("heatmap",Te).draw(b,M.TRIANGLES,Fe.disabled,Q,R,st.disabled,zl(Ae.posMatrix,Be,l.transform.zoom,A.paint.get("heatmap-intensity")),A.id,Ie.layoutVertexBuffer,Ie.indexBuffer,Ie.segments,A.paint,l.transform.zoom,Te)}}}b.viewport.set([0,0,l.width,l.height])}else l.renderPass==="translucent"&&(l.context.setColorMode(l.colorModeForRenderPass()),function(He,Le){var qe=He.context,ke=qe.gl,Xe=Le.heatmapFbo;if(Xe){qe.activeTexture.set(ke.TEXTURE0),ke.bindTexture(ke.TEXTURE_2D,Xe.colorAttachment.get()),qe.activeTexture.set(ke.TEXTURE1);var et=Le.colorRampTexture;et||(et=Le.colorRampTexture=new o.Texture(qe,Le.colorRamp,ke.RGBA)),et.bind(ke.LINEAR,ke.CLAMP_TO_EDGE),He.useProgram("heatmapTexture").draw(qe,ke.TRIANGLES,Fe.disabled,Re.disabled,He.colorModeForRenderPass(),st.disabled,function(at,mt,Ze,bt){var Tt=o.create();o.ortho(Tt,0,at.width,at.height,0,0,1);var Vt=at.context.gl;return{u_matrix:Tt,u_world:[Vt.drawingBufferWidth,Vt.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:mt.paint.get("heatmap-opacity")}}(He,Le),Le.id,He.viewportBuffer,He.quadTriangleIndexBuffer,He.viewportSegments,Le.paint,He.transform.zoom)}}(l,A))},line:function(l,u,A,d){if(l.renderPass==="translucent"){var b=A.paint.get("line-opacity"),M=A.paint.get("line-width");if(b.constantOr(1)!==0&&M.constantOr(1)!==0)for(var Q=l.depthModeForSublayer(0,Fe.ReadOnly),R=l.colorModeForRenderPass(),J=A.paint.get("line-dasharray"),Ae=A.paint.get("line-pattern"),Be=Ae.constantOr(1),Ie=A.paint.get("line-gradient"),Te=A.getCrossfadeParameters(),He=Be?"linePattern":J?"lineSDF":Ie?"lineGradient":"line",Le=l.context,qe=Le.gl,ke=!0,Xe=0,et=d;Xe<et.length;Xe+=1){var at=et[Xe],mt=u.getTile(at);if(!Be||mt.patternsLoaded()){var Ze=mt.getBucket(A);if(Ze){var bt=Ze.programConfigurations.get(A.id),Tt=l.context.program.get(),Vt=l.useProgram(He,bt),Ht=ke||Vt.program!==Tt,hr=Ae.constantOr(null);if(hr&&mt.imageAtlas){var Er=mt.imageAtlas,Mr=Er.patternPositions[hr.to.toString()],Ur=Er.patternPositions[hr.from.toString()];Mr&&Ur&&bt.setConstantPatternPositions(Mr,Ur)}var gi=Be?Rl(l,mt,A,Te):J?To(l,mt,A,J,Te):Ie?Ai(l,mt,A,Ze.lineClipsArray.length):ta(l,mt,A);if(Be)Le.activeTexture.set(qe.TEXTURE0),mt.imageAtlasTexture.bind(qe.LINEAR,qe.CLAMP_TO_EDGE),bt.updatePaintBuffers(Te);else if(J&&(Ht||l.lineAtlas.dirty))Le.activeTexture.set(qe.TEXTURE0),l.lineAtlas.bind(Le);else if(Ie){var lr=Ze.gradients[A.id],zr=lr.texture;if(A.gradientVersion!==lr.version){var $r=256;if(A.stepInterpolant){var qr=u.getSource().maxzoom,Zr=at.canonical.z===qr?Math.ceil(1<<l.transform.maxZoom-at.canonical.z):1;$r=o.clamp(o.nextPowerOfTwo(Ze.maxLineLength/o.EXTENT*1024*Zr),256,Le.maxTextureSize)}lr.gradient=o.renderColorRamp({expression:A.gradientExpression(),evaluationKey:"lineProgress",resolution:$r,image:lr.gradient||void 0,clips:Ze.lineClipsArray}),lr.texture?lr.texture.update(lr.gradient):lr.texture=new o.Texture(Le,lr.gradient,qe.RGBA),lr.version=A.gradientVersion,zr=lr.texture}Le.activeTexture.set(qe.TEXTURE0),zr.bind(A.stepInterpolant?qe.NEAREST:qe.LINEAR,qe.CLAMP_TO_EDGE)}Vt.draw(Le,qe.TRIANGLES,Q,l.stencilModeForClipping(at),R,st.disabled,gi,A.id,Ze.layoutVertexBuffer,Ze.indexBuffer,Ze.segments,A.paint,l.transform.zoom,bt,Ze.layoutVertexBuffer2),ke=!1}}}}},fill:function(l,u,A,d){var b=A.paint.get("fill-color"),M=A.paint.get("fill-opacity");if(M.constantOr(1)!==0){var Q=l.colorModeForRenderPass(),R=A.paint.get("fill-pattern"),J=l.opaquePassEnabledForLayer()&&!R.constantOr(1)&&b.constantOr(o.Color.transparent).a===1&&M.constantOr(0)===1?"opaque":"translucent";if(l.renderPass===J){var Ae=l.depthModeForSublayer(1,l.renderPass==="opaque"?Fe.ReadWrite:Fe.ReadOnly);ml(l,u,A,d,Ae,Q,!1)}if(l.renderPass==="translucent"&&A.paint.get("fill-antialias")){var Be=l.depthModeForSublayer(A.getPaintProperty("fill-outline-color")?2:0,Fe.ReadOnly);ml(l,u,A,d,Be,Q,!0)}}},"fill-extrusion":function(l,u,A,d){var b=A.paint.get("fill-extrusion-opacity");if(b!==0&&l.renderPass==="translucent"){var M=new Fe(l.context.gl.LEQUAL,Fe.ReadWrite,l.depthRangeFor3D);if(b!==1||A.paint.get("fill-extrusion-pattern").constantOr(1))el(l,u,A,d,M,Re.disabled,We.disabled),el(l,u,A,d,M,l.stencilModeFor3D(),l.colorModeForRenderPass());else{var Q=l.colorModeForRenderPass();el(l,u,A,d,M,Re.disabled,Q)}}},hillshade:function(l,u,A,d){if(l.renderPass==="offscreen"||l.renderPass==="translucent"){for(var b=l.context,M=l.depthModeForSublayer(0,Fe.ReadOnly),Q=l.colorModeForRenderPass(),R=l.renderPass==="translucent"?l.stencilConfigForOverlap(d):[{},d],J=R[0],Ae=0,Be=R[1];Ae<Be.length;Ae+=1){var Ie=Be[Ae],Te=u.getTile(Ie);Te.needsHillshadePrepare&&l.renderPass==="offscreen"?Vl(l,Te,A,M,Re.disabled,Q):l.renderPass==="translucent"&&iA(l,Te,A,M,J[Ie.overscaledZ],Q)}b.viewport.set([0,0,l.width,l.height])}},raster:function(l,u,A,d){if(l.renderPass==="translucent"&&A.paint.get("raster-opacity")!==0&&d.length)for(var b=l.context,M=b.gl,Q=u.getSource(),R=l.useProgram("raster"),J=l.colorModeForRenderPass(),Ae=Q instanceof ki?[{},d]:l.stencilConfigForOverlap(d),Be=Ae[0],Ie=Ae[1],Te=Ie[Ie.length-1].overscaledZ,He=!l.options.moving,Le=0,qe=Ie;Le<qe.length;Le+=1){var ke=qe[Le],Xe=l.depthModeForSublayer(ke.overscaledZ-Te,A.paint.get("raster-opacity")===1?Fe.ReadWrite:Fe.ReadOnly,M.LESS),et=u.getTile(ke),at=l.transform.calculatePosMatrix(ke.toUnwrapped(),He);et.registerFadeDuration(A.paint.get("raster-fade-duration"));var mt=u.findLoadedParent(ke,0),Ze=Ra(et,mt,u,A,l.transform),bt=void 0,Tt=void 0,Vt=A.paint.get("raster-resampling")==="nearest"?M.NEAREST:M.LINEAR;b.activeTexture.set(M.TEXTURE0),et.texture.bind(Vt,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),b.activeTexture.set(M.TEXTURE1),mt?(mt.texture.bind(Vt,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),bt=Math.pow(2,mt.tileID.overscaledZ-et.tileID.overscaledZ),Tt=[et.tileID.canonical.x*bt%1,et.tileID.canonical.y*bt%1]):et.texture.bind(Vt,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST);var Ht=Ol(at,Tt||[0,0],bt||1,Ze,A);Q instanceof ki?R.draw(b,M.TRIANGLES,Xe,Re.disabled,J,st.disabled,Ht,A.id,Q.boundsBuffer,l.quadTriangleIndexBuffer,Q.boundsSegments):R.draw(b,M.TRIANGLES,Xe,Be[ke.overscaledZ],J,st.disabled,Ht,A.id,l.rasterBoundsBuffer,l.quadTriangleIndexBuffer,l.rasterBoundsSegments)}},background:function(l,u,A){var d=A.paint.get("background-color"),b=A.paint.get("background-opacity");if(b!==0){var M=l.context,Q=M.gl,R=l.transform,J=R.tileSize,Ae=A.paint.get("background-pattern");if(!l.isPatternMissing(Ae)){var Be=!Ae&&d.a===1&&b===1&&l.opaquePassEnabledForLayer()?"opaque":"translucent";if(l.renderPass===Be){var Ie=Re.disabled,Te=l.depthModeForSublayer(0,Be==="opaque"?Fe.ReadWrite:Fe.ReadOnly),He=l.colorModeForRenderPass(),Le=l.useProgram(Ae?"backgroundPattern":"background"),qe=R.coveringTiles({tileSize:J});Ae&&(M.activeTexture.set(Q.TEXTURE0),l.imageManager.bind(l.context));for(var ke=A.getCrossfadeParameters(),Xe=0,et=qe;Xe<et.length;Xe+=1){var at=et[Xe],mt=l.transform.calculatePosMatrix(at.toUnwrapped()),Ze=Ae?_s(mt,b,l,Ae,{tileID:at,tileSize:J},ke):Ys(mt,b,d);Le.draw(M,Q.TRIANGLES,Te,Ie,He,st.disabled,Ze,A.id,l.tileExtentBuffer,l.quadTriangleIndexBuffer,l.tileExtentSegments)}}}}},debug:function(l,u,A){for(var d=0;d<A.length;d++)Rs(l,u,A[d])},custom:function(l,u,A){var d=l.context,b=A.implementation;if(l.renderPass==="offscreen"){var M=b.prerender;M&&(l.setCustomLayerDefaults(),d.setColorMode(l.colorModeForRenderPass()),M.call(b,d.gl,l.transform.customLayerMatrix()),d.setDirty(),l.setBaseState())}else if(l.renderPass==="translucent"){l.setCustomLayerDefaults(),d.setColorMode(l.colorModeForRenderPass()),d.setStencilMode(Re.disabled);var Q=b.renderingMode==="3d"?new Fe(l.context.gl.LEQUAL,Fe.ReadWrite,l.depthRangeFor3D):l.depthModeForSublayer(0,Fe.ReadOnly);d.setDepthMode(Q),b.render(d.gl,l.transform.customLayerMatrix()),d.setDirty(),l.setBaseState(),d.bindFramebuffer.set(null)}}},Oi=function(l,u){this.context=new Ee(l),this.transform=u,this._tileTextures={},this.setup(),this.numSublayers=X.maxUnderzooming+X.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ti,this.gpuTimers={}};Oi.prototype.resize=function(l,u){if(this.width=l*o.browser.devicePixelRatio,this.height=u*o.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var A=0,d=this.style._order;A<d.length;A+=1)this.style._layers[d[A]].resize()},Oi.prototype.setup=function(){var l=this.context,u=new o.StructArrayLayout2i4;u.emplaceBack(0,0),u.emplaceBack(o.EXTENT,0),u.emplaceBack(0,o.EXTENT),u.emplaceBack(o.EXTENT,o.EXTENT),this.tileExtentBuffer=l.createVertexBuffer(u,Li.members),this.tileExtentSegments=o.SegmentVector.simpleSegment(0,0,4,2);var A=new o.StructArrayLayout2i4;A.emplaceBack(0,0),A.emplaceBack(o.EXTENT,0),A.emplaceBack(0,o.EXTENT),A.emplaceBack(o.EXTENT,o.EXTENT),this.debugBuffer=l.createVertexBuffer(A,Li.members),this.debugSegments=o.SegmentVector.simpleSegment(0,0,4,5);var d=new o.StructArrayLayout4i8;d.emplaceBack(0,0,0,0),d.emplaceBack(o.EXTENT,0,o.EXTENT,0),d.emplaceBack(0,o.EXTENT,0,o.EXTENT),d.emplaceBack(o.EXTENT,o.EXTENT,o.EXTENT,o.EXTENT),this.rasterBoundsBuffer=l.createVertexBuffer(d,ii.members),this.rasterBoundsSegments=o.SegmentVector.simpleSegment(0,0,4,2);var b=new o.StructArrayLayout2i4;b.emplaceBack(0,0),b.emplaceBack(1,0),b.emplaceBack(0,1),b.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(b,Li.members),this.viewportSegments=o.SegmentVector.simpleSegment(0,0,4,2);var M=new o.StructArrayLayout1ui2;M.emplaceBack(0),M.emplaceBack(1),M.emplaceBack(3),M.emplaceBack(2),M.emplaceBack(0),this.tileBorderIndexBuffer=l.createIndexBuffer(M);var Q=new o.StructArrayLayout3ui6;Q.emplaceBack(0,1,2),Q.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(Q),this.emptyTexture=new o.Texture(l,{width:1,height:1,data:new Uint8Array([0,0,0,0])},l.gl.RGBA);var R=this.context.gl;this.stencilClearMode=new Re({func:R.ALWAYS,mask:0},0,255,R.ZERO,R.ZERO,R.ZERO)},Oi.prototype.clearStencil=function(){var l=this.context,u=l.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var A=o.create();o.ortho(A,0,this.width,this.height,0,0,1),o.scale(A,A,[u.drawingBufferWidth,u.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(l,u.TRIANGLES,Fe.disabled,this.stencilClearMode,We.disabled,st.disabled,So(A),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Oi.prototype._renderTileClippingMasks=function(l,u){if(this.currentStencilSource!==l.source&&l.isTileClipped()&&u&&u.length){this.currentStencilSource=l.source;var A=this.context,d=A.gl;this.nextStencilID+u.length>256&&this.clearStencil(),A.setColorMode(We.disabled),A.setDepthMode(Fe.disabled);var b=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var M=0,Q=u;M<Q.length;M+=1){var R=Q[M],J=this._tileClippingMaskIDs[R.key]=this.nextStencilID++;b.draw(A,d.TRIANGLES,Fe.disabled,new Re({func:d.ALWAYS,mask:0},J,255,d.KEEP,d.KEEP,d.REPLACE),We.disabled,st.disabled,So(R.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Oi.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var l=this.nextStencilID++,u=this.context.gl;return new Re({func:u.NOTEQUAL,mask:255},l,255,u.KEEP,u.KEEP,u.REPLACE)},Oi.prototype.stencilModeForClipping=function(l){var u=this.context.gl;return new Re({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,u.KEEP,u.KEEP,u.REPLACE)},Oi.prototype.stencilConfigForOverlap=function(l){var u,A=this.context.gl,d=l.sort(function(J,Ae){return Ae.overscaledZ-J.overscaledZ}),b=d[d.length-1].overscaledZ,M=d[0].overscaledZ-b+1;if(M>1){this.currentStencilSource=void 0,this.nextStencilID+M>256&&this.clearStencil();for(var Q={},R=0;R<M;R++)Q[R+b]=new Re({func:A.GEQUAL,mask:255},R+this.nextStencilID,255,A.KEEP,A.KEEP,A.REPLACE);return this.nextStencilID+=M,[Q,d]}return[(u={},u[b]=Re.disabled,u),d]},Oi.prototype.colorModeForRenderPass=function(){var l=this.context.gl;return this._showOverdrawInspector?new We([l.CONSTANT_COLOR,l.ONE],new o.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?We.unblended:We.alphaBlended},Oi.prototype.depthModeForSublayer=function(l,u,A){if(!this.opaquePassEnabledForLayer())return Fe.disabled;var d=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new Fe(A||this.context.gl.LEQUAL,u,[d,d])},Oi.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Oi.prototype.render=function(l,u){var A=this;this.style=l,this.options=u,this.lineAtlas=l.lineAtlas,this.imageManager=l.imageManager,this.glyphManager=l.glyphManager,this.symbolFadeChange=l.placement.symbolFadeChange(o.browser.now()),this.imageManager.beginFrame();var d=this.style._order,b=this.style.sourceCaches;for(var M in b){var Q=b[M];Q.used&&Q.prepare(this.context)}var R,J,Ae={},Be={},Ie={};for(var Te in b){var He=b[Te];Ae[Te]=He.getVisibleCoordinates(),Be[Te]=Ae[Te].slice().reverse(),Ie[Te]=He.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Le=0;Le<d.length;Le++)if(this.style._layers[d[Le]].is3D()){this.opaquePassCutoff=Le;break}this.renderPass="offscreen";for(var qe=0,ke=d;qe<ke.length;qe+=1){var Xe=this.style._layers[ke[qe]];if(Xe.hasOffscreenPass()&&!Xe.isHidden(this.transform.zoom)){var et=Be[Xe.source];(Xe.type==="custom"||et.length)&&this.renderLayer(this,b[Xe.source],Xe,et)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:u.showOverdrawInspector?o.Color.black:o.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.depthRangeFor3D=[0,1-(l._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=d.length-1;this.currentLayer>=0;this.currentLayer--){var at=this.style._layers[d[this.currentLayer]],mt=b[at.source],Ze=Ae[at.source];this._renderTileClippingMasks(at,Ze),this.renderLayer(this,mt,at,Ze)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<d.length;this.currentLayer++){var bt=this.style._layers[d[this.currentLayer]],Tt=b[bt.source],Vt=(bt.type==="symbol"?Ie:Be)[bt.source];this._renderTileClippingMasks(bt,Ae[bt.source]),this.renderLayer(this,Tt,bt,Vt)}this.options.showTileBoundaries&&(o.values(this.style._layers).forEach(function(Ht){Ht.source&&!Ht.isHidden(A.transform.zoom)&&(Ht.source!==(J&&J.id)&&(J=A.style.sourceCaches[Ht.source]),(!R||R.getSource().maxzoom<J.getSource().maxzoom)&&(R=J))}),R&&rl.debug(this,R,R.getVisibleCoordinates())),this.options.showPadding&&function(Ht){var hr=Ht.transform.padding;gl(Ht,Ht.transform.height-(hr.top||0),3,tl),gl(Ht,hr.bottom||0,3,ZA),Zn(Ht,hr.left||0,3,Ls),Zn(Ht,Ht.transform.width-(hr.right||0),3,zs);var Er=Ht.transform.centerPoint;(function(Mr,Ur,gi,lr){Nl(Mr,Ur-1,gi-10,2,20,lr),Nl(Mr,Ur-10,gi-1,20,2,lr)})(Ht,Er.x,Ht.transform.height-Er.y,pa)}(this),this.context.setDefault()},Oi.prototype.renderLayer=function(l,u,A,d){A.isHidden(this.transform.zoom)||(A.type==="background"||A.type==="custom"||d.length)&&(this.id=A.id,this.gpuTimingStart(A),rl[A.type](l,u,A,d,this.style.placement.variableOffsets),this.gpuTimingEnd())},Oi.prototype.gpuTimingStart=function(l){if(this.options.gpuTiming){var u=this.context.extTimerQuery,A=this.gpuTimers[l.id];A||(A=this.gpuTimers[l.id]={calls:0,cpuTime:0,query:u.createQueryEXT()}),A.calls++,u.beginQueryEXT(u.TIME_ELAPSED_EXT,A.query)}},Oi.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var l=this.context.extTimerQuery;l.endQueryEXT(l.TIME_ELAPSED_EXT)}},Oi.prototype.collectGpuTimers=function(){var l=this.gpuTimers;return this.gpuTimers={},l},Oi.prototype.queryGpuTimers=function(l){var u={};for(var A in l){var d=l[A],b=this.context.extTimerQuery,M=b.getQueryObjectEXT(d.query,b.QUERY_RESULT_EXT)/1e6;b.deleteQueryEXT(d.query),u[A]=M}return u},Oi.prototype.translatePosMatrix=function(l,u,A,d,b){if(!A[0]&&!A[1])return l;var M=b?d==="map"?this.transform.angle:0:d==="viewport"?-this.transform.angle:0;if(M){var Q=Math.sin(M),R=Math.cos(M);A=[A[0]*R-A[1]*Q,A[0]*Q+A[1]*R]}var J=[b?A[0]:Ni(u,A[0],this.transform.zoom),b?A[1]:Ni(u,A[1],this.transform.zoom),0],Ae=new Float32Array(16);return o.translate(Ae,l,J),Ae},Oi.prototype.saveTileTexture=function(l){var u=this._tileTextures[l.size[0]];u?u.push(l):this._tileTextures[l.size[0]]=[l]},Oi.prototype.getTileTexture=function(l){var u=this._tileTextures[l];return u&&u.length>0?u.pop():null},Oi.prototype.isPatternMissing=function(l){if(!l)return!1;if(!l.from||!l.to)return!0;var u=this.imageManager.getPattern(l.from.toString()),A=this.imageManager.getPattern(l.to.toString());return!u||!A},Oi.prototype.useProgram=function(l,u){this.cache=this.cache||{};var A=""+l+(u?u.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[A]||(this.cache[A]=new jA(this.context,l,gc[l],u,BA[l],this._showOverdrawInspector)),this.cache[A]},Oi.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Oi.prototype.setBaseState=function(){var l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)},Oi.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=o.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},Oi.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var il=function(l,u){this.points=l,this.planes=u};il.fromInvProjectionMatrix=function(l,u,A){var d=Math.pow(2,A),b=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(Q){return o.transformMat4([],Q,l)}).map(function(Q){return o.scale$1([],Q,1/Q[3]/u*d)}),M=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(Q){var R=o.sub([],b[Q[0]],b[Q[1]]),J=o.sub([],b[Q[2]],b[Q[1]]),Ae=o.normalize([],o.cross([],R,J)),Be=-o.dot(Ae,b[Q[1]]);return Ae.concat(Be)});return new il(b,M)};var xs=function(l,u){this.min=l,this.max=u,this.center=o.scale$2([],o.add([],this.min,this.max),.5)};xs.prototype.quadrant=function(l){for(var u=[l%2==0,l<2],A=o.clone$2(this.min),d=o.clone$2(this.max),b=0;b<u.length;b++)A[b]=u[b]?this.min[b]:this.center[b],d[b]=u[b]?this.center[b]:this.max[b];return d[2]=this.max[2],new xs(A,d)},xs.prototype.distanceX=function(l){return Math.max(Math.min(this.max[0],l[0]),this.min[0])-l[0]},xs.prototype.distanceY=function(l){return Math.max(Math.min(this.max[1],l[1]),this.min[1])-l[1]},xs.prototype.intersects=function(l){for(var u=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],A=!0,d=0;d<l.planes.length;d++){for(var b=l.planes[d],M=0,Q=0;Q<u.length;Q++)M+=o.dot$1(b,u[Q])>=0;if(M===0)return 0;M!==u.length&&(A=!1)}if(A)return 2;for(var R=0;R<3;R++){for(var J=Number.MAX_VALUE,Ae=-Number.MAX_VALUE,Be=0;Be<l.points.length;Be++){var Ie=l.points[Be][R]-this.min[R];J=Math.min(J,Ie),Ae=Math.max(Ae,Ie)}if(Ae<0||J>this.max[R]-this.min[R])return 0}return 1};var Os=function(l,u,A,d){if(l===void 0&&(l=0),u===void 0&&(u=0),A===void 0&&(A=0),d===void 0&&(d=0),isNaN(l)||l<0||isNaN(u)||u<0||isNaN(A)||A<0||isNaN(d)||d<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=u,this.left=A,this.right=d};Os.prototype.interpolate=function(l,u,A){return u.top!=null&&l.top!=null&&(this.top=o.number(l.top,u.top,A)),u.bottom!=null&&l.bottom!=null&&(this.bottom=o.number(l.bottom,u.bottom,A)),u.left!=null&&l.left!=null&&(this.left=o.number(l.left,u.left,A)),u.right!=null&&l.right!=null&&(this.right=o.number(l.right,u.right,A)),this},Os.prototype.getCenter=function(l,u){var A=o.clamp((this.left+l-this.right)/2,0,l),d=o.clamp((this.top+u-this.bottom)/2,0,u);return new o.Point(A,d)},Os.prototype.equals=function(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right},Os.prototype.clone=function(){return new Os(this.top,this.bottom,this.left,this.right)},Os.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Ei=function(l,u,A,d,b){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=b===void 0||b,this._minZoom=l||0,this._maxZoom=u||22,this._minPitch=A==null?0:A,this._maxPitch=d==null?60:d,this.setMaxBounds(),this.width=0,this.height=0,this._center=new o.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Os,this._posMatrixCache={},this._alignedPosMatrixCache={}},ln={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Ei.prototype.clone=function(){var l=new Ei(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return l.tileSize=this.tileSize,l.latRange=this.latRange,l.width=this.width,l.height=this.height,l._center=this._center,l.zoom=this.zoom,l.angle=this.angle,l._fov=this._fov,l._pitch=this._pitch,l._unmodified=this._unmodified,l._edgeInsets=this._edgeInsets.clone(),l._calcMatrices(),l},ln.minZoom.get=function(){return this._minZoom},ln.minZoom.set=function(l){this._minZoom!==l&&(this._minZoom=l,this.zoom=Math.max(this.zoom,l))},ln.maxZoom.get=function(){return this._maxZoom},ln.maxZoom.set=function(l){this._maxZoom!==l&&(this._maxZoom=l,this.zoom=Math.min(this.zoom,l))},ln.minPitch.get=function(){return this._minPitch},ln.minPitch.set=function(l){this._minPitch!==l&&(this._minPitch=l,this.pitch=Math.max(this.pitch,l))},ln.maxPitch.get=function(){return this._maxPitch},ln.maxPitch.set=function(l){this._maxPitch!==l&&(this._maxPitch=l,this.pitch=Math.min(this.pitch,l))},ln.renderWorldCopies.get=function(){return this._renderWorldCopies},ln.renderWorldCopies.set=function(l){l===void 0?l=!0:l===null&&(l=!1),this._renderWorldCopies=l},ln.worldSize.get=function(){return this.tileSize*this.scale},ln.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},ln.size.get=function(){return new o.Point(this.width,this.height)},ln.bearing.get=function(){return-this.angle/Math.PI*180},ln.bearing.set=function(l){var u=-o.wrap(l,-180,180)*Math.PI/180;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=o.create$2(),o.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},ln.pitch.get=function(){return this._pitch/Math.PI*180},ln.pitch.set=function(l){var u=o.clamp(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())},ln.fov.get=function(){return this._fov/Math.PI*180},ln.fov.set=function(l){l=Math.max(.01,Math.min(60,l)),this._fov!==l&&(this._unmodified=!1,this._fov=l/180*Math.PI,this._calcMatrices())},ln.zoom.get=function(){return this._zoom},ln.zoom.set=function(l){var u=Math.min(Math.max(l,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._zoom=u,this.scale=this.zoomScale(u),this.tileZoom=Math.floor(u),this.zoomFraction=u-this.tileZoom,this._constrain(),this._calcMatrices())},ln.center.get=function(){return this._center},ln.center.set=function(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._constrain(),this._calcMatrices())},ln.padding.get=function(){return this._edgeInsets.toJSON()},ln.padding.set=function(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())},ln.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Ei.prototype.isPaddingEqual=function(l){return this._edgeInsets.equals(l)},Ei.prototype.interpolatePadding=function(l,u,A){this._unmodified=!1,this._edgeInsets.interpolate(l,u,A),this._constrain(),this._calcMatrices()},Ei.prototype.coveringZoomLevel=function(l){var u=(l.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/l.tileSize));return Math.max(0,u)},Ei.prototype.getVisibleUnwrappedCoordinates=function(l){var u=[new o.UnwrappedTileID(0,l)];if(this._renderWorldCopies)for(var A=this.pointCoordinate(new o.Point(0,0)),d=this.pointCoordinate(new o.Point(this.width,0)),b=this.pointCoordinate(new o.Point(this.width,this.height)),M=this.pointCoordinate(new o.Point(0,this.height)),Q=Math.floor(Math.min(A.x,d.x,b.x,M.x)),R=Math.floor(Math.max(A.x,d.x,b.x,M.x)),J=Q-1;J<=R+1;J++)J!==0&&u.push(new o.UnwrappedTileID(J,l));return u},Ei.prototype.coveringTiles=function(l){var u=this.coveringZoomLevel(l),A=u;if(l.minzoom!==void 0&&u<l.minzoom)return[];l.maxzoom!==void 0&&u>l.maxzoom&&(u=l.maxzoom);var d=o.MercatorCoordinate.fromLngLat(this.center),b=Math.pow(2,u),M=[b*d.x,b*d.y,0],Q=il.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,u),R=l.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(R=u);var J=function(Ht){return{aabb:new xs([Ht*b,0,0],[(Ht+1)*b,b,0]),zoom:0,x:0,y:0,wrap:Ht,fullyVisible:!1}},Ae=[],Be=[],Ie=u,Te=l.reparseOverscaled?A:u;if(this._renderWorldCopies)for(var He=1;He<=3;He++)Ae.push(J(-He)),Ae.push(J(He));for(Ae.push(J(0));Ae.length>0;){var Le=Ae.pop(),qe=Le.x,ke=Le.y,Xe=Le.fullyVisible;if(!Xe){var et=Le.aabb.intersects(Q);if(et===0)continue;Xe=et===2}var at=Le.aabb.distanceX(M),mt=Le.aabb.distanceY(M),Ze=Math.max(Math.abs(at),Math.abs(mt));if(Le.zoom===Ie||Ze>3+(1<<Ie-Le.zoom)-2&&Le.zoom>=R)Be.push({tileID:new o.OverscaledTileID(Le.zoom===Ie?Te:Le.zoom,Le.wrap,Le.zoom,qe,ke),distanceSq:o.sqrLen([M[0]-.5-qe,M[1]-.5-ke])});else for(var bt=0;bt<4;bt++){var Tt=(qe<<1)+bt%2,Vt=(ke<<1)+(bt>>1);Ae.push({aabb:Le.aabb.quadrant(bt),zoom:Le.zoom+1,x:Tt,y:Vt,wrap:Le.wrap,fullyVisible:Xe})}}return Be.sort(function(Ht,hr){return Ht.distanceSq-hr.distanceSq}).map(function(Ht){return Ht.tileID})},Ei.prototype.resize=function(l,u){this.width=l,this.height=u,this.pixelsToGLUnits=[2/l,-2/u],this._constrain(),this._calcMatrices()},ln.unmodified.get=function(){return this._unmodified},Ei.prototype.zoomScale=function(l){return Math.pow(2,l)},Ei.prototype.scaleZoom=function(l){return Math.log(l)/Math.LN2},Ei.prototype.project=function(l){var u=o.clamp(l.lat,-this.maxValidLatitude,this.maxValidLatitude);return new o.Point(o.mercatorXfromLng(l.lng)*this.worldSize,o.mercatorYfromLat(u)*this.worldSize)},Ei.prototype.unproject=function(l){return new o.MercatorCoordinate(l.x/this.worldSize,l.y/this.worldSize).toLngLat()},ln.point.get=function(){return this.project(this.center)},Ei.prototype.setLocationAtPoint=function(l,u){var A=this.pointCoordinate(u),d=this.pointCoordinate(this.centerPoint),b=this.locationCoordinate(l),M=new o.MercatorCoordinate(b.x-(A.x-d.x),b.y-(A.y-d.y));this.center=this.coordinateLocation(M),this._renderWorldCopies&&(this.center=this.center.wrap())},Ei.prototype.locationPoint=function(l){return this.coordinatePoint(this.locationCoordinate(l))},Ei.prototype.pointLocation=function(l){return this.coordinateLocation(this.pointCoordinate(l))},Ei.prototype.locationCoordinate=function(l){return o.MercatorCoordinate.fromLngLat(l)},Ei.prototype.coordinateLocation=function(l){return l.toLngLat()},Ei.prototype.pointCoordinate=function(l){var u=[l.x,l.y,0,1],A=[l.x,l.y,1,1];o.transformMat4(u,u,this.pixelMatrixInverse),o.transformMat4(A,A,this.pixelMatrixInverse);var d=u[3],b=A[3],M=u[1]/d,Q=A[1]/b,R=u[2]/d,J=A[2]/b,Ae=R===J?0:(0-R)/(J-R);return new o.MercatorCoordinate(o.number(u[0]/d,A[0]/b,Ae)/this.worldSize,o.number(M,Q,Ae)/this.worldSize)},Ei.prototype.coordinatePoint=function(l){var u=[l.x*this.worldSize,l.y*this.worldSize,0,1];return o.transformMat4(u,u,this.pixelMatrix),new o.Point(u[0]/u[3],u[1]/u[3])},Ei.prototype.getBounds=function(){return new o.LngLatBounds().extend(this.pointLocation(new o.Point(0,0))).extend(this.pointLocation(new o.Point(this.width,0))).extend(this.pointLocation(new o.Point(this.width,this.height))).extend(this.pointLocation(new o.Point(0,this.height)))},Ei.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new o.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Ei.prototype.setMaxBounds=function(l){l?(this.lngRange=[l.getWest(),l.getEast()],this.latRange=[l.getSouth(),l.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Ei.prototype.calculatePosMatrix=function(l,u){u===void 0&&(u=!1);var A=l.key,d=u?this._alignedPosMatrixCache:this._posMatrixCache;if(d[A])return d[A];var b=l.canonical,M=this.worldSize/this.zoomScale(b.z),Q=b.x+Math.pow(2,b.z)*l.wrap,R=o.identity(new Float64Array(16));return o.translate(R,R,[Q*M,b.y*M,0]),o.scale(R,R,[M/o.EXTENT,M/o.EXTENT,1]),o.multiply(R,u?this.alignedProjMatrix:this.projMatrix,R),d[A]=new Float32Array(R),d[A]},Ei.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Ei.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var l,u,A,d,b=-90,M=90,Q=-180,R=180,J=this.size,Ae=this._unmodified;if(this.latRange){var Be=this.latRange;b=o.mercatorYfromLat(Be[1])*this.worldSize,l=(M=o.mercatorYfromLat(Be[0])*this.worldSize)-b<J.y?J.y/(M-b):0}if(this.lngRange){var Ie=this.lngRange;Q=o.mercatorXfromLng(Ie[0])*this.worldSize,u=(R=o.mercatorXfromLng(Ie[1])*this.worldSize)-Q<J.x?J.x/(R-Q):0}var Te=this.point,He=Math.max(u||0,l||0);if(He)return this.center=this.unproject(new o.Point(u?(R+Q)/2:Te.x,l?(M+b)/2:Te.y)),this.zoom+=this.scaleZoom(He),this._unmodified=Ae,void(this._constraining=!1);if(this.latRange){var Le=Te.y,qe=J.y/2;Le-qe<b&&(d=b+qe),Le+qe>M&&(d=M-qe)}if(this.lngRange){var ke=Te.x,Xe=J.x/2;ke-Xe<Q&&(A=Q+Xe),ke+Xe>R&&(A=R-Xe)}A===void 0&&d===void 0||(this.center=this.unproject(new o.Point(A!==void 0?A:Te.x,d!==void 0?d:Te.y))),this._unmodified=Ae,this._constraining=!1}},Ei.prototype._calcMatrices=function(){if(this.height){var l=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var u=Math.PI/2+this._pitch,A=this._fov*(.5+l.y/this.height),d=Math.sin(A)*this.cameraToCenterDistance/Math.sin(o.clamp(Math.PI-u-A,.01,Math.PI-.01)),b=this.point,M=b.x,Q=b.y,R=1.01*(Math.cos(Math.PI/2-this._pitch)*d+this.cameraToCenterDistance),J=this.height/50,Ae=new Float64Array(16);o.perspective(Ae,this._fov,this.width/this.height,J,R),Ae[8]=2*-l.x/this.width,Ae[9]=2*l.y/this.height,o.scale(Ae,Ae,[1,-1,1]),o.translate(Ae,Ae,[0,0,-this.cameraToCenterDistance]),o.rotateX(Ae,Ae,this._pitch),o.rotateZ(Ae,Ae,this.angle),o.translate(Ae,Ae,[-M,-Q,0]),this.mercatorMatrix=o.scale([],Ae,[this.worldSize,this.worldSize,this.worldSize]),o.scale(Ae,Ae,[1,1,o.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=Ae,this.invProjMatrix=o.invert([],this.projMatrix);var Be=this.width%2/2,Ie=this.height%2/2,Te=Math.cos(this.angle),He=Math.sin(this.angle),Le=M-Math.round(M)+Te*Be+He*Ie,qe=Q-Math.round(Q)+Te*Ie+He*Be,ke=new Float64Array(Ae);if(o.translate(ke,ke,[Le>.5?Le-1:Le,qe>.5?qe-1:qe,0]),this.alignedProjMatrix=ke,Ae=o.create(),o.scale(Ae,Ae,[this.width/2,-this.height/2,1]),o.translate(Ae,Ae,[1,-1,0]),this.labelPlaneMatrix=Ae,Ae=o.create(),o.scale(Ae,Ae,[1,-1,1]),o.translate(Ae,Ae,[-1,-1,0]),o.scale(Ae,Ae,[2/this.width,2/this.height,1]),this.glCoordMatrix=Ae,this.pixelMatrix=o.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(Ae=o.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=Ae,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Ei.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var l=this.pointCoordinate(new o.Point(0,0)),u=[l.x*this.worldSize,l.y*this.worldSize,0,1];return o.transformMat4(u,u,this.pixelMatrix)[3]/this.cameraToCenterDistance},Ei.prototype.getCameraPoint=function(){var l=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.Point(0,l))},Ei.prototype.getCameraQueryGeometry=function(l){var u=this.getCameraPoint();if(l.length===1)return[l[0],u];for(var A=u.x,d=u.y,b=u.x,M=u.y,Q=0,R=l;Q<R.length;Q+=1){var J=R[Q];A=Math.min(A,J.x),d=Math.min(d,J.y),b=Math.max(b,J.x),M=Math.max(M,J.y)}return[new o.Point(A,d),new o.Point(b,d),new o.Point(b,M),new o.Point(A,M),new o.Point(A,d)]},Object.defineProperties(Ei.prototype,ln);var Ho=function(l){var u,A,d,b;this._hashName=l&&encodeURIComponent(l),o.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(u=this._updateHashUnthrottled.bind(this),A=!1,d=null,b=function(){d=null,A&&(u(),d=setTimeout(b,300),A=!1)},function(){return A=!0,d||b(),d})};Ho.prototype.addTo=function(l){return this._map=l,o.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Ho.prototype.remove=function(){return o.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Ho.prototype.getHashString=function(l){var u=this._map.getCenter(),A=Math.round(100*this._map.getZoom())/100,d=Math.ceil((A*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,d),M=Math.round(u.lng*b)/b,Q=Math.round(u.lat*b)/b,R=this._map.getBearing(),J=this._map.getPitch(),Ae="";if(Ae+=l?"/"+M+"/"+Q+"/"+A:A+"/"+Q+"/"+M,(R||J)&&(Ae+="/"+Math.round(10*R)/10),J&&(Ae+="/"+Math.round(J)),this._hashName){var Be=this._hashName,Ie=!1,Te=o.window.location.hash.slice(1).split("&").map(function(He){var Le=He.split("=")[0];return Le===Be?(Ie=!0,Le+"="+Ae):He}).filter(function(He){return He});return Ie||Te.push(Be+"="+Ae),"#"+Te.join("&")}return"#"+Ae},Ho.prototype._getCurrentHash=function(){var l,u=this,A=o.window.location.hash.replace("#","");return this._hashName?(A.split("&").map(function(d){return d.split("=")}).forEach(function(d){d[0]===u._hashName&&(l=d)}),(l&&l[1]||"").split("/")):A.split("/")},Ho.prototype._onHashChange=function(){var l=this._getCurrentHash();if(l.length>=3&&!l.some(function(A){return isNaN(A)})){var u=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(l[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:u,pitch:+(l[4]||0)}),!0}return!1},Ho.prototype._updateHashUnthrottled=function(){var l=o.window.location.href.replace(/(#.+)?$/,this.getHashString());try{o.window.history.replaceState(o.window.history.state,null,l)}catch{}};var va={linearity:.3,easing:o.bezier(0,0,.3,1)},xr=o.extend({deceleration:2500,maxSpeed:1400},va),yl=o.extend({deceleration:20,maxSpeed:1400},va),_l=o.extend({deceleration:1e3,maxSpeed:360},va),rs=o.extend({deceleration:1e3,maxSpeed:90},va),vl=function(l){this._map=l,this.clear()};function pr(l,u){(!l.duration||l.duration<u.duration)&&(l.duration=u.duration,l.easing=u.easing)}function xa(l,u,A){var d=A.maxSpeed,b=A.linearity,M=A.deceleration,Q=o.clamp(l*b/(u/1e3),-d,d),R=Math.abs(Q)/(M*b);return{easing:A.easing,duration:1e3*R,amount:Q*(R/2)}}vl.prototype.clear=function(){this._inertiaBuffer=[]},vl.prototype.record=function(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.browser.now(),settings:l})},vl.prototype._drainInertiaBuffer=function(){for(var l=this._inertiaBuffer,u=o.browser.now();l.length>0&&u-l[0].time>160;)l.shift()},vl.prototype._onMoveEnd=function(l){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var u={zoom:0,bearing:0,pitch:0,pan:new o.Point(0,0),pinchAround:void 0,around:void 0},A=0,d=this._inertiaBuffer;A<d.length;A+=1){var b=d[A].settings;u.zoom+=b.zoomDelta||0,u.bearing+=b.bearingDelta||0,u.pitch+=b.pitchDelta||0,b.panDelta&&u.pan._add(b.panDelta),b.around&&(u.around=b.around),b.pinchAround&&(u.pinchAround=b.pinchAround)}var M=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,Q={};if(u.pan.mag()){var R=xa(u.pan.mag(),M,o.extend({},xr,l||{}));Q.offset=u.pan.mult(R.amount/u.pan.mag()),Q.center=this._map.transform.center,pr(Q,R)}if(u.zoom){var J=xa(u.zoom,M,yl);Q.zoom=this._map.transform.zoom+J.amount,pr(Q,J)}if(u.bearing){var Ae=xa(u.bearing,M,_l);Q.bearing=this._map.transform.bearing+o.clamp(Ae.amount,-179,179),pr(Q,Ae)}if(u.pitch){var Be=xa(u.pitch,M,rs);Q.pitch=this._map.transform.pitch+Be.amount,pr(Q,Be)}if(Q.zoom||Q.bearing){var Ie=u.pinchAround===void 0?u.around:u.pinchAround;Q.around=Ie?this._map.unproject(Ie):this._map.getCenter()}return this.clear(),o.extend(Q,{noMoveStart:!0})}};var yo=function(l){function u(d,b,M,Q){Q===void 0&&(Q={});var R=K.mousePos(b.getCanvasContainer(),M),J=b.unproject(R);l.call(this,d,o.extend({point:R,lngLat:J,originalEvent:M},Q)),this._defaultPrevented=!1,this.target=b}l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u;var A={defaultPrevented:{configurable:!0}};return u.prototype.preventDefault=function(){this._defaultPrevented=!0},A.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(u.prototype,A),u}(o.Event),Xa=function(l){function u(d,b,M){var Q=d==="touchend"?M.changedTouches:M.touches,R=K.touchPos(b.getCanvasContainer(),Q),J=R.map(function(Ie){return b.unproject(Ie)}),Ae=R.reduce(function(Ie,Te,He,Le){return Ie.add(Te.div(Le.length))},new o.Point(0,0)),Be=b.unproject(Ae);l.call(this,d,{points:R,point:Ae,lngLats:J,lngLat:Be,originalEvent:M}),this._defaultPrevented=!1}l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u;var A={defaultPrevented:{configurable:!0}};return u.prototype.preventDefault=function(){this._defaultPrevented=!0},A.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(u.prototype,A),u}(o.Event),nA=function(l){function u(d,b,M){l.call(this,d,{originalEvent:M}),this._defaultPrevented=!1}l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u;var A={defaultPrevented:{configurable:!0}};return u.prototype.preventDefault=function(){this._defaultPrevented=!0},A.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(u.prototype,A),u}(o.Event),io=function(l,u){this._map=l,this._clickTolerance=u.clickTolerance};io.prototype.reset=function(){delete this._mousedownPos},io.prototype.wheel=function(l){return this._firePreventable(new nA(l.type,this._map,l))},io.prototype.mousedown=function(l,u){return this._mousedownPos=u,this._firePreventable(new yo(l.type,this._map,l))},io.prototype.mouseup=function(l){this._map.fire(new yo(l.type,this._map,l))},io.prototype.click=function(l,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||this._map.fire(new yo(l.type,this._map,l))},io.prototype.dblclick=function(l){return this._firePreventable(new yo(l.type,this._map,l))},io.prototype.mouseover=function(l){this._map.fire(new yo(l.type,this._map,l))},io.prototype.mouseout=function(l){this._map.fire(new yo(l.type,this._map,l))},io.prototype.touchstart=function(l){return this._firePreventable(new Xa(l.type,this._map,l))},io.prototype.touchmove=function(l){this._map.fire(new Xa(l.type,this._map,l))},io.prototype.touchend=function(l){this._map.fire(new Xa(l.type,this._map,l))},io.prototype.touchcancel=function(l){this._map.fire(new Xa(l.type,this._map,l))},io.prototype._firePreventable=function(l){if(this._map.fire(l),l.defaultPrevented)return{}},io.prototype.isEnabled=function(){return!0},io.prototype.isActive=function(){return!1},io.prototype.enable=function(){},io.prototype.disable=function(){};var fr=function(l){this._map=l};fr.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},fr.prototype.mousemove=function(l){this._map.fire(new yo(l.type,this._map,l))},fr.prototype.mousedown=function(){this._delayContextMenu=!0},fr.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new yo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},fr.prototype.contextmenu=function(l){this._delayContextMenu?this._contextMenuEvent=l:this._map.fire(new yo(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()},fr.prototype.isEnabled=function(){return!0},fr.prototype.isActive=function(){return!1},fr.prototype.enable=function(){},fr.prototype.disable=function(){};var wa=function(l,u){this._map=l,this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=u.clickTolerance||1};function oA(l,u){for(var A={},d=0;d<l.length;d++)A[l[d].identifier]=u[d];return A}wa.prototype.isEnabled=function(){return!!this._enabled},wa.prototype.isActive=function(){return!!this._active},wa.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},wa.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},wa.prototype.mousedown=function(l,u){this.isEnabled()&&l.shiftKey&&l.button===0&&(K.disableDrag(),this._startPos=this._lastPos=u,this._active=!0)},wa.prototype.mousemoveWindow=function(l,u){if(this._active){var A=u;if(!(this._lastPos.equals(A)||!this._box&&A.dist(this._startPos)<this._clickTolerance)){var d=this._startPos;this._lastPos=A,this._box||(this._box=K.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",l));var b=Math.min(d.x,A.x),M=Math.max(d.x,A.x),Q=Math.min(d.y,A.y),R=Math.max(d.y,A.y);K.setTransform(this._box,"translate("+b+"px,"+Q+"px)"),this._box.style.width=M-b+"px",this._box.style.height=R-Q+"px"}}},wa.prototype.mouseupWindow=function(l,u){var A=this;if(this._active&&l.button===0){var d=this._startPos,b=u;if(this.reset(),K.suppressClick(),d.x!==b.x||d.y!==b.y)return this._map.fire(new o.Event("boxzoomend",{originalEvent:l})),{cameraAnimation:function(M){return M.fitScreenCoordinates(d,b,A._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",l)}},wa.prototype.keydown=function(l){this._active&&l.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",l))},wa.prototype.blur=function(){this.reset()},wa.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(K.remove(this._box),this._box=null),K.enableDrag(),delete this._startPos,delete this._lastPos},wa.prototype._fireEvent=function(l,u){return this._map.fire(new o.Event(l,{originalEvent:u}))};var nl=function(l){this.reset(),this.numTouches=l.numTouches};nl.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},nl.prototype.touchstart=function(l,u,A){(this.centroid||A.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=l.timeStamp),A.length===this.numTouches&&(this.centroid=function(d){for(var b=new o.Point(0,0),M=0,Q=d;M<Q.length;M+=1)b._add(Q[M]);return b.div(d.length)}(u),this.touches=oA(A,u)))},nl.prototype.touchmove=function(l,u,A){if(!this.aborted&&this.centroid){var d=oA(A,u);for(var b in this.touches){var M=d[b];(!M||M.dist(this.touches[b])>30)&&(this.aborted=!0)}}},nl.prototype.touchend=function(l,u,A){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),A.length===0){var d=!this.aborted&&this.centroid;if(this.reset(),d)return d}};var ra=function(l){this.singleTap=new nl(l),this.numTaps=l.numTaps,this.reset()};ra.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},ra.prototype.touchstart=function(l,u,A){this.singleTap.touchstart(l,u,A)},ra.prototype.touchmove=function(l,u,A){this.singleTap.touchmove(l,u,A)},ra.prototype.touchend=function(l,u,A){var d=this.singleTap.touchend(l,u,A);if(d){var b=l.timeStamp-this.lastTime<500,M=!this.lastTap||this.lastTap.dist(d)<30;if(b&&M||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=d,this.count===this.numTaps)return this.reset(),d}};var ia=function(){this._zoomIn=new ra({numTouches:1,numTaps:2}),this._zoomOut=new ra({numTouches:2,numTaps:1}),this.reset()};ia.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},ia.prototype.touchstart=function(l,u,A){this._zoomIn.touchstart(l,u,A),this._zoomOut.touchstart(l,u,A)},ia.prototype.touchmove=function(l,u,A){this._zoomIn.touchmove(l,u,A),this._zoomOut.touchmove(l,u,A)},ia.prototype.touchend=function(l,u,A){var d=this,b=this._zoomIn.touchend(l,u,A),M=this._zoomOut.touchend(l,u,A);return b?(this._active=!0,l.preventDefault(),setTimeout(function(){return d.reset()},0),{cameraAnimation:function(Q){return Q.easeTo({duration:300,zoom:Q.getZoom()+1,around:Q.unproject(b)},{originalEvent:l})}}):M?(this._active=!0,l.preventDefault(),setTimeout(function(){return d.reset()},0),{cameraAnimation:function(Q){return Q.easeTo({duration:300,zoom:Q.getZoom()-1,around:Q.unproject(M)},{originalEvent:l})}}):void 0},ia.prototype.touchcancel=function(){this.reset()},ia.prototype.enable=function(){this._enabled=!0},ia.prototype.disable=function(){this._enabled=!1,this.reset()},ia.prototype.isEnabled=function(){return this._enabled},ia.prototype.isActive=function(){return this._active};var aA={0:1,2:2},Gt=function(l){this.reset(),this._clickTolerance=l.clickTolerance||1};Gt.prototype.blur=function(){this.reset()},Gt.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Gt.prototype._correctButton=function(l,u){return!1},Gt.prototype._move=function(l,u){return{}},Gt.prototype.mousedown=function(l,u){if(!this._lastPoint){var A=K.mouseButton(l);this._correctButton(l,A)&&(this._lastPoint=u,this._eventButton=A)}},Gt.prototype.mousemoveWindow=function(l,u){var A=this._lastPoint;if(A){if(l.preventDefault(),function(d,b){var M=aA[b];return d.buttons===void 0||(d.buttons&M)!==M}(l,this._eventButton))this.reset();else if(this._moved||!(u.dist(A)<this._clickTolerance))return this._moved=!0,this._lastPoint=u,this._move(A,u)}},Gt.prototype.mouseupWindow=function(l){this._lastPoint&&K.mouseButton(l)===this._eventButton&&(this._moved&&K.suppressClick(),this.reset())},Gt.prototype.enable=function(){this._enabled=!0},Gt.prototype.disable=function(){this._enabled=!1,this.reset()},Gt.prototype.isEnabled=function(){return this._enabled},Gt.prototype.isActive=function(){return this._active};var ws=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.mousedown=function(A,d){l.prototype.mousedown.call(this,A,d),this._lastPoint&&(this._active=!0)},u.prototype._correctButton=function(A,d){return d===0&&!A.ctrlKey},u.prototype._move=function(A,d){return{around:d,panDelta:d.sub(A)}},u}(Gt),sA=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype._correctButton=function(A,d){return d===0&&A.ctrlKey||d===2},u.prototype._move=function(A,d){var b=.8*(d.x-A.x);if(b)return this._active=!0,{bearingDelta:b}},u.prototype.contextmenu=function(A){A.preventDefault()},u}(Gt),ol=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype._correctButton=function(A,d){return d===0&&A.ctrlKey||d===2},u.prototype._move=function(A,d){var b=-.5*(d.y-A.y);if(b)return this._active=!0,{pitchDelta:b}},u.prototype.contextmenu=function(A){A.preventDefault()},u}(Gt),ba=function(l){this._minTouches=1,this._clickTolerance=l.clickTolerance||1,this.reset()};ba.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new o.Point(0,0)},ba.prototype.touchstart=function(l,u,A){return this._calculateTransform(l,u,A)},ba.prototype.touchmove=function(l,u,A){if(this._active&&!(A.length<this._minTouches))return l.preventDefault(),this._calculateTransform(l,u,A)},ba.prototype.touchend=function(l,u,A){this._calculateTransform(l,u,A),this._active&&A.length<this._minTouches&&this.reset()},ba.prototype.touchcancel=function(){this.reset()},ba.prototype._calculateTransform=function(l,u,A){A.length>0&&(this._active=!0);var d=oA(A,u),b=new o.Point(0,0),M=new o.Point(0,0),Q=0;for(var R in d){var J=d[R],Ae=this._touches[R];Ae&&(b._add(J),M._add(J.sub(Ae)),Q++,d[R]=J)}if(this._touches=d,!(Q<this._minTouches)&&M.mag()){var Be=M.div(Q);if(this._sum._add(Be),!(this._sum.mag()<this._clickTolerance))return{around:b.div(Q),panDelta:Be}}},ba.prototype.enable=function(){this._enabled=!0},ba.prototype.disable=function(){this._enabled=!1,this.reset()},ba.prototype.isEnabled=function(){return this._enabled},ba.prototype.isActive=function(){return this._active};var _o=function(){this.reset()};function lA(l,u,A){for(var d=0;d<l.length;d++)if(l[d].identifier===A)return u[d]}function da(l,u){return Math.log(l/u)/Math.LN2}_o.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},_o.prototype._start=function(l){},_o.prototype._move=function(l,u,A){return{}},_o.prototype.touchstart=function(l,u,A){this._firstTwoTouches||A.length<2||(this._firstTwoTouches=[A[0].identifier,A[1].identifier],this._start([u[0],u[1]]))},_o.prototype.touchmove=function(l,u,A){if(this._firstTwoTouches){l.preventDefault();var d=this._firstTwoTouches,b=d[1],M=lA(A,u,d[0]),Q=lA(A,u,b);if(M&&Q){var R=this._aroundCenter?null:M.add(Q).div(2);return this._move([M,Q],R,l)}}},_o.prototype.touchend=function(l,u,A){if(this._firstTwoTouches){var d=this._firstTwoTouches,b=d[1],M=lA(A,u,d[0]),Q=lA(A,u,b);M&&Q||(this._active&&K.suppressClick(),this.reset())}},_o.prototype.touchcancel=function(){this.reset()},_o.prototype.enable=function(l){this._enabled=!0,this._aroundCenter=!!l&&l.around==="center"},_o.prototype.disable=function(){this._enabled=!1,this.reset()},_o.prototype.isEnabled=function(){return this._enabled},_o.prototype.isActive=function(){return this._active};var Hi=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.reset=function(){l.prototype.reset.call(this),delete this._distance,delete this._startDistance},u.prototype._start=function(A){this._startDistance=this._distance=A[0].dist(A[1])},u.prototype._move=function(A,d){var b=this._distance;if(this._distance=A[0].dist(A[1]),this._active||!(Math.abs(da(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:da(this._distance,b),pinchAround:d}},u}(_o);function Oa(l,u){return 180*l.angleWith(u)/Math.PI}var al=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.reset=function(){l.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},u.prototype._start=function(A){this._startVector=this._vector=A[0].sub(A[1]),this._minDiameter=A[0].dist(A[1])},u.prototype._move=function(A,d){var b=this._vector;if(this._vector=A[0].sub(A[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Oa(this._vector,b),pinchAround:d}},u.prototype._isBelowThreshold=function(A){this._minDiameter=Math.min(this._minDiameter,A.mag());var d=25/(Math.PI*this._minDiameter)*360,b=Oa(A,this._startVector);return Math.abs(b)<d},u}(_o);function Kl(l){return Math.abs(l.y)>Math.abs(l.x)}var CA=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.reset=function(){l.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},u.prototype._start=function(A){this._lastPoints=A,Kl(A[0].sub(A[1]))&&(this._valid=!1)},u.prototype._move=function(A,d,b){var M=A[0].sub(this._lastPoints[0]),Q=A[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(M,Q,b.timeStamp),this._valid)return this._lastPoints=A,this._active=!0,{pitchDelta:(M.y+Q.y)/2*-.5}},u.prototype.gestureBeginsVertically=function(A,d,b){if(this._valid!==void 0)return this._valid;var M=A.mag()>=2,Q=d.mag()>=2;if(M||Q){if(!M||!Q)return this._firstMove===void 0&&(this._firstMove=b),b-this._firstMove<100&&void 0;var R=A.y>0==d.y>0;return Kl(A)&&Kl(d)&&R}},u}(_o),EA={panStep:100,bearingStep:15,pitchStep:10},is=function(){var l=EA;this._panStep=l.panStep,this._bearingStep=l.bearingStep,this._pitchStep=l.pitchStep,this._rotationDisabled=!1};function Xn(l){return l*(2-l)}is.prototype.blur=function(){this.reset()},is.prototype.reset=function(){this._active=!1},is.prototype.keydown=function(l){var u=this;if(!(l.altKey||l.ctrlKey||l.metaKey)){var A=0,d=0,b=0,M=0,Q=0;switch(l.keyCode){case 61:case 107:case 171:case 187:A=1;break;case 189:case 109:case 173:A=-1;break;case 37:l.shiftKey?d=-1:(l.preventDefault(),M=-1);break;case 39:l.shiftKey?d=1:(l.preventDefault(),M=1);break;case 38:l.shiftKey?b=1:(l.preventDefault(),Q=-1);break;case 40:l.shiftKey?b=-1:(l.preventDefault(),Q=1);break;default:return}return this._rotationDisabled&&(d=0,b=0),{cameraAnimation:function(R){var J=R.getZoom();R.easeTo({duration:300,easeId:"keyboardHandler",easing:Xn,zoom:A?Math.round(J)+A*(l.shiftKey?2:1):J,bearing:R.getBearing()+d*u._bearingStep,pitch:R.getPitch()+b*u._pitchStep,offset:[-M*u._panStep,-Q*u._panStep],center:R.getCenter()},{originalEvent:l})}}}},is.prototype.enable=function(){this._enabled=!0},is.prototype.disable=function(){this._enabled=!1,this.reset()},is.prototype.isEnabled=function(){return this._enabled},is.prototype.isActive=function(){return this._active},is.prototype.disableRotation=function(){this._rotationDisabled=!0},is.prototype.enableRotation=function(){this._rotationDisabled=!1};var pi=function(l,u){this._map=l,this._el=l.getCanvasContainer(),this._handler=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,o.bindAll(["_onTimeout"],this)};pi.prototype.setZoomRate=function(l){this._defaultZoomRate=l},pi.prototype.setWheelZoomRate=function(l){this._wheelZoomRate=l},pi.prototype.isEnabled=function(){return!!this._enabled},pi.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},pi.prototype.isZooming=function(){return!!this._zooming},pi.prototype.enable=function(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=l&&l.around==="center")},pi.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},pi.prototype.wheel=function(l){if(this.isEnabled()){var u=l.deltaMode===o.window.WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY,A=o.browser.now(),d=A-(this._lastWheelEventTime||0);this._lastWheelEventTime=A,u!==0&&u%4.000244140625==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":d>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(d*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),l.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=l,this._delta-=u,this._active||this._start(l)),l.preventDefault()}},pi.prototype._onTimeout=function(l){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)},pi.prototype._start=function(l){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var u=K.mousePos(this._el,l);this._around=o.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(u)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},pi.prototype.renderFrame=function(){var l=this;if(this._frameId&&(this._frameId=null,this.isActive())){var u=this._map.transform;if(this._delta!==0){var A=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,d=2/(1+Math.exp(-Math.abs(this._delta*A)));this._delta<0&&d!==0&&(d=1/d);var b=typeof this._targetZoom=="number"?u.zoomScale(this._targetZoom):u.scale;this._targetZoom=Math.min(u.maxZoom,Math.max(u.minZoom,u.scaleZoom(b*d))),this._type==="wheel"&&(this._startZoom=u.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var M,Q=typeof this._targetZoom=="number"?this._targetZoom:u.zoom,R=this._startZoom,J=this._easing,Ae=!1;if(this._type==="wheel"&&R&&J){var Be=Math.min((o.browser.now()-this._lastWheelEventTime)/200,1),Ie=J(Be);M=o.number(R,Q,Ie),Be<1?this._frameId||(this._frameId=!0):Ae=!0}else M=Q,Ae=!0;return this._active=!0,Ae&&(this._active=!1,this._finishTimeout=setTimeout(function(){l._zooming=!1,l._handler._triggerRenderFrame(),delete l._targetZoom,delete l._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Ae,zoomDelta:M-u.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},pi.prototype._smoothOutEasing=function(l){var u=o.ease;if(this._prevEase){var A=this._prevEase,d=(o.browser.now()-A.start)/A.duration,b=A.easing(d+.01)-A.easing(d),M=.27/Math.sqrt(b*b+1e-4)*.01,Q=Math.sqrt(.0729-M*M);u=o.bezier(M,Q,.25,1)}return this._prevEase={start:o.browser.now(),duration:l,easing:u},u},pi.prototype.blur=function(){this.reset()},pi.prototype.reset=function(){this._active=!1};var Cr=function(l,u){this._clickZoom=l,this._tapZoom=u};Cr.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Cr.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Cr.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Cr.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Pr=function(){this.reset()};Pr.prototype.reset=function(){this._active=!1},Pr.prototype.blur=function(){this.reset()},Pr.prototype.dblclick=function(l,u){return l.preventDefault(),{cameraAnimation:function(A){A.easeTo({duration:300,zoom:A.getZoom()+(l.shiftKey?-1:1),around:A.unproject(u)},{originalEvent:l})}}},Pr.prototype.enable=function(){this._enabled=!0},Pr.prototype.disable=function(){this._enabled=!1,this.reset()},Pr.prototype.isEnabled=function(){return this._enabled},Pr.prototype.isActive=function(){return this._active};var no=function(){this._tap=new ra({numTouches:1,numTaps:1}),this.reset()};no.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},no.prototype.touchstart=function(l,u,A){this._swipePoint||(this._tapTime&&l.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?A.length>0&&(this._swipePoint=u[0],this._swipeTouch=A[0].identifier):this._tap.touchstart(l,u,A))},no.prototype.touchmove=function(l,u,A){if(this._tapTime){if(this._swipePoint){if(A[0].identifier!==this._swipeTouch)return;var d=u[0],b=d.y-this._swipePoint.y;return this._swipePoint=d,l.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(l,u,A)},no.prototype.touchend=function(l,u,A){this._tapTime?this._swipePoint&&A.length===0&&this.reset():this._tap.touchend(l,u,A)&&(this._tapTime=l.timeStamp)},no.prototype.touchcancel=function(){this.reset()},no.prototype.enable=function(){this._enabled=!0},no.prototype.disable=function(){this._enabled=!1,this.reset()},no.prototype.isEnabled=function(){return this._enabled},no.prototype.isActive=function(){return this._active};var Hs=function(l,u,A){this._el=l,this._mousePan=u,this._touchPan=A};Hs.prototype.enable=function(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},Hs.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},Hs.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Hs.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var fa=function(l,u,A){this._pitchWithRotate=l.pitchWithRotate,this._mouseRotate=u,this._mousePitch=A};fa.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},fa.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},fa.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},fa.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var On=function(l,u,A,d){this._el=l,this._touchZoom=u,this._touchRotate=A,this._tapDragZoom=d,this._rotationDisabled=!1,this._enabled=!0};On.prototype.enable=function(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},On.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},On.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},On.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},On.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},On.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var oo=function(l){return l.zoom||l.drag||l.pitch||l.rotate},Ba=function(l){function u(){l.apply(this,arguments)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u}(o.Event);function kr(l){return l.panDelta&&l.panDelta.mag()||l.zoomDelta||l.bearingDelta||l.pitchDelta}var cr=function(l,u){this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new vl(l),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(u),o.bindAll(["handleEvent","handleWindowEvent"],this);var A=this._el;this._listeners=[[A,"touchstart",{passive:!0}],[A,"touchmove",{passive:!1}],[A,"touchend",void 0],[A,"touchcancel",void 0],[A,"mousedown",void 0],[A,"mousemove",void 0],[A,"mouseup",void 0],[o.window.document,"mousemove",{capture:!0}],[o.window.document,"mouseup",void 0],[A,"mouseover",void 0],[A,"mouseout",void 0],[A,"dblclick",void 0],[A,"click",void 0],[A,"keydown",{capture:!1}],[A,"keyup",void 0],[A,"wheel",{passive:!1}],[A,"contextmenu",void 0],[o.window,"blur",void 0]];for(var d=0,b=this._listeners;d<b.length;d+=1){var M=b[d],Q=M[0];K.addEventListener(Q,M[1],Q===o.window.document?this.handleWindowEvent:this.handleEvent,M[2])}};cr.prototype.destroy=function(){for(var l=0,u=this._listeners;l<u.length;l+=1){var A=u[l],d=A[0];K.removeEventListener(d,A[1],d===o.window.document?this.handleWindowEvent:this.handleEvent,A[2])}},cr.prototype._addDefaultHandlers=function(l){var u=this._map,A=u.getCanvasContainer();this._add("mapEvent",new io(u,l));var d=u.boxZoom=new wa(u,l);this._add("boxZoom",d);var b=new ia,M=new Pr;u.doubleClickZoom=new Cr(M,b),this._add("tapZoom",b),this._add("clickZoom",M);var Q=new no;this._add("tapDragZoom",Q);var R=u.touchPitch=new CA;this._add("touchPitch",R);var J=new sA(l),Ae=new ol(l);u.dragRotate=new fa(l,J,Ae),this._add("mouseRotate",J,["mousePitch"]),this._add("mousePitch",Ae,["mouseRotate"]);var Be=new ws(l),Ie=new ba(l);u.dragPan=new Hs(A,Be,Ie),this._add("mousePan",Be),this._add("touchPan",Ie,["touchZoom","touchRotate"]);var Te=new al,He=new Hi;u.touchZoomRotate=new On(A,He,Te,Q),this._add("touchRotate",Te,["touchPan","touchZoom"]),this._add("touchZoom",He,["touchPan","touchRotate"]);var Le=u.scrollZoom=new pi(u,this);this._add("scrollZoom",Le,["mousePan"]);var qe=u.keyboard=new is;this._add("keyboard",qe),this._add("blockableMapEvent",new fr(u));for(var ke=0,Xe=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];ke<Xe.length;ke+=1){var et=Xe[ke];l.interactive&&l[et]&&u[et].enable(l[et])}},cr.prototype._add=function(l,u,A){this._handlers.push({handlerName:l,handler:u,allowed:A}),this._handlersById[l]=u},cr.prototype.stop=function(l){if(!this._updatingCamera){for(var u=0,A=this._handlers;u<A.length;u+=1)A[u].handler.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[]}},cr.prototype.isActive=function(){for(var l=0,u=this._handlers;l<u.length;l+=1)if(u[l].handler.isActive())return!0;return!1},cr.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},cr.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},cr.prototype.isMoving=function(){return Boolean(oo(this._eventsInProgress))||this.isZooming()},cr.prototype._blockedByActive=function(l,u,A){for(var d in l)if(d!==A&&(!u||u.indexOf(d)<0))return!0;return!1},cr.prototype.handleWindowEvent=function(l){this.handleEvent(l,l.type+"Window")},cr.prototype._getMapTouches=function(l){for(var u=[],A=0,d=l;A<d.length;A+=1){var b=d[A];this._el.contains(b.target)&&u.push(b)}return u},cr.prototype.handleEvent=function(l,u){this._updatingCamera=!0;for(var A=l.type==="renderFrame"?void 0:l,d={needsRenderFrame:!1},b={},M={},Q=l.touches?this._getMapTouches(l.touches):void 0,R=Q?K.touchPos(this._el,Q):K.mousePos(this._el,l),J=0,Ae=this._handlers;J<Ae.length;J+=1){var Be=Ae[J],Ie=Be.handlerName,Te=Be.handler,He=Be.allowed;if(Te.isEnabled()){var Le=void 0;this._blockedByActive(M,He,Ie)?Te.reset():Te[u||l.type]&&(Le=Te[u||l.type](l,R,Q),this.mergeHandlerResult(d,b,Le,Ie,A),Le&&Le.needsRenderFrame&&this._triggerRenderFrame()),(Le||Te.isActive())&&(M[Ie]=Te)}}var qe={};for(var ke in this._previousActiveHandlers)M[ke]||(qe[ke]=A);this._previousActiveHandlers=M,(Object.keys(qe).length||kr(d))&&(this._changes.push([d,b,qe]),this._triggerRenderFrame()),(Object.keys(M).length||kr(d))&&this._map._stop(!0),this._updatingCamera=!1;var Xe=d.cameraAnimation;Xe&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Xe(this._map))},cr.prototype.mergeHandlerResult=function(l,u,A,d,b){if(A){o.extend(l,A);var M={handlerName:d,originalEvent:A.originalEvent||b};A.zoomDelta!==void 0&&(u.zoom=M),A.panDelta!==void 0&&(u.drag=M),A.pitchDelta!==void 0&&(u.pitch=M),A.bearingDelta!==void 0&&(u.rotate=M)}},cr.prototype._applyChanges=function(){for(var l={},u={},A={},d=0,b=this._changes;d<b.length;d+=1){var M=b[d],Q=M[0],R=M[1],J=M[2];Q.panDelta&&(l.panDelta=(l.panDelta||new o.Point(0,0))._add(Q.panDelta)),Q.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+Q.zoomDelta),Q.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+Q.bearingDelta),Q.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+Q.pitchDelta),Q.around!==void 0&&(l.around=Q.around),Q.pinchAround!==void 0&&(l.pinchAround=Q.pinchAround),Q.noInertia&&(l.noInertia=Q.noInertia),o.extend(u,R),o.extend(A,J)}this._updateMapTransform(l,u,A),this._changes=[]},cr.prototype._updateMapTransform=function(l,u,A){var d=this._map,b=d.transform;if(!kr(l))return this._fireEvents(u,A,!0);var M=l.panDelta,Q=l.zoomDelta,R=l.bearingDelta,J=l.pitchDelta,Ae=l.around,Be=l.pinchAround;Be!==void 0&&(Ae=Be),d._stop(!0),Ae=Ae||d.transform.centerPoint;var Ie=b.pointLocation(M?Ae.sub(M):Ae);R&&(b.bearing+=R),J&&(b.pitch+=J),Q&&(b.zoom+=Q),b.setLocationAtPoint(Ie,Ae),this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(u,A,!0)},cr.prototype._fireEvents=function(l,u,A){var d=this,b=oo(this._eventsInProgress),M=oo(l),Q={};for(var R in l)this._eventsInProgress[R]||(Q[R+"start"]=l[R].originalEvent),this._eventsInProgress[R]=l[R];for(var J in!b&&M&&this._fireEvent("movestart",M.originalEvent),Q)this._fireEvent(J,Q[J]);for(var Ae in M&&this._fireEvent("move",M.originalEvent),l)this._fireEvent(Ae,l[Ae].originalEvent);var Be,Ie={};for(var Te in this._eventsInProgress){var He=this._eventsInProgress[Te],Le=He.handlerName,qe=He.originalEvent;this._handlersById[Le].isActive()||(delete this._eventsInProgress[Te],Ie[Te+"end"]=Be=u[Le]||qe)}for(var ke in Ie)this._fireEvent(ke,Ie[ke]);var Xe=oo(this._eventsInProgress);if(A&&(b||M)&&!Xe){this._updatingCamera=!0;var et=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),at=function(mt){return mt!==0&&-d._bearingSnap<mt&&mt<d._bearingSnap};et?(at(et.bearing||this._map.getBearing())&&(et.bearing=0),this._map.easeTo(et,{originalEvent:Be})):(this._map.fire(new o.Event("moveend",{originalEvent:Be})),at(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},cr.prototype._fireEvent=function(l,u){this._map.fire(new o.Event(l,u?{originalEvent:u}:{}))},cr.prototype._requestFrame=function(){var l=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(u){delete l._frameId,l.handleEvent(new Ba("renderFrame",{timeStamp:u})),l._applyChanges()})},cr.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var Wn=function(l){function u(A,d){l.call(this),this._moving=!1,this._zooming=!1,this.transform=A,this._bearingSnap=d.bearingSnap,o.bindAll(["_renderFrameCallback"],this)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.getCenter=function(){return new o.LngLat(this.transform.center.lng,this.transform.center.lat)},u.prototype.setCenter=function(A,d){return this.jumpTo({center:A},d)},u.prototype.panBy=function(A,d,b){return A=o.Point.convert(A).mult(-1),this.panTo(this.transform.center,o.extend({offset:A},d),b)},u.prototype.panTo=function(A,d,b){return this.easeTo(o.extend({center:A},d),b)},u.prototype.getZoom=function(){return this.transform.zoom},u.prototype.setZoom=function(A,d){return this.jumpTo({zoom:A},d),this},u.prototype.zoomTo=function(A,d,b){return this.easeTo(o.extend({zoom:A},d),b)},u.prototype.zoomIn=function(A,d){return this.zoomTo(this.getZoom()+1,A,d),this},u.prototype.zoomOut=function(A,d){return this.zoomTo(this.getZoom()-1,A,d),this},u.prototype.getBearing=function(){return this.transform.bearing},u.prototype.setBearing=function(A,d){return this.jumpTo({bearing:A},d),this},u.prototype.getPadding=function(){return this.transform.padding},u.prototype.setPadding=function(A,d){return this.jumpTo({padding:A},d),this},u.prototype.rotateTo=function(A,d,b){return this.easeTo(o.extend({bearing:A},d),b)},u.prototype.resetNorth=function(A,d){return this.rotateTo(0,o.extend({duration:1e3},A),d),this},u.prototype.resetNorthPitch=function(A,d){return this.easeTo(o.extend({bearing:0,pitch:0,duration:1e3},A),d),this},u.prototype.snapToNorth=function(A,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(A,d):this},u.prototype.getPitch=function(){return this.transform.pitch},u.prototype.setPitch=function(A,d){return this.jumpTo({pitch:A},d),this},u.prototype.cameraForBounds=function(A,d){A=o.LngLatBounds.convert(A);var b=d&&d.bearing||0;return this._cameraForBoxAndBearing(A.getNorthWest(),A.getSouthEast(),b,d)},u.prototype._cameraForBoxAndBearing=function(A,d,b,M){var Q={top:0,bottom:0,right:0,left:0};if(typeof(M=o.extend({padding:Q,offset:[0,0],maxZoom:this.transform.maxZoom},M)).padding=="number"){var R=M.padding;M.padding={top:R,bottom:R,right:R,left:R}}M.padding=o.extend(Q,M.padding);var J=this.transform,Ae=J.padding,Be=J.project(o.LngLat.convert(A)),Ie=J.project(o.LngLat.convert(d)),Te=Be.rotate(-b*Math.PI/180),He=Ie.rotate(-b*Math.PI/180),Le=new o.Point(Math.max(Te.x,He.x),Math.max(Te.y,He.y)),qe=new o.Point(Math.min(Te.x,He.x),Math.min(Te.y,He.y)),ke=Le.sub(qe),Xe=(J.width-(Ae.left+Ae.right+M.padding.left+M.padding.right))/ke.x,et=(J.height-(Ae.top+Ae.bottom+M.padding.top+M.padding.bottom))/ke.y;if(!(et<0||Xe<0)){var at=Math.min(J.scaleZoom(J.scale*Math.min(Xe,et)),M.maxZoom),mt=typeof M.offset.x=="number"?new o.Point(M.offset.x,M.offset.y):o.Point.convert(M.offset),Ze=new o.Point((M.padding.left-M.padding.right)/2,(M.padding.top-M.padding.bottom)/2).rotate(b*Math.PI/180),bt=mt.add(Ze).mult(J.scale/J.zoomScale(at));return{center:J.unproject(Be.add(Ie).div(2).sub(bt)),zoom:at,bearing:b}}o.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},u.prototype.fitBounds=function(A,d,b){return this._fitInternal(this.cameraForBounds(A,d),d,b)},u.prototype.fitScreenCoordinates=function(A,d,b,M,Q){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(o.Point.convert(A)),this.transform.pointLocation(o.Point.convert(d)),b,M),M,Q)},u.prototype._fitInternal=function(A,d,b){return A?(delete(d=o.extend(A,d)).padding,d.linear?this.easeTo(d,b):this.flyTo(d,b)):this},u.prototype.jumpTo=function(A,d){this.stop();var b=this.transform,M=!1,Q=!1,R=!1;return"zoom"in A&&b.zoom!==+A.zoom&&(M=!0,b.zoom=+A.zoom),A.center!==void 0&&(b.center=o.LngLat.convert(A.center)),"bearing"in A&&b.bearing!==+A.bearing&&(Q=!0,b.bearing=+A.bearing),"pitch"in A&&b.pitch!==+A.pitch&&(R=!0,b.pitch=+A.pitch),A.padding==null||b.isPaddingEqual(A.padding)||(b.padding=A.padding),this.fire(new o.Event("movestart",d)).fire(new o.Event("move",d)),M&&this.fire(new o.Event("zoomstart",d)).fire(new o.Event("zoom",d)).fire(new o.Event("zoomend",d)),Q&&this.fire(new o.Event("rotatestart",d)).fire(new o.Event("rotate",d)).fire(new o.Event("rotateend",d)),R&&this.fire(new o.Event("pitchstart",d)).fire(new o.Event("pitch",d)).fire(new o.Event("pitchend",d)),this.fire(new o.Event("moveend",d))},u.prototype.easeTo=function(A,d){var b=this;this._stop(!1,A.easeId),((A=o.extend({offset:[0,0],duration:500,easing:o.ease},A)).animate===!1||!A.essential&&o.browser.prefersReducedMotion)&&(A.duration=0);var M=this.transform,Q=this.getZoom(),R=this.getBearing(),J=this.getPitch(),Ae=this.getPadding(),Be="zoom"in A?+A.zoom:Q,Ie="bearing"in A?this._normalizeBearing(A.bearing,R):R,Te="pitch"in A?+A.pitch:J,He="padding"in A?A.padding:M.padding,Le=o.Point.convert(A.offset),qe=M.centerPoint.add(Le),ke=M.pointLocation(qe),Xe=o.LngLat.convert(A.center||ke);this._normalizeCenter(Xe);var et,at,mt=M.project(ke),Ze=M.project(Xe).sub(mt),bt=M.zoomScale(Be-Q);A.around&&(et=o.LngLat.convert(A.around),at=M.locationPoint(et));var Tt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Be!==Q,this._rotating=this._rotating||R!==Ie,this._pitching=this._pitching||Te!==J,this._padding=!M.isPaddingEqual(He),this._easeId=A.easeId,this._prepareEase(d,A.noMoveStart,Tt),this._ease(function(Vt){if(b._zooming&&(M.zoom=o.number(Q,Be,Vt)),b._rotating&&(M.bearing=o.number(R,Ie,Vt)),b._pitching&&(M.pitch=o.number(J,Te,Vt)),b._padding&&(M.interpolatePadding(Ae,He,Vt),qe=M.centerPoint.add(Le)),et)M.setLocationAtPoint(et,at);else{var Ht=M.zoomScale(M.zoom-Q),hr=Be>Q?Math.min(2,bt):Math.max(.5,bt),Er=Math.pow(hr,1-Vt),Mr=M.unproject(mt.add(Ze.mult(Vt*Er)).mult(Ht));M.setLocationAtPoint(M.renderWorldCopies?Mr.wrap():Mr,qe)}b._fireMoveEvents(d)},function(Vt){b._afterEase(d,Vt)},A),this},u.prototype._prepareEase=function(A,d,b){b===void 0&&(b={}),this._moving=!0,d||b.moving||this.fire(new o.Event("movestart",A)),this._zooming&&!b.zooming&&this.fire(new o.Event("zoomstart",A)),this._rotating&&!b.rotating&&this.fire(new o.Event("rotatestart",A)),this._pitching&&!b.pitching&&this.fire(new o.Event("pitchstart",A))},u.prototype._fireMoveEvents=function(A){this.fire(new o.Event("move",A)),this._zooming&&this.fire(new o.Event("zoom",A)),this._rotating&&this.fire(new o.Event("rotate",A)),this._pitching&&this.fire(new o.Event("pitch",A))},u.prototype._afterEase=function(A,d){if(!this._easeId||!d||this._easeId!==d){delete this._easeId;var b=this._zooming,M=this._rotating,Q=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,b&&this.fire(new o.Event("zoomend",A)),M&&this.fire(new o.Event("rotateend",A)),Q&&this.fire(new o.Event("pitchend",A)),this.fire(new o.Event("moveend",A))}},u.prototype.flyTo=function(A,d){var b=this;if(!A.essential&&o.browser.prefersReducedMotion){var M=o.pick(A,["center","zoom","bearing","pitch","around"]);return this.jumpTo(M,d)}this.stop(),A=o.extend({offset:[0,0],speed:1.2,curve:1.42,easing:o.ease},A);var Q=this.transform,R=this.getZoom(),J=this.getBearing(),Ae=this.getPitch(),Be=this.getPadding(),Ie="zoom"in A?o.clamp(+A.zoom,Q.minZoom,Q.maxZoom):R,Te="bearing"in A?this._normalizeBearing(A.bearing,J):J,He="pitch"in A?+A.pitch:Ae,Le="padding"in A?A.padding:Q.padding,qe=Q.zoomScale(Ie-R),ke=o.Point.convert(A.offset),Xe=Q.centerPoint.add(ke),et=Q.pointLocation(Xe),at=o.LngLat.convert(A.center||et);this._normalizeCenter(at);var mt=Q.project(et),Ze=Q.project(at).sub(mt),bt=A.curve,Tt=Math.max(Q.width,Q.height),Vt=Tt/qe,Ht=Ze.mag();if("minZoom"in A){var hr=o.clamp(Math.min(A.minZoom,R,Ie),Q.minZoom,Q.maxZoom),Er=Tt/Q.zoomScale(hr-R);bt=Math.sqrt(Er/Ht*2)}var Mr=bt*bt;function Ur(Lr){var Dr=(Vt*Vt-Tt*Tt+(Lr?-1:1)*Mr*Mr*Ht*Ht)/(2*(Lr?Vt:Tt)*Mr*Ht);return Math.log(Math.sqrt(Dr*Dr+1)-Dr)}function gi(Lr){return(Math.exp(Lr)-Math.exp(-Lr))/2}function lr(Lr){return(Math.exp(Lr)+Math.exp(-Lr))/2}var zr=Ur(0),$r=function(Lr){return lr(zr)/lr(zr+bt*Lr)},qr=function(Lr){return Tt*((lr(zr)*(gi(Dr=zr+bt*Lr)/lr(Dr))-gi(zr))/Mr)/Ht;var Dr},Zr=(Ur(1)-zr)/bt;if(Math.abs(Ht)<1e-6||!isFinite(Zr)){if(Math.abs(Tt-Vt)<1e-6)return this.easeTo(A,d);var si=Vt<Tt?-1:1;Zr=Math.abs(Math.log(Vt/Tt))/bt,qr=function(){return 0},$r=function(Lr){return Math.exp(si*bt*Lr)}}return A.duration="duration"in A?+A.duration:1e3*Zr/("screenSpeed"in A?+A.screenSpeed/bt:+A.speed),A.maxDuration&&A.duration>A.maxDuration&&(A.duration=0),this._zooming=!0,this._rotating=J!==Te,this._pitching=He!==Ae,this._padding=!Q.isPaddingEqual(Le),this._prepareEase(d,!1),this._ease(function(Lr){var Dr=Lr*Zr,Kn=1/$r(Dr);Q.zoom=Lr===1?Ie:R+Q.scaleZoom(Kn),b._rotating&&(Q.bearing=o.number(J,Te,Lr)),b._pitching&&(Q.pitch=o.number(Ae,He,Lr)),b._padding&&(Q.interpolatePadding(Be,Le,Lr),Xe=Q.centerPoint.add(ke));var dn=Lr===1?at:Q.unproject(mt.add(Ze.mult(qr(Dr))).mult(Kn));Q.setLocationAtPoint(Q.renderWorldCopies?dn.wrap():dn,Xe),b._fireMoveEvents(d)},function(){return b._afterEase(d)},A),this},u.prototype.isEasing=function(){return!!this._easeFrameId},u.prototype.stop=function(){return this._stop()},u.prototype._stop=function(A,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var b=this._onEaseEnd;delete this._onEaseEnd,b.call(this,d)}if(!A){var M=this.handlers;M&&M.stop(!1)}return this},u.prototype._ease=function(A,d,b){b.animate===!1||b.duration===0?(A(1),d()):(this._easeStart=o.browser.now(),this._easeOptions=b,this._onEaseFrame=A,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},u.prototype._renderFrameCallback=function(){var A=Math.min((o.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(A)),A<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},u.prototype._normalizeBearing=function(A,d){A=o.wrap(A,-180,180);var b=Math.abs(A-d);return Math.abs(A-360-d)<b&&(A-=360),Math.abs(A+360-d)<b&&(A+=360),A},u.prototype._normalizeCenter=function(A){var d=this.transform;if(d.renderWorldCopies&&!d.lngRange){var b=A.lng-d.center.lng;A.lng+=b>180?-360:b<-180?360:0}},u}(o.Evented),qi=function(l){l===void 0&&(l={}),this.options=l,o.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};qi.prototype.getDefaultPosition=function(){return"bottom-right"},qi.prototype.onAdd=function(l){var u=this.options&&this.options.compact;return this._map=l,this._container=K.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=K.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=K.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),u&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),u===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},qi.prototype.onRemove=function(){K.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},qi.prototype._setElementTitle=function(l,u){var A=this._map._getUIString("AttributionControl."+u);l.title=A,l.setAttribute("aria-label",A)},qi.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},qi.prototype._updateEditLink=function(){var l=this._editLink;l||(l=this._editLink=this._container.querySelector(".mapbox-improve-map"));var u=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.config.ACCESS_TOKEN}];if(l){var A=u.reduce(function(d,b,M){return b.value&&(d+=b.key+"="+b.value+(M<u.length-1?"&":"")),d},"?");l.href=o.config.FEEDBACK_URL+"/"+A+(this._map._hash?this._map._hash.getHashString(!0):""),l.rel="noopener nofollow",this._setElementTitle(l,"MapFeedback")}},qi.prototype._updateData=function(l){!l||l.sourceDataType!=="metadata"&&l.sourceDataType!=="visibility"&&l.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},qi.prototype._updateAttributions=function(){if(this._map.style){var l=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=l.concat(this.options.customAttribution.map(function(R){return typeof R!="string"?"":R})):typeof this.options.customAttribution=="string"&&l.push(this.options.customAttribution)),this._map.style.stylesheet){var u=this._map.style.stylesheet;this.styleOwner=u.owner,this.styleId=u.id}var A=this._map.style.sourceCaches;for(var d in A){var b=A[d];if(b.used){var M=b.getSource();M.attribution&&l.indexOf(M.attribution)<0&&l.push(M.attribution)}}l.sort(function(R,J){return R.length-J.length});var Q=(l=l.filter(function(R,J){for(var Ae=J+1;Ae<l.length;Ae++)if(l[Ae].indexOf(R)>=0)return!1;return!0})).join(" | ");Q!==this._attribHTML&&(this._attribHTML=Q,l.length?(this._innerContainer.innerHTML=Q,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},qi.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var Ca=function(){o.bindAll(["_updateLogo"],this),o.bindAll(["_updateCompact"],this)};Ca.prototype.onAdd=function(l){this._map=l,this._container=K.create("div","mapboxgl-ctrl");var u=K.create("a","mapboxgl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://www.mapbox.com/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Ca.prototype.onRemove=function(){K.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Ca.prototype.getDefaultPosition=function(){return"bottom-left"},Ca.prototype._updateLogo=function(l){l&&l.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},Ca.prototype._logoRequired=function(){if(this._map.style){var l=this._map.style.sourceCaches;for(var u in l)if(l[u].getSource().mapbox_logo)return!0;return!1}},Ca.prototype._updateCompact=function(){var l=this._container.children;if(l.length){var u=l[0];this._map.getCanvasContainer().offsetWidth<250?u.classList.add("mapboxgl-compact"):u.classList.remove("mapboxgl-compact")}};var eo=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};eo.prototype.add=function(l){var u=++this._id;return this._queue.push({callback:l,id:u,cancelled:!1}),u},eo.prototype.remove=function(l){for(var u=this._currentlyRunning,A=0,d=u?this._queue.concat(u):this._queue;A<d.length;A+=1){var b=d[A];if(b.id===l)return void(b.cancelled=!0)}},eo.prototype.run=function(l){l===void 0&&(l=0);var u=this._currentlyRunning=this._queue;this._queue=[];for(var A=0,d=u;A<d.length;A+=1){var b=d[A];if(!b.cancelled&&(b.callback(l),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},eo.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var y={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},r=o.window.HTMLImageElement,c=o.window.HTMLElement,m=o.window.ImageBitmap,_={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},S=function(l){function u(d){var b=this;if((d=o.extend({},_,d)).minZoom!=null&&d.maxZoom!=null&&d.minZoom>d.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(d.minPitch!=null&&d.maxPitch!=null&&d.minPitch>d.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(d.minPitch!=null&&d.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(d.maxPitch!=null&&d.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var M=new Ei(d.minZoom,d.maxZoom,d.minPitch,d.maxPitch,d.renderWorldCopies);if(l.call(this,M,d),this._interactive=d.interactive,this._maxTileCacheSize=d.maxTileCacheSize,this._failIfMajorPerformanceCaveat=d.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=d.preserveDrawingBuffer,this._antialias=d.antialias,this._trackResize=d.trackResize,this._bearingSnap=d.bearingSnap,this._refreshExpiredTiles=d.refreshExpiredTiles,this._fadeDuration=d.fadeDuration,this._crossSourceCollisions=d.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=d.collectResourceTiming,this._renderTaskQueue=new eo,this._controls=[],this._mapId=o.uniqueId(),this._locale=o.extend({},y,d.locale),this._clickTolerance=d.clickTolerance,this._requestManager=new o.RequestManager(d.transformRequest,d.accessToken),typeof d.container=="string"){if(this._container=o.window.document.getElementById(d.container),!this._container)throw new Error("Container '"+d.container+"' not found.")}else{if(!(d.container instanceof c))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=d.container}if(d.maxBounds&&this.setMaxBounds(d.maxBounds),o.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return b._update(!1)}),this.on("moveend",function(){return b._update(!1)}),this.on("zoom",function(){return b._update(!0)}),o.window!==void 0&&(o.window.addEventListener("online",this._onWindowOnline,!1),o.window.addEventListener("resize",this._onWindowResize,!1),o.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new cr(this,d),this._hash=d.hash&&new Ho(typeof d.hash=="string"&&d.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch}),d.bounds&&(this.resize(),this.fitBounds(d.bounds,o.extend({},d.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=d.localIdeographFontFamily,d.style&&this.setStyle(d.style,{localIdeographFontFamily:d.localIdeographFontFamily}),d.attributionControl&&this.addControl(new qi({customAttribution:d.customAttribution})),this.addControl(new Ca,d.logoPosition),this.on("style.load",function(){b.transform.unmodified&&b.jumpTo(b.style.stylesheet)}),this.on("data",function(Q){b._update(Q.dataType==="style"),b.fire(new o.Event(Q.dataType+"data",Q))}),this.on("dataloading",function(Q){b.fire(new o.Event(Q.dataType+"dataloading",Q))})}l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u;var A={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return u.prototype._getMapId=function(){return this._mapId},u.prototype.addControl=function(d,b){if(b===void 0&&(b=d.getDefaultPosition?d.getDefaultPosition():"top-right"),!d||!d.onAdd)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var M=d.onAdd(this);this._controls.push(d);var Q=this._controlPositions[b];return b.indexOf("bottom")!==-1?Q.insertBefore(M,Q.firstChild):Q.appendChild(M),this},u.prototype.removeControl=function(d){if(!d||!d.onRemove)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var b=this._controls.indexOf(d);return b>-1&&this._controls.splice(b,1),d.onRemove(this),this},u.prototype.hasControl=function(d){return this._controls.indexOf(d)>-1},u.prototype.resize=function(d){var b=this._containerDimensions(),M=b[0],Q=b[1];if(M===this.transform.width&&Q===this.transform.height)return this;this._resizeCanvas(M,Q),this.transform.resize(M,Q),this.painter.resize(M,Q);var R=!this._moving;return R&&this.fire(new o.Event("movestart",d)).fire(new o.Event("move",d)),this.fire(new o.Event("resize",d)),R&&this.fire(new o.Event("moveend",d)),this},u.prototype.getBounds=function(){return this.transform.getBounds()},u.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},u.prototype.setMaxBounds=function(d){return this.transform.setMaxBounds(o.LngLatBounds.convert(d)),this._update()},u.prototype.setMinZoom=function(d){if((d=d==null?-2:d)>=-2&&d<=this.transform.maxZoom)return this.transform.minZoom=d,this._update(),this.getZoom()<d&&this.setZoom(d),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},u.prototype.getMinZoom=function(){return this.transform.minZoom},u.prototype.setMaxZoom=function(d){if((d=d==null?22:d)>=this.transform.minZoom)return this.transform.maxZoom=d,this._update(),this.getZoom()>d&&this.setZoom(d),this;throw new Error("maxZoom must be greater than the current minZoom")},u.prototype.getMaxZoom=function(){return this.transform.maxZoom},u.prototype.setMinPitch=function(d){if((d=d==null?0:d)<0)throw new Error("minPitch must be greater than or equal to 0");if(d>=0&&d<=this.transform.maxPitch)return this.transform.minPitch=d,this._update(),this.getPitch()<d&&this.setPitch(d),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},u.prototype.getMinPitch=function(){return this.transform.minPitch},u.prototype.setMaxPitch=function(d){if((d=d==null?60:d)>60)throw new Error("maxPitch must be less than or equal to 60");if(d>=this.transform.minPitch)return this.transform.maxPitch=d,this._update(),this.getPitch()>d&&this.setPitch(d),this;throw new Error("maxPitch must be greater than the current minPitch")},u.prototype.getMaxPitch=function(){return this.transform.maxPitch},u.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},u.prototype.setRenderWorldCopies=function(d){return this.transform.renderWorldCopies=d,this._update()},u.prototype.project=function(d){return this.transform.locationPoint(o.LngLat.convert(d))},u.prototype.unproject=function(d){return this.transform.pointLocation(o.Point.convert(d))},u.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},u.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},u.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},u.prototype._createDelegatedListener=function(d,b,M){var Q,R=this;if(d==="mouseenter"||d==="mouseover"){var J=!1;return{layer:b,listener:M,delegates:{mousemove:function(Be){var Ie=R.getLayer(b)?R.queryRenderedFeatures(Be.point,{layers:[b]}):[];Ie.length?J||(J=!0,M.call(R,new yo(d,R,Be.originalEvent,{features:Ie}))):J=!1},mouseout:function(){J=!1}}}}if(d==="mouseleave"||d==="mouseout"){var Ae=!1;return{layer:b,listener:M,delegates:{mousemove:function(Be){(R.getLayer(b)?R.queryRenderedFeatures(Be.point,{layers:[b]}):[]).length?Ae=!0:Ae&&(Ae=!1,M.call(R,new yo(d,R,Be.originalEvent)))},mouseout:function(Be){Ae&&(Ae=!1,M.call(R,new yo(d,R,Be.originalEvent)))}}}}return{layer:b,listener:M,delegates:(Q={},Q[d]=function(Be){var Ie=R.getLayer(b)?R.queryRenderedFeatures(Be.point,{layers:[b]}):[];Ie.length&&(Be.features=Ie,M.call(R,Be),delete Be.features)},Q)}},u.prototype.on=function(d,b,M){if(M===void 0)return l.prototype.on.call(this,d,b);var Q=this._createDelegatedListener(d,b,M);for(var R in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[d]=this._delegatedListeners[d]||[],this._delegatedListeners[d].push(Q),Q.delegates)this.on(R,Q.delegates[R]);return this},u.prototype.once=function(d,b,M){if(M===void 0)return l.prototype.once.call(this,d,b);var Q=this._createDelegatedListener(d,b,M);for(var R in Q.delegates)this.once(R,Q.delegates[R]);return this},u.prototype.off=function(d,b,M){var Q=this;return M===void 0?l.prototype.off.call(this,d,b):(this._delegatedListeners&&this._delegatedListeners[d]&&function(R){for(var J=R[d],Ae=0;Ae<J.length;Ae++){var Be=J[Ae];if(Be.layer===b&&Be.listener===M){for(var Ie in Be.delegates)Q.off(Ie,Be.delegates[Ie]);return J.splice(Ae,1),Q}}}(this._delegatedListeners),this)},u.prototype.queryRenderedFeatures=function(d,b){if(!this.style)return[];var M;if(b!==void 0||d===void 0||d instanceof o.Point||Array.isArray(d)||(b=d,d=void 0),b=b||{},(d=d||[[0,0],[this.transform.width,this.transform.height]])instanceof o.Point||typeof d[0]=="number")M=[o.Point.convert(d)];else{var Q=o.Point.convert(d[0]),R=o.Point.convert(d[1]);M=[Q,new o.Point(R.x,Q.y),R,new o.Point(Q.x,R.y),Q]}return this.style.queryRenderedFeatures(M,b,this.transform)},u.prototype.querySourceFeatures=function(d,b){return this.style.querySourceFeatures(d,b)},u.prototype.setStyle=function(d,b){return(b=o.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},b)).diff!==!1&&b.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&d?(this._diffStyle(d,b),this):(this._localIdeographFontFamily=b.localIdeographFontFamily,this._updateStyle(d,b))},u.prototype._getUIString=function(d){var b=this._locale[d];if(b==null)throw new Error("Missing UI string '"+d+"'");return b},u.prototype._updateStyle=function(d,b){return this.style&&(this.style.setEventedParent(null),this.style._remove()),d?(this.style=new ca(this,b||{}),this.style.setEventedParent(this,{style:this.style}),typeof d=="string"?this.style.loadURL(d):this.style.loadJSON(d),this):(delete this.style,this)},u.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new ca(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},u.prototype._diffStyle=function(d,b){var M=this;if(typeof d=="string"){var Q=this._requestManager.normalizeStyleURL(d),R=this._requestManager.transformRequest(Q,o.ResourceType.Style);o.getJSON(R,function(J,Ae){J?M.fire(new o.ErrorEvent(J)):Ae&&M._updateDiff(Ae,b)})}else typeof d=="object"&&this._updateDiff(d,b)},u.prototype._updateDiff=function(d,b){try{this.style.setState(d)&&this._update(!0)}catch(M){o.warnOnce("Unable to perform style diff: "+(M.message||M.error||M)+".  Rebuilding the style from scratch."),this._updateStyle(d,b)}},u.prototype.getStyle=function(){if(this.style)return this.style.serialize()},u.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():o.warnOnce("There is no style added to the map.")},u.prototype.addSource=function(d,b){return this._lazyInitEmptyStyle(),this.style.addSource(d,b),this._update(!0)},u.prototype.isSourceLoaded=function(d){var b=this.style&&this.style.sourceCaches[d];if(b!==void 0)return b.loaded();this.fire(new o.ErrorEvent(new Error("There is no source with ID '"+d+"'")))},u.prototype.areTilesLoaded=function(){var d=this.style&&this.style.sourceCaches;for(var b in d){var M=d[b]._tiles;for(var Q in M){var R=M[Q];if(R.state!=="loaded"&&R.state!=="errored")return!1}}return!0},u.prototype.addSourceType=function(d,b,M){return this._lazyInitEmptyStyle(),this.style.addSourceType(d,b,M)},u.prototype.removeSource=function(d){return this.style.removeSource(d),this._update(!0)},u.prototype.getSource=function(d){return this.style.getSource(d)},u.prototype.addImage=function(d,b,M){M===void 0&&(M={});var Q=M.pixelRatio;Q===void 0&&(Q=1);var R=M.sdf;R===void 0&&(R=!1);var J=M.stretchX,Ae=M.stretchY,Be=M.content;if(this._lazyInitEmptyStyle(),b instanceof r||m&&b instanceof m){var Ie=o.browser.getImageData(b);this.style.addImage(d,{data:new o.RGBAImage({width:Ie.width,height:Ie.height},Ie.data),pixelRatio:Q,stretchX:J,stretchY:Ae,content:Be,sdf:R,version:0})}else{if(b.width===void 0||b.height===void 0)return this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var Te=b;this.style.addImage(d,{data:new o.RGBAImage({width:b.width,height:b.height},new Uint8Array(b.data)),pixelRatio:Q,stretchX:J,stretchY:Ae,content:Be,sdf:R,version:0,userImage:Te}),Te.onAdd&&Te.onAdd(this,d)}},u.prototype.updateImage=function(d,b){var M=this.style.getImage(d);if(!M)return this.fire(new o.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var Q=b instanceof r||m&&b instanceof m?o.browser.getImageData(b):b,R=Q.width,J=Q.height,Ae=Q.data;return R===void 0||J===void 0?this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):R!==M.data.width||J!==M.data.height?this.fire(new o.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(M.data.replace(Ae,!(b instanceof r||m&&b instanceof m)),void this.style.updateImage(d,M))},u.prototype.hasImage=function(d){return d?!!this.style.getImage(d):(this.fire(new o.ErrorEvent(new Error("Missing required image id"))),!1)},u.prototype.removeImage=function(d){this.style.removeImage(d)},u.prototype.loadImage=function(d,b){o.getImage(this._requestManager.transformRequest(d,o.ResourceType.Image),b)},u.prototype.listImages=function(){return this.style.listImages()},u.prototype.addLayer=function(d,b){return this._lazyInitEmptyStyle(),this.style.addLayer(d,b),this._update(!0)},u.prototype.moveLayer=function(d,b){return this.style.moveLayer(d,b),this._update(!0)},u.prototype.removeLayer=function(d){return this.style.removeLayer(d),this._update(!0)},u.prototype.getLayer=function(d){return this.style.getLayer(d)},u.prototype.setLayerZoomRange=function(d,b,M){return this.style.setLayerZoomRange(d,b,M),this._update(!0)},u.prototype.setFilter=function(d,b,M){return M===void 0&&(M={}),this.style.setFilter(d,b,M),this._update(!0)},u.prototype.getFilter=function(d){return this.style.getFilter(d)},u.prototype.setPaintProperty=function(d,b,M,Q){return Q===void 0&&(Q={}),this.style.setPaintProperty(d,b,M,Q),this._update(!0)},u.prototype.getPaintProperty=function(d,b){return this.style.getPaintProperty(d,b)},u.prototype.setLayoutProperty=function(d,b,M,Q){return Q===void 0&&(Q={}),this.style.setLayoutProperty(d,b,M,Q),this._update(!0)},u.prototype.getLayoutProperty=function(d,b){return this.style.getLayoutProperty(d,b)},u.prototype.setLight=function(d,b){return b===void 0&&(b={}),this._lazyInitEmptyStyle(),this.style.setLight(d,b),this._update(!0)},u.prototype.getLight=function(){return this.style.getLight()},u.prototype.setFeatureState=function(d,b){return this.style.setFeatureState(d,b),this._update()},u.prototype.removeFeatureState=function(d,b){return this.style.removeFeatureState(d,b),this._update()},u.prototype.getFeatureState=function(d){return this.style.getFeatureState(d)},u.prototype.getContainer=function(){return this._container},u.prototype.getCanvasContainer=function(){return this._canvasContainer},u.prototype.getCanvas=function(){return this._canvas},u.prototype._containerDimensions=function(){var d=0,b=0;return this._container&&(d=this._container.clientWidth||400,b=this._container.clientHeight||300),[d,b]},u.prototype._detectMissingCSS=function(){o.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},u.prototype._setupContainer=function(){var d=this._container;d.classList.add("mapboxgl-map"),(this._missingCSSCanary=K.create("div","mapboxgl-canary",d)).style.visibility="hidden",this._detectMissingCSS();var b=this._canvasContainer=K.create("div","mapboxgl-canvas-container",d);this._interactive&&b.classList.add("mapboxgl-interactive"),this._canvas=K.create("canvas","mapboxgl-canvas",b),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var M=this._containerDimensions();this._resizeCanvas(M[0],M[1]);var Q=this._controlContainer=K.create("div","mapboxgl-control-container",d),R=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(J){R[J]=K.create("div","mapboxgl-ctrl-"+J,Q)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},u.prototype._resizeCanvas=function(d,b){var M=o.browser.devicePixelRatio||1;this._canvas.width=M*d,this._canvas.height=M*b,this._canvas.style.width=d+"px",this._canvas.style.height=b+"px"},u.prototype._setupPainter=function(){var d=o.extend({},q.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),b=this._canvas.getContext("webgl",d)||this._canvas.getContext("experimental-webgl",d);b?(this.painter=new Oi(b,this.transform),o.webpSupported.testSupport(b)):this.fire(new o.ErrorEvent(new Error("Failed to initialize WebGL")))},u.prototype._contextLost=function(d){d.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.Event("webglcontextlost",{originalEvent:d}))},u.prototype._contextRestored=function(d){this._setupPainter(),this.resize(),this._update(),this.fire(new o.Event("webglcontextrestored",{originalEvent:d}))},u.prototype._onMapScroll=function(d){if(d.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},u.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},u.prototype._update=function(d){return this.style?(this._styleDirty=this._styleDirty||d,this._sourcesDirty=!0,this.triggerRepaint(),this):this},u.prototype._requestRenderFrame=function(d){return this._update(),this._renderTaskQueue.add(d)},u.prototype._cancelRenderFrame=function(d){this._renderTaskQueue.remove(d)},u.prototype._render=function(d){var b,M=this,Q=0,R=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(b=R.createQueryEXT(),R.beginQueryEXT(R.TIME_ELAPSED_EXT,b),Q=o.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(d),!this._removed){var J=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var Ae=this.transform.zoom,Be=o.browser.now();this.style.zoomHistory.update(Ae,Be);var Ie=new o.EvaluationParameters(Ae,{now:Be,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Te=Ie.crossFadingFactor();Te===1&&Te===this._crossFadingFactor||(J=!0,this._crossFadingFactor=Te),this.style.update(Ie)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new o.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new o.Event("load"))),this.style&&(this.style.hasTransitions()||J)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var He=o.browser.now()-Q;R.endQueryEXT(R.TIME_ELAPSED_EXT,b),setTimeout(function(){var ke=R.getQueryObjectEXT(b,R.QUERY_RESULT_EXT)/1e6;R.deleteQueryEXT(b),M.fire(new o.Event("gpu-timing-frame",{cpuTime:He,gpuTime:ke}))},50)}if(this.listens("gpu-timing-layer")){var Le=this.painter.collectGpuTimers();setTimeout(function(){var ke=M.painter.queryGpuTimers(Le);M.fire(new o.Event("gpu-timing-layer",{layerTimes:ke}))},50)}var qe=this._sourcesDirty||this._styleDirty||this._placementDirty;return qe||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.Event("idle")),!this._loaded||this._fullyLoaded||qe||(this._fullyLoaded=!0),this}},u.prototype.remove=function(){this._hash&&this._hash.remove();for(var d=0,b=this._controls;d<b.length;d+=1)b[d].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),o.window!==void 0&&(o.window.removeEventListener("resize",this._onWindowResize,!1),o.window.removeEventListener("orientationchange",this._onWindowResize,!1),o.window.removeEventListener("online",this._onWindowOnline,!1));var M=this.painter.context.gl.getExtension("WEBGL_lose_context");M&&M.loseContext(),z(this._canvasContainer),z(this._controlContainer),z(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new o.Event("remove"))},u.prototype.triggerRepaint=function(){var d=this;this.style&&!this._frame&&(this._frame=o.browser.frame(function(b){d._frame=null,d._render(b)}))},u.prototype._onWindowOnline=function(){this._update()},u.prototype._onWindowResize=function(d){this._trackResize&&this.resize({originalEvent:d})._update()},A.showTileBoundaries.get=function(){return!!this._showTileBoundaries},A.showTileBoundaries.set=function(d){this._showTileBoundaries!==d&&(this._showTileBoundaries=d,this._update())},A.showPadding.get=function(){return!!this._showPadding},A.showPadding.set=function(d){this._showPadding!==d&&(this._showPadding=d,this._update())},A.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},A.showCollisionBoxes.set=function(d){this._showCollisionBoxes!==d&&(this._showCollisionBoxes=d,d?this.style._generateCollisionBoxes():this._update())},A.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},A.showOverdrawInspector.set=function(d){this._showOverdrawInspector!==d&&(this._showOverdrawInspector=d,this._update())},A.repaint.get=function(){return!!this._repaint},A.repaint.set=function(d){this._repaint!==d&&(this._repaint=d,this.triggerRepaint())},A.vertices.get=function(){return!!this._vertices},A.vertices.set=function(d){this._vertices=d,this._update()},u.prototype._setCacheLimits=function(d,b){o.setCacheLimits(d,b)},A.version.get=function(){return o.version},Object.defineProperties(u.prototype,A),u}(Wn);function z(l){l.parentNode&&l.parentNode.removeChild(l)}var N={showCompass:!0,showZoom:!0,visualizePitch:!1},$=function(l){var u=this;this.options=o.extend({},N,l),this._container=K.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(A){return A.preventDefault()}),this.options.showZoom&&(o.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(A){return u._map.zoomIn({},{originalEvent:A})}),K.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(A){return u._map.zoomOut({},{originalEvent:A})}),K.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(o.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(A){u.options.visualizePitch?u._map.resetNorthPitch({},{originalEvent:A}):u._map.resetNorth({},{originalEvent:A})}),this._compassIcon=K.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};$.prototype._updateZoomButtons=function(){var l=this._map.getZoom(),u=l===this._map.getMaxZoom(),A=l===this._map.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=A,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",A.toString())},$.prototype._rotateCompassArrow=function(){var l=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=l},$.prototype.onAdd=function(l){return this._map=l,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new W(this._map,this._compass,this.options.visualizePitch)),this._container},$.prototype.onRemove=function(){K.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},$.prototype._createButton=function(l,u){var A=K.create("button",l,this._container);return A.type="button",A.addEventListener("click",u),A},$.prototype._setButtonTitle=function(l,u){var A=this._map._getUIString("NavigationControl."+u);l.title=A,l.setAttribute("aria-label",A)};var W=function(l,u,A){A===void 0&&(A=!1),this._clickTolerance=10,this.element=u,this.mouseRotate=new sA({clickTolerance:l.dragRotate._mouseRotate._clickTolerance}),this.map=l,A&&(this.mousePitch=new ol({clickTolerance:l.dragRotate._mousePitch._clickTolerance})),o.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),K.addEventListener(u,"mousedown",this.mousedown),K.addEventListener(u,"touchstart",this.touchstart,{passive:!1}),K.addEventListener(u,"touchmove",this.touchmove),K.addEventListener(u,"touchend",this.touchend),K.addEventListener(u,"touchcancel",this.reset)};function ce(l,u,A){if(l=new o.LngLat(l.lng,l.lat),u){var d=new o.LngLat(l.lng-360,l.lat),b=new o.LngLat(l.lng+360,l.lat),M=A.locationPoint(l).distSqr(u);A.locationPoint(d).distSqr(u)<M?l=d:A.locationPoint(b).distSqr(u)<M&&(l=b)}for(;Math.abs(l.lng-A.center.lng)>180;){var Q=A.locationPoint(l);if(Q.x>=0&&Q.y>=0&&Q.x<=A.width&&Q.y<=A.height)break;l.lng>A.center.lng?l.lng-=360:l.lng+=360}return l}W.prototype.down=function(l,u){this.mouseRotate.mousedown(l,u),this.mousePitch&&this.mousePitch.mousedown(l,u),K.disableDrag()},W.prototype.move=function(l,u){var A=this.map,d=this.mouseRotate.mousemoveWindow(l,u);if(d&&d.bearingDelta&&A.setBearing(A.getBearing()+d.bearingDelta),this.mousePitch){var b=this.mousePitch.mousemoveWindow(l,u);b&&b.pitchDelta&&A.setPitch(A.getPitch()+b.pitchDelta)}},W.prototype.off=function(){var l=this.element;K.removeEventListener(l,"mousedown",this.mousedown),K.removeEventListener(l,"touchstart",this.touchstart,{passive:!1}),K.removeEventListener(l,"touchmove",this.touchmove),K.removeEventListener(l,"touchend",this.touchend),K.removeEventListener(l,"touchcancel",this.reset),this.offTemp()},W.prototype.offTemp=function(){K.enableDrag(),K.removeEventListener(o.window,"mousemove",this.mousemove),K.removeEventListener(o.window,"mouseup",this.mouseup)},W.prototype.mousedown=function(l){this.down(o.extend({},l,{ctrlKey:!0,preventDefault:function(){return l.preventDefault()}}),K.mousePos(this.element,l)),K.addEventListener(o.window,"mousemove",this.mousemove),K.addEventListener(o.window,"mouseup",this.mouseup)},W.prototype.mousemove=function(l){this.move(l,K.mousePos(this.element,l))},W.prototype.mouseup=function(l){this.mouseRotate.mouseupWindow(l),this.mousePitch&&this.mousePitch.mouseupWindow(l),this.offTemp()},W.prototype.touchstart=function(l){l.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=K.touchPos(this.element,l.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return l.preventDefault()}},this._startPos))},W.prototype.touchmove=function(l){l.targetTouches.length!==1?this.reset():(this._lastPos=K.touchPos(this.element,l.targetTouches)[0],this.move({preventDefault:function(){return l.preventDefault()}},this._lastPos))},W.prototype.touchend=function(l){l.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},W.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var ge={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Ce(l,u,A){var d=l.classList;for(var b in ge)d.remove("mapboxgl-"+A+"-anchor-"+b);d.add("mapboxgl-"+A+"-anchor-"+u)}var je,De=function(l){function u(A,d){if(l.call(this),(A instanceof o.window.HTMLElement||d)&&(A=o.extend({element:A},d)),o.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=A&&A.anchor||"center",this._color=A&&A.color||"#3FB1CE",this._scale=A&&A.scale||1,this._draggable=A&&A.draggable||!1,this._clickTolerance=A&&A.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=A&&A.rotation||0,this._rotationAlignment=A&&A.rotationAlignment||"auto",this._pitchAlignment=A&&A.pitchAlignment&&A.pitchAlignment!=="auto"?A.pitchAlignment:this._rotationAlignment,A&&A.element)this._element=A.element,this._offset=o.Point.convert(A&&A.offset||[0,0]);else{this._defaultMarker=!0,this._element=K.create("div"),this._element.setAttribute("aria-label","Map marker");var b=K.createNS("http://www.w3.org/2000/svg","svg");b.setAttributeNS(null,"display","block"),b.setAttributeNS(null,"height","41px"),b.setAttributeNS(null,"width","27px"),b.setAttributeNS(null,"viewBox","0 0 27 41");var M=K.createNS("http://www.w3.org/2000/svg","g");M.setAttributeNS(null,"stroke","none"),M.setAttributeNS(null,"stroke-width","1"),M.setAttributeNS(null,"fill","none"),M.setAttributeNS(null,"fill-rule","evenodd");var Q=K.createNS("http://www.w3.org/2000/svg","g");Q.setAttributeNS(null,"fill-rule","nonzero");var R=K.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"transform","translate(3.0, 29.0)"),R.setAttributeNS(null,"fill","#000000");for(var J=0,Ae=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];J<Ae.length;J+=1){var Be=Ae[J],Ie=K.createNS("http://www.w3.org/2000/svg","ellipse");Ie.setAttributeNS(null,"opacity","0.04"),Ie.setAttributeNS(null,"cx","10.5"),Ie.setAttributeNS(null,"cy","5.80029008"),Ie.setAttributeNS(null,"rx",Be.rx),Ie.setAttributeNS(null,"ry",Be.ry),R.appendChild(Ie)}var Te=K.createNS("http://www.w3.org/2000/svg","g");Te.setAttributeNS(null,"fill",this._color);var He=K.createNS("http://www.w3.org/2000/svg","path");He.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Te.appendChild(He);var Le=K.createNS("http://www.w3.org/2000/svg","g");Le.setAttributeNS(null,"opacity","0.25"),Le.setAttributeNS(null,"fill","#000000");var qe=K.createNS("http://www.w3.org/2000/svg","path");qe.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Le.appendChild(qe);var ke=K.createNS("http://www.w3.org/2000/svg","g");ke.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ke.setAttributeNS(null,"fill","#FFFFFF");var Xe=K.createNS("http://www.w3.org/2000/svg","g");Xe.setAttributeNS(null,"transform","translate(8.0, 8.0)");var et=K.createNS("http://www.w3.org/2000/svg","circle");et.setAttributeNS(null,"fill","#000000"),et.setAttributeNS(null,"opacity","0.25"),et.setAttributeNS(null,"cx","5.5"),et.setAttributeNS(null,"cy","5.5"),et.setAttributeNS(null,"r","5.4999962");var at=K.createNS("http://www.w3.org/2000/svg","circle");at.setAttributeNS(null,"fill","#FFFFFF"),at.setAttributeNS(null,"cx","5.5"),at.setAttributeNS(null,"cy","5.5"),at.setAttributeNS(null,"r","5.4999962"),Xe.appendChild(et),Xe.appendChild(at),Q.appendChild(R),Q.appendChild(Te),Q.appendChild(Le),Q.appendChild(ke),Q.appendChild(Xe),b.appendChild(Q),b.setAttributeNS(null,"height",41*this._scale+"px"),b.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(b),this._offset=o.Point.convert(A&&A.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(mt){mt.preventDefault()}),this._element.addEventListener("mousedown",function(mt){mt.preventDefault()}),Ce(this._element,this._anchor,"marker"),this._popup=null}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.addTo=function(A){return this.remove(),this._map=A,A.getCanvasContainer().appendChild(this._element),A.on("move",this._update),A.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},u.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),K.remove(this._element),this._popup&&this._popup.remove(),this},u.prototype.getLngLat=function(){return this._lngLat},u.prototype.setLngLat=function(A){return this._lngLat=o.LngLat.convert(A),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},u.prototype.getElement=function(){return this._element},u.prototype.setPopup=function(A){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),A){if(!("offset"in A.options)){var d=Math.sqrt(Math.pow(13.5,2)/2);A.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[d,-1*(24.6+d)],"bottom-right":[-d,-1*(24.6+d)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=A,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},u.prototype._onKeyPress=function(A){var d=A.code,b=A.charCode||A.keyCode;d!=="Space"&&d!=="Enter"&&b!==32&&b!==13||this.togglePopup()},u.prototype._onMapClick=function(A){var d=A.originalEvent.target,b=this._element;this._popup&&(d===b||b.contains(d))&&this.togglePopup()},u.prototype.getPopup=function(){return this._popup},u.prototype.togglePopup=function(){var A=this._popup;return A?(A.isOpen()?A.remove():A.addTo(this._map),this):this},u.prototype._update=function(A){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=ce(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var d="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?d="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(d="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var b="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?b="rotateX(0deg)":this._pitchAlignment==="map"&&(b="rotateX("+this._map.getPitch()+"deg)"),A&&A.type!=="moveend"||(this._pos=this._pos.round()),K.setTransform(this._element,ge[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+b+" "+d)}},u.prototype.getOffset=function(){return this._offset},u.prototype.setOffset=function(A){return this._offset=o.Point.convert(A),this._update(),this},u.prototype._onMove=function(A){if(!this._isDragging){var d=this._clickTolerance||this._map._clickTolerance;this._isDragging=A.point.dist(this._pointerdownPos)>=d}this._isDragging&&(this._pos=A.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.Event("dragstart"))),this.fire(new o.Event("drag")))},u.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.Event("dragend")),this._state="inactive"},u.prototype._addDragHandler=function(A){this._element.contains(A.originalEvent.target)&&(A.preventDefault(),this._positionDelta=A.point.sub(this._pos).add(this._offset),this._pointerdownPos=A.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},u.prototype.setDraggable=function(A){return this._draggable=!!A,this._map&&(A?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},u.prototype.isDraggable=function(){return this._draggable},u.prototype.setRotation=function(A){return this._rotation=A||0,this._update(),this},u.prototype.getRotation=function(){return this._rotation},u.prototype.setRotationAlignment=function(A){return this._rotationAlignment=A||"auto",this._update(),this},u.prototype.getRotationAlignment=function(){return this._rotationAlignment},u.prototype.setPitchAlignment=function(A){return this._pitchAlignment=A&&A!=="auto"?A:this._rotationAlignment,this._update(),this},u.prototype.getPitchAlignment=function(){return this._pitchAlignment},u}(o.Evented),Ke={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},lt=0,ht=!1,vt=function(l){function u(A){l.call(this),this.options=o.extend({},Ke,A),o.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.onAdd=function(A){var d;return this._map=A,this._container=K.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),d=this._setupUI,je!==void 0?d(je):o.window.navigator.permissions!==void 0?o.window.navigator.permissions.query({name:"geolocation"}).then(function(b){d(je=b.state!=="denied")}):d(je=!!o.window.navigator.geolocation),this._container},u.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(o.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),K.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,lt=0,ht=!1},u.prototype._isOutOfMapMaxBounds=function(A){var d=this._map.getMaxBounds(),b=A.coords;return d&&(b.longitude<d.getWest()||b.longitude>d.getEast()||b.latitude<d.getSouth()||b.latitude>d.getNorth())},u.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},u.prototype._onSuccess=function(A){if(this._map){if(this._isOutOfMapMaxBounds(A))return this._setErrorState(),this.fire(new o.Event("outofmaxbounds",A)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=A,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(A),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(A),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("geolocate",A)),this._finish()}},u.prototype._updateCamera=function(A){var d=new o.LngLat(A.coords.longitude,A.coords.latitude),b=A.coords.accuracy,M=this._map.getBearing(),Q=o.extend({bearing:M},this.options.fitBoundsOptions);this._map.fitBounds(d.toBounds(b),Q,{geolocateSource:!0})},u.prototype._updateMarker=function(A){if(A){var d=new o.LngLat(A.coords.longitude,A.coords.latitude);this._accuracyCircleMarker.setLngLat(d).addTo(this._map),this._userLocationDotMarker.setLngLat(d).addTo(this._map),this._accuracy=A.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},u.prototype._updateCircleRadius=function(){var A=this._map._container.clientHeight/2,d=this._map.unproject([0,A]),b=this._map.unproject([1,A]),M=d.distanceTo(b),Q=Math.ceil(2*this._accuracy/M);this._circleElement.style.width=Q+"px",this._circleElement.style.height=Q+"px"},u.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},u.prototype._onError=function(A){if(this._map){if(this.options.trackUserLocation)if(A.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(A.code===3&&ht)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("error",A)),this._finish()}},u.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},u.prototype._setupUI=function(A){var d=this;if(this._container.addEventListener("contextmenu",function(Q){return Q.preventDefault()}),this._geolocateButton=K.create("button","mapboxgl-ctrl-geolocate",this._container),K.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",A===!1){o.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var b=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=b,this._geolocateButton.setAttribute("aria-label",b)}else{var M=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=M,this._geolocateButton.setAttribute("aria-label",M)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=K.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new De(this._dotElement),this._circleElement=K.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new De({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(Q){Q.geolocateSource||d._watchState!=="ACTIVE_LOCK"||Q.originalEvent&&Q.originalEvent.type==="resize"||(d._watchState="BACKGROUND",d._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),d._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),d.fire(new o.Event("trackuserlocationend")))})},u.prototype.trigger=function(){if(!this._setup)return o.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":lt--,ht=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var A;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++lt>1?(A={maximumAge:6e5,timeout:0},ht=!0):(A=this.options.positionOptions,ht=!1),this._geolocationWatchID=o.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,A)}}else o.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},u.prototype._clearWatch=function(){o.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},u}(o.Evented),$e={maxWidth:100,unit:"metric"},Ct=function(l){this.options=o.extend({},$e,l),o.bindAll(["_onMove","setUnit"],this)};function wt(l,u,A){var d=A&&A.maxWidth||100,b=l._container.clientHeight/2,M=l.unproject([0,b]),Q=l.unproject([d,b]),R=M.distanceTo(Q);if(A&&A.unit==="imperial"){var J=3.2808*R;J>5280?Mt(u,d,J/5280,l._getUIString("ScaleControl.Miles")):Mt(u,d,J,l._getUIString("ScaleControl.Feet"))}else A&&A.unit==="nautical"?Mt(u,d,R/1852,l._getUIString("ScaleControl.NauticalMiles")):R>=1e3?Mt(u,d,R/1e3,l._getUIString("ScaleControl.Kilometers")):Mt(u,d,R,l._getUIString("ScaleControl.Meters"))}function Mt(l,u,A,d){var b,M,Q,R=(b=A,(M=Math.pow(10,(""+Math.floor(b)).length-1))*(Q=(Q=b/M)>=10?10:Q>=5?5:Q>=3?3:Q>=2?2:Q>=1?1:function(J){var Ae=Math.pow(10,Math.ceil(-Math.log(J)/Math.LN10));return Math.round(J*Ae)/Ae}(Q)));l.style.width=u*(R/A)+"px",l.innerHTML=R+"&nbsp;"+d}Ct.prototype.getDefaultPosition=function(){return"bottom-left"},Ct.prototype._onMove=function(){wt(this._map,this._container,this.options)},Ct.prototype.onAdd=function(l){return this._map=l,this._container=K.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",l.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Ct.prototype.onRemove=function(){K.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Ct.prototype.setUnit=function(l){this.options.unit=l,wt(this._map,this._container,this.options)};var Ft=function(l){this._fullscreen=!1,l&&l.container&&(l.container instanceof o.window.HTMLElement?this._container=l.container:o.warnOnce("Full screen control 'container' must be a DOM element.")),o.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in o.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in o.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in o.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in o.window.document&&(this._fullscreenchange="MSFullscreenChange")};Ft.prototype.onAdd=function(l){return this._map=l,this._container||(this._container=this._map.getContainer()),this._controlContainer=K.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Ft.prototype.onRemove=function(){K.remove(this._controlContainer),this._map=null,o.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Ft.prototype._checkFullscreenSupport=function(){return!!(o.window.document.fullscreenEnabled||o.window.document.mozFullScreenEnabled||o.window.document.msFullscreenEnabled||o.window.document.webkitFullscreenEnabled)},Ft.prototype._setupUI=function(){var l=this._fullscreenButton=K.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);K.create("span","mapboxgl-ctrl-icon",l).setAttribute("aria-hidden",!0),l.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),o.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Ft.prototype._updateTitle=function(){var l=this._getTitle();this._fullscreenButton.setAttribute("aria-label",l),this._fullscreenButton.title=l},Ft.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Ft.prototype._isFullscreen=function(){return this._fullscreen},Ft.prototype._changeIcon=function(){(o.window.document.fullscreenElement||o.window.document.mozFullScreenElement||o.window.document.webkitFullscreenElement||o.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Ft.prototype._onClickFullscreen=function(){this._isFullscreen()?o.window.document.exitFullscreen?o.window.document.exitFullscreen():o.window.document.mozCancelFullScreen?o.window.document.mozCancelFullScreen():o.window.document.msExitFullscreen?o.window.document.msExitFullscreen():o.window.document.webkitCancelFullScreen&&o.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var jt={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},St=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),mr=function(l){function u(A){l.call(this),this.options=o.extend(Object.create(jt),A),o.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return l&&(u.__proto__=l),(u.prototype=Object.create(l&&l.prototype)).constructor=u,u.prototype.addTo=function(A){return this._map&&this.remove(),this._map=A,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new o.Event("open")),this},u.prototype.isOpen=function(){return!!this._map},u.prototype.remove=function(){return this._content&&K.remove(this._content),this._container&&(K.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new o.Event("close")),this},u.prototype.getLngLat=function(){return this._lngLat},u.prototype.setLngLat=function(A){return this._lngLat=o.LngLat.convert(A),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},u.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},u.prototype.getElement=function(){return this._container},u.prototype.setText=function(A){return this.setDOMContent(o.window.document.createTextNode(A))},u.prototype.setHTML=function(A){var d,b=o.window.document.createDocumentFragment(),M=o.window.document.createElement("body");for(M.innerHTML=A;d=M.firstChild;)b.appendChild(d);return this.setDOMContent(b)},u.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},u.prototype.setMaxWidth=function(A){return this.options.maxWidth=A,this._update(),this},u.prototype.setDOMContent=function(A){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=K.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(A),this._createCloseButton(),this._update(),this._focusFirstElement(),this},u.prototype.addClassName=function(A){this._container&&this._container.classList.add(A)},u.prototype.removeClassName=function(A){this._container&&this._container.classList.remove(A)},u.prototype.setOffset=function(A){return this.options.offset=A,this._update(),this},u.prototype.toggleClassName=function(A){if(this._container)return this._container.classList.toggle(A)},u.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=K.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},u.prototype._onMouseUp=function(A){this._update(A.point)},u.prototype._onMouseMove=function(A){this._update(A.point)},u.prototype._onDrag=function(A){this._update(A.point)},u.prototype._update=function(A){var d=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=K.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=K.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(Ie){return d._container.classList.add(Ie)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ce(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||A)){var b=this._pos=this._trackPointer&&A?A:this._map.project(this._lngLat),M=this.options.anchor,Q=function Ie(Te){if(Te){if(typeof Te=="number"){var He=Math.round(Math.sqrt(.5*Math.pow(Te,2)));return{center:new o.Point(0,0),top:new o.Point(0,Te),"top-left":new o.Point(He,He),"top-right":new o.Point(-He,He),bottom:new o.Point(0,-Te),"bottom-left":new o.Point(He,-He),"bottom-right":new o.Point(-He,-He),left:new o.Point(Te,0),right:new o.Point(-Te,0)}}if(Te instanceof o.Point||Array.isArray(Te)){var Le=o.Point.convert(Te);return{center:Le,top:Le,"top-left":Le,"top-right":Le,bottom:Le,"bottom-left":Le,"bottom-right":Le,left:Le,right:Le}}return{center:o.Point.convert(Te.center||[0,0]),top:o.Point.convert(Te.top||[0,0]),"top-left":o.Point.convert(Te["top-left"]||[0,0]),"top-right":o.Point.convert(Te["top-right"]||[0,0]),bottom:o.Point.convert(Te.bottom||[0,0]),"bottom-left":o.Point.convert(Te["bottom-left"]||[0,0]),"bottom-right":o.Point.convert(Te["bottom-right"]||[0,0]),left:o.Point.convert(Te.left||[0,0]),right:o.Point.convert(Te.right||[0,0])}}return Ie(new o.Point(0,0))}(this.options.offset);if(!M){var R,J=this._container.offsetWidth,Ae=this._container.offsetHeight;R=b.y+Q.bottom.y<Ae?["top"]:b.y>this._map.transform.height-Ae?["bottom"]:[],b.x<J/2?R.push("left"):b.x>this._map.transform.width-J/2&&R.push("right"),M=R.length===0?"bottom":R.join("-")}var Be=b.add(Q[M]).round();K.setTransform(this._container,ge[M]+" translate("+Be.x+"px,"+Be.y+"px)"),Ce(this._container,M,"popup")}},u.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var A=this._container.querySelector(St);A&&A.focus()}},u.prototype._onClose=function(){this.remove()},u}(o.Evented),sr={version:o.version,supported:q,setRTLTextPlugin:o.setRTLTextPlugin,getRTLTextPluginStatus:o.getRTLTextPluginStatus,Map:S,NavigationControl:$,GeolocateControl:vt,AttributionControl:qi,ScaleControl:Ct,FullscreenControl:Ft,Popup:mr,Marker:De,Style:ca,LngLat:o.LngLat,LngLatBounds:o.LngLatBounds,Point:o.Point,MercatorCoordinate:o.MercatorCoordinate,Evented:o.Evented,config:o.config,prewarm:function(){ve().acquire(se)},clearPrewarmedResources:function(){var l=Ne;l&&(l.isPreloaded()&&l.numActive()===1?(l.release(se),Ne=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return o.config.ACCESS_TOKEN},set accessToken(l){o.config.ACCESS_TOKEN=l},get baseApiUrl(){return o.config.API_URL},set baseApiUrl(l){o.config.API_URL=l},get workerCount(){return Se.workerCount},set workerCount(l){Se.workerCount=l},get maxParallelImageRequests(){return o.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(l){o.config.MAX_PARALLEL_IMAGE_REQUESTS=l},clearStorage:function(l){o.clearTileCache(l)},workerUrl:""};return sr}),P}(),C_=qg({__proto__:null,default:ry},[ty.exports]),iy={exports:{}},ny=iy.exports=function(){var C,E,P;function V(o,q){if(C)if(E){var K="var sharedChunk = {}; ("+C+")(sharedChunk); ("+E+")(sharedChunk);",ae={};C(ae),P=q(ae),typeof window<"u"&&(P.workerUrl=window.URL.createObjectURL(new Blob([K],{type:"text/javascript"})))}else E=q;else C=q}return V(["exports"],function(o){var q=K;function K(i,t,a,h){this.cx=3*i,this.bx=3*(a-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(h-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=t,this.p2x=a,this.p2y=h}function ae(i,t,a,h){const f=new q(i,t,a,h);return function(v){return f.solve(v)}}K.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,t){if(t===void 0&&(t=1e-6),i<0)return 0;if(i>1)return 1;for(var a=i,h=0;h<8;h++){var f=this.sampleCurveX(a)-i;if(Math.abs(f)<t)return a;var v=this.sampleCurveDerivativeX(a);if(Math.abs(v)<1e-6)break;a-=f/v}var w=0,k=1;for(a=i,h=0;h<20&&(f=this.sampleCurveX(a),!(Math.abs(f-i)<t));h++)i>f?w=a:k=a,a=.5*(k-w)+w;return a},solve:function(i,t){return this.sampleCurveY(this.solveCurveX(i,t))}};const Y=ae(.25,.1,.25,1);function ie(i,t,a){return Math.min(a,Math.max(t,i))}function be(i,t,a){const h=a-t,f=((i-t)%h+h)%h+t;return f===t?a:f}function ze(i,...t){for(const a of t)for(const h in a)i[h]=a[h];return i}let it=1;function tt(i,t){i.forEach(a=>{t[a]&&(t[a]=t[a].bind(t))})}function _t(i,t,a){const h={};for(const f in i)h[f]=t.call(a||this,i[f],f,i);return h}function yt(i,t,a){const h={};for(const f in i)t.call(a||this,i[f],f,i)&&(h[f]=i[f]);return h}function Bt(i){return Array.isArray(i)?i.map(Bt):typeof i=="object"&&i?_t(i,Bt):i}const rt={};function It(i){rt[i]||(typeof console<"u"&&console.warn(i),rt[i]=!0)}function gt(i,t,a){return(a.y-i.y)*(t.x-i.x)>(t.y-i.y)*(a.x-i.x)}function Zt(i){let t=0;for(let a,h,f=0,v=i.length,w=v-1;f<v;w=f++)a=i[f],h=i[w],t+=(h.x-a.x)*(a.y+h.y);return t}function dr(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Xr(i){const t={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(a,h,f,v)=>{const w=f||v;return t[h]=!w||w.toLowerCase(),""}),t["max-age"]){const a=parseInt(t["max-age"],10);isNaN(a)?delete t["max-age"]:t["max-age"]=a}return t}let ur,_r,Rr=null;function ei(i){if(Rr==null){const t=i.navigator?i.navigator.userAgent:null;Rr=!!i.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Rr}function rr(i){return typeof ImageBitmap<"u"&&i instanceof ImageBitmap}const kt={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(i){const t=requestAnimationFrame(i);return{cancel:()=>cancelAnimationFrame(t)}},getImageData(i,t=0){const a=window.document.createElement("canvas"),h=a.getContext("2d");if(!h)throw new Error("failed to create canvas 2d context");return a.width=i.width,a.height=i.height,h.drawImage(i,0,0,i.width,i.height),h.getImageData(-t,-t,i.width+2*t,i.height+2*t)},resolveURL:i=>(ur||(ur=document.createElement("a")),ur.href=i,ur.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(_r==null&&(_r=matchMedia("(prefers-reduced-motion: reduce)")),_r.matches)}};var Rt=br;function br(i,t){this.x=i,this.y=t}br.prototype={clone:function(){return new br(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,t){return this.clone()._rotateAround(i,t)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var t=i.x-this.x,a=i.y-this.y;return t*t+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,t){return Math.atan2(this.x*t-this.y*i,this.x*i+this.y*t)},_matMult:function(i){var t=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=t,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var t=Math.cos(i),a=Math.sin(i),h=a*this.x+t*this.y;return this.x=t*this.x-a*this.y,this.y=h,this},_rotateAround:function(i,t){var a=Math.cos(i),h=Math.sin(i),f=t.y+h*(this.x-t.x)+a*(this.y-t.y);return this.x=t.x+a*(this.x-t.x)-h*(this.y-t.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},br.convert=function(i){return i instanceof br?i:Array.isArray(i)?new br(i[0],i[1]):i};const Or={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},Kr="mapbox-tiles";let di,ri,ii=500,ki=50;function kn(){typeof caches>"u"||di||(di=caches.open(Kr))}let Zi=1/0;const Bn={supported:!1,testSupport:function(i){!cn&&Xi&&(wi?Vi(i):la=i)}};let la,Xi,cn=!1,wi=!1;function Vi(i){const t=i.createTexture();i.bindTexture(i.TEXTURE_2D,t);try{if(i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,Xi),i.isContextLost())return;Bn.supported=!0}catch{}i.deleteTexture(t),cn=!0}typeof document<"u"&&(Xi=document.createElement("img"),Xi.onload=function(){la&&Vi(la),la=null,wi=!0},Xi.onerror=function(){cn=!0,la=null},Xi.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Ln={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Ln);class Wi extends Error{constructor(t,a,h,f){super(`AJAXError: ${a} (${t}): ${h}`),this.status=t,this.statusText=a,this.url=h,this.body=f}}const ni=dr()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href;function Pn(i,t){const a=new AbortController,h=new Request(i.url,{method:i.method||"GET",body:i.body,credentials:i.credentials,headers:i.headers,referrer:ni(),signal:a.signal});let f=!1,v=!1;return i.type==="json"&&h.headers.set("Accept","application/json"),((w,k,L)=>{if(v)return;const O=Date.now();fetch(h).then(Z=>Z.ok?((re,he,de)=>{(i.type==="arrayBuffer"?re.arrayBuffer():i.type==="json"?re.json():re.text()).then(me=>{v||(he&&de&&function(Ue,Qe,Ye){if(kn(),!di)return;const ot={status:Qe.status,statusText:Qe.statusText,headers:new Headers};Qe.headers.forEach((At,Et)=>ot.headers.set(Et,At));const nt=Xr(Qe.headers.get("Cache-Control")||"");nt["no-store"]||(nt["max-age"]&&ot.headers.set("Expires",new Date(Ye+1e3*nt["max-age"]).toUTCString()),new Date(ot.headers.get("Expires")).getTime()-Ye<42e4||function(At,Et){if(ri===void 0)try{new Response(new ReadableStream),ri=!0}catch{ri=!1}ri?Et(At.body):At.blob().then(Et)}(Qe,At=>{const Et=new Response(At,ot);kn(),di&&di.then(ft=>ft.put(function($t){const nr=$t.indexOf("?");return nr<0?$t:$t.slice(0,nr)}(Ue.url),Et)).catch(ft=>It(ft.message))}))}(h,he,de),f=!0,t(null,me,re.headers.get("Cache-Control"),re.headers.get("Expires")))}).catch(me=>{v||t(new Error(me.message))})})(Z,null,O):Z.blob().then(re=>t(new Wi(Z.status,Z.statusText,i.url,re)))).catch(Z=>{Z.code!==20&&t(new Error(Z.message))})})(),{cancel:()=>{v=!0,f||a.abort()}}}const an=function(i,t){if(/:\/\//.test(i.url)&&!/^https?:|^file:/.test(i.url)){if(dr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,t);if(!dr()){const h=i.url.substring(0,i.url.indexOf("://"));return(Or.REGISTERED_PROTOCOLS[h]||Pn)(i,t)}}if(!(/^file:/.test(a=i.url)||/^file:/.test(ni())&&!/^\w+:/.test(a))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Pn(i,t);if(dr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,t,void 0,!0)}var a;return function(h,f){const v=new XMLHttpRequest;v.open(h.method||"GET",h.url,!0),h.type==="arrayBuffer"&&(v.responseType="arraybuffer");for(const w in h.headers)v.setRequestHeader(w,h.headers[w]);return h.type==="json"&&(v.responseType="text",v.setRequestHeader("Accept","application/json")),v.withCredentials=h.credentials==="include",v.onerror=()=>{f(new Error(v.statusText))},v.onload=()=>{if((v.status>=200&&v.status<300||v.status===0)&&v.response!==null){let w=v.response;if(h.type==="json")try{w=JSON.parse(v.response)}catch(k){return f(k)}f(null,w,v.getResponseHeader("Cache-Control"),v.getResponseHeader("Expires"))}else{const w=new Blob([v.response],{type:v.getResponseHeader("Content-Type")});f(new Wi(v.status,v.statusText,h.url,w))}},v.send(h.body),{cancel:()=>v.abort()}}(i,t)},qn=function(i,t){return an(ze(i,{type:"arrayBuffer"}),t)};function un(i){const t=window.document.createElement("a");return t.href=i,t.protocol===window.document.location.protocol&&t.host===window.document.location.host}const Wr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Nn,Ri;Nn=[],Ri=0;const Hr=function(i,t){if(Bn.supported&&(i.headers||(i.headers={}),i.headers.accept="image/webp,*/*"),Ri>=Or.MAX_PARALLEL_IMAGE_REQUESTS){const v={requestParameters:i,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return Nn.push(v),v}Ri++;let a=!1;const h=()=>{if(!a)for(a=!0,Ri--;Nn.length&&Ri<Or.MAX_PARALLEL_IMAGE_REQUESTS;){const v=Nn.shift(),{requestParameters:w,callback:k,cancelled:L}=v;L||(v.cancel=Hr(w,k).cancel)}},f=qn(i,(v,w,k,L)=>{h(),v?t(v):w&&function(O,Z){typeof createImageBitmap=="function"?function(re,he){const de=new Blob([new Uint8Array(re)],{type:"image/png"});createImageBitmap(de).then(me=>{he(null,me)}).catch(me=>{he(new Error(`Could not load image because of ${me.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(O,Z):function(re,he){const de=new Image;de.onload=()=>{he(null,de),URL.revokeObjectURL(de.src),de.onload=null,window.requestAnimationFrame(()=>{de.src=Wr})},de.onerror=()=>he(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const me=new Blob([new Uint8Array(re)],{type:"image/png"});de.src=re.byteLength?URL.createObjectURL(me):Wr}(O,Z)}(w,(O,Z)=>{O!=null?t(O):Z!=null&&t(null,Z,{cacheControl:k,expires:L})})});return{cancel:()=>{f.cancel(),h()}}};function Ji(i,t,a){a[i]&&a[i].indexOf(t)!==-1||(a[i]=a[i]||[],a[i].push(t))}function Cn(i,t,a){if(a&&a[i]){const h=a[i].indexOf(t);h!==-1&&a[i].splice(h,1)}}class $i{constructor(t,a={}){ze(this,a),this.type=t}}class yn extends $i{constructor(t,a={}){super("error",ze({error:t},a))}}class En{on(t,a){return this._listeners=this._listeners||{},Ji(t,a,this._listeners),this}off(t,a){return Cn(t,a,this._listeners),Cn(t,a,this._oneTimeListeners),this}once(t,a){return this._oneTimeListeners=this._oneTimeListeners||{},Ji(t,a,this._oneTimeListeners),this}fire(t,a){typeof t=="string"&&(t=new $i(t,a||{}));const h=t.type;if(this.listens(h)){t.target=this;const f=this._listeners&&this._listeners[h]?this._listeners[h].slice():[];for(const k of f)k.call(this,t);const v=this._oneTimeListeners&&this._oneTimeListeners[h]?this._oneTimeListeners[h].slice():[];for(const k of v)Cn(h,k,this._oneTimeListeners),k.call(this,t);const w=this._eventedParent;w&&(ze(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),w.fire(t))}else t instanceof yn&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,a){return this._eventedParent=t,this._eventedParentData=a,this}}var Ut={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1},elevationOffset:{type:"number",default:450}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class ir{constructor(t,a,h,f){this.message=(t?`${t}: `:"")+h,f&&(this.identifier=f),a!=null&&a.__line__&&(this.line=a.__line__)}}function Ma(i){const t=i.value;return t?[new ir(i.key,t,"constants have been deprecated as of v8")]:[]}function lo(i,...t){for(const a of t)for(const h in a)i[h]=a[h];return i}function bi(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function bo(i){if(Array.isArray(i))return i.map(bo);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const t={};for(const a in i)t[a]=bo(i[a]);return t}return bi(i)}class ro extends Error{constructor(t,a){super(a),this.message=a,this.key=t}}class Ao{constructor(t,a=[]){this.parent=t,this.bindings={};for(const[h,f]of a)this.bindings[h]=f}concat(t){return new Ao(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Bo={kind:"null"},er={kind:"number"},Vr={kind:"string"},Nr={kind:"boolean"},_n={kind:"color"},Qn={kind:"object"},Gr={kind:"value"},mo={kind:"collator"},In={kind:"formatted"},ka={kind:"padding"},mi={kind:"resolvedImage"};function ne(i,t){return{kind:"array",itemType:i,N:t}}function fe(i){if(i.kind==="array"){const t=fe(i.itemType);return typeof i.N=="number"?`array<${t}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${t}>`}return i.kind}const xe=[Bo,er,Vr,Nr,_n,In,Qn,ne(Gr),ka,mi];function Fe(i,t){if(t.kind==="error")return null;if(i.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Fe(i.itemType,t.itemType))&&(typeof i.N!="number"||i.N===t.N))return null}else{if(i.kind===t.kind)return null;if(i.kind==="value"){for(const a of xe)if(!Fe(a,t))return null}}return`Expected ${fe(i)} but found ${fe(t)} instead.`}function Re(i,t){return t.some(a=>a.kind===i.kind)}function We(i,t){return t.some(a=>a==="null"?i===null:a==="array"?Array.isArray(i):a==="object"?i&&!Array.isArray(i)&&typeof i=="object":a===typeof i)}var st,Ee={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function X(i){return(i=Math.round(i))<0?0:i>255?255:i}function H(i){return X(i[i.length-1]==="%"?parseFloat(i)/100*255:parseInt(i))}function te(i){return(t=i[i.length-1]==="%"?parseFloat(i)/100:parseFloat(i))<0?0:t>1?1:t;var t}function pe(i,t,a){return a<0?a+=1:a>1&&(a-=1),6*a<1?i+(t-i)*a*6:2*a<1?t:3*a<2?i+(t-i)*(2/3-a)*6:i}try{st={}.parseCSSColor=function(i){var t,a=i.replace(/ /g,"").toLowerCase();if(a in Ee)return Ee[a].slice();if(a[0]==="#")return a.length===4?(t=parseInt(a.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:a.length===7&&(t=parseInt(a.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var h=a.indexOf("("),f=a.indexOf(")");if(h!==-1&&f+1===a.length){var v=a.substr(0,h),w=a.substr(h+1,f-(h+1)).split(","),k=1;switch(v){case"rgba":if(w.length!==4)return null;k=te(w.pop());case"rgb":return w.length!==3?null:[H(w[0]),H(w[1]),H(w[2]),k];case"hsla":if(w.length!==4)return null;k=te(w.pop());case"hsl":if(w.length!==3)return null;var L=(parseFloat(w[0])%360+360)%360/360,O=te(w[1]),Z=te(w[2]),re=Z<=.5?Z*(O+1):Z+O-Z*O,he=2*Z-re;return[X(255*pe(he,re,L+1/3)),X(255*pe(he,re,L)),X(255*pe(he,re,L-1/3)),k];default:return null}}return null}}catch{}class se{constructor(t,a,h,f=1){this.r=t,this.g=a,this.b=h,this.a=f}static parse(t){if(!t)return;if(t instanceof se)return t;if(typeof t!="string")return;const a=st(t);return a?new se(a[0]/255*a[3],a[1]/255*a[3],a[2]/255*a[3],a[3]):void 0}toString(){const[t,a,h,f]=this.toArray();return`rgba(${Math.round(t)},${Math.round(a)},${Math.round(h)},${f})`}toArray(){const{r:t,g:a,b:h,a:f}=this;return f===0?[0,0,0,0]:[255*t/f,255*a/f,255*h/f,f]}}se.black=new se(0,0,0,1),se.white=new se(1,1,1,1),se.transparent=new se(0,0,0,0),se.red=new se(1,0,0,1);class Se{constructor(t,a,h){this.sensitivity=t?a?"variant":"case":a?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,a){return this.collator.compare(t,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Ne{constructor(t,a,h,f,v){this.text=t,this.image=a,this.scale=h,this.fontStack=f,this.textColor=v}}class Me{constructor(t){this.sections=t}static fromString(t){return new Me([new Ne(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof Me?t:Me.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class ve{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof ve)return t;if(typeof t=="number")return new ve([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const a of t)if(typeof a!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new ve(t)}}toString(){return JSON.stringify(this.values)}}class Oe{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Oe({name:t,available:!1}):null}}function Je(i,t,a,h){return typeof i=="number"&&i>=0&&i<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof a=="number"&&a>=0&&a<=255?h===void 0||typeof h=="number"&&h>=0&&h<=1?null:`Invalid rgba value [${[i,t,a,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof h=="number"?[i,t,a,h]:[i,t,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ct(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof se||i instanceof Se||i instanceof Me||i instanceof ve||i instanceof Oe)return!0;if(Array.isArray(i)){for(const t of i)if(!ct(t))return!1;return!0}if(typeof i=="object"){for(const t in i)if(!ct(i[t]))return!1;return!0}return!1}function we(i){if(i===null)return Bo;if(typeof i=="string")return Vr;if(typeof i=="boolean")return Nr;if(typeof i=="number")return er;if(i instanceof se)return _n;if(i instanceof Se)return mo;if(i instanceof Me)return In;if(i instanceof ve)return ka;if(i instanceof Oe)return mi;if(Array.isArray(i)){const t=i.length;let a;for(const h of i){const f=we(h);if(a){if(a===f)continue;a=Gr;break}a=f}return ne(a||Gr,t)}return Qn}function Pe(i){const t=typeof i;return i===null?"":t==="string"||t==="number"||t==="boolean"?String(i):i instanceof se||i instanceof Me||i instanceof ve||i instanceof Oe?i.toString():JSON.stringify(i)}class dt{constructor(t,a){this.type=t,this.value=a}static parse(t,a){if(t.length!==2)return a.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!ct(t[1]))return a.error("invalid value");const h=t[1];let f=we(h);const v=a.expectedType;return f.kind!=="array"||f.N!==0||!v||v.kind!=="array"||typeof v.N=="number"&&v.N!==0||(f=v),new dt(f,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class xt{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const Lt={string:Vr,number:er,boolean:Nr,object:Qn};class zt{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");let h,f=1;const v=t[0];if(v==="array"){let k,L;if(t.length>2){const O=t[1];if(typeof O!="string"||!(O in Lt)||O==="object")return a.error('The item type argument of "array" must be one of string, number, boolean',1);k=Lt[O],f++}else k=Gr;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return a.error('The length argument to "array" must be a positive integer literal',2);L=t[2],f++}h=ne(k,L)}else{if(!Lt[v])throw new Error(`Types doesn't contain name = ${v}`);h=Lt[v]}const w=[];for(;f<t.length;f++){const k=a.parse(t[f],f,Gr);if(!k)return null;w.push(k)}return new zt(h,w)}evaluate(t){for(let a=0;a<this.args.length;a++){const h=this.args[a].evaluate(t);if(!Fe(this.type,we(h)))return h;if(a===this.args.length-1)throw new xt(`Expected value to be of type ${fe(this.type)}, but found ${fe(we(h))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Jt={"to-boolean":Nr,"to-color":_n,"to-number":er,"to-string":Vr};class or{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");const h=t[0];if(!Jt[h])throw new Error(`Can't parse ${h} as it is not part of the known types`);if((h==="to-boolean"||h==="to-string")&&t.length!==2)return a.error("Expected one argument.");const f=Jt[h],v=[];for(let w=1;w<t.length;w++){const k=a.parse(t[w],w,Gr);if(!k)return null;v.push(k)}return new or(f,v)}evaluate(t){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(t));if(this.type.kind==="color"){let a,h;for(const f of this.args){if(a=f.evaluate(t),h=null,a instanceof se)return a;if(typeof a=="string"){const v=t.parseColor(a);if(v)return v}else if(Array.isArray(a)&&(h=a.length<3||a.length>4?`Invalid rbga value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:Je(a[0],a[1],a[2],a[3]),!h))return new se(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new xt(h||`Could not parse color from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}if(this.type.kind==="padding"){let a;for(const h of this.args){a=h.evaluate(t);const f=ve.parse(a);if(f)return f}throw new xt(`Could not parse padding from value '${typeof a=="string"?a:JSON.stringify(a)}'`)}if(this.type.kind==="number"){let a=null;for(const h of this.args){if(a=h.evaluate(t),a===null)return 0;const f=Number(a);if(!isNaN(f))return f}throw new xt(`Could not convert ${JSON.stringify(a)} to number.`)}return this.type.kind==="formatted"?Me.fromString(Pe(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?Oe.fromString(Pe(this.args[0].evaluate(t))):Pe(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Ar=["Unknown","Point","LineString","Polygon"];class Br{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ar[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let a=this._parseColorCache[t];return a||(a=this._parseColorCache[t]=se.parse(t)),a}}class vr{constructor(t,a,h,f){this.name=t,this.type=a,this._evaluate=h,this.args=f}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,a){const h=t[0],f=vr.definitions[h];if(!f)return a.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const v=Array.isArray(f)?f[0]:f.type,w=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,k=w.filter(([O])=>!Array.isArray(O)||O.length===t.length-1);let L=null;for(const[O,Z]of k){L=new Sn(a.registry,a.path,null,a.scope);const re=[];let he=!1;for(let de=1;de<t.length;de++){const me=t[de],Ue=Array.isArray(O)?O[de-1]:O.type,Qe=L.parse(me,1+re.length,Ue);if(!Qe){he=!0;break}re.push(Qe)}if(!he)if(Array.isArray(O)&&O.length!==re.length)L.error(`Expected ${O.length} arguments, but found ${re.length} instead.`);else{for(let de=0;de<re.length;de++){const me=Array.isArray(O)?O[de]:O.type,Ue=re[de];L.concat(de+1).checkSubtype(me,Ue.type)}if(L.errors.length===0)return new vr(h,v,Z,re)}}if(k.length===1)a.errors.push(...L.errors);else{const O=(k.length?k:w).map(([re])=>{return he=re,Array.isArray(he)?`(${he.map(fe).join(", ")})`:`(${fe(he.type)}...)`;var he}).join(" | "),Z=[];for(let re=1;re<t.length;re++){const he=a.parse(t[re],1+Z.length);if(!he)return null;Z.push(fe(he.type))}a.error(`Expected arguments of type ${O}, but found (${Z.join(", ")}) instead.`)}return null}static register(t,a){vr.definitions=a;for(const h in a)t[h]=vr}}class Sr{constructor(t,a,h){this.type=mo,this.locale=h,this.caseSensitive=t,this.diacriticSensitive=a}static parse(t,a){if(t.length!==2)return a.error("Expected one argument.");const h=t[1];if(typeof h!="object"||Array.isArray(h))return a.error("Collator options argument must be an object.");const f=a.parse(h["case-sensitive"]!==void 0&&h["case-sensitive"],1,Nr);if(!f)return null;const v=a.parse(h["diacritic-sensitive"]!==void 0&&h["diacritic-sensitive"],1,Nr);if(!v)return null;let w=null;return h.locale&&(w=a.parse(h.locale,1,Vr),!w)?null:new Sr(f,v,w)}evaluate(t){return new Se(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}const Tr=8192;function li(i,t){i[0]=Math.min(i[0],t[0]),i[1]=Math.min(i[1],t[1]),i[2]=Math.max(i[2],t[0]),i[3]=Math.max(i[3],t[1])}function Co(i,t){return!(i[0]<=t[0]||i[2]>=t[2]||i[1]<=t[1]||i[3]>=t[3])}function Bi(i,t){const a=(180+i[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,f=Math.pow(2,t.z);return[Math.round(a*f*Tr),Math.round(h*f*Tr)]}function hi(i,t,a){const h=i[0]-t[0],f=i[1]-t[1],v=i[0]-a[0],w=i[1]-a[1];return h*w-v*f==0&&h*v<=0&&f*w<=0}function Na(i,t){let a=!1;for(let w=0,k=t.length;w<k;w++){const L=t[w];for(let O=0,Z=L.length;O<Z-1;O++){if(hi(i,L[O],L[O+1]))return!1;(f=L[O])[1]>(h=i)[1]!=(v=L[O+1])[1]>h[1]&&h[0]<(v[0]-f[0])*(h[1]-f[1])/(v[1]-f[1])+f[0]&&(a=!a)}}var h,f,v;return a}function Pa(i,t){for(let a=0;a<t.length;a++)if(Na(i,t[a]))return!0;return!1}function zn(i,t,a,h){const f=h[0]-a[0],v=h[1]-a[1],w=(i[0]-a[0])*v-f*(i[1]-a[1]),k=(t[0]-a[0])*v-f*(t[1]-a[1]);return w>0&&k<0||w<0&&k>0}function js(i,t,a){for(const O of a)for(let Z=0;Z<O.length-1;++Z)if((k=[(w=O[Z+1])[0]-(v=O[Z])[0],w[1]-v[1]])[0]*(L=[(f=t)[0]-(h=i)[0],f[1]-h[1]])[1]-k[1]*L[0]!=0&&zn(h,f,v,w)&&zn(v,w,h,f))return!0;var h,f,v,w,k,L;return!1}function Eo(i,t){for(let a=0;a<i.length;++a)if(!Na(i[a],t))return!1;for(let a=0;a<i.length-1;++a)if(js(i[a],i[a+1],t))return!1;return!0}function fi(i,t){for(let a=0;a<t.length;a++)if(Eo(i,t[a]))return!0;return!1}function vi(i,t,a){const h=[];for(let f=0;f<i.length;f++){const v=[];for(let w=0;w<i[f].length;w++){const k=Bi(i[f][w],a);li(t,k),v.push(k)}h.push(v)}return h}function Ni(i,t,a){const h=[];for(let f=0;f<i.length;f++){const v=vi(i[f],t,a);h.push(v)}return h}function go(i,t,a,h){if(i[0]<a[0]||i[0]>a[2]){const f=.5*h;let v=i[0]-a[0]>f?-h:a[0]-i[0]>f?h:0;v===0&&(v=i[0]-a[2]>f?-h:a[2]-i[0]>f?h:0),i[0]+=v}li(t,i)}function Uo(i,t,a,h){const f=Math.pow(2,h.z)*Tr,v=[h.x*Tr,h.y*Tr],w=[];for(const k of i)for(const L of k){const O=[L.x+v[0],L.y+v[1]];go(O,t,a,f),w.push(O)}return w}function ea(i,t,a,h){const f=Math.pow(2,h.z)*Tr,v=[h.x*Tr,h.y*Tr],w=[];for(const L of i){const O=[];for(const Z of L){const re=[Z.x+v[0],Z.y+v[1]];li(t,re),O.push(re)}w.push(O)}if(t[2]-t[0]<=f/2){(k=t)[0]=k[1]=1/0,k[2]=k[3]=-1/0;for(const L of w)for(const O of L)go(O,t,a,f)}var k;return w}class Dn{constructor(t,a){this.type=Nr,this.geojson=t,this.geometries=a}static parse(t,a){if(t.length!==2)return a.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(ct(t[1])){const h=t[1];if(h.type==="FeatureCollection")for(let f=0;f<h.features.length;++f){const v=h.features[f].geometry.type;if(v==="Polygon"||v==="MultiPolygon")return new Dn(h,h.features[f].geometry)}else if(h.type==="Feature"){const f=h.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new Dn(h,h.geometry)}else if(h.type==="Polygon"||h.type==="MultiPolygon")return new Dn(h,h)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(a,h){const f=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],w=a.canonicalID();if(h.type==="Polygon"){const k=vi(h.coordinates,v,w),L=Uo(a.geometry(),f,v,w);if(!Co(f,v))return!1;for(const O of L)if(!Na(O,k))return!1}if(h.type==="MultiPolygon"){const k=Ni(h.coordinates,v,w),L=Uo(a.geometry(),f,v,w);if(!Co(f,v))return!1;for(const O of L)if(!Pa(O,k))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(a,h){const f=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],w=a.canonicalID();if(h.type==="Polygon"){const k=vi(h.coordinates,v,w),L=ea(a.geometry(),f,v,w);if(!Co(f,v))return!1;for(const O of L)if(!Eo(O,k))return!1}if(h.type==="MultiPolygon"){const k=Ni(h.coordinates,v,w),L=ea(a.geometry(),f,v,w);if(!Co(f,v))return!1;for(const O of L)if(!fi(O,k))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}function Aa(i){if(i instanceof vr&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof Dn)return!1;let t=!0;return i.eachChild(a=>{t&&!Aa(a)&&(t=!1)}),t}function co(i){if(i instanceof vr&&i.name==="feature-state")return!1;let t=!0;return i.eachChild(a=>{t&&!co(a)&&(t=!1)}),t}function hn(i,t){if(i instanceof vr&&t.indexOf(i.name)>=0)return!1;let a=!0;return i.eachChild(h=>{a&&!hn(h,t)&&(a=!1)}),a}class Io{constructor(t,a){this.type=a.type,this.name=t,this.boundExpression=a}static parse(t,a){if(t.length!==2||typeof t[1]!="string")return a.error("'var' expression requires exactly one string literal argument.");const h=t[1];return a.scope.has(h)?new Io(h,a.scope.get(h)):a.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class Sn{constructor(t,a=[],h,f=new Ao,v=[]){this.registry=t,this.path=a,this.key=a.map(w=>`[${w}]`).join(""),this.scope=f,this.errors=v,this.expectedType=h}parse(t,a,h,f,v={}){return a?this.concat(a,h,f)._parse(t,v):this._parse(t,v)}_parse(t,a){function h(f,v,w){return w==="assert"?new zt(v,[f]):w==="coerce"?new or(v,[f]):f}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=t[0];if(typeof f!="string")return this.error(`Expression name must be a string, but found ${typeof f} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const v=this.registry[f];if(v){let w=v.parse(t,this);if(!w)return null;if(this.expectedType){const k=this.expectedType,L=w.type;if(k.kind!=="string"&&k.kind!=="number"&&k.kind!=="boolean"&&k.kind!=="object"&&k.kind!=="array"||L.kind!=="value")if(k.kind!=="color"&&k.kind!=="formatted"&&k.kind!=="resolvedImage"||L.kind!=="value"&&L.kind!=="string")if(k.kind!=="padding"||L.kind!=="value"&&L.kind!=="number"&&L.kind!=="array"){if(this.checkSubtype(k,L))return null}else w=h(w,k,a.typeAnnotation||"coerce");else w=h(w,k,a.typeAnnotation||"coerce");else w=h(w,k,a.typeAnnotation||"assert")}if(!(w instanceof dt)&&w.type.kind!=="resolvedImage"&&Ka(w)){const k=new Br;try{w=new dt(w.type,w.evaluate(k))}catch(L){return this.error(L.message),null}}return w}return this.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,a,h){const f=typeof t=="number"?this.path.concat(t):this.path,v=h?this.scope.concat(h):this.scope;return new Sn(this.registry,f,a||null,v,this.errors)}error(t,...a){const h=`${this.key}${a.map(f=>`[${f}]`).join("")}`;this.errors.push(new ro(h,t))}checkSubtype(t,a){const h=Fe(t,a);return h&&this.error(h),h}}function Ka(i){if(i instanceof Io)return Ka(i.boundExpression);if(i instanceof vr&&i.name==="error"||i instanceof Sr||i instanceof Dn)return!1;const t=i instanceof or||i instanceof zt;let a=!0;return i.eachChild(h=>{a=t?a&&Ka(h):a&&h instanceof dt}),!!a&&Aa(i)&&hn(i,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Qa(i,t){const a=i.length-1;let h,f,v=0,w=a,k=0;for(;v<=w;)if(k=Math.floor((v+w)/2),h=i[k],f=i[k+1],h<=t){if(k===a||t<f)return k;v=k+1}else{if(!(h>t))throw new xt("Input is not a number.");w=k-1}return 0}class Fs{constructor(t,a,h){this.type=t,this.input=a,this.labels=[],this.outputs=[];for(const[f,v]of h)this.labels.push(f),this.outputs.push(v)}static parse(t,a){if(t.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return a.error("Expected an even number of arguments.");const h=a.parse(t[1],1,er);if(!h)return null;const f=[];let v=null;a.expectedType&&a.expectedType.kind!=="value"&&(v=a.expectedType);for(let w=1;w<t.length;w+=2){const k=w===1?-1/0:t[w],L=t[w+1],O=w,Z=w+1;if(typeof k!="number")return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(f.length&&f[f.length-1][0]>=k)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',O);const re=a.parse(L,Z,v);if(!re)return null;v=v||re.type,f.push([k,re])}return new Fs(v,h,f)}evaluate(t){const a=this.labels,h=this.outputs;if(a.length===1)return h[0].evaluate(t);const f=this.input.evaluate(t);if(f<=a[0])return h[0].evaluate(t);const v=a.length;return f>=a[v-1]?h[v-1].evaluate(t):h[Qa(a,f)].evaluate(t)}eachChild(t){t(this.input);for(const a of this.outputs)t(a)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function pn(i,t,a){return i*(1-a)+t*a}var hs=Object.freeze({__proto__:null,number:pn,color:function(i,t,a){return new se(pn(i.r,t.r,a),pn(i.g,t.g,a),pn(i.b,t.b,a),pn(i.a,t.a,a))},array:function(i,t,a){return i.map((h,f)=>pn(h,t[f],a))},padding:function(i,t,a){const h=i.values,f=t.values;return new ve([pn(h[0],f[0],a),pn(h[1],f[1],a),pn(h[2],f[2],a),pn(h[3],f[3],a)])}});const kl=.95047,fl=1.08883,Us=4/29,ya=6/29,$s=3*ya*ya,vA=Math.PI/180,Pl=180/Math.PI;function xA(i){return i>.008856451679035631?Math.pow(i,1/3):i/$s+Us}function Ql(i){return i>ya?i*i*i:$s*(i-Us)}function _a(i){return 255*(i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055)}function Ya(i){return(i/=255)<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function Ti(i){const t=Ya(i.r),a=Ya(i.g),h=Ya(i.b),f=xA((.4124564*t+.3575761*a+.1804375*h)/kl),v=xA((.2126729*t+.7151522*a+.072175*h)/1);return{l:116*v-16,a:500*(f-v),b:200*(v-xA((.0193339*t+.119192*a+.9503041*h)/fl)),alpha:i.a}}function Ms(i){let t=(i.l+16)/116,a=isNaN(i.a)?t:t+i.a/500,h=isNaN(i.b)?t:t-i.b/200;return t=1*Ql(t),a=kl*Ql(a),h=fl*Ql(h),new se(_a(3.2404542*a-1.5371385*t-.4985314*h),_a(-.969266*a+1.8760108*t+.041556*h),_a(.0556434*a-.2040259*t+1.0572252*h),i.alpha)}function qs(i,t,a){const h=t-i;return i+a*(h>180||h<-180?h-360*Math.round(h/360):h)}const Ga={forward:Ti,reverse:Ms,interpolate:function(i,t,a){return{l:pn(i.l,t.l,a),a:pn(i.a,t.a,a),b:pn(i.b,t.b,a),alpha:pn(i.alpha,t.alpha,a)}}},uo={forward:function(i){const{l:t,a,b:h}=Ti(i),f=Math.atan2(h,a)*Pl;return{h:f<0?f+360:f,c:Math.sqrt(a*a+h*h),l:t,alpha:i.a}},reverse:function(i){const t=i.h*vA,a=i.c;return Ms({l:i.l,a:Math.cos(t)*a,b:Math.sin(t)*a,alpha:i.alpha})},interpolate:function(i,t,a){return{h:qs(i.h,t.h,a),c:pn(i.c,t.c,a),l:pn(i.l,t.l,a),alpha:pn(i.alpha,t.alpha,a)}}};var ca=Object.freeze({__proto__:null,lab:Ga,hcl:uo});class Li{constructor(t,a,h,f,v){this.type=t,this.operator=a,this.interpolation=h,this.input=f,this.labels=[],this.outputs=[];for(const[w,k]of v)this.labels.push(w),this.outputs.push(k)}static interpolationFactor(t,a,h,f){let v=0;if(t.name==="exponential")v=Zs(a,t.base,h,f);else if(t.name==="linear")v=Zs(a,1,h,f);else if(t.name==="cubic-bezier"){const w=t.controlPoints;v=new q(w[0],w[1],w[2],w[3]).solve(Zs(a,1,h,f))}return v}static parse(t,a){let[h,f,v,...w]=t;if(!Array.isArray(f)||f.length===0)return a.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){const O=f[1];if(typeof O!="number")return a.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:O}}else{if(f[0]!=="cubic-bezier")return a.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const O=f.slice(1);if(O.length!==4||O.some(Z=>typeof Z!="number"||Z<0||Z>1))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:O}}}if(t.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(v=a.parse(v,2,er),!v)return null;const k=[];let L=null;h==="interpolate-hcl"||h==="interpolate-lab"?L=_n:a.expectedType&&a.expectedType.kind!=="value"&&(L=a.expectedType);for(let O=0;O<w.length;O+=2){const Z=w[O],re=w[O+1],he=O+3,de=O+4;if(typeof Z!="number")return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',he);if(k.length&&k[k.length-1][0]>=Z)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',he);const me=a.parse(re,de,L);if(!me)return null;L=L||me.type,k.push([Z,me])}return L.kind==="number"||L.kind==="color"||L.kind==="padding"||L.kind==="array"&&L.itemType.kind==="number"&&typeof L.N=="number"?new Li(L,h,f,v,k):a.error(`Type ${fe(L)} is not interpolatable.`)}evaluate(t){const a=this.labels,h=this.outputs;if(a.length===1)return h[0].evaluate(t);const f=this.input.evaluate(t);if(f<=a[0])return h[0].evaluate(t);const v=a.length;if(f>=a[v-1])return h[v-1].evaluate(t);const w=Qa(a,f),k=Li.interpolationFactor(this.interpolation,f,a[w],a[w+1]),L=h[w].evaluate(t),O=h[w+1].evaluate(t);return this.operator==="interpolate"?hs[this.type.kind.toLowerCase()](L,O,k):this.operator==="interpolate-hcl"?uo.reverse(uo.interpolate(uo.forward(L),uo.forward(O),k)):Ga.reverse(Ga.interpolate(Ga.forward(L),Ga.forward(O),k))}eachChild(t){t(this.input);for(const a of this.outputs)t(a)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Zs(i,t,a,h){const f=h-a,v=i-a;return f===0?0:t===1?v/f:(Math.pow(t,v)-1)/(Math.pow(t,f)-1)}class Yl{constructor(t,a){this.type=t,this.args=a}static parse(t,a){if(t.length<2)return a.error("Expectected at least one argument.");let h=null;const f=a.expectedType;f&&f.kind!=="value"&&(h=f);const v=[];for(const k of t.slice(1)){const L=a.parse(k,1+v.length,h,void 0,{typeAnnotation:"omit"});if(!L)return null;h=h||L.type,v.push(L)}if(!h)throw new Error("No output type");const w=f&&v.some(k=>Fe(f,k.type));return new Yl(w?Gr:h,v)}evaluate(t){let a,h=null,f=0;for(const v of this.args)if(f++,h=v.evaluate(t),h&&h instanceof Oe&&!h.available&&(a||(a=h.name),h=null,f===this.args.length&&(h=a)),h!==null)break;return h}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}class wA{constructor(t,a){this.type=a.type,this.bindings=[].concat(t),this.result=a}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const a of this.bindings)t(a[1]);t(this.result)}static parse(t,a){if(t.length<4)return a.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const h=[];for(let v=1;v<t.length-1;v+=2){const w=t[v];if(typeof w!="string")return a.error(`Expected string, but found ${typeof w} instead.`,v);if(/[^a-zA-Z0-9_]/.test(w))return a.error("Variable names must contain only alphanumeric characters or '_'.",v);const k=a.parse(t[v+1],v+1);if(!k)return null;h.push([w,k])}const f=a.parse(t[t.length-1],t.length-1,a.expectedType,h);return f?new wA(h,f):null}outputDefined(){return this.result.outputDefined()}}class NA{constructor(t,a,h){this.type=t,this.index=a,this.input=h}static parse(t,a){if(t.length!==3)return a.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const h=a.parse(t[1],1,er),f=a.parse(t[2],2,ne(a.expectedType||Gr));return h&&f?new NA(f.type.itemType,h,f):null}evaluate(t){const a=this.index.evaluate(t),h=this.input.evaluate(t);if(a<0)throw new xt(`Array index out of bounds: ${a} < 0.`);if(a>=h.length)throw new xt(`Array index out of bounds: ${a} > ${h.length-1}.`);if(a!==Math.floor(a))throw new xt(`Array index must be an integer, but found ${a} instead.`);return h[a]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Xs{constructor(t,a){this.type=Nr,this.needle=t,this.haystack=a}static parse(t,a){if(t.length!==3)return a.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const h=a.parse(t[1],1,Gr),f=a.parse(t[2],2,Gr);return h&&f?Re(h.type,[Nr,Vr,er,Bo,Gr])?new Xs(h,f):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${fe(h.type)} instead`):null}evaluate(t){const a=this.needle.evaluate(t),h=this.haystack.evaluate(t);if(!h)return!1;if(!We(a,["boolean","string","number","null"]))throw new xt(`Expected first argument to be of type boolean, string, number or null, but found ${fe(we(a))} instead.`);if(!We(h,["string","array"]))throw new xt(`Expected second argument to be of type array or string, but found ${fe(we(h))} instead.`);return h.indexOf(a)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class ks{constructor(t,a,h){this.type=er,this.needle=t,this.haystack=a,this.fromIndex=h}static parse(t,a){if(t.length<=2||t.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const h=a.parse(t[1],1,Gr),f=a.parse(t[2],2,Gr);if(!h||!f)return null;if(!Re(h.type,[Nr,Vr,er,Bo,Gr]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${fe(h.type)} instead`);if(t.length===4){const v=a.parse(t[3],3,er);return v?new ks(h,f,v):null}return new ks(h,f)}evaluate(t){const a=this.needle.evaluate(t),h=this.haystack.evaluate(t);if(!We(a,["boolean","string","number","null"]))throw new xt(`Expected first argument to be of type boolean, string, number or null, but found ${fe(we(a))} instead.`);if(!We(h,["string","array"]))throw new xt(`Expected second argument to be of type array or string, but found ${fe(we(h))} instead.`);if(this.fromIndex){const f=this.fromIndex.evaluate(t);return h.indexOf(a,f)}return h.indexOf(a)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class Dl{constructor(t,a,h,f,v,w){this.inputType=t,this.type=a,this.input=h,this.cases=f,this.outputs=v,this.otherwise=w}static parse(t,a){if(t.length<5)return a.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return a.error("Expected an even number of arguments.");let h,f;a.expectedType&&a.expectedType.kind!=="value"&&(f=a.expectedType);const v={},w=[];for(let O=2;O<t.length-1;O+=2){let Z=t[O];const re=t[O+1];Array.isArray(Z)||(Z=[Z]);const he=a.concat(O);if(Z.length===0)return he.error("Expected at least one branch label.");for(const me of Z){if(typeof me!="number"&&typeof me!="string")return he.error("Branch labels must be numbers or strings.");if(typeof me=="number"&&Math.abs(me)>Number.MAX_SAFE_INTEGER)return he.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof me=="number"&&Math.floor(me)!==me)return he.error("Numeric branch labels must be integer values.");if(h){if(he.checkSubtype(h,we(me)))return null}else h=we(me);if(v[String(me)]!==void 0)return he.error("Branch labels must be unique.");v[String(me)]=w.length}const de=a.parse(re,O,f);if(!de)return null;f=f||de.type,w.push(de)}const k=a.parse(t[1],1,Gr);if(!k)return null;const L=a.parse(t[t.length-1],t.length-1,f);return L?k.type.kind!=="value"&&a.concat(1).checkSubtype(h,k.type)?null:new Dl(h,f,k,v,w,L):null}evaluate(t){const a=this.input.evaluate(t);return(we(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class eA{constructor(t,a,h){this.type=t,this.branches=a,this.otherwise=h}static parse(t,a){if(t.length<4)return a.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return a.error("Expected an odd number of arguments.");let h;a.expectedType&&a.expectedType.kind!=="value"&&(h=a.expectedType);const f=[];for(let w=1;w<t.length-1;w+=2){const k=a.parse(t[w],w,Nr);if(!k)return null;const L=a.parse(t[w+1],w+1,h);if(!L)return null;f.push([k,L]),h=h||L.type}const v=a.parse(t[t.length-1],t.length-1,h);if(!v)return null;if(!h)throw new Error("Can't infer output type");return new eA(h,f,v)}evaluate(t){for(const[a,h]of this.branches)if(a.evaluate(t))return h.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[a,h]of this.branches)t(a),t(h);t(this.otherwise)}outputDefined(){return this.branches.every(([t,a])=>a.outputDefined())&&this.otherwise.outputDefined()}}class ja{constructor(t,a,h,f){this.type=t,this.input=a,this.beginIndex=h,this.endIndex=f}static parse(t,a){if(t.length<=2||t.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const h=a.parse(t[1],1,Gr),f=a.parse(t[2],2,er);if(!h||!f)return null;if(!Re(h.type,[ne(Gr),Vr,Gr]))return a.error(`Expected first argument to be of type array or string, but found ${fe(h.type)} instead`);if(t.length===4){const v=a.parse(t[3],3,er);return v?new ja(h.type,h,f,v):null}return new ja(h.type,h,f)}evaluate(t){const a=this.input.evaluate(t),h=this.beginIndex.evaluate(t);if(!We(a,["string","array"]))throw new xt(`Expected first argument to be of type array or string, but found ${fe(we(a))} instead.`);if(this.endIndex){const f=this.endIndex.evaluate(t);return a.slice(h,f)}return a.slice(h)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function Ll(i,t){return i==="=="||i==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function bA(i,t,a,h){return h.compare(t,a)===0}function ps(i,t,a){const h=i!=="=="&&i!=="!=";return class oy{constructor(v,w,k){this.type=Nr,this.lhs=v,this.rhs=w,this.collator=k,this.hasUntypedArgument=v.type.kind==="value"||w.type.kind==="value"}static parse(v,w){if(v.length!==3&&v.length!==4)return w.error("Expected two or three arguments.");const k=v[0];let L=w.parse(v[1],1,Gr);if(!L)return null;if(!Ll(k,L.type))return w.concat(1).error(`"${k}" comparisons are not supported for type '${fe(L.type)}'.`);let O=w.parse(v[2],2,Gr);if(!O)return null;if(!Ll(k,O.type))return w.concat(2).error(`"${k}" comparisons are not supported for type '${fe(O.type)}'.`);if(L.type.kind!==O.type.kind&&L.type.kind!=="value"&&O.type.kind!=="value")return w.error(`Cannot compare types '${fe(L.type)}' and '${fe(O.type)}'.`);h&&(L.type.kind==="value"&&O.type.kind!=="value"?L=new zt(O.type,[L]):L.type.kind!=="value"&&O.type.kind==="value"&&(O=new zt(L.type,[O])));let Z=null;if(v.length===4){if(L.type.kind!=="string"&&O.type.kind!=="string"&&L.type.kind!=="value"&&O.type.kind!=="value")return w.error("Cannot use collator to compare non-string types.");if(Z=w.parse(v[3],3,mo),!Z)return null}return new oy(L,O,Z)}evaluate(v){const w=this.lhs.evaluate(v),k=this.rhs.evaluate(v);if(h&&this.hasUntypedArgument){const L=we(w),O=we(k);if(L.kind!==O.kind||L.kind!=="string"&&L.kind!=="number")throw new xt(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${L.kind}, ${O.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const L=we(w),O=we(k);if(L.kind!=="string"||O.kind!=="string")return t(v,w,k)}return this.collator?a(v,w,k,this.collator.evaluate(v)):t(v,w,k)}eachChild(v){v(this.lhs),v(this.rhs),this.collator&&v(this.collator)}outputDefined(){return!0}}}const tA=ps("==",function(i,t,a){return t===a},bA),mc=ps("!=",function(i,t,a){return t!==a},function(i,t,a,h){return!bA(0,t,a,h)}),Ro=ps("<",function(i,t,a){return t<a},function(i,t,a,h){return h.compare(t,a)<0}),KA=ps(">",function(i,t,a){return t>a},function(i,t,a,h){return h.compare(t,a)>0}),Ws=ps("<=",function(i,t,a){return t<=a},function(i,t,a,h){return h.compare(t,a)<=0}),Js=ps(">=",function(i,t,a){return t>=a},function(i,t,a,h){return h.compare(t,a)>=0});class Ps{constructor(t,a,h,f,v){this.type=Vr,this.number=t,this.locale=a,this.currency=h,this.minFractionDigits=f,this.maxFractionDigits=v}static parse(t,a){if(t.length!==3)return a.error("Expected two arguments.");const h=a.parse(t[1],1,er);if(!h)return null;const f=t[2];if(typeof f!="object"||Array.isArray(f))return a.error("NumberFormat options argument must be an object.");let v=null;if(f.locale&&(v=a.parse(f.locale,1,Vr),!v))return null;let w=null;if(f.currency&&(w=a.parse(f.currency,1,Vr),!w))return null;let k=null;if(f["min-fraction-digits"]&&(k=a.parse(f["min-fraction-digits"],1,er),!k))return null;let L=null;return f["max-fraction-digits"]&&(L=a.parse(f["max-fraction-digits"],1,er),!L)?null:new Ps(h,v,w,k,L)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class ds{constructor(t){this.type=In,this.sections=t}static parse(t,a){if(t.length<2)return a.error("Expected at least one argument.");const h=t[1];if(!Array.isArray(h)&&typeof h=="object")return a.error("First argument must be an image or text section.");const f=[];let v=!1;for(let w=1;w<=t.length-1;++w){const k=t[w];if(v&&typeof k=="object"&&!Array.isArray(k)){v=!1;let L=null;if(k["font-scale"]&&(L=a.parse(k["font-scale"],1,er),!L))return null;let O=null;if(k["text-font"]&&(O=a.parse(k["text-font"],1,ne(Vr)),!O))return null;let Z=null;if(k["text-color"]&&(Z=a.parse(k["text-color"],1,_n),!Z))return null;const re=f[f.length-1];re.scale=L,re.font=O,re.textColor=Z}else{const L=a.parse(t[w],1,Gr);if(!L)return null;const O=L.type.kind;if(O!=="string"&&O!=="value"&&O!=="null"&&O!=="resolvedImage")return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");v=!0,f.push({content:L,scale:null,font:null,textColor:null})}}return new ds(f)}evaluate(t){return new Me(this.sections.map(a=>{const h=a.content.evaluate(t);return we(h)===mi?new Ne("",h,null,null,null):new Ne(Pe(h),null,a.scale?a.scale.evaluate(t):null,a.font?a.font.evaluate(t).join(","):null,a.textColor?a.textColor.evaluate(t):null)}))}eachChild(t){for(const a of this.sections)t(a.content),a.scale&&t(a.scale),a.font&&t(a.font),a.textColor&&t(a.textColor)}outputDefined(){return!1}}class fs{constructor(t){this.type=mi,this.input=t}static parse(t,a){if(t.length!==2)return a.error("Expected two arguments.");const h=a.parse(t[1],1,Vr);return h?new fs(h):a.error("No image name provided.")}evaluate(t){const a=this.input.evaluate(t),h=Oe.fromString(a);return h&&t.availableImages&&(h.available=t.availableImages.indexOf(a)>-1),h}eachChild(t){t(this.input)}outputDefined(){return!1}}class Qs{constructor(t){this.type=er,this.input=t}static parse(t,a){if(t.length!==2)return a.error(`Expected 1 argument, but found ${t.length-1} instead.`);const h=a.parse(t[1],1);return h?h.type.kind!=="array"&&h.type.kind!=="string"&&h.type.kind!=="value"?a.error(`Expected argument of type string or array, but found ${fe(h.type)} instead.`):new Qs(h):null}evaluate(t){const a=this.input.evaluate(t);if(typeof a=="string"||Array.isArray(a))return a.length;throw new xt(`Expected value to be of type string or array, but found ${fe(we(a))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const $a={"==":tA,"!=":mc,">":KA,"<":Ro,">=":Js,"<=":Ws,array:zt,at:NA,boolean:zt,case:eA,coalesce:Yl,collator:Sr,format:ds,image:fs,in:Xs,"index-of":ks,interpolate:Li,"interpolate-hcl":Li,"interpolate-lab":Li,length:Qs,let:wA,literal:dt,match:Dl,number:zt,"number-format":Ps,object:zt,slice:ja,step:Fs,string:zt,"to-boolean":or,"to-color":or,"to-number":or,"to-string":or,var:Io,within:Dn};function qa(i,[t,a,h,f]){t=t.evaluate(i),a=a.evaluate(i),h=h.evaluate(i);const v=f?f.evaluate(i):1,w=Je(t,a,h,v);if(w)throw new xt(w);return new se(t/255*v,a/255*v,h/255*v,v)}function GA(i,t){return i in t}function rA(i,t){const a=t[i];return a===void 0?null:a}function Ki(i){return{type:i}}function gc(i){return{result:"success",value:i}}function Ds(i){return{result:"error",value:i}}function Rn(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function jA(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function Pi(i){return!!i.expression&&i.expression.interpolated}function Gi(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function Yi(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function sn(i){return i}function ua(i,t){const a=t.type==="color",h=i.stops&&typeof i.stops[0][0]=="object",f=h||!(h||i.property!==void 0),v=i.type||(Pi(t)?"exponential":"interval");if(a||t.type==="padding"){const O=a?se.parse:ve.parse;(i=lo({},i)).stops&&(i.stops=i.stops.map(Z=>[Z[0],O(Z[1])])),i.default=O(i.default?i.default:t.default)}if(i.colorSpace&&i.colorSpace!=="rgb"&&!ca[i.colorSpace])throw new Error(`Unknown color space: ${i.colorSpace}`);let w,k,L;if(v==="exponential")w=ms;else if(v==="interval")w=$A;else if(v==="categorical"){w=Tn,k=Object.create(null);for(const O of i.stops)k[O[0]]=O[1];L=typeof i.stops[0][0]}else{if(v!=="identity")throw new Error(`Unknown function type "${v}"`);w=qA}if(h){const O={},Z=[];for(let de=0;de<i.stops.length;de++){const me=i.stops[de],Ue=me[0].zoom;O[Ue]===void 0&&(O[Ue]={zoom:Ue,type:i.type,property:i.property,default:i.default,stops:[]},Z.push(Ue)),O[Ue].stops.push([me[0].value,me[1]])}const re=[];for(const de of Z)re.push([O[de].zoom,ua(O[de],t)]);const he={name:"linear"};return{kind:"composite",interpolationType:he,interpolationFactor:Li.interpolationFactor.bind(void 0,he),zoomStops:re.map(de=>de[0]),evaluate:({zoom:de},me)=>ms({stops:re,base:i.base},t,de).evaluate(de,me)}}if(f){const O=v==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:O,interpolationFactor:Li.interpolationFactor.bind(void 0,O),zoomStops:i.stops.map(Z=>Z[0]),evaluate:({zoom:Z})=>w(i,t,Z,k,L)}}return{kind:"source",evaluate(O,Z){const re=Z&&Z.properties?Z.properties[i.property]:void 0;return re===void 0?Za(i.default,t.default):w(i,t,re,k,L)}}}function Za(i,t,a){return i!==void 0?i:t!==void 0?t:a!==void 0?a:void 0}function Tn(i,t,a,h,f){return Za(typeof a===f?h[a]:void 0,i.default,t.default)}function $A(i,t,a){if(Gi(a)!=="number")return Za(i.default,t.default);const h=i.stops.length;if(h===1||a<=i.stops[0][0])return i.stops[0][1];if(a>=i.stops[h-1][0])return i.stops[h-1][1];const f=Qa(i.stops.map(v=>v[0]),a);return i.stops[f][1]}function ms(i,t,a){const h=i.base!==void 0?i.base:1;if(Gi(a)!=="number")return Za(i.default,t.default);const f=i.stops.length;if(f===1||a<=i.stops[0][0])return i.stops[0][1];if(a>=i.stops[f-1][0])return i.stops[f-1][1];const v=Qa(i.stops.map(Z=>Z[0]),a),w=function(Z,re,he,de){const me=de-he,Ue=Z-he;return me===0?0:re===1?Ue/me:(Math.pow(re,Ue)-1)/(Math.pow(re,me)-1)}(a,h,i.stops[v][0],i.stops[v+1][0]),k=i.stops[v][1],L=i.stops[v+1][1];let O=hs[t.type]||sn;if(i.colorSpace&&i.colorSpace!=="rgb"){const Z=ca[i.colorSpace];O=(re,he)=>Z.reverse(Z.interpolate(Z.forward(re),Z.forward(he),w))}return typeof k.evaluate=="function"?{evaluate(...Z){const re=k.evaluate.apply(void 0,Z),he=L.evaluate.apply(void 0,Z);if(re!==void 0&&he!==void 0)return O(re,he,w)}}:O(k,L,w)}function qA(i,t,a){switch(t.type){case"color":a=se.parse(a);break;case"formatted":a=Me.fromString(a.toString());break;case"resolvedImage":a=Oe.fromString(a.toString());break;case"padding":a=ve.parse(a);break;default:Gi(a)===t.type||t.type==="enum"&&t.values[a]||(a=void 0)}return Za(a,i.default,t.default)}vr.register($a,{error:[{kind:"error"},[Vr],(i,[t])=>{throw new xt(t.evaluate(i))}],typeof:[Vr,[Gr],(i,[t])=>fe(we(t.evaluate(i)))],"to-rgba":[ne(er,4),[_n],(i,[t])=>t.evaluate(i).toArray()],rgb:[_n,[er,er,er],qa],rgba:[_n,[er,er,er,er],qa],has:{type:Nr,overloads:[[[Vr],(i,[t])=>GA(t.evaluate(i),i.properties())],[[Vr,Qn],(i,[t,a])=>GA(t.evaluate(i),a.evaluate(i))]]},get:{type:Gr,overloads:[[[Vr],(i,[t])=>rA(t.evaluate(i),i.properties())],[[Vr,Qn],(i,[t,a])=>rA(t.evaluate(i),a.evaluate(i))]]},"feature-state":[Gr,[Vr],(i,[t])=>rA(t.evaluate(i),i.featureState||{})],properties:[Qn,[],i=>i.properties()],"geometry-type":[Vr,[],i=>i.geometryType()],id:[Gr,[],i=>i.id()],zoom:[er,[],i=>i.globals.zoom],"heatmap-density":[er,[],i=>i.globals.heatmapDensity||0],"line-progress":[er,[],i=>i.globals.lineProgress||0],accumulated:[Gr,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[er,Ki(er),(i,t)=>{let a=0;for(const h of t)a+=h.evaluate(i);return a}],"*":[er,Ki(er),(i,t)=>{let a=1;for(const h of t)a*=h.evaluate(i);return a}],"-":{type:er,overloads:[[[er,er],(i,[t,a])=>t.evaluate(i)-a.evaluate(i)],[[er],(i,[t])=>-t.evaluate(i)]]},"/":[er,[er,er],(i,[t,a])=>t.evaluate(i)/a.evaluate(i)],"%":[er,[er,er],(i,[t,a])=>t.evaluate(i)%a.evaluate(i)],ln2:[er,[],()=>Math.LN2],pi:[er,[],()=>Math.PI],e:[er,[],()=>Math.E],"^":[er,[er,er],(i,[t,a])=>Math.pow(t.evaluate(i),a.evaluate(i))],sqrt:[er,[er],(i,[t])=>Math.sqrt(t.evaluate(i))],log10:[er,[er],(i,[t])=>Math.log(t.evaluate(i))/Math.LN10],ln:[er,[er],(i,[t])=>Math.log(t.evaluate(i))],log2:[er,[er],(i,[t])=>Math.log(t.evaluate(i))/Math.LN2],sin:[er,[er],(i,[t])=>Math.sin(t.evaluate(i))],cos:[er,[er],(i,[t])=>Math.cos(t.evaluate(i))],tan:[er,[er],(i,[t])=>Math.tan(t.evaluate(i))],asin:[er,[er],(i,[t])=>Math.asin(t.evaluate(i))],acos:[er,[er],(i,[t])=>Math.acos(t.evaluate(i))],atan:[er,[er],(i,[t])=>Math.atan(t.evaluate(i))],min:[er,Ki(er),(i,t)=>Math.min(...t.map(a=>a.evaluate(i)))],max:[er,Ki(er),(i,t)=>Math.max(...t.map(a=>a.evaluate(i)))],abs:[er,[er],(i,[t])=>Math.abs(t.evaluate(i))],round:[er,[er],(i,[t])=>{const a=t.evaluate(i);return a<0?-Math.round(-a):Math.round(a)}],floor:[er,[er],(i,[t])=>Math.floor(t.evaluate(i))],ceil:[er,[er],(i,[t])=>Math.ceil(t.evaluate(i))],"filter-==":[Nr,[Vr,Gr],(i,[t,a])=>i.properties()[t.value]===a.value],"filter-id-==":[Nr,[Gr],(i,[t])=>i.id()===t.value],"filter-type-==":[Nr,[Vr],(i,[t])=>i.geometryType()===t.value],"filter-<":[Nr,[Vr,Gr],(i,[t,a])=>{const h=i.properties()[t.value],f=a.value;return typeof h==typeof f&&h<f}],"filter-id-<":[Nr,[Gr],(i,[t])=>{const a=i.id(),h=t.value;return typeof a==typeof h&&a<h}],"filter->":[Nr,[Vr,Gr],(i,[t,a])=>{const h=i.properties()[t.value],f=a.value;return typeof h==typeof f&&h>f}],"filter-id->":[Nr,[Gr],(i,[t])=>{const a=i.id(),h=t.value;return typeof a==typeof h&&a>h}],"filter-<=":[Nr,[Vr,Gr],(i,[t,a])=>{const h=i.properties()[t.value],f=a.value;return typeof h==typeof f&&h<=f}],"filter-id-<=":[Nr,[Gr],(i,[t])=>{const a=i.id(),h=t.value;return typeof a==typeof h&&a<=h}],"filter->=":[Nr,[Vr,Gr],(i,[t,a])=>{const h=i.properties()[t.value],f=a.value;return typeof h==typeof f&&h>=f}],"filter-id->=":[Nr,[Gr],(i,[t])=>{const a=i.id(),h=t.value;return typeof a==typeof h&&a>=h}],"filter-has":[Nr,[Gr],(i,[t])=>t.value in i.properties()],"filter-has-id":[Nr,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[Nr,[ne(Vr)],(i,[t])=>t.value.indexOf(i.geometryType())>=0],"filter-id-in":[Nr,[ne(Gr)],(i,[t])=>t.value.indexOf(i.id())>=0],"filter-in-small":[Nr,[Vr,ne(Gr)],(i,[t,a])=>a.value.indexOf(i.properties()[t.value])>=0],"filter-in-large":[Nr,[Vr,ne(Gr)],(i,[t,a])=>function(h,f,v,w){for(;v<=w;){const k=v+w>>1;if(f[k]===h)return!0;f[k]>h?w=k-1:v=k+1}return!1}(i.properties()[t.value],a.value,0,a.value.length-1)],all:{type:Nr,overloads:[[[Nr,Nr],(i,[t,a])=>t.evaluate(i)&&a.evaluate(i)],[Ki(Nr),(i,t)=>{for(const a of t)if(!a.evaluate(i))return!1;return!0}]]},any:{type:Nr,overloads:[[[Nr,Nr],(i,[t,a])=>t.evaluate(i)||a.evaluate(i)],[Ki(Nr),(i,t)=>{for(const a of t)if(a.evaluate(i))return!0;return!1}]]},"!":[Nr,[Nr],(i,[t])=>!t.evaluate(i)],"is-supported-script":[Nr,[Vr],(i,[t])=>{const a=i.globals&&i.globals.isSupportedScript;return!a||a(t.evaluate(i))}],upcase:[Vr,[Vr],(i,[t])=>t.evaluate(i).toUpperCase()],downcase:[Vr,[Vr],(i,[t])=>t.evaluate(i).toLowerCase()],concat:[Vr,Ki(Gr),(i,t)=>t.map(a=>Pe(a.evaluate(i))).join("")],"resolved-locale":[Vr,[mo],(i,[t])=>t.evaluate(i).resolvedLocale()]});class ha{constructor(t,a){this.expression=t,this._warningHistory={},this._evaluator=new Br,this._defaultValue=a?function(h){return h.type==="color"&&Yi(h.default)?new se(0,0,0,0):h.type==="color"?se.parse(h.default)||null:h.type==="padding"?ve.parse(h.default)||null:h.default===void 0?null:h.default}(a):null,this._enumValues=a&&a.type==="enum"?a.values:null}evaluateWithoutErrorHandling(t,a,h,f,v,w){return this._evaluator.globals=t,this._evaluator.feature=a,this._evaluator.featureState=h,this._evaluator.canonical=f,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=w,this.expression.evaluate(this._evaluator)}evaluate(t,a,h,f,v,w){this._evaluator.globals=t,this._evaluator.feature=a||null,this._evaluator.featureState=h||null,this._evaluator.canonical=f,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=w||null;try{const k=this.expression.evaluate(this._evaluator);if(k==null||typeof k=="number"&&k!=k)return this._defaultValue;if(this._enumValues&&!(k in this._enumValues))throw new xt(`Expected value to be one of ${Object.keys(this._enumValues).map(L=>JSON.stringify(L)).join(", ")}, but found ${JSON.stringify(k)} instead.`);return k}catch(k){return this._warningHistory[k.message]||(this._warningHistory[k.message]=!0,typeof console<"u"&&console.warn(k.message)),this._defaultValue}}}function So(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in $a}function zl(i,t){const a=new Sn($a,[],t?function(f){const v={color:_n,string:Vr,number:er,enum:Vr,boolean:Nr,formatted:In,padding:ka,resolvedImage:mi};return f.type==="array"?ne(v[f.value]||Gr,f.length):v[f.type]}(t):void 0),h=a.parse(i,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return h?gc(new ha(h,t)):Ds(a.errors)}class ta{constructor(t,a){this.kind=t,this._styleExpression=a,this.isStateDependent=t!=="constant"&&!co(a.expression)}evaluateWithoutErrorHandling(t,a,h,f,v,w){return this._styleExpression.evaluateWithoutErrorHandling(t,a,h,f,v,w)}evaluate(t,a,h,f,v,w){return this._styleExpression.evaluate(t,a,h,f,v,w)}}class Ai{constructor(t,a,h,f){this.kind=t,this.zoomStops=h,this._styleExpression=a,this.isStateDependent=t!=="camera"&&!co(a.expression),this.interpolationType=f}evaluateWithoutErrorHandling(t,a,h,f,v,w){return this._styleExpression.evaluateWithoutErrorHandling(t,a,h,f,v,w)}evaluate(t,a,h,f,v,w){return this._styleExpression.evaluate(t,a,h,f,v,w)}interpolationFactor(t,a,h){return this.interpolationType?Li.interpolationFactor(this.interpolationType,t,a,h):0}}function Rl(i,t){const a=zl(i,t);if(a.result==="error")return a;const h=a.value.expression,f=Aa(h);if(!f&&!Rn(t))return Ds([new ro("","data expressions not supported")]);const v=hn(h,["zoom"]);if(!v&&!jA(t))return Ds([new ro("","zoom expressions not supported")]);const w=es(h);return w||v?w instanceof ro?Ds([w]):w instanceof Li&&!Pi(t)?Ds([new ro("",'"interpolate" expressions cannot be used with this property')]):gc(w?new Ai(f?"camera":"composite",a.value,w.labels,w instanceof Li?w.interpolation:void 0):new ta(f?"constant":"source",a.value)):Ds([new ro("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class To{constructor(t,a){this._parameters=t,this._specification=a,lo(this,ua(this._parameters,this._specification))}static deserialize(t){return new To(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function es(i){let t=null;if(i instanceof wA)t=es(i.result);else if(i instanceof Yl){for(const a of i.args)if(t=es(a),t)break}else(i instanceof Fs||i instanceof Li)&&i.input instanceof vr&&i.input.name==="zoom"&&(t=i);return t instanceof ro||i.eachChild(a=>{const h=es(a);h instanceof ro?t=h:!t&&h?t=new ro("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&h&&t!==h&&(t=new ro("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function Mo(i){const t=i.key,a=i.value,h=i.valueSpec||{},f=i.objectElementValidators||{},v=i.style,w=i.styleSpec;let k=[];const L=Gi(a);if(L!=="object")return[new ir(t,a,`object expected, ${L} found`)];for(const O in a){const Z=O.split(".")[0],re=h[Z]||h["*"];let he;if(f[Z])he=f[Z];else if(h[Z])he=Zn;else if(f["*"])he=f["*"];else{if(!h["*"]){k.push(new ir(t,a[O],`unknown property "${O}"`));continue}he=Zn}k=k.concat(he({key:(t&&`${t}.`)+O,value:a[O],valueSpec:re,style:v,styleSpec:w,object:a,objectKey:O},a))}for(const O in h)f[O]||h[O].required&&h[O].default===void 0&&a[O]===void 0&&k.push(new ir(t,a,`missing required property "${O}"`));return k}function Ol(i){const t=i.value,a=i.valueSpec,h=i.style,f=i.styleSpec,v=i.key,w=i.arrayElementValidator||Zn;if(Gi(t)!=="array")return[new ir(v,t,`array expected, ${Gi(t)} found`)];if(a.length&&t.length!==a.length)return[new ir(v,t,`array length ${a.length} expected, length ${t.length} found`)];if(a["min-length"]&&t.length<a["min-length"])return[new ir(v,t,`array length at least ${a["min-length"]} expected, length ${t.length} found`)];let k={type:a.value,values:a.values};f.$version<7&&(k.function=a.function),Gi(a.value)==="object"&&(k=a.value);let L=[];for(let O=0;O<t.length;O++)L=L.concat(w({array:t,arrayIndex:O,value:t[O],valueSpec:k,style:h,styleSpec:f,key:`${v}[${O}]`}));return L}function Fn(i){const t=i.key,a=i.value,h=i.valueSpec;let f=Gi(a);return f==="number"&&a!=a&&(f="NaN"),f!=="number"?[new ir(t,a,`number expected, ${f} found`)]:"minimum"in h&&a<h.minimum?[new ir(t,a,`${a} is less than the minimum value ${h.minimum}`)]:"maximum"in h&&a>h.maximum?[new ir(t,a,`${a} is greater than the maximum value ${h.maximum}`)]:[]}function Hl(i){const t=i.valueSpec,a=bi(i.value.type);let h,f,v,w={};const k=a!=="categorical"&&i.value.property===void 0,L=!k,O=Gi(i.value.stops)==="array"&&Gi(i.value.stops[0])==="array"&&Gi(i.value.stops[0][0])==="object",Z=Mo({key:i.key,value:i.value,valueSpec:i.styleSpec.function,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(de){if(a==="identity")return[new ir(de.key,de.value,'identity function may not have a "stops" property')];let me=[];const Ue=de.value;return me=me.concat(Ol({key:de.key,value:Ue,valueSpec:de.valueSpec,style:de.style,styleSpec:de.styleSpec,arrayElementValidator:re})),Gi(Ue)==="array"&&Ue.length===0&&me.push(new ir(de.key,Ue,"array must have at least one stop")),me},default:function(de){return Zn({key:de.key,value:de.value,valueSpec:t,style:de.style,styleSpec:de.styleSpec})}}});return a==="identity"&&k&&Z.push(new ir(i.key,i.value,'missing required property "property"')),a==="identity"||i.value.stops||Z.push(new ir(i.key,i.value,'missing required property "stops"')),a==="exponential"&&i.valueSpec.expression&&!Pi(i.valueSpec)&&Z.push(new ir(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(L&&!Rn(i.valueSpec)?Z.push(new ir(i.key,i.value,"property functions not supported")):k&&!jA(i.valueSpec)&&Z.push(new ir(i.key,i.value,"zoom functions not supported"))),a!=="categorical"&&!O||i.value.property!==void 0||Z.push(new ir(i.key,i.value,'"property" property is required')),Z;function re(de){let me=[];const Ue=de.value,Qe=de.key;if(Gi(Ue)!=="array")return[new ir(Qe,Ue,`array expected, ${Gi(Ue)} found`)];if(Ue.length!==2)return[new ir(Qe,Ue,`array length 2 expected, length ${Ue.length} found`)];if(O){if(Gi(Ue[0])!=="object")return[new ir(Qe,Ue,`object expected, ${Gi(Ue[0])} found`)];if(Ue[0].zoom===void 0)return[new ir(Qe,Ue,"object stop key must have zoom")];if(Ue[0].value===void 0)return[new ir(Qe,Ue,"object stop key must have value")];if(v&&v>bi(Ue[0].zoom))return[new ir(Qe,Ue[0].zoom,"stop zoom values must appear in ascending order")];bi(Ue[0].zoom)!==v&&(v=bi(Ue[0].zoom),f=void 0,w={}),me=me.concat(Mo({key:`${Qe}[0]`,value:Ue[0],valueSpec:{zoom:{}},style:de.style,styleSpec:de.styleSpec,objectElementValidators:{zoom:Fn,value:he}}))}else me=me.concat(he({key:`${Qe}[0]`,value:Ue[0],valueSpec:{},style:de.style,styleSpec:de.styleSpec},Ue));return So(bo(Ue[1]))?me.concat([new ir(`${Qe}[1]`,Ue[1],"expressions are not allowed in function stops.")]):me.concat(Zn({key:`${Qe}[1]`,value:Ue[1],valueSpec:t,style:de.style,styleSpec:de.styleSpec}))}function he(de,me){const Ue=Gi(de.value),Qe=bi(de.value),Ye=de.value!==null?de.value:me;if(h){if(Ue!==h)return[new ir(de.key,Ye,`${Ue} stop domain type must match previous stop domain type ${h}`)]}else h=Ue;if(Ue!=="number"&&Ue!=="string"&&Ue!=="boolean")return[new ir(de.key,Ye,"stop domain value must be a number, string, or boolean")];if(Ue!=="number"&&a!=="categorical"){let ot=`number expected, ${Ue} found`;return Rn(t)&&a===void 0&&(ot+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ir(de.key,Ye,ot)]}return a!=="categorical"||Ue!=="number"||isFinite(Qe)&&Math.floor(Qe)===Qe?a!=="categorical"&&Ue==="number"&&f!==void 0&&Qe<f?[new ir(de.key,Ye,"stop domain values must appear in ascending order")]:(f=Qe,a==="categorical"&&Qe in w?[new ir(de.key,Ye,"stop domain values must be unique")]:(w[Qe]=!0,[])):[new ir(de.key,Ye,`integer expected, found ${Qe}`)]}}function Da(i){const t=(i.expressionContext==="property"?Rl:zl)(bo(i.value),i.valueSpec);if(t.result==="error")return t.value.map(h=>new ir(`${i.key}${h.key}`,i.value,h.message));const a=t.value.expression||t.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!a.outputDefined())return[new ir(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!co(a))return[new ir(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter"&&!co(a))return[new ir(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!hn(a,["zoom","feature-state"]))return[new ir(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!Aa(a))return[new ir(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function gs(i){const t=i.key,a=i.value,h=i.valueSpec,f=[];return Array.isArray(h.values)?h.values.indexOf(bi(a))===-1&&f.push(new ir(t,a,`expected one of [${h.values.join(", ")}], ${JSON.stringify(a)} found`)):Object.keys(h.values).indexOf(bi(a))===-1&&f.push(new ir(t,a,`expected one of [${Object.keys(h.values).join(", ")}], ${JSON.stringify(a)} found`)),f}function ys(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const t of i.slice(1))if(!ys(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const Ys={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function _s(i){if(i==null)return{filter:()=>!0,needGeometry:!1};ys(i)||(i=ho(i));const t=zl(i,Ys);if(t.result==="error")throw new Error(t.value.map(a=>`${a.key}: ${a.message}`).join(", "));return{filter:(a,h,f)=>t.value.evaluate(a,h,{},f),needGeometry:Oo(i)}}function BA(i,t){return i<t?-1:i>t?1:0}function Oo(i){if(!Array.isArray(i))return!1;if(i[0]==="within")return!0;for(let t=1;t<i.length;t++)if(Oo(i[t]))return!0;return!1}function ho(i){if(!i)return!0;const t=i[0];return i.length<=1?t!=="any":t==="=="?ts(i[1],i[2],"=="):t==="!="?za(ts(i[1],i[2],"==")):t==="<"||t===">"||t==="<="||t===">="?ts(i[1],i[2],t):t==="any"?(a=i.slice(1),["any"].concat(a.map(ho))):t==="all"?["all"].concat(i.slice(1).map(ho)):t==="none"?["all"].concat(i.slice(1).map(ho).map(za)):t==="in"?po(i[1],i.slice(2)):t==="!in"?za(po(i[1],i.slice(2))):t==="has"?La(i[1]):t==="!has"?za(La(i[1])):t!=="within"||i;var a}function ts(i,t,a){switch(i){case"$type":return[`filter-type-${a}`,t];case"$id":return[`filter-id-${a}`,t];default:return[`filter-${a}`,i,t]}}function po(i,t){if(t.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(a=>typeof a!=typeof t[0])?["filter-in-large",i,["literal",t.sort(BA)]]:["filter-in-small",i,["literal",t]]}}function La(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function za(i){return["!",i]}function vs(i){return ys(bo(i.value))?Da(lo({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):ml(i)}function ml(i){const t=i.value,a=i.key;if(Gi(t)!=="array")return[new ir(a,t,`array expected, ${Gi(t)} found`)];const h=i.styleSpec;let f,v=[];if(t.length<1)return[new ir(a,t,"filter array must have at least 1 element")];switch(v=v.concat(gs({key:`${a}[0]`,value:t[0],valueSpec:h.filter_operator,style:i.style,styleSpec:i.styleSpec})),bi(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&bi(t[1])==="$type"&&v.push(new ir(a,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&v.push(new ir(a,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(f=Gi(t[1]),f!=="string"&&v.push(new ir(`${a}[1]`,t[1],`string expected, ${f} found`)));for(let w=2;w<t.length;w++)f=Gi(t[w]),bi(t[1])==="$type"?v=v.concat(gs({key:`${a}[${w}]`,value:t[w],valueSpec:h.geometry_type,style:i.style,styleSpec:i.styleSpec})):f!=="string"&&f!=="number"&&f!=="boolean"&&v.push(new ir(`${a}[${w}]`,t[w],`string, number, or boolean expected, ${f} found`));break;case"any":case"all":case"none":for(let w=1;w<t.length;w++)v=v.concat(ml({key:`${a}[${w}]`,value:t[w],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":f=Gi(t[1]),t.length!==2?v.push(new ir(a,t,`filter array for "${t[0]}" operator must have 2 elements`)):f!=="string"&&v.push(new ir(`${a}[1]`,t[1],`string expected, ${f} found`));break;case"within":f=Gi(t[1]),t.length!==2?v.push(new ir(a,t,`filter array for "${t[0]}" operator must have 2 elements`)):f!=="object"&&v.push(new ir(`${a}[1]`,t[1],`object expected, ${f} found`))}return v}function el(i,t){const a=i.key,h=i.style,f=i.styleSpec,v=i.value,w=i.objectKey,k=f[`${t}_${i.layerType}`];if(!k)return[];const L=w.match(/^(.*)-transition$/);if(t==="paint"&&L&&k[L[1]]&&k[L[1]].transition)return Zn({key:a,value:v,valueSpec:f.transition,style:h,styleSpec:f});const O=i.valueSpec||k[w];if(!O)return[new ir(a,v,`unknown property "${w}"`)];let Z;if(Gi(v)==="string"&&Rn(O)&&!O.tokens&&(Z=/^{([^}]+)}$/.exec(v)))return[new ir(a,v,`"${w}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(Z[1])} }\`.`)];const re=[];return i.layerType==="symbol"&&(w==="text-field"&&h&&!h.glyphs&&re.push(new ir(a,v,'use of "text-field" requires a style "glyphs" property')),w==="text-font"&&Yi(bo(v))&&bi(v.type)==="identity"&&re.push(new ir(a,v,'"text-font" does not support identity functions'))),re.concat(Zn({key:i.key,value:v,valueSpec:O,style:h,styleSpec:f,expressionContext:"property",propertyType:t,propertyKey:w}))}function iA(i){return el(i,"paint")}function Vl(i){return el(i,"layout")}function Ra(i){let t=[];const a=i.value,h=i.key,f=i.style,v=i.styleSpec;a.type||a.ref||t.push(new ir(h,a,'either "type" or "ref" is required'));let w=bi(a.type);const k=bi(a.ref);if(a.id){const L=bi(a.id);for(let O=0;O<i.arrayIndex;O++){const Z=f.layers[O];bi(Z.id)===L&&t.push(new ir(h,a.id,`duplicate layer id "${a.id}", previously used at line ${Z.id.__line__}`))}}if("ref"in a){let L;["type","source","source-layer","filter","layout"].forEach(O=>{O in a&&t.push(new ir(h,a[O],`"${O}" is prohibited for ref layers`))}),f.layers.forEach(O=>{bi(O.id)===k&&(L=O)}),L?L.ref?t.push(new ir(h,a.ref,"ref cannot reference another ref layer")):w=bi(L.type):t.push(new ir(h,a.ref,`ref layer "${k}" not found`))}else if(w!=="background")if(a.source){const L=f.sources&&f.sources[a.source],O=L&&bi(L.type);L?O==="vector"&&w==="raster"?t.push(new ir(h,a.source,`layer "${a.id}" requires a raster source`)):O==="raster"&&w!=="raster"?t.push(new ir(h,a.source,`layer "${a.id}" requires a vector source`)):O!=="vector"||a["source-layer"]?O==="raster-dem"&&w!=="hillshade"?t.push(new ir(h,a.source,"raster-dem source can only be used with layer type 'hillshade'.")):w!=="line"||!a.paint||!a.paint["line-gradient"]||O==="geojson"&&L.lineMetrics||t.push(new ir(h,a,`layer "${a.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new ir(h,a,`layer "${a.id}" must specify a "source-layer"`)):t.push(new ir(h,a.source,`source "${a.source}" not found`))}else t.push(new ir(h,a,'missing required property "source"'));return t=t.concat(Mo({key:h,value:a,valueSpec:v.layer,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Zn({key:`${h}.type`,value:a.type,valueSpec:v.layer.type,style:i.style,styleSpec:i.styleSpec,object:a,objectKey:"type"}),filter:vs,layout:L=>Mo({layer:a,key:L.key,value:L.value,style:L.style,styleSpec:L.styleSpec,objectElementValidators:{"*":O=>Vl(lo({layerType:w},O))}}),paint:L=>Mo({layer:a,key:L.key,value:L.value,style:L.style,styleSpec:L.styleSpec,objectElementValidators:{"*":O=>iA(lo({layerType:w},O))}})}})),t}function tl(i){const t=i.value,a=i.key,h=Gi(t);return h!=="string"?[new ir(a,t,`string expected, ${h} found`)]:[]}const ZA={promoteId:function({key:i,value:t}){if(Gi(t)==="string")return tl({key:i,value:t});{const a=[];for(const h in t)a.push(...tl({key:`${i}.${h}`,value:t[h]}));return a}}};function Ls(i){const t=i.value,a=i.key,h=i.styleSpec,f=i.style;if(!t.type)return[new ir(a,t,'"type" is required')];const v=bi(t.type);let w;switch(v){case"vector":case"raster":case"raster-dem":return w=Mo({key:a,value:t,valueSpec:h[`source_${v.replace("-","_")}`],style:i.style,styleSpec:h,objectElementValidators:ZA}),w;case"geojson":if(w=Mo({key:a,value:t,valueSpec:h.source_geojson,style:f,styleSpec:h,objectElementValidators:ZA}),t.cluster)for(const k in t.clusterProperties){const[L,O]=t.clusterProperties[k],Z=typeof L=="string"?[L,["accumulated"],["get",k]]:L;w.push(...Da({key:`${a}.${k}.map`,value:O,expressionContext:"cluster-map"})),w.push(...Da({key:`${a}.${k}.reduce`,value:Z,expressionContext:"cluster-reduce"}))}return w;case"video":return Mo({key:a,value:t,valueSpec:h.source_video,style:f,styleSpec:h});case"image":return Mo({key:a,value:t,valueSpec:h.source_image,style:f,styleSpec:h});case"canvas":return[new ir(a,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return gs({key:`${a}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:f,styleSpec:h})}}function zs(i){const t=i.value,a=i.styleSpec,h=a.light,f=i.style;let v=[];const w=Gi(t);if(t===void 0)return v;if(w!=="object")return v=v.concat([new ir("light",t,`object expected, ${w} found`)]),v;for(const k in t){const L=k.match(/^(.*)-transition$/);v=v.concat(L&&h[L[1]]&&h[L[1]].transition?Zn({key:k,value:t[k],valueSpec:a.transition,style:f,styleSpec:a}):h[k]?Zn({key:k,value:t[k],valueSpec:h[k],style:f,styleSpec:a}):[new ir(k,t[k],`unknown property "${k}"`)])}return v}function pa(i){const t=i.value,a=i.styleSpec,h=a.terrain,f=i.style;let v=[];const w=Gi(t);if(t===void 0)return v;if(w!=="object")return v=v.concat([new ir("terrain",t,`object expected, ${w} found`)]),v;for(const k in t)v=v.concat(h[k]?Zn({key:k,value:t[k],valueSpec:h[k],style:f,styleSpec:a}):[new ir(k,t[k],`unknown property "${k}"`)]);return v}const gl={"*":()=>[],array:Ol,boolean:function(i){const t=i.value,a=i.key,h=Gi(t);return h!=="boolean"?[new ir(a,t,`boolean expected, ${h} found`)]:[]},number:Fn,color:function(i){const t=i.key,a=i.value,h=Gi(a);return h!=="string"?[new ir(t,a,`color expected, ${h} found`)]:st(a)===null?[new ir(t,a,`color expected, "${a}" found`)]:[]},constants:Ma,enum:gs,filter:vs,function:Hl,layer:Ra,object:Mo,source:Ls,light:zs,terrain:pa,string:tl,formatted:function(i){return tl(i).length===0?[]:Da(i)},resolvedImage:function(i){return tl(i).length===0?[]:Da(i)},padding:function(i){const t=i.key,a=i.value;if(Gi(a)==="array"){if(a.length<1||a.length>4)return[new ir(t,a,`padding requires 1 to 4 values; ${a.length} values found`)];const h={type:"number"};let f=[];for(let v=0;v<a.length;v++)f=f.concat(Zn({key:`${t}[${v}]`,value:a[v],valueSpec:h}));return f}return Fn({key:t,value:a,valueSpec:{}})}};function Zn(i){const t=i.value,a=i.valueSpec,h=i.styleSpec;return a.expression&&Yi(bi(t))?Hl(i):a.expression&&So(bo(t))?Da(i):a.type&&gl[a.type]?gl[a.type](i):Mo(lo({},i,{valueSpec:a.type?h[a.type]:a}))}function Nl(i){const t=i.value,a=i.key,h=tl(i);return h.length||(t.indexOf("{fontstack}")===-1&&h.push(new ir(a,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&h.push(new ir(a,t,'"glyphs" url must include a "{range}" token'))),h}function Rs(i,t=Ut){let a=[];return a=a.concat(Zn({key:"",value:i,valueSpec:t.$root,styleSpec:t,style:i,objectElementValidators:{glyphs:Nl,"*":()=>[]}})),i.constants&&(a=a.concat(Ma({key:"constants",value:i.constants,style:i,styleSpec:t}))),rl(a)}function rl(i){return[].concat(i).sort((t,a)=>t.line-a.line)}function Oi(i){return function(...t){return rl(i.apply(this,t))}}Rs.source=Oi(Ls),Rs.light=Oi(zs),Rs.terrain=Oi(pa),Rs.layer=Oi(Ra),Rs.filter=Oi(vs),Rs.paintProperty=Oi(iA),Rs.layoutProperty=Oi(Vl);const il=Rs,xs=il.light,Os=il.paintProperty,Ei=il.layoutProperty;function ln(i,t){let a=!1;if(t&&t.length)for(const h of t)i.fire(new yn(new Error(h.message))),a=!0;return a}class Ho{constructor(t,a,h){const f=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const w=new Int32Array(this.arrayBuffer);t=w[0],this.d=(a=w[1])+2*(h=w[2]);for(let L=0;L<this.d*this.d;L++){const O=w[3+L],Z=w[3+L+1];f.push(O===Z?null:w.subarray(O,Z))}const k=w[3+f.length+1];this.keys=w.subarray(w[3+f.length],k),this.bboxes=w.subarray(k),this.insert=this._insertReadonly}else{this.d=a+2*h;for(let w=0;w<this.d*this.d;w++)f.push([]);this.keys=[],this.bboxes=[]}this.n=a,this.extent=t,this.padding=h,this.scale=a/t,this.uid=0;const v=h/a*t;this.min=-v,this.max=t+v}insert(t,a,h,f,v){this._forEachCell(a,h,f,v,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(a),this.bboxes.push(h),this.bboxes.push(f),this.bboxes.push(v)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,a,h,f,v,w){this.cells[v].push(w)}query(t,a,h,f,v){const w=this.min,k=this.max;if(t<=w&&a<=w&&k<=h&&k<=f&&!v)return Array.prototype.slice.call(this.keys);{const L=[];return this._forEachCell(t,a,h,f,this._queryCell,L,{},v),L}}_queryCell(t,a,h,f,v,w,k,L){const O=this.cells[v];if(O!==null){const Z=this.keys,re=this.bboxes;for(let he=0;he<O.length;he++){const de=O[he];if(k[de]===void 0){const me=4*de;(L?L(re[me+0],re[me+1],re[me+2],re[me+3]):t<=re[me+2]&&a<=re[me+3]&&h>=re[me+0]&&f>=re[me+1])?(k[de]=!0,w.push(Z[de])):k[de]=!1}}}}_forEachCell(t,a,h,f,v,w,k,L){const O=this._convertToCellCoord(t),Z=this._convertToCellCoord(a),re=this._convertToCellCoord(h),he=this._convertToCellCoord(f);for(let de=O;de<=re;de++)for(let me=Z;me<=he;me++){const Ue=this.d*me+de;if((!L||L(this._convertFromCellCoord(de),this._convertFromCellCoord(me),this._convertFromCellCoord(de+1),this._convertFromCellCoord(me+1)))&&v.call(this,t,a,h,f,Ue,w,k,L))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,a=3+this.cells.length+1+1;let h=0;for(let w=0;w<this.cells.length;w++)h+=this.cells[w].length;const f=new Int32Array(a+h+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;let v=a;for(let w=0;w<t.length;w++){const k=t[w];f[3+w]=v,f.set(k,v),v+=k.length}return f[3+t.length]=v,f.set(this.keys,v),v+=this.keys.length,f[3+t.length+1]=v,f.set(this.bboxes,v),v+=this.bboxes.length,f.buffer}static serialize(t,a){const h=t.toArrayBuffer();return a&&a.push(h),{buffer:h}}static deserialize(t){return new Ho(t.buffer)}}const va={};function xr(i,t,a={}){if(va[i])throw new Error(`${i} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:i,writeable:!1}),va[i]={klass:t,omit:a.omit||[],shallow:a.shallow||[]}}xr("Object",Object),xr("TransferableGridIndex",Ho),xr("Color",se),xr("Error",Error),xr("AJAXError",Wi),xr("ResolvedImage",Oe),xr("StylePropertyFunction",To),xr("StyleExpression",ha,{omit:["_evaluator"]}),xr("ZoomDependentExpression",Ai),xr("ZoomConstantExpression",ta),xr("CompoundExpression",vr,{omit:["_evaluate"]});for(const i in $a)$a[i]._classRegistryKey||xr(`Expression_${i}`,$a[i]);function yl(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function _l(i,t){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob)return i;if(yl(i)||rr(i))return t&&t.push(i),i;if(ArrayBuffer.isView(i)){const a=i;return t&&t.push(a.buffer),a}if(i instanceof ImageData)return t&&t.push(i.data.buffer),i;if(Array.isArray(i)){const a=[];for(const h of i)a.push(_l(h,t));return a}if(typeof i=="object"){const a=i.constructor,h=a._classRegistryKey;if(!h)throw new Error("can't serialize object of unregistered class");if(!va[h])throw new Error(`${h} is not registered.`);const f=a.serialize?a.serialize(i,t):{};if(a.serialize){if(t&&f===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const v in i){if(!i.hasOwnProperty(v)||va[h].omit.indexOf(v)>=0)continue;const w=i[v];f[v]=va[h].shallow.indexOf(v)>=0?w:_l(w,t)}i instanceof Error&&(f.message=i.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return h!=="Object"&&(f.$name=h),f}throw new Error("can't serialize object of type "+typeof i)}function rs(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||yl(i)||rr(i)||ArrayBuffer.isView(i)||i instanceof ImageData)return i;if(Array.isArray(i))return i.map(rs);if(typeof i=="object"){const t=i.$name||"Object";if(!va[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:a}=va[t];if(!a)throw new Error(`can't deserialize unregistered class ${t}`);if(a.deserialize)return a.deserialize(i);const h=Object.create(a.prototype);for(const f of Object.keys(i)){if(f==="$name")continue;const v=i[f];h[f]=va[t].shallow.indexOf(f)>=0?v:rs(v)}return h}throw new Error("can't deserialize object of type "+typeof i)}class vl{constructor(){this.first=!0}update(t,a){const h=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=h,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=h,!0):(this.lastFloorZoom>h?(this.lastIntegerZoom=h+1,this.lastIntegerZoomTime=a):this.lastFloorZoom<h&&(this.lastIntegerZoom=h,this.lastIntegerZoomTime=a),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=h,!0))}}const pr={"Latin-1 Supplement":i=>i>=128&&i<=255,Arabic:i=>i>=1536&&i<=1791,"Arabic Supplement":i=>i>=1872&&i<=1919,"Arabic Extended-A":i=>i>=2208&&i<=2303,"Hangul Jamo":i=>i>=4352&&i<=4607,"Unified Canadian Aboriginal Syllabics":i=>i>=5120&&i<=5759,Khmer:i=>i>=6016&&i<=6143,"Unified Canadian Aboriginal Syllabics Extended":i=>i>=6320&&i<=6399,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"CJK Radicals Supplement":i=>i>=11904&&i<=12031,"Kangxi Radicals":i=>i>=12032&&i<=12255,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Bopomofo:i=>i>=12544&&i<=12591,"Hangul Compatibility Jamo":i=>i>=12592&&i<=12687,Kanbun:i=>i>=12688&&i<=12703,"Bopomofo Extended":i=>i>=12704&&i<=12735,"CJK Strokes":i=>i>=12736&&i<=12783,"Katakana Phonetic Extensions":i=>i>=12784&&i<=12799,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"CJK Unified Ideographs Extension A":i=>i>=13312&&i<=19903,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Yi Syllables":i=>i>=40960&&i<=42127,"Yi Radicals":i=>i>=42128&&i<=42191,"Hangul Jamo Extended-A":i=>i>=43360&&i<=43391,"Hangul Syllables":i=>i>=44032&&i<=55215,"Hangul Jamo Extended-B":i=>i>=55216&&i<=55295,"Private Use Area":i=>i>=57344&&i<=63743,"CJK Compatibility Ideographs":i=>i>=63744&&i<=64255,"Arabic Presentation Forms-A":i=>i>=64336&&i<=65023,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Arabic Presentation Forms-B":i=>i>=65136&&i<=65279,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function xa(i){for(const t of i)if(nA(t.charCodeAt(0)))return!0;return!1}function yo(i){for(const t of i)if(!Xa(t.charCodeAt(0)))return!1;return!0}function Xa(i){return!(pr.Arabic(i)||pr["Arabic Supplement"](i)||pr["Arabic Extended-A"](i)||pr["Arabic Presentation Forms-A"](i)||pr["Arabic Presentation Forms-B"](i))}function nA(i){return!(i!==746&&i!==747&&(i<4352||!(pr["Bopomofo Extended"](i)||pr.Bopomofo(i)||pr["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||pr["CJK Compatibility Ideographs"](i)||pr["CJK Compatibility"](i)||pr["CJK Radicals Supplement"](i)||pr["CJK Strokes"](i)||!(!pr["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||pr["CJK Unified Ideographs Extension A"](i)||pr["CJK Unified Ideographs"](i)||pr["Enclosed CJK Letters and Months"](i)||pr["Hangul Compatibility Jamo"](i)||pr["Hangul Jamo Extended-A"](i)||pr["Hangul Jamo Extended-B"](i)||pr["Hangul Jamo"](i)||pr["Hangul Syllables"](i)||pr.Hiragana(i)||pr["Ideographic Description Characters"](i)||pr.Kanbun(i)||pr["Kangxi Radicals"](i)||pr["Katakana Phonetic Extensions"](i)||pr.Katakana(i)&&i!==12540||!(!pr["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!pr["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||pr["Unified Canadian Aboriginal Syllabics"](i)||pr["Unified Canadian Aboriginal Syllabics Extended"](i)||pr["Vertical Forms"](i)||pr["Yijing Hexagram Symbols"](i)||pr["Yi Syllables"](i)||pr["Yi Radicals"](i))))}function io(i){return!(nA(i)||function(t){return!!(pr["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||pr["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||pr["Letterlike Symbols"](t)||pr["Number Forms"](t)||pr["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||pr["Control Pictures"](t)&&t!==9251||pr["Optical Character Recognition"](t)||pr["Enclosed Alphanumerics"](t)||pr["Geometric Shapes"](t)||pr["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||pr["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||pr["CJK Symbols and Punctuation"](t)||pr.Katakana(t)||pr["Private Use Area"](t)||pr["CJK Compatibility Forms"](t)||pr["Small Form Variants"](t)||pr["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(i))}function fr(i){return i>=1424&&i<=2303||pr["Arabic Presentation Forms-A"](i)||pr["Arabic Presentation Forms-B"](i)}function wa(i,t){return!(!t&&fr(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||pr.Khmer(i))}function oA(i){for(const t of i)if(fr(t.charCodeAt(0)))return!0;return!1}const nl="deferred",ra="loading",ia="loaded";let aA=null,Gt="unavailable",ws=null;const sA=function(i){i&&typeof i=="string"&&i.indexOf("NetworkError")>-1&&(Gt="error"),aA&&aA(i)};function ol(){ba.fire(new $i("pluginStateChange",{pluginStatus:Gt,pluginURL:ws}))}const ba=new En,_o=function(){return Gt},lA=function(){if(Gt!==nl||!ws)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Gt=ra,ol(),ws&&qn({url:ws},i=>{i?sA(i):(Gt=ia,ol())})},da={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Gt===ia||da.applyArabicShaping!=null,isLoading:()=>Gt===ra,setState(i){if(!dr())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");Gt=i.pluginStatus,ws=i.pluginURL},isParsed(){if(!dr())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return da.applyArabicShaping!=null&&da.processBidirectionalText!=null&&da.processStyledBidirectionalText!=null},getPluginURL(){if(!dr())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return ws}};class Hi{constructor(t,a){this.zoom=t,a?(this.now=a.now,this.fadeDuration=a.fadeDuration,this.zoomHistory=a.zoomHistory,this.transition=a.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new vl,this.transition={})}isSupportedScript(t){return function(a,h){for(const f of a)if(!wa(f.charCodeAt(0),h))return!1;return!0}(t,da.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,a=t-Math.floor(t),h=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:a+(1-a)*h}:{fromScale:.5,toScale:1,t:1-(1-h)*a}}}class Oa{constructor(t,a){this.property=t,this.value=a,this.expression=function(h,f){if(Yi(h))return new To(h,f);if(So(h)){const v=Rl(h,f);if(v.result==="error")throw new Error(v.value.map(w=>`${w.key}: ${w.message}`).join(", "));return v.value}{let v=h;return f.type==="color"&&typeof h=="string"?v=se.parse(h):f.type!=="padding"||typeof h!="number"&&!Array.isArray(h)||(v=ve.parse(h)),{kind:"constant",evaluate:()=>v}}}(a===void 0?t.specification.default:a,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,a,h){return this.property.possiblyEvaluate(this,t,a,h)}}class al{constructor(t){this.property=t,this.value=new Oa(t,void 0)}transitioned(t,a){return new CA(this.property,this.value,a,ze({},t.transition,this.transition),t.now)}untransitioned(){return new CA(this.property,this.value,null,{},0)}}class Kl{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return Bt(this._values[t].value.value)}setValue(t,a){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new al(this._values[t].property)),this._values[t].value=new Oa(this._values[t].property,a===null?void 0:Bt(a))}getTransition(t){return Bt(this._values[t].transition)}setTransition(t,a){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new al(this._values[t].property)),this._values[t].transition=Bt(a)||void 0}serialize(){const t={};for(const a of Object.keys(this._values)){const h=this.getValue(a);h!==void 0&&(t[a]=h);const f=this.getTransition(a);f!==void 0&&(t[`${a}-transition`]=f)}return t}transitioned(t,a){const h=new EA(this._properties);for(const f of Object.keys(this._values))h._values[f]=this._values[f].transitioned(t,a._values[f]);return h}untransitioned(){const t=new EA(this._properties);for(const a of Object.keys(this._values))t._values[a]=this._values[a].untransitioned();return t}}class CA{constructor(t,a,h,f,v){this.property=t,this.value=a,this.begin=v+f.delay||0,this.end=this.begin+f.duration||0,t.specification.transition&&(f.delay||f.duration)&&(this.prior=h)}possiblyEvaluate(t,a,h){const f=t.now||0,v=this.value.possiblyEvaluate(t,a,h),w=this.prior;if(w){if(f>this.end)return this.prior=null,v;if(this.value.isDataDriven())return this.prior=null,v;if(f<this.begin)return w.possiblyEvaluate(t,a,h);{const k=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(w.possiblyEvaluate(t,a,h),v,function(L){if(L<=0)return 0;if(L>=1)return 1;const O=L*L,Z=O*L;return 4*(L<.5?Z:3*(L-O)+Z-.75)}(k))}}return v}}class EA{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,a,h){const f=new pi(this._properties);for(const v of Object.keys(this._values))f._values[v]=this._values[v].possiblyEvaluate(t,a,h);return f}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class is{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}getValue(t){return Bt(this._values[t].value)}setValue(t,a){this._values[t]=new Oa(this._values[t].property,a===null?void 0:Bt(a))}serialize(){const t={};for(const a of Object.keys(this._values)){const h=this.getValue(a);h!==void 0&&(t[a]=h)}return t}possiblyEvaluate(t,a,h){const f=new pi(this._properties);for(const v of Object.keys(this._values))f._values[v]=this._values[v].possiblyEvaluate(t,a,h);return f}}class Xn{constructor(t,a,h){this.property=t,this.value=a,this.parameters=h}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,a,h,f){return this.property.evaluate(this.value,this.parameters,t,a,h,f)}}class pi{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Cr{constructor(t){this.specification=t}possiblyEvaluate(t,a){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(a)}interpolate(t,a,h){const f=hs[this.specification.type];return f?f(t,a,h):t}}class Pr{constructor(t,a){this.specification=t,this.overrides=a}possiblyEvaluate(t,a,h,f){return new Xn(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(a,null,{},h,f)}:t.expression,a)}interpolate(t,a,h){if(t.value.kind!=="constant"||a.value.kind!=="constant")return t;if(t.value.value===void 0||a.value.value===void 0)return new Xn(this,{kind:"constant",value:void 0},t.parameters);const f=hs[this.specification.type];return f?new Xn(this,{kind:"constant",value:f(t.value.value,a.value.value,h)},t.parameters):t}evaluate(t,a,h,f,v,w){return t.kind==="constant"?t.value:t.evaluate(a,h,f,v,w)}}class no extends Pr{possiblyEvaluate(t,a,h,f){if(t.value===void 0)return new Xn(this,{kind:"constant",value:void 0},a);if(t.expression.kind==="constant"){const v=t.expression.evaluate(a,null,{},h,f),w=t.property.specification.type==="resolvedImage"&&typeof v!="string"?v.name:v,k=this._calculate(w,w,w,a);return new Xn(this,{kind:"constant",value:k},a)}if(t.expression.kind==="camera"){const v=this._calculate(t.expression.evaluate({zoom:a.zoom-1}),t.expression.evaluate({zoom:a.zoom}),t.expression.evaluate({zoom:a.zoom+1}),a);return new Xn(this,{kind:"constant",value:v},a)}return new Xn(this,t.expression,a)}evaluate(t,a,h,f,v,w){if(t.kind==="source"){const k=t.evaluate(a,h,f,v,w);return this._calculate(k,k,k,a)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(a.zoom)-1},h,f),t.evaluate({zoom:Math.floor(a.zoom)},h,f),t.evaluate({zoom:Math.floor(a.zoom)+1},h,f),a):t.value}_calculate(t,a,h,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:t,to:a}:{from:h,to:a}}interpolate(t){return t}}class Hs{constructor(t){this.specification=t}possiblyEvaluate(t,a,h,f){if(t.value!==void 0){if(t.expression.kind==="constant"){const v=t.expression.evaluate(a,null,{},h,f);return this._calculate(v,v,v,a)}return this._calculate(t.expression.evaluate(new Hi(Math.floor(a.zoom-1),a)),t.expression.evaluate(new Hi(Math.floor(a.zoom),a)),t.expression.evaluate(new Hi(Math.floor(a.zoom+1),a)),a)}}_calculate(t,a,h,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:t,to:a}:{from:h,to:a}}interpolate(t){return t}}class fa{constructor(t){this.specification=t}possiblyEvaluate(t,a,h,f){return!!t.expression.evaluate(a,null,{},h,f)}interpolate(){return!1}}class On{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const a in t){const h=t[a];h.specification.overridable&&this.overridableProperties.push(a);const f=this.defaultPropertyValues[a]=new Oa(h,void 0),v=this.defaultTransitionablePropertyValues[a]=new al(h);this.defaultTransitioningPropertyValues[a]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=f.possiblyEvaluate({})}}}xr("DataDrivenProperty",Pr),xr("DataConstantProperty",Cr),xr("CrossFadedDataDrivenProperty",no),xr("CrossFadedProperty",Hs),xr("ColorRampProperty",fa);const oo="-transition";class Ba extends En{constructor(t,a){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),a.layout&&(this._unevaluatedLayout=new is(a.layout)),a.paint)){this._transitionablePaint=new Kl(a.paint);for(const h in t.paint)this.setPaintProperty(h,t.paint[h],{validate:!1});for(const h in t.layout)this.setLayoutProperty(h,t.layout[h],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new pi(a.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,a,h={}){a!=null&&this._validate(Ei,`layers.${this.id}.layout.${t}`,t,a,h)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,a):this.visibility=a)}getPaintProperty(t){return t.endsWith(oo)?this._transitionablePaint.getTransition(t.slice(0,-oo.length)):this._transitionablePaint.getValue(t)}setPaintProperty(t,a,h={}){if(a!=null&&this._validate(Os,`layers.${this.id}.paint.${t}`,t,a,h))return!1;if(t.endsWith(oo))return this._transitionablePaint.setTransition(t.slice(0,-oo.length),a||void 0),!1;{const f=this._transitionablePaint._values[t],v=f.property.specification["property-type"]==="cross-faded-data-driven",w=f.value.isDataDriven(),k=f.value;this._transitionablePaint.setValue(t,a),this._handleSpecialPaintPropertyUpdate(t);const L=this._transitionablePaint._values[t].value;return L.isDataDriven()||w||v||this._handleOverridablePaintPropertyUpdate(t,k,L)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,a,h){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,a){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,a)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),yt(t,(a,h)=>!(a===void 0||h==="layout"&&!Object.keys(a).length||h==="paint"&&!Object.keys(a).length))}_validate(t,a,h,f,v={}){return(!v||v.validate!==!1)&&ln(this,t.call(il,{key:a,layerType:this.type,objectKey:h,value:f,styleSpec:Ut,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const a=this.paint.get(t);if(a instanceof Xn&&Rn(a.property.specification)&&(a.value.kind==="source"||a.value.kind==="composite")&&a.value.isStateDependent)return!0}return!1}}const kr={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class cr{constructor(t,a){this._structArray=t,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Wn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,a){return t._trim(),a&&(t.isTransferred=!0,a.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const a=Object.create(this.prototype);return a.arrayBuffer=t.arrayBuffer,a.length=t.length,a.capacity=t.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function qi(i,t=1){let a=0,h=0;return{members:i.map(f=>{const v=kr[f.type].BYTES_PER_ELEMENT,w=a=Ca(a,Math.max(t,v)),k=f.components||1;return h=Math.max(h,v),a+=v*k,{name:f.name,type:f.type,components:k,offset:w}}),size:Ca(a,Math.max(h,t)),alignment:t}}function Ca(i,t){return Math.ceil(i/t)*t}class eo extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,a)}emplace(t,a,h){const f=2*t;return this.int16[f+0]=a,this.int16[f+1]=h,t}}eo.prototype.bytesPerElement=4,xr("StructArrayLayout2i4",eo);class y extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,h,f){const v=this.length;return this.resize(v+1),this.emplace(v,t,a,h,f)}emplace(t,a,h,f,v){const w=4*t;return this.int16[w+0]=a,this.int16[w+1]=h,this.int16[w+2]=f,this.int16[w+3]=v,t}}y.prototype.bytesPerElement=8,xr("StructArrayLayout4i8",y);class r extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,h,f,v,w){const k=this.length;return this.resize(k+1),this.emplace(k,t,a,h,f,v,w)}emplace(t,a,h,f,v,w,k){const L=6*t;return this.int16[L+0]=a,this.int16[L+1]=h,this.int16[L+2]=f,this.int16[L+3]=v,this.int16[L+4]=w,this.int16[L+5]=k,t}}r.prototype.bytesPerElement=12,xr("StructArrayLayout2i4i12",r);class c extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,h,f,v,w){const k=this.length;return this.resize(k+1),this.emplace(k,t,a,h,f,v,w)}emplace(t,a,h,f,v,w,k){const L=4*t,O=8*t;return this.int16[L+0]=a,this.int16[L+1]=h,this.uint8[O+4]=f,this.uint8[O+5]=v,this.uint8[O+6]=w,this.uint8[O+7]=k,t}}c.prototype.bytesPerElement=8,xr("StructArrayLayout2i4ub8",c);class m extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,a)}emplace(t,a,h){const f=2*t;return this.float32[f+0]=a,this.float32[f+1]=h,t}}m.prototype.bytesPerElement=8,xr("StructArrayLayout2f8",m);class _ extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,h,f,v,w,k,L,O,Z){const re=this.length;return this.resize(re+1),this.emplace(re,t,a,h,f,v,w,k,L,O,Z)}emplace(t,a,h,f,v,w,k,L,O,Z,re){const he=10*t;return this.uint16[he+0]=a,this.uint16[he+1]=h,this.uint16[he+2]=f,this.uint16[he+3]=v,this.uint16[he+4]=w,this.uint16[he+5]=k,this.uint16[he+6]=L,this.uint16[he+7]=O,this.uint16[he+8]=Z,this.uint16[he+9]=re,t}}_.prototype.bytesPerElement=20,xr("StructArrayLayout10ui20",_);class S extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,h,f,v,w,k,L,O,Z,re,he){const de=this.length;return this.resize(de+1),this.emplace(de,t,a,h,f,v,w,k,L,O,Z,re,he)}emplace(t,a,h,f,v,w,k,L,O,Z,re,he,de){const me=12*t;return this.int16[me+0]=a,this.int16[me+1]=h,this.int16[me+2]=f,this.int16[me+3]=v,this.uint16[me+4]=w,this.uint16[me+5]=k,this.uint16[me+6]=L,this.uint16[me+7]=O,this.int16[me+8]=Z,this.int16[me+9]=re,this.int16[me+10]=he,this.int16[me+11]=de,t}}S.prototype.bytesPerElement=24,xr("StructArrayLayout4i4ui4i24",S);class z extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,h){const f=this.length;return this.resize(f+1),this.emplace(f,t,a,h)}emplace(t,a,h,f){const v=3*t;return this.float32[v+0]=a,this.float32[v+1]=h,this.float32[v+2]=f,t}}z.prototype.bytesPerElement=12,xr("StructArrayLayout3f12",z);class N extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.uint32[1*t+0]=a,t}}N.prototype.bytesPerElement=4,xr("StructArrayLayout1ul4",N);class $ extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,h,f,v,w,k,L,O){const Z=this.length;return this.resize(Z+1),this.emplace(Z,t,a,h,f,v,w,k,L,O)}emplace(t,a,h,f,v,w,k,L,O,Z){const re=10*t,he=5*t;return this.int16[re+0]=a,this.int16[re+1]=h,this.int16[re+2]=f,this.int16[re+3]=v,this.int16[re+4]=w,this.int16[re+5]=k,this.uint32[he+3]=L,this.uint16[re+8]=O,this.uint16[re+9]=Z,t}}$.prototype.bytesPerElement=20,xr("StructArrayLayout6i1ul2ui20",$);class W extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,h,f,v,w){const k=this.length;return this.resize(k+1),this.emplace(k,t,a,h,f,v,w)}emplace(t,a,h,f,v,w,k){const L=6*t;return this.int16[L+0]=a,this.int16[L+1]=h,this.int16[L+2]=f,this.int16[L+3]=v,this.int16[L+4]=w,this.int16[L+5]=k,t}}W.prototype.bytesPerElement=12,xr("StructArrayLayout2i2i2i12",W);class ce extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,h,f,v){const w=this.length;return this.resize(w+1),this.emplace(w,t,a,h,f,v)}emplace(t,a,h,f,v,w){const k=4*t,L=8*t;return this.float32[k+0]=a,this.float32[k+1]=h,this.float32[k+2]=f,this.int16[L+6]=v,this.int16[L+7]=w,t}}ce.prototype.bytesPerElement=16,xr("StructArrayLayout2f1f2i16",ce);class ge extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,h,f){const v=this.length;return this.resize(v+1),this.emplace(v,t,a,h,f)}emplace(t,a,h,f,v){const w=12*t,k=3*t;return this.uint8[w+0]=a,this.uint8[w+1]=h,this.float32[k+1]=f,this.float32[k+2]=v,t}}ge.prototype.bytesPerElement=12,xr("StructArrayLayout2ub2f12",ge);class Ce extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,h){const f=this.length;return this.resize(f+1),this.emplace(f,t,a,h)}emplace(t,a,h,f){const v=3*t;return this.uint16[v+0]=a,this.uint16[v+1]=h,this.uint16[v+2]=f,t}}Ce.prototype.bytesPerElement=6,xr("StructArrayLayout3ui6",Ce);class je extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,h,f,v,w,k,L,O,Z,re,he,de,me,Ue,Qe,Ye){const ot=this.length;return this.resize(ot+1),this.emplace(ot,t,a,h,f,v,w,k,L,O,Z,re,he,de,me,Ue,Qe,Ye)}emplace(t,a,h,f,v,w,k,L,O,Z,re,he,de,me,Ue,Qe,Ye,ot){const nt=24*t,At=12*t,Et=48*t;return this.int16[nt+0]=a,this.int16[nt+1]=h,this.uint16[nt+2]=f,this.uint16[nt+3]=v,this.uint32[At+2]=w,this.uint32[At+3]=k,this.uint32[At+4]=L,this.uint16[nt+10]=O,this.uint16[nt+11]=Z,this.uint16[nt+12]=re,this.float32[At+7]=he,this.float32[At+8]=de,this.uint8[Et+36]=me,this.uint8[Et+37]=Ue,this.uint8[Et+38]=Qe,this.uint32[At+10]=Ye,this.int16[nt+22]=ot,t}}je.prototype.bytesPerElement=48,xr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",je);class De extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,h,f,v,w,k,L,O,Z,re,he,de,me,Ue,Qe,Ye,ot,nt,At,Et,ft,$t,nr,Xt,qt,Kt,Wt){const Yt=this.length;return this.resize(Yt+1),this.emplace(Yt,t,a,h,f,v,w,k,L,O,Z,re,he,de,me,Ue,Qe,Ye,ot,nt,At,Et,ft,$t,nr,Xt,qt,Kt,Wt)}emplace(t,a,h,f,v,w,k,L,O,Z,re,he,de,me,Ue,Qe,Ye,ot,nt,At,Et,ft,$t,nr,Xt,qt,Kt,Wt,Yt){const Ot=34*t,Ir=17*t;return this.int16[Ot+0]=a,this.int16[Ot+1]=h,this.int16[Ot+2]=f,this.int16[Ot+3]=v,this.int16[Ot+4]=w,this.int16[Ot+5]=k,this.int16[Ot+6]=L,this.int16[Ot+7]=O,this.uint16[Ot+8]=Z,this.uint16[Ot+9]=re,this.uint16[Ot+10]=he,this.uint16[Ot+11]=de,this.uint16[Ot+12]=me,this.uint16[Ot+13]=Ue,this.uint16[Ot+14]=Qe,this.uint16[Ot+15]=Ye,this.uint16[Ot+16]=ot,this.uint16[Ot+17]=nt,this.uint16[Ot+18]=At,this.uint16[Ot+19]=Et,this.uint16[Ot+20]=ft,this.uint16[Ot+21]=$t,this.uint16[Ot+22]=nr,this.uint32[Ir+12]=Xt,this.float32[Ir+13]=qt,this.float32[Ir+14]=Kt,this.float32[Ir+15]=Wt,this.float32[Ir+16]=Yt,t}}De.prototype.bytesPerElement=68,xr("StructArrayLayout8i15ui1ul4f68",De);class Ke extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.float32[1*t+0]=a,t}}Ke.prototype.bytesPerElement=4,xr("StructArrayLayout1f4",Ke);class lt extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,a,h){const f=this.length;return this.resize(f+1),this.emplace(f,t,a,h)}emplace(t,a,h,f){const v=3*t;return this.int16[v+0]=a,this.int16[v+1]=h,this.int16[v+2]=f,t}}lt.prototype.bytesPerElement=6,xr("StructArrayLayout3i6",lt);class ht extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a,h){const f=this.length;return this.resize(f+1),this.emplace(f,t,a,h)}emplace(t,a,h,f){const v=4*t;return this.uint32[2*t+0]=a,this.uint16[v+2]=h,this.uint16[v+3]=f,t}}ht.prototype.bytesPerElement=8,xr("StructArrayLayout1ul2ui8",ht);class vt extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,a){const h=this.length;return this.resize(h+1),this.emplace(h,t,a)}emplace(t,a,h){const f=2*t;return this.uint16[f+0]=a,this.uint16[f+1]=h,t}}vt.prototype.bytesPerElement=4,xr("StructArrayLayout2ui4",vt);class $e extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const a=this.length;return this.resize(a+1),this.emplace(a,t)}emplace(t,a){return this.uint16[1*t+0]=a,t}}$e.prototype.bytesPerElement=2,xr("StructArrayLayout1ui2",$e);class Ct extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,a,h,f){const v=this.length;return this.resize(v+1),this.emplace(v,t,a,h,f)}emplace(t,a,h,f,v){const w=4*t;return this.float32[w+0]=a,this.float32[w+1]=h,this.float32[w+2]=f,this.float32[w+3]=v,t}}Ct.prototype.bytesPerElement=16,xr("StructArrayLayout4f16",Ct);class wt extends cr{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Rt(this.anchorPointX,this.anchorPointY)}}wt.prototype.size=20;class Mt extends ${get(t){return new wt(this,t)}}xr("CollisionBoxArray",Mt);class Ft extends cr{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Ft.prototype.size=48;class jt extends je{get(t){return new Ft(this,t)}}xr("PlacedSymbolArray",jt);class St extends cr{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}St.prototype.size=68;class mr extends De{get(t){return new St(this,t)}}xr("SymbolInstanceArray",mr);class sr extends Ke{getoffsetX(t){return this.float32[1*t+0]}}xr("GlyphOffsetArray",sr);class l extends lt{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}xr("SymbolLineVertexArray",l);class u extends cr{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}u.prototype.size=8;class A extends ht{get(t){return new u(this,t)}}xr("FeatureIndexArray",A);class d extends eo{}class b extends eo{}class M extends eo{}class Q extends r{}class R extends c{}class J extends m{}class Ae extends _{}class Be extends S{}class Ie extends z{}class Te extends N{}class He extends W{}class Le extends ge{}class qe extends Ce{}class ke extends vt{}const Xe=qi([{name:"a_pos",components:2,type:"Int16"}],4),{members:et}=Xe;class at{constructor(t=[]){this.segments=t}prepareSegment(t,a,h,f){let v=this.segments[this.segments.length-1];return t>at.MAX_VERTEX_ARRAY_LENGTH&&It(`Max vertices per segment is ${at.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!v||v.vertexLength+t>at.MAX_VERTEX_ARRAY_LENGTH||v.sortKey!==f)&&(v={vertexOffset:a.length,primitiveOffset:h.length,vertexLength:0,primitiveLength:0},f!==void 0&&(v.sortKey=f),this.segments.push(v)),v}get(){return this.segments}destroy(){for(const t of this.segments)for(const a in t.vaos)t.vaos[a].destroy()}static simpleSegment(t,a,h,f){return new at([{vertexOffset:t,primitiveOffset:a,vertexLength:h,primitiveLength:f,vaos:{},sortKey:0}])}}function mt(i,t){return 256*(i=ie(Math.floor(i),0,255))+ie(Math.floor(t),0,255)}at.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,xr("SegmentVector",at);const Ze=qi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var bt={exports:{}},Tt={exports:{}};Tt.exports=function(i,t){var a,h,f,v,w,k,L,O;for(h=i.length-(a=3&i.length),f=t,w=3432918353,k=461845907,O=0;O<h;)L=255&i.charCodeAt(O)|(255&i.charCodeAt(++O))<<8|(255&i.charCodeAt(++O))<<16|(255&i.charCodeAt(++O))<<24,++O,f=27492+(65535&(v=5*(65535&(f=(f^=L=(65535&(L=(L=(65535&L)*w+(((L>>>16)*w&65535)<<16)&4294967295)<<15|L>>>17))*k+(((L>>>16)*k&65535)<<16)&4294967295)<<13|f>>>19))+((5*(f>>>16)&65535)<<16)&4294967295))+((58964+(v>>>16)&65535)<<16);switch(L=0,a){case 3:L^=(255&i.charCodeAt(O+2))<<16;case 2:L^=(255&i.charCodeAt(O+1))<<8;case 1:f^=L=(65535&(L=(L=(65535&(L^=255&i.charCodeAt(O)))*w+(((L>>>16)*w&65535)<<16)&4294967295)<<15|L>>>17))*k+(((L>>>16)*k&65535)<<16)&4294967295}return f^=i.length,f=2246822507*(65535&(f^=f>>>16))+((2246822507*(f>>>16)&65535)<<16)&4294967295,f=3266489909*(65535&(f^=f>>>13))+((3266489909*(f>>>16)&65535)<<16)&4294967295,(f^=f>>>16)>>>0};var Vt={exports:{}};Vt.exports=function(i,t){for(var a,h=i.length,f=t^h,v=0;h>=4;)a=1540483477*(65535&(a=255&i.charCodeAt(v)|(255&i.charCodeAt(++v))<<8|(255&i.charCodeAt(++v))<<16|(255&i.charCodeAt(++v))<<24))+((1540483477*(a>>>16)&65535)<<16),f=1540483477*(65535&f)+((1540483477*(f>>>16)&65535)<<16)^(a=1540483477*(65535&(a^=a>>>24))+((1540483477*(a>>>16)&65535)<<16)),h-=4,++v;switch(h){case 3:f^=(255&i.charCodeAt(v+2))<<16;case 2:f^=(255&i.charCodeAt(v+1))<<8;case 1:f=1540483477*(65535&(f^=255&i.charCodeAt(v)))+((1540483477*(f>>>16)&65535)<<16)}return f=1540483477*(65535&(f^=f>>>13))+((1540483477*(f>>>16)&65535)<<16),(f^=f>>>15)>>>0};var Ht=Tt.exports,hr=Vt.exports;bt.exports=Ht,bt.exports.murmur3=Ht,bt.exports.murmur2=hr;class Er{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,a,h,f){this.ids.push(Mr(t)),this.positions.push(a,h,f)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const a=Mr(t);let h=0,f=this.ids.length-1;for(;h<f;){const w=h+f>>1;this.ids[w]>=a?f=w:h=w+1}const v=[];for(;this.ids[h]===a;)v.push({index:this.positions[3*h],start:this.positions[3*h+1],end:this.positions[3*h+2]}),h++;return v}static serialize(t,a){const h=new Float64Array(t.ids),f=new Uint32Array(t.positions);return Ur(h,f,0,h.length-1),a&&a.push(h.buffer,f.buffer),{ids:h,positions:f}}static deserialize(t){const a=new Er;return a.ids=t.ids,a.positions=t.positions,a.indexed=!0,a}}function Mr(i){const t=+i;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:bt.exports(String(i))}function Ur(i,t,a,h){for(;a<h;){const f=i[a+h>>1];let v=a-1,w=h+1;for(;;){do v++;while(i[v]<f);do w--;while(i[w]>f);if(v>=w)break;gi(i,v,w),gi(t,3*v,3*w),gi(t,3*v+1,3*w+1),gi(t,3*v+2,3*w+2)}w-a<h-w?(Ur(i,t,a,w),a=w+1):(Ur(i,t,w+1,h),h=w)}}function gi(i,t,a){const h=i[t];i[t]=i[a],i[a]=h}xr("FeaturePositionMap",Er);class lr{constructor(t,a){this.gl=t.gl,this.location=a}}class zr extends lr{constructor(t,a){super(t,a),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class $r extends lr{constructor(t,a){super(t,a),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class qr extends lr{constructor(t,a){super(t,a),this.current=se.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const Zr=new Float32Array(16);function si(i){return[mt(255*i.r,255*i.g),mt(255*i.b,255*i.a)]}class Lr{constructor(t,a,h){this.value=t,this.uniformNames=a.map(f=>`u_${f}`),this.type=h}setUniform(t,a,h){t.set(h.constantOr(this.value))}getBinding(t,a,h){return this.type==="color"?new qr(t,a):new zr(t,a)}}class Dr{constructor(t,a){this.uniformNames=a.map(h=>`u_${h}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,a){this.pixelRatioFrom=a.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=a.tlbr,this.patternTo=t.tlbr}setUniform(t,a,h,f){const v=f==="u_pattern_to"?this.patternTo:f==="u_pattern_from"?this.patternFrom:f==="u_pixel_ratio_to"?this.pixelRatioTo:f==="u_pixel_ratio_from"?this.pixelRatioFrom:null;v&&t.set(v)}getBinding(t,a,h){return h.substr(0,9)==="u_pattern"?new $r(t,a):new zr(t,a)}}class Kn{constructor(t,a,h,f){this.expression=t,this.type=h,this.maxValue=0,this.paintVertexAttributes=a.map(v=>({name:`a_${v}`,type:"Float32",components:h==="color"?2:1,offset:0})),this.paintVertexArray=new f}populatePaintArray(t,a,h,f,v){const w=this.paintVertexArray.length,k=this.expression.evaluate(new Hi(0),a,{},f,[],v);this.paintVertexArray.resize(t),this._setPaintValue(w,t,k)}updatePaintArray(t,a,h,f){const v=this.expression.evaluate({zoom:0},h,f);this._setPaintValue(t,a,v)}_setPaintValue(t,a,h){if(this.type==="color"){const f=si(h);for(let v=t;v<a;v++)this.paintVertexArray.emplace(v,f[0],f[1])}else{for(let f=t;f<a;f++)this.paintVertexArray.emplace(f,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class dn{constructor(t,a,h,f,v,w){this.expression=t,this.uniformNames=a.map(k=>`u_${k}_t`),this.type=h,this.useIntegerZoom=f,this.zoom=v,this.maxValue=0,this.paintVertexAttributes=a.map(k=>({name:`a_${k}`,type:"Float32",components:h==="color"?4:2,offset:0})),this.paintVertexArray=new w}populatePaintArray(t,a,h,f,v){const w=this.expression.evaluate(new Hi(this.zoom),a,{},f,[],v),k=this.expression.evaluate(new Hi(this.zoom+1),a,{},f,[],v),L=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(L,t,w,k)}updatePaintArray(t,a,h,f){const v=this.expression.evaluate({zoom:this.zoom},h,f),w=this.expression.evaluate({zoom:this.zoom+1},h,f);this._setPaintValue(t,a,v,w)}_setPaintValue(t,a,h,f){if(this.type==="color"){const v=si(h),w=si(f);for(let k=t;k<a;k++)this.paintVertexArray.emplace(k,v[0],v[1],w[0],w[1])}else{for(let v=t;v<a;v++)this.paintVertexArray.emplace(v,h,f);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(f))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,a){const h=this.useIntegerZoom?Math.floor(a.zoom):a.zoom,f=ie(this.expression.interpolationFactor(h,this.zoom,this.zoom+1),0,1);t.set(f)}getBinding(t,a,h){return new zr(t,a)}}class ao{constructor(t,a,h,f,v,w){this.expression=t,this.type=a,this.useIntegerZoom=h,this.zoom=f,this.layerId=w,this.zoomInPaintVertexArray=new v,this.zoomOutPaintVertexArray=new v}populatePaintArray(t,a,h){const f=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(f,t,a.patterns&&a.patterns[this.layerId],h)}updatePaintArray(t,a,h,f,v){this._setPaintValues(t,a,h.patterns&&h.patterns[this.layerId],v)}_setPaintValues(t,a,h,f){if(!f||!h)return;const{min:v,mid:w,max:k}=h,L=f[v],O=f[w],Z=f[k];if(L&&O&&Z)for(let re=t;re<a;re++)this.zoomInPaintVertexArray.emplace(re,O.tl[0],O.tl[1],O.br[0],O.br[1],L.tl[0],L.tl[1],L.br[0],L.br[1],O.pixelRatio,L.pixelRatio),this.zoomOutPaintVertexArray.emplace(re,O.tl[0],O.tl[1],O.br[0],O.br[1],Z.tl[0],Z.tl[1],Z.br[0],Z.br[1],O.pixelRatio,Z.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Ze.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Ze.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Vo{constructor(t,a,h){this.binders={},this._buffers=[];const f=[];for(const v in t.paint._values){if(!h(v))continue;const w=t.paint.get(v);if(!(w instanceof Xn&&Rn(w.property.specification)))continue;const k=vo(v,t.type),L=w.value,O=w.property.specification.type,Z=w.property.useIntegerZoom,re=w.property.specification["property-type"],he=re==="cross-faded"||re==="cross-faded-data-driven";if(L.kind==="constant")this.binders[v]=he?new Dr(L.value,k):new Lr(L.value,k,O),f.push(`/u_${v}`);else if(L.kind==="source"||he){const de=Ea(v,O,"source");this.binders[v]=he?new ao(L,O,Z,a,de,t.id):new Kn(L,k,O,de),f.push(`/a_${v}`)}else{const de=Ea(v,O,"composite");this.binders[v]=new dn(L,k,O,Z,a,de),f.push(`/z_${v}`)}}this.cacheKey=f.sort().join("")}getMaxValue(t){const a=this.binders[t];return a instanceof Kn||a instanceof dn?a.maxValue:0}populatePaintArrays(t,a,h,f,v){for(const w in this.binders){const k=this.binders[w];(k instanceof Kn||k instanceof dn||k instanceof ao)&&k.populatePaintArray(t,a,h,f,v)}}setConstantPatternPositions(t,a){for(const h in this.binders){const f=this.binders[h];f instanceof Dr&&f.setConstantPatternPositions(t,a)}}updatePaintArrays(t,a,h,f,v){let w=!1;for(const k in t){const L=a.getPositions(k);for(const O of L){const Z=h.feature(O.index);for(const re in this.binders){const he=this.binders[re];if((he instanceof Kn||he instanceof dn||he instanceof ao)&&he.expression.isStateDependent===!0){const de=f.paint.get(re);he.expression=de.value,he.updatePaintArray(O.start,O.end,Z,t[k],v),w=!0}}}}return w}defines(){const t=[];for(const a in this.binders){const h=this.binders[a];(h instanceof Lr||h instanceof Dr)&&t.push(...h.uniformNames.map(f=>`#define HAS_UNIFORM_${f}`))}return t}getBinderAttributes(){const t=[];for(const a in this.binders){const h=this.binders[a];if(h instanceof Kn||h instanceof dn)for(let f=0;f<h.paintVertexAttributes.length;f++)t.push(h.paintVertexAttributes[f].name);else if(h instanceof ao)for(let f=0;f<Ze.members.length;f++)t.push(Ze.members[f].name)}return t}getBinderUniforms(){const t=[];for(const a in this.binders){const h=this.binders[a];if(h instanceof Lr||h instanceof Dr||h instanceof dn)for(const f of h.uniformNames)t.push(f)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,a){const h=[];for(const f in this.binders){const v=this.binders[f];if(v instanceof Lr||v instanceof Dr||v instanceof dn){for(const w of v.uniformNames)if(a[w]){const k=v.getBinding(t,a[w],w);h.push({name:w,property:f,binding:k})}}}return h}setUniforms(t,a,h,f){for(const{name:v,property:w,binding:k}of a)this.binders[w].setUniform(k,f,h.get(w),v)}updatePaintBuffers(t){this._buffers=[];for(const a in this.binders){const h=this.binders[a];if(t&&h instanceof ao){const f=t.fromScale===2?h.zoomInPaintVertexBuffer:h.zoomOutPaintVertexBuffer;f&&this._buffers.push(f)}else(h instanceof Kn||h instanceof dn)&&h.paintVertexBuffer&&this._buffers.push(h.paintVertexBuffer)}}upload(t){for(const a in this.binders){const h=this.binders[a];(h instanceof Kn||h instanceof dn||h instanceof ao)&&h.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const a=this.binders[t];(a instanceof Kn||a instanceof dn||a instanceof ao)&&a.destroy()}}}class Un{constructor(t,a,h=()=>!0){this.programConfigurations={};for(const f of t)this.programConfigurations[f.id]=new Vo(f,a,h);this.needsUpload=!1,this._featureMap=new Er,this._bufferOffset=0}populatePaintArrays(t,a,h,f,v,w){for(const k in this.programConfigurations)this.programConfigurations[k].populatePaintArrays(t,a,f,v,w);a.id!==void 0&&this._featureMap.add(a.id,h,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,a,h,f){for(const v of h)this.needsUpload=this.programConfigurations[v.id].updatePaintArrays(t,this._featureMap,a,v,f)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function vo(i,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace(`${t}-`,"").replace(/-/g,"_")]}function Ea(i,t,a){const h={color:{source:m,composite:Ct},number:{source:Ke,composite:m}},f=function(v){return{"line-pattern":{source:Ae,composite:Ae},"fill-pattern":{source:Ae,composite:Ae},"fill-extrusion-pattern":{source:Ae,composite:Ae}}[v]}(i);return f&&f[a]||h[t][a]}xr("ConstantBinder",Lr),xr("CrossFadedConstantBinder",Dr),xr("SourceExpressionBinder",Kn),xr("CrossFadedCompositeBinder",ao),xr("CompositeExpressionBinder",dn),xr("ProgramConfiguration",Vo,{omit:["_buffers"]}),xr("ProgramConfigurationSet",Un);var en=8192;const ns=Math.pow(2,14)-1,No=-ns-1;function ma(i){const t=en/i.extent,a=i.loadGeometry();for(let h=0;h<a.length;h++){const f=a[h];for(let v=0;v<f.length;v++){const w=f[v],k=Math.round(w.x*t),L=Math.round(w.y*t);w.x=ie(k,No,ns),w.y=ie(L,No,ns),(k<w.x||k>w.x+1||L<w.y||L>w.y+1)&&It("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return a}function Ko(i,t){return{type:i.type,id:i.id,properties:i.properties,geometry:t?ma(i):[]}}function sl(i,t,a,h,f){i.emplaceBack(2*t+(h+1)/2,2*a+(f+1)/2)}class xl{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new b,this.indexArray=new qe,this.segments=new at,this.programConfigurations=new Un(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,h){const f=this.layers[0],v=[];let w=null,k=!1;f.type==="circle"&&(w=f.layout.get("circle-sort-key"),k=!w.isConstant());for(const{feature:L,id:O,index:Z,sourceLayerIndex:re}of t){const he=this.layers[0]._featureFilter.needGeometry,de=Ko(L,he);if(!this.layers[0]._featureFilter.filter(new Hi(this.zoom),de,h))continue;const me=k?w.evaluate(de,{},h):void 0,Ue={id:O,properties:L.properties,type:L.type,sourceLayerIndex:re,index:Z,geometry:he?de.geometry:ma(L),patterns:{},sortKey:me};v.push(Ue)}k&&v.sort((L,O)=>L.sortKey-O.sortKey);for(const L of v){const{geometry:O,index:Z,sourceLayerIndex:re}=L,he=t[Z].feature;this.addFeature(L,O,Z,h),a.featureIndex.insert(he,O,Z,re,this.index)}}update(t,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,et),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,a,h,f){for(const v of a)for(const w of v){const k=w.x,L=w.y;if(k<0||k>=en||L<0||L>=en)continue;const O=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),Z=O.vertexLength;sl(this.layoutVertexArray,k,L,-1,-1),sl(this.layoutVertexArray,k,L,1,-1),sl(this.layoutVertexArray,k,L,1,1),sl(this.layoutVertexArray,k,L,-1,1),this.indexArray.emplaceBack(Z,Z+1,Z+2),this.indexArray.emplaceBack(Z,Z+3,Z+2),O.vertexLength+=4,O.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,h,{},f)}}function ll(i,t){for(let a=0;a<i.length;a++)if(Wa(t,i[a]))return!0;for(let a=0;a<t.length;a++)if(Wa(i,t[a]))return!0;return!!wl(i,t)}function IA(i,t,a){return!!Wa(i,t)||!!xo(t,i,a)}function AA(i,t){if(i.length===1)return Al(t,i[0]);for(let a=0;a<t.length;a++){const h=t[a];for(let f=0;f<h.length;f++)if(Wa(i,h[f]))return!0}for(let a=0;a<i.length;a++)if(Al(t,i[a]))return!0;for(let a=0;a<t.length;a++)if(wl(i,t[a]))return!0;return!1}function bs(i,t,a){if(i.length>1){if(wl(i,t))return!0;for(let h=0;h<t.length;h++)if(xo(t[h],i,a))return!0}for(let h=0;h<i.length;h++)if(xo(i[h],t,a))return!0;return!1}function wl(i,t){if(i.length===0||t.length===0)return!1;for(let a=0;a<i.length-1;a++){const h=i[a],f=i[a+1];for(let v=0;v<t.length-1;v++)if(Vs(h,f,t[v],t[v+1]))return!0}return!1}function Vs(i,t,a,h){return gt(i,a,h)!==gt(t,a,h)&&gt(i,t,a)!==gt(i,t,h)}function xo(i,t,a){const h=a*a;if(t.length===1)return i.distSqr(t[0])<h;for(let f=1;f<t.length;f++)if(Ns(i,t[f-1],t[f])<h)return!0;return!1}function Ns(i,t,a){const h=t.distSqr(a);if(h===0)return i.distSqr(t);const f=((i.x-t.x)*(a.x-t.x)+(i.y-t.y)*(a.y-t.y))/h;return i.distSqr(f<0?t:f>1?a:a.sub(t)._mult(f)._add(t))}function Al(i,t){let a,h,f,v=!1;for(let w=0;w<i.length;w++){a=i[w];for(let k=0,L=a.length-1;k<a.length;L=k++)h=a[k],f=a[L],h.y>t.y!=f.y>t.y&&t.x<(f.x-h.x)*(t.y-h.y)/(f.y-h.y)+h.x&&(v=!v)}return v}function Wa(i,t){let a=!1;for(let h=0,f=i.length-1;h<i.length;f=h++){const v=i[h],w=i[f];v.y>t.y!=w.y>t.y&&t.x<(w.x-v.x)*(t.y-v.y)/(w.y-v.y)+v.x&&(a=!a)}return a}function tn(i,t,a){const h=a[0],f=a[2];if(i.x<h.x&&t.x<h.x||i.x>f.x&&t.x>f.x||i.y<h.y&&t.y<h.y||i.y>f.y&&t.y>f.y)return!1;const v=gt(i,t,a[0]);return v!==gt(i,t,a[1])||v!==gt(i,t,a[2])||v!==gt(i,t,a[3])}function ga(i,t,a){const h=t.paint.get(i).value;return h.kind==="constant"?h.value:a.programConfigurations.get(t.id).getMaxValue(i)}function na(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function ko(i,t,a,h,f){if(!t[0]&&!t[1])return i;const v=Rt.convert(t)._mult(f);a==="viewport"&&v._rotate(-h);const w=[];for(let k=0;k<i.length;k++)w.push(i[k].sub(v));return w}xr("CircleBucket",xl,{omit:["layers"]});const Nc=new On({"circle-sort-key":new Pr(Ut.layout_circle["circle-sort-key"])});var yc={paint:new On({"circle-radius":new Pr(Ut.paint_circle["circle-radius"]),"circle-color":new Pr(Ut.paint_circle["circle-color"]),"circle-blur":new Pr(Ut.paint_circle["circle-blur"]),"circle-opacity":new Pr(Ut.paint_circle["circle-opacity"]),"circle-translate":new Cr(Ut.paint_circle["circle-translate"]),"circle-translate-anchor":new Cr(Ut.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Cr(Ut.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Cr(Ut.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Pr(Ut.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Pr(Ut.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Pr(Ut.paint_circle["circle-stroke-opacity"])}),layout:Nc},Ia=1e-6,Go=typeof Float32Array<"u"?Float32Array:Array;function Kc(){var i=new Go(9);return Go!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i}function Gl(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function XA(i,t,a){var h=t[0],f=t[1],v=t[2],w=t[3],k=t[4],L=t[5],O=t[6],Z=t[7],re=t[8],he=t[9],de=t[10],me=t[11],Ue=t[12],Qe=t[13],Ye=t[14],ot=t[15],nt=a[0],At=a[1],Et=a[2],ft=a[3];return i[0]=nt*h+At*k+Et*re+ft*Ue,i[1]=nt*f+At*L+Et*he+ft*Qe,i[2]=nt*v+At*O+Et*de+ft*Ye,i[3]=nt*w+At*Z+Et*me+ft*ot,i[4]=(nt=a[4])*h+(At=a[5])*k+(Et=a[6])*re+(ft=a[7])*Ue,i[5]=nt*f+At*L+Et*he+ft*Qe,i[6]=nt*v+At*O+Et*de+ft*Ye,i[7]=nt*w+At*Z+Et*me+ft*ot,i[8]=(nt=a[8])*h+(At=a[9])*k+(Et=a[10])*re+(ft=a[11])*Ue,i[9]=nt*f+At*L+Et*he+ft*Qe,i[10]=nt*v+At*O+Et*de+ft*Ye,i[11]=nt*w+At*Z+Et*me+ft*ot,i[12]=(nt=a[12])*h+(At=a[13])*k+(Et=a[14])*re+(ft=a[15])*Ue,i[13]=nt*f+At*L+Et*he+ft*Qe,i[14]=nt*v+At*O+Et*de+ft*Ye,i[15]=nt*w+At*Z+Et*me+ft*ot,i}Math.hypot||(Math.hypot=function(){for(var i=0,t=arguments.length;t--;)i+=arguments[t]*arguments[t];return Math.sqrt(i)});var WA,JA=XA;function Ha(){var i=new Go(3);return Go!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function Xu(i,t,a){var h=new Go(3);return h[0]=i,h[1]=t,h[2]=a,h}function Gc(i,t,a){var h=t[0],f=t[1],v=t[2],w=t[3];return i[0]=a[0]*h+a[4]*f+a[8]*v+a[12]*w,i[1]=a[1]*h+a[5]*f+a[9]*v+a[13]*w,i[2]=a[2]*h+a[6]*f+a[10]*v+a[14]*w,i[3]=a[3]*h+a[7]*f+a[11]*v+a[15]*w,i}function gu(){var i=new Go(4);return Go!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i[3]=1,i}function Wu(i,t){const a=Gc([],[i.x,i.y,0,1],t);return new Rt(a[0]/a[3],a[1]/a[3])}Ha(),WA=new Go(4),Go!=Float32Array&&(WA[0]=0,WA[1]=0,WA[2]=0,WA[3]=0),Ha(),Xu(1,0,0),Xu(0,1,0),gu(),gu(),Kc(),function(){var i;i=new Go(2),Go!=Float32Array&&(i[0]=0,i[1]=0)}();class Sa extends xl{}xr("HeatmapBucket",Sa,{omit:["layers"]});var jc={paint:new On({"heatmap-radius":new Pr(Ut.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Pr(Ut.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Cr(Ut.paint_heatmap["heatmap-intensity"]),"heatmap-color":new fa(Ut.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Cr(Ut.paint_heatmap["heatmap-opacity"])})};function $c(i,{width:t,height:a},h,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==t*a*h)throw new RangeError(`mismatched image size. expected: ${f.length} but got: ${t*a*h}`)}else f=new Uint8Array(t*a*h);return i.width=t,i.height=a,i.data=f,i}function Eh(i,{width:t,height:a},h){if(t===i.width&&a===i.height)return;const f=$c({},{width:t,height:a},h);YA(i,f,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,t),height:Math.min(i.height,a)},h),i.width=t,i.height=a,i.data=f.data}function YA(i,t,a,h,f,v){if(f.width===0||f.height===0)return t;if(f.width>i.width||f.height>i.height||a.x>i.width-f.width||a.y>i.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>t.width||f.height>t.height||h.x>t.width-f.width||h.y>t.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const w=i.data,k=t.data;if(w===k)throw new Error("srcData equals dstData, so image is already copied");for(let L=0;L<f.height;L++){const O=((a.y+L)*i.width+a.x)*v,Z=((h.y+L)*t.width+h.x)*v;for(let re=0;re<f.width*v;re++)k[Z+re]=w[O+re]}return t}class SA{constructor(t,a){$c(this,t,1,a)}resize(t){Eh(this,t,1)}clone(){return new SA({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,a,h,f,v){YA(t,a,h,f,v,1)}}class oa{constructor(t,a){$c(this,t,4,a)}resize(t){Eh(this,t,4)}replace(t,a){a?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new oa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,a,h,f,v){YA(t,a,h,f,v,4)}}function _c(i){const t={},a=i.resolution||256,h=i.clips?i.clips.length:1,f=i.image||new oa({width:a,height:h});if(Math.log(a)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${a}`);const v=(w,k,L)=>{t[i.evaluationKey]=L;const O=i.expression.evaluate(t);f.data[w+k+0]=Math.floor(255*O.r/O.a),f.data[w+k+1]=Math.floor(255*O.g/O.a),f.data[w+k+2]=Math.floor(255*O.b/O.a),f.data[w+k+3]=Math.floor(255*O.a)};if(i.clips)for(let w=0,k=0;w<h;++w,k+=4*a)for(let L=0,O=0;L<a;L++,O+=4){const Z=L/(a-1),{start:re,end:he}=i.clips[w];v(k,O,re*(1-Z)+he*Z)}else for(let w=0,k=0;w<a;w++,k+=4)v(0,k,w/(a-1));return f}xr("AlphaImage",SA),xr("RGBAImage",oa);var vp={paint:new On({"hillshade-illumination-direction":new Cr(Ut.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Cr(Ut.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Cr(Ut.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Cr(Ut.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Cr(Ut.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Cr(Ut.paint_hillshade["hillshade-accent-color"])})};const xp=qi([{name:"a_pos",components:2,type:"Int16"}],4),{members:wp}=xp;var yu={exports:{}};function _u(i,t,a){a=a||2;var h,f,v,w,k,L,O,Z=t&&t.length,re=Z?t[0]*a:i.length,he=Ih(i,0,re,a,!0),de=[];if(!he||he.next===he.prev)return de;if(Z&&(he=function(Ue,Qe,Ye,ot){var nt,At,Et,ft=[];for(nt=0,At=Qe.length;nt<At;nt++)(Et=Ih(Ue,Qe[nt]*ot,nt<At-1?Qe[nt+1]*ot:Ue.length,ot,!1))===Et.next&&(Et.steiner=!0),ft.push(UA(Et));for(ft.sort(vu),nt=0;nt<ft.length;nt++)Ye=Th(ft[nt],Ye);return Ye}(i,t,he,a)),i.length>80*a){h=v=i[0],f=w=i[1];for(var me=a;me<re;me+=a)(k=i[me])<h&&(h=k),(L=i[me+1])<f&&(f=L),k>v&&(v=k),L>w&&(w=L);O=(O=Math.max(v-h,w-f))!==0?32767/O:0}return FA(he,de,a,h,f,O,0),de}function Ih(i,t,a,h,f){var v,w;if(f===Bs(i,t,a,h)>0)for(v=t;v<a;v+=h)w=eh(v,i[v],i[v+1],w);else for(v=a-h;v>=t;v-=h)w=eh(v,i[v],i[v+1],w);return w&&rc(w,w.next)&&(ic(w),w=w.next),w}function TA(i,t){if(!i)return i;t||(t=i);var a,h=i;do if(a=!1,h.steiner||!rc(h,h.next)&&Jn(h.prev,h,h.next)!==0)h=h.next;else{if(ic(h),(h=t=h.prev)===h.next)break;a=!0}while(a||h!==t);return t}function FA(i,t,a,h,f,v,w){if(i){!w&&v&&function(Z,re,he,de){var me=Z;do me.z===0&&(me.z=cA(me.x,me.y,re,he,de)),me.prevZ=me.prev,me.nextZ=me.next,me=me.next;while(me!==Z);me.prevZ.nextZ=null,me.prevZ=null,function(Ue){var Qe,Ye,ot,nt,At,Et,ft,$t,nr=1;do{for(Ye=Ue,Ue=null,At=null,Et=0;Ye;){for(Et++,ot=Ye,ft=0,Qe=0;Qe<nr&&(ft++,ot=ot.nextZ);Qe++);for($t=nr;ft>0||$t>0&&ot;)ft!==0&&($t===0||!ot||Ye.z<=ot.z)?(nt=Ye,Ye=Ye.nextZ,ft--):(nt=ot,ot=ot.nextZ,$t--),At?At.nextZ=nt:Ue=nt,nt.prevZ=At,At=nt;Ye=ot}At.nextZ=null,nr*=2}while(Et>1)}(me)}(i,h,f,v);for(var k,L,O=i;i.prev!==i.next;)if(k=i.prev,L=i.next,v?ec(i,h,f,v):Sh(i))t.push(k.i/a|0),t.push(i.i/a|0),t.push(L.i/a|0),ic(i),i=L.next,O=L.next;else if((i=L)===O){w?w===1?FA(i=Ju(TA(i),t,a),t,a,h,f,v,2):w===2&&Po(i,t,a,h,f,v):FA(TA(i),t,a,h,f,v,1);break}}}function Sh(i){var t=i.prev,a=i,h=i.next;if(Jn(t,a,h)>=0)return!1;for(var f=t.x,v=a.x,w=h.x,k=t.y,L=a.y,O=h.y,Z=f<v?f<w?f:w:v<w?v:w,re=k<L?k<O?k:O:L<O?L:O,he=f>v?f>w?f:w:v>w?v:w,de=k>L?k>O?k:O:L>O?L:O,me=h.next;me!==t;){if(me.x>=Z&&me.x<=he&&me.y>=re&&me.y<=de&&tc(f,k,v,L,w,O,me.x,me.y)&&Jn(me.prev,me,me.next)>=0)return!1;me=me.next}return!0}function ec(i,t,a,h){var f=i.prev,v=i,w=i.next;if(Jn(f,v,w)>=0)return!1;for(var k=f.x,L=v.x,O=w.x,Z=f.y,re=v.y,he=w.y,de=k<L?k<O?k:O:L<O?L:O,me=Z<re?Z<he?Z:he:re<he?re:he,Ue=k>L?k>O?k:O:L>O?L:O,Qe=Z>re?Z>he?Z:he:re>he?re:he,Ye=cA(de,me,t,a,h),ot=cA(Ue,Qe,t,a,h),nt=i.prevZ,At=i.nextZ;nt&&nt.z>=Ye&&At&&At.z<=ot;){if(nt.x>=de&&nt.x<=Ue&&nt.y>=me&&nt.y<=Qe&&nt!==f&&nt!==w&&tc(k,Z,L,re,O,he,nt.x,nt.y)&&Jn(nt.prev,nt,nt.next)>=0||(nt=nt.prevZ,At.x>=de&&At.x<=Ue&&At.y>=me&&At.y<=Qe&&At!==f&&At!==w&&tc(k,Z,L,re,O,he,At.x,At.y)&&Jn(At.prev,At,At.next)>=0))return!1;At=At.nextZ}for(;nt&&nt.z>=Ye;){if(nt.x>=de&&nt.x<=Ue&&nt.y>=me&&nt.y<=Qe&&nt!==f&&nt!==w&&tc(k,Z,L,re,O,he,nt.x,nt.y)&&Jn(nt.prev,nt,nt.next)>=0)return!1;nt=nt.prevZ}for(;At&&At.z<=ot;){if(At.x>=de&&At.x<=Ue&&At.y>=me&&At.y<=Qe&&At!==f&&At!==w&&tc(k,Z,L,re,O,he,At.x,At.y)&&Jn(At.prev,At,At.next)>=0)return!1;At=At.nextZ}return!0}function Ju(i,t,a){var h=i;do{var f=h.prev,v=h.next.next;!rc(f,v)&&qc(f,h,h.next,v)&&kA(f,v)&&kA(v,f)&&(t.push(f.i/a|0),t.push(h.i/a|0),t.push(v.i/a|0),ic(h),ic(h.next),h=i=v),h=h.next}while(h!==i);return TA(h)}function Po(i,t,a,h,f,v){var w=i;do{for(var k=w.next.next;k!==w.prev;){if(w.i!==k.i&&Yu(w,k)){var L=Xc(w,k);return w=TA(w,w.next),L=TA(L,L.next),FA(w,t,a,h,f,v,0),void FA(L,t,a,h,f,v,0)}k=k.next}w=w.next}while(w!==i)}function vu(i,t){return i.x-t.x}function Th(i,t){var a=function(f,v){var w,k=v,L=f.x,O=f.y,Z=-1/0;do{if(O<=k.y&&O>=k.next.y&&k.next.y!==k.y){var re=k.x+(O-k.y)*(k.next.x-k.x)/(k.next.y-k.y);if(re<=L&&re>Z&&(Z=re,w=k.x<k.next.x?k:k.next,re===L))return w}k=k.next}while(k!==v);if(!w)return null;var he,de=w,me=w.x,Ue=w.y,Qe=1/0;k=w;do L>=k.x&&k.x>=me&&L!==k.x&&tc(O<Ue?L:Z,O,me,Ue,O<Ue?Z:L,O,k.x,k.y)&&(he=Math.abs(O-k.y)/(L-k.x),kA(k,f)&&(he<Qe||he===Qe&&(k.x>w.x||k.x===w.x&&xu(w,k)))&&(w=k,Qe=he)),k=k.next;while(k!==de);return w}(i,t);if(!a)return t;var h=Xc(a,i);return TA(h,h.next),TA(a,a.next)}function xu(i,t){return Jn(i.prev,i,t.prev)<0&&Jn(t.next,i,i.next)<0}function cA(i,t,a,h,f){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-a)*f|0)|i<<8))|i<<4))|i<<2))|i<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-h)*f|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function UA(i){var t=i,a=i;do(t.x<a.x||t.x===a.x&&t.y<a.y)&&(a=t),t=t.next;while(t!==i);return a}function tc(i,t,a,h,f,v,w,k){return(f-w)*(t-k)>=(i-w)*(v-k)&&(i-w)*(h-k)>=(a-w)*(t-k)&&(a-w)*(v-k)>=(f-w)*(h-k)}function Yu(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!function(a,h){var f=a;do{if(f.i!==a.i&&f.next.i!==a.i&&f.i!==h.i&&f.next.i!==h.i&&qc(f,f.next,a,h))return!0;f=f.next}while(f!==a);return!1}(i,t)&&(kA(i,t)&&kA(t,i)&&function(a,h){var f=a,v=!1,w=(a.x+h.x)/2,k=(a.y+h.y)/2;do f.y>k!=f.next.y>k&&f.next.y!==f.y&&w<(f.next.x-f.x)*(k-f.y)/(f.next.y-f.y)+f.x&&(v=!v),f=f.next;while(f!==a);return v}(i,t)&&(Jn(i.prev,i,t.prev)||Jn(i,t.prev,t))||rc(i,t)&&Jn(i.prev,i,i.next)>0&&Jn(t.prev,t,t.next)>0)}function Jn(i,t,a){return(t.y-i.y)*(a.x-t.x)-(t.x-i.x)*(a.y-t.y)}function rc(i,t){return i.x===t.x&&i.y===t.y}function qc(i,t,a,h){var f=MA(Jn(i,t,a)),v=MA(Jn(i,t,h)),w=MA(Jn(a,h,i)),k=MA(Jn(a,h,t));return f!==v&&w!==k||!(f!==0||!Zc(i,a,t))||!(v!==0||!Zc(i,h,t))||!(w!==0||!Zc(a,i,h))||!(k!==0||!Zc(a,t,h))}function Zc(i,t,a){return t.x<=Math.max(i.x,a.x)&&t.x>=Math.min(i.x,a.x)&&t.y<=Math.max(i.y,a.y)&&t.y>=Math.min(i.y,a.y)}function MA(i){return i>0?1:i<0?-1:0}function kA(i,t){return Jn(i.prev,i,i.next)<0?Jn(i,t,i.next)>=0&&Jn(i,i.prev,t)>=0:Jn(i,t,i.prev)<0||Jn(i,i.next,t)<0}function Xc(i,t){var a=new Wc(i.i,i.x,i.y),h=new Wc(t.i,t.x,t.y),f=i.next,v=t.prev;return i.next=t,t.prev=i,a.next=f,f.prev=a,h.next=a,a.prev=h,v.next=h,h.prev=v,h}function eh(i,t,a,h){var f=new Wc(i,t,a);return h?(f.next=h.next,f.prev=h,h.next.prev=f,h.next=f):(f.prev=f,f.next=f),f}function ic(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Wc(i,t,a){this.i=i,this.x=t,this.y=a,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Bs(i,t,a,h){for(var f=0,v=t,w=a-h;v<a;v+=h)f+=(i[w]-i[v])*(i[v+1]+i[w+1]),w=v;return f}function vc(i,t,a,h,f){wu(i,t,a||0,h||i.length-1,f||bp)}function wu(i,t,a,h,f){for(;h>a;){if(h-a>600){var v=h-a+1,w=t-a+1,k=Math.log(v),L=.5*Math.exp(2*k/3),O=.5*Math.sqrt(k*L*(v-L)/v)*(w-v/2<0?-1:1);wu(i,t,Math.max(a,Math.floor(t-w*L/v+O)),Math.min(h,Math.floor(t+(v-w)*L/v+O)),f)}var Z=i[t],re=a,he=h;for(PA(i,a,t),f(i[h],Z)>0&&PA(i,a,h);re<he;){for(PA(i,re,he),re++,he--;f(i[re],Z)<0;)re++;for(;f(i[he],Z)>0;)he--}f(i[a],Z)===0?PA(i,a,he):PA(i,++he,h),he<=t&&(a=he+1),t<=he&&(h=he-1)}}function PA(i,t,a){var h=i[t];i[t]=i[a],i[a]=h}function bp(i,t){return i<t?-1:i>t?1:0}function bu(i,t){const a=i.length;if(a<=1)return[i];const h=[];let f,v;for(let w=0;w<a;w++){const k=Zt(i[w]);k!==0&&(i[w].area=Math.abs(k),v===void 0&&(v=k<0),v===k<0?(f&&h.push(f),f=[i[w]]):f.push(i[w]))}if(f&&h.push(f),t>1)for(let w=0;w<h.length;w++)h[w].length<=t||(vc(h[w],t,1,h[w].length-1,xc),h[w]=h[w].slice(0,t));return h}function xc(i,t){return t.area-i.area}function th(i,t,a){const h=a.patternDependencies;let f=!1;for(const v of t){const w=v.paint.get(`${i}-pattern`);w.isConstant()||(f=!0);const k=w.constantOr(null);k&&(f=!0,h[k.to]=!0,h[k.from]=!0)}return f}function Bu(i,t,a,h,f){const v=f.patternDependencies;for(const w of t){const k=w.paint.get(`${i}-pattern`).value;if(k.kind!=="constant"){let L=k.evaluate({zoom:h-1},a,{},f.availableImages),O=k.evaluate({zoom:h},a,{},f.availableImages),Z=k.evaluate({zoom:h+1},a,{},f.availableImages);L=L&&L.name?L.name:L,O=O&&O.name?O.name:O,Z=Z&&Z.name?Z.name:Z,v[L]=!0,v[O]=!0,v[Z]=!0,a.patterns[w.id]={min:L,mid:O,max:Z}}}return a}yu.exports=_u,yu.exports.default=_u,_u.deviation=function(i,t,a,h){var f=t&&t.length,v=Math.abs(Bs(i,0,f?t[0]*a:i.length,a));if(f)for(var w=0,k=t.length;w<k;w++)v-=Math.abs(Bs(i,t[w]*a,w<k-1?t[w+1]*a:i.length,a));var L=0;for(w=0;w<h.length;w+=3){var O=h[w]*a,Z=h[w+1]*a,re=h[w+2]*a;L+=Math.abs((i[O]-i[re])*(i[Z+1]-i[O+1])-(i[O]-i[Z])*(i[re+1]-i[O+1]))}return v===0&&L===0?0:Math.abs((L-v)/v)},_u.flatten=function(i){for(var t=i[0][0].length,a={vertices:[],holes:[],dimensions:t},h=0,f=0;f<i.length;f++){for(var v=0;v<i[f].length;v++)for(var w=0;w<t;w++)a.vertices.push(i[f][v][w]);f>0&&a.holes.push(h+=i[f-1].length)}return a};class wc{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new M,this.indexArray=new qe,this.indexArray2=new ke,this.programConfigurations=new Un(t.layers,t.zoom),this.segments=new at,this.segments2=new at,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,h){this.hasPattern=th("fill",this.layers,a);const f=this.layers[0].layout.get("fill-sort-key"),v=!f.isConstant(),w=[];for(const{feature:k,id:L,index:O,sourceLayerIndex:Z}of t){const re=this.layers[0]._featureFilter.needGeometry,he=Ko(k,re);if(!this.layers[0]._featureFilter.filter(new Hi(this.zoom),he,h))continue;const de=v?f.evaluate(he,{},h,a.availableImages):void 0,me={id:L,properties:k.properties,type:k.type,sourceLayerIndex:Z,index:O,geometry:re?he.geometry:ma(k),patterns:{},sortKey:de};w.push(me)}v&&w.sort((k,L)=>k.sortKey-L.sortKey);for(const k of w){const{geometry:L,index:O,sourceLayerIndex:Z}=k;if(this.hasPattern){const re=Bu("fill",this.layers,k,this.zoom,a);this.patternFeatures.push(re)}else this.addFeature(k,L,O,h,{});a.featureIndex.insert(t[O].feature,L,O,Z,this.index)}}update(t,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,h)}addFeatures(t,a,h){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,a,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,wp),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,a,h,f,v){for(const w of bu(a,500)){let k=0;for(const de of w)k+=de.length;const L=this.segments.prepareSegment(k,this.layoutVertexArray,this.indexArray),O=L.vertexLength,Z=[],re=[];for(const de of w){if(de.length===0)continue;de!==w[0]&&re.push(Z.length/2);const me=this.segments2.prepareSegment(de.length,this.layoutVertexArray,this.indexArray2),Ue=me.vertexLength;this.layoutVertexArray.emplaceBack(de[0].x,de[0].y),this.indexArray2.emplaceBack(Ue+de.length-1,Ue),Z.push(de[0].x),Z.push(de[0].y);for(let Qe=1;Qe<de.length;Qe++)this.layoutVertexArray.emplaceBack(de[Qe].x,de[Qe].y),this.indexArray2.emplaceBack(Ue+Qe-1,Ue+Qe),Z.push(de[Qe].x),Z.push(de[Qe].y);me.vertexLength+=de.length,me.primitiveLength+=de.length}const he=yu.exports(Z,re);for(let de=0;de<he.length;de+=3)this.indexArray.emplaceBack(O+he[de],O+he[de+1],O+he[de+2]);L.vertexLength+=k,L.primitiveLength+=he.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,h,v,f)}}xr("FillBucket",wc,{omit:["layers","patternFeatures"]});const rh=new On({"fill-sort-key":new Pr(Ut.layout_fill["fill-sort-key"])});var Fh={paint:new On({"fill-antialias":new Cr(Ut.paint_fill["fill-antialias"]),"fill-opacity":new Pr(Ut.paint_fill["fill-opacity"]),"fill-color":new Pr(Ut.paint_fill["fill-color"]),"fill-outline-color":new Pr(Ut.paint_fill["fill-outline-color"]),"fill-translate":new Cr(Ut.paint_fill["fill-translate"]),"fill-translate-anchor":new Cr(Ut.paint_fill["fill-translate-anchor"]),"fill-pattern":new no(Ut.paint_fill["fill-pattern"])}),layout:rh};const ih=qi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),nc=qi([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Uh}=ih;var jl={},QA=Rt,os=oc;function oc(i,t,a,h,f){this.properties={},this.extent=a,this.type=0,this._pbf=i,this._geometry=-1,this._keys=h,this._values=f,i.readFields(Mh,this,t)}function Mh(i,t,a){i==1?t.id=a.readVarint():i==2?function(h,f){for(var v=h.readVarint()+h.pos;h.pos<v;){var w=f._keys[h.readVarint()],k=f._values[h.readVarint()];f.properties[w]=k}}(a,t):i==3?t.type=a.readVarint():i==4&&(t._geometry=a.pos)}function Bp(i){for(var t,a,h=0,f=0,v=i.length,w=v-1;f<v;w=f++)h+=((a=i[w]).x-(t=i[f]).x)*(t.y+a.y);return h}oc.types=["Unknown","Point","LineString","Polygon"],oc.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var t,a=i.readVarint()+i.pos,h=1,f=0,v=0,w=0,k=[];i.pos<a;){if(f<=0){var L=i.readVarint();h=7&L,f=L>>3}if(f--,h===1||h===2)v+=i.readSVarint(),w+=i.readSVarint(),h===1&&(t&&k.push(t),t=[]),t.push(new QA(v,w));else{if(h!==7)throw new Error("unknown command "+h);t&&t.push(t[0].clone())}}return t&&k.push(t),k},oc.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var t=i.readVarint()+i.pos,a=1,h=0,f=0,v=0,w=1/0,k=-1/0,L=1/0,O=-1/0;i.pos<t;){if(h<=0){var Z=i.readVarint();a=7&Z,h=Z>>3}if(h--,a===1||a===2)(f+=i.readSVarint())<w&&(w=f),f>k&&(k=f),(v+=i.readSVarint())<L&&(L=v),v>O&&(O=v);else if(a!==7)throw new Error("unknown command "+a)}return[w,L,k,O]},oc.prototype.toGeoJSON=function(i,t,a){var h,f,v=this.extent*Math.pow(2,a),w=this.extent*i,k=this.extent*t,L=this.loadGeometry(),O=oc.types[this.type];function Z(de){for(var me=0;me<de.length;me++){var Ue=de[me];de[me]=[360*(Ue.x+w)/v-180,360/Math.PI*Math.atan(Math.exp((180-360*(Ue.y+k)/v)*Math.PI/180))-90]}}switch(this.type){case 1:var re=[];for(h=0;h<L.length;h++)re[h]=L[h][0];Z(L=re);break;case 2:for(h=0;h<L.length;h++)Z(L[h]);break;case 3:for(L=function(de){var me=de.length;if(me<=1)return[de];for(var Ue,Qe,Ye=[],ot=0;ot<me;ot++){var nt=Bp(de[ot]);nt!==0&&(Qe===void 0&&(Qe=nt<0),Qe===nt<0?(Ue&&Ye.push(Ue),Ue=[de[ot]]):Ue.push(de[ot]))}return Ue&&Ye.push(Ue),Ye}(L),h=0;h<L.length;h++)for(f=0;f<L[h].length;f++)Z(L[h][f])}L.length===1?L=L[0]:O="Multi"+O;var he={type:"Feature",geometry:{type:O,coordinates:L},properties:this.properties};return"id"in this&&(he.id=this.id),he};var bc=os,Cu=kh;function kh(i,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(Cp,this,t),this.length=this._features.length}function Cp(i,t,a){i===15?t.version=a.readVarint():i===1?t.name=a.readString():i===5?t.extent=a.readVarint():i===2?t._features.push(a.pos):i===3?t._keys.push(a.readString()):i===4&&t._values.push(function(h){for(var f=null,v=h.readVarint()+h.pos;h.pos<v;){var w=h.readVarint()>>3;f=w===1?h.readString():w===2?h.readFloat():w===3?h.readDouble():w===4?h.readVarint64():w===5?h.readVarint():w===6?h.readSVarint():w===7?h.readBoolean():null}return f}(a))}kh.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var t=this._pbf.readVarint()+this._pbf.pos;return new bc(this._pbf,t,this.extent,this._keys,this._values)};var Bc=Cu;function Ph(i,t,a){if(i===3){var h=new Bc(a,a.readVarint()+a.pos);h.length&&(t[h.name]=h)}}jl.VectorTile=function(i,t){this.layers=i.readFields(Ph,{},t)},jl.VectorTileFeature=os,jl.VectorTileLayer=Cu;const jo=jl.VectorTileFeature.types,wo=Math.pow(2,13);function $l(i,t,a,h,f,v,w,k){i.emplaceBack(t,a,2*Math.floor(h*wo)+w,f*wo*2,v*wo*2,Math.round(k))}class bl{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Q,this.centroidVertexArray=new d,this.indexArray=new qe,this.programConfigurations=new Un(t.layers,t.zoom),this.segments=new at,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,h){this.features=[],this.hasPattern=th("fill-extrusion",this.layers,a);for(const{feature:f,id:v,index:w,sourceLayerIndex:k}of t){const L=this.layers[0]._featureFilter.needGeometry,O=Ko(f,L);if(!this.layers[0]._featureFilter.filter(new Hi(this.zoom),O,h))continue;const Z={id:v,sourceLayerIndex:k,index:w,geometry:L?O.geometry:ma(f),properties:f.properties,type:f.type,patterns:{}};this.hasPattern?this.features.push(Bu("fill-extrusion",this.layers,Z,this.zoom,a)):this.addFeature(Z,Z.geometry,w,h,{}),a.featureIndex.insert(f,Z.geometry,w,k,this.index,!0)}}addFeatures(t,a,h){for(const f of this.features){const{geometry:v}=f;this.addFeature(f,v,f.index,a,h)}}update(t,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,h)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Uh),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,nc.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,a,h,f,v){const w={x:0,y:0,vertexCount:0};for(const k of bu(a,500)){let L=0;for(const me of k)L+=me.length;let O=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const me of k){if(me.length===0||Jc(me))continue;let Ue=0;for(let Qe=0;Qe<me.length;Qe++){const Ye=me[Qe];if(Qe>=1){const ot=me[Qe-1];if(!uA(Ye,ot)){O.vertexLength+4>at.MAX_VERTEX_ARRAY_LENGTH&&(O=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const nt=Ye.sub(ot)._perp()._unit(),At=ot.dist(Ye);Ue+At>32768&&(Ue=0),$l(this.layoutVertexArray,Ye.x,Ye.y,nt.x,nt.y,0,0,Ue),$l(this.layoutVertexArray,Ye.x,Ye.y,nt.x,nt.y,0,1,Ue),w.x+=2*Ye.x,w.y+=2*Ye.y,w.vertexCount+=2,Ue+=At,$l(this.layoutVertexArray,ot.x,ot.y,nt.x,nt.y,0,0,Ue),$l(this.layoutVertexArray,ot.x,ot.y,nt.x,nt.y,0,1,Ue),w.x+=2*ot.x,w.y+=2*ot.y,w.vertexCount+=2;const Et=O.vertexLength;this.indexArray.emplaceBack(Et,Et+2,Et+1),this.indexArray.emplaceBack(Et+1,Et+2,Et+3),O.vertexLength+=4,O.primitiveLength+=2}}}}if(O.vertexLength+L>at.MAX_VERTEX_ARRAY_LENGTH&&(O=this.segments.prepareSegment(L,this.layoutVertexArray,this.indexArray)),jo[t.type]!=="Polygon")continue;const Z=[],re=[],he=O.vertexLength;for(const me of k)if(me.length!==0){me!==k[0]&&re.push(Z.length/2);for(let Ue=0;Ue<me.length;Ue++){const Qe=me[Ue];$l(this.layoutVertexArray,Qe.x,Qe.y,0,0,1,1,0),w.x+=Qe.x,w.y+=Qe.y,w.vertexCount+=1,Z.push(Qe.x),Z.push(Qe.y)}}const de=yu.exports(Z,re);for(let me=0;me<de.length;me+=3)this.indexArray.emplaceBack(he+de[me],he+de[me+2],he+de[me+1]);O.primitiveLength+=de.length/3,O.vertexLength+=L}for(let k=0;k<w.vertexCount;k++)this.centroidVertexArray.emplaceBack(Math.floor(w.x/w.vertexCount),Math.floor(w.y/w.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,h,v,f)}}function uA(i,t){return i.x===t.x&&(i.x<0||i.x>en)||i.y===t.y&&(i.y<0||i.y>en)}function Jc(i){return i.every(t=>t.x<0)||i.every(t=>t.x>en)||i.every(t=>t.y<0)||i.every(t=>t.y>en)}xr("FillExtrusionBucket",bl,{omit:["layers","features"]});var ql={paint:new On({"fill-extrusion-opacity":new Cr(Ut["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Pr(Ut["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Cr(Ut["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Cr(Ut["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new no(Ut["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Pr(Ut["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Pr(Ut["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Cr(Ut["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function Cc(i,t){return i.x*t.x+i.y*t.y}function nh(i,t){if(i.length===1){let a=0;const h=t[a++];let f;for(;!f||h.equals(f);)if(f=t[a++],!f)return 1/0;for(;a<t.length;a++){const v=t[a],w=i[0],k=f.sub(h),L=v.sub(h),O=w.sub(h),Z=Cc(k,k),re=Cc(k,L),he=Cc(L,L),de=Cc(O,k),me=Cc(O,L),Ue=Z*he-re*re,Qe=(he*de-re*me)/Ue,Ye=(Z*me-re*de)/Ue,ot=h.z*(1-Qe-Ye)+f.z*Qe+v.z*Ye;if(isFinite(ot))return ot}return 1/0}{let a=1/0;for(const h of t)a=Math.min(a,h.z);return a}}const Qh=qi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Eu}=Qh,Yc=qi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Dh}=Yc,Ec=jl.VectorTileFeature.types,Hn=Math.cos(Math.PI/180*37.5),oh=Math.pow(2,14)/.5;class Ic{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(a=>a.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(a=>{this.gradients[a.id]={}}),this.layoutVertexArray=new R,this.layoutVertexArray2=new J,this.indexArray=new qe,this.programConfigurations=new Un(t.layers,t.zoom),this.segments=new at,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(t,a,h){this.hasPattern=th("line",this.layers,a);const f=this.layers[0].layout.get("line-sort-key"),v=!f.isConstant(),w=[];for(const{feature:k,id:L,index:O,sourceLayerIndex:Z}of t){const re=this.layers[0]._featureFilter.needGeometry,he=Ko(k,re);if(!this.layers[0]._featureFilter.filter(new Hi(this.zoom),he,h))continue;const de=v?f.evaluate(he,{},h):void 0,me={id:L,properties:k.properties,type:k.type,sourceLayerIndex:Z,index:O,geometry:re?he.geometry:ma(k),patterns:{},sortKey:de};w.push(me)}v&&w.sort((k,L)=>k.sortKey-L.sortKey);for(const k of w){const{geometry:L,index:O,sourceLayerIndex:Z}=k;if(this.hasPattern){const re=Bu("line",this.layers,k,this.zoom,a);this.patternFeatures.push(re)}else this.addFeature(k,L,O,h,{});a.featureIndex.insert(t[O].feature,L,O,Z,this.index)}}update(t,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,a,this.stateDependentLayers,h)}addFeatures(t,a,h){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,a,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Dh)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Eu),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,a,h,f,v){const w=this.layers[0].layout,k=w.get("line-join").evaluate(t,{}),L=w.get("line-cap"),O=w.get("line-miter-limit"),Z=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const re of a)this.addLine(re,t,k,L,O,Z);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,h,v,f)}addLine(t,a,h,f,v,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Ye=0;Ye<t.length-1;Ye++)this.totalDistance+=t[Ye].dist(t[Ye+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const k=Ec[a.type]==="Polygon";let L=t.length;for(;L>=2&&t[L-1].equals(t[L-2]);)L--;let O=0;for(;O<L-1&&t[O].equals(t[O+1]);)O++;if(L<(k?3:2))return;h==="bevel"&&(v=1.05);const Z=this.overscaling<=16?122880/(512*this.overscaling):0,re=this.segments.prepareSegment(10*L,this.layoutVertexArray,this.indexArray);let he,de,me,Ue,Qe;this.e1=this.e2=-1,k&&(he=t[L-2],Qe=t[O].sub(he)._unit()._perp());for(let Ye=O;Ye<L;Ye++){if(me=Ye===L-1?k?t[O+1]:void 0:t[Ye+1],me&&t[Ye].equals(me))continue;Qe&&(Ue=Qe),he&&(de=he),he=t[Ye],Qe=me?me.sub(he)._unit()._perp():Ue,Ue=Ue||Qe;let ot=Ue.add(Qe);ot.x===0&&ot.y===0||ot._unit();const nt=Ue.x*Qe.x+Ue.y*Qe.y,At=ot.x*Qe.x+ot.y*Qe.y,Et=At!==0?1/At:1/0,ft=2*Math.sqrt(2-2*At),$t=At<Hn&&de&&me,nr=Ue.x*Qe.y-Ue.y*Qe.x>0;if($t&&Ye>O){const Kt=he.dist(de);if(Kt>2*Z){const Wt=he.sub(he.sub(de)._mult(Z/Kt)._round());this.updateDistance(de,Wt),this.addCurrentVertex(Wt,Ue,0,0,re),de=Wt}}const Xt=de&&me;let qt=Xt?h:k?"butt":f;if(Xt&&qt==="round"&&(Et<w?qt="miter":Et<=2&&(qt="fakeround")),qt==="miter"&&Et>v&&(qt="bevel"),qt==="bevel"&&(Et>2&&(qt="flipbevel"),Et<v&&(qt="miter")),de&&this.updateDistance(de,he),qt==="miter")ot._mult(Et),this.addCurrentVertex(he,ot,0,0,re);else if(qt==="flipbevel"){if(Et>100)ot=Qe.mult(-1);else{const Kt=Et*Ue.add(Qe).mag()/Ue.sub(Qe).mag();ot._perp()._mult(Kt*(nr?-1:1))}this.addCurrentVertex(he,ot,0,0,re),this.addCurrentVertex(he,ot.mult(-1),0,0,re)}else if(qt==="bevel"||qt==="fakeround"){const Kt=-Math.sqrt(Et*Et-1),Wt=nr?Kt:0,Yt=nr?0:Kt;if(de&&this.addCurrentVertex(he,Ue,Wt,Yt,re),qt==="fakeround"){const Ot=Math.round(180*ft/Math.PI/20);for(let Ir=1;Ir<Ot;Ir++){let gr=Ir/Ot;if(gr!==.5){const yi=gr-.5;gr+=gr*yi*(gr-1)*((1.0904+nt*(nt*(3.55645-1.43519*nt)-3.2452))*yi*yi+(.848013+nt*(.215638*nt-1.06021)))}const Jr=Qe.sub(Ue)._mult(gr)._add(Ue)._unit()._mult(nr?-1:1);this.addHalfVertex(he,Jr.x,Jr.y,!1,nr,0,re)}}me&&this.addCurrentVertex(he,Qe,-Wt,-Yt,re)}else if(qt==="butt")this.addCurrentVertex(he,ot,0,0,re);else if(qt==="square"){const Kt=de?1:-1;this.addCurrentVertex(he,ot,Kt,Kt,re)}else qt==="round"&&(de&&(this.addCurrentVertex(he,Ue,0,0,re),this.addCurrentVertex(he,Ue,1,1,re,!0)),me&&(this.addCurrentVertex(he,Qe,-1,-1,re,!0),this.addCurrentVertex(he,Qe,0,0,re)));if($t&&Ye<L-1){const Kt=he.dist(me);if(Kt>2*Z){const Wt=he.add(me.sub(he)._mult(Z/Kt)._round());this.updateDistance(he,Wt),this.addCurrentVertex(Wt,Qe,0,0,re),he=Wt}}}}addCurrentVertex(t,a,h,f,v,w=!1){const k=a.y*f-a.x,L=-a.y-a.x*f;this.addHalfVertex(t,a.x+a.y*h,a.y-a.x*h,w,!1,h,v),this.addHalfVertex(t,k,L,w,!0,-f,v),this.distance>oh/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(t,a,h,f,v,w))}addHalfVertex({x:t,y:a},h,f,v,w,k,L){const O=.5*(this.lineClips?this.scaledDistance*(oh-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(v?1:0),(a<<1)+(w?1:0),Math.round(63*h)+128,Math.round(63*f)+128,1+(k===0?0:k<0?-1:1)|(63&O)<<2,O>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const Z=L.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,Z),L.primitiveLength++),w?this.e2=Z:this.e1=Z}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,a){this.distance+=t.dist(a),this.updateScaledDistance()}}xr("LineBucket",Ic,{omit:["layers","patternFeatures"]});const Vn=new On({"line-cap":new Cr(Ut.layout_line["line-cap"]),"line-join":new Pr(Ut.layout_line["line-join"]),"line-miter-limit":new Cr(Ut.layout_line["line-miter-limit"]),"line-round-limit":new Cr(Ut.layout_line["line-round-limit"]),"line-sort-key":new Pr(Ut.layout_line["line-sort-key"])});var ah={paint:new On({"line-opacity":new Pr(Ut.paint_line["line-opacity"]),"line-color":new Pr(Ut.paint_line["line-color"]),"line-translate":new Cr(Ut.paint_line["line-translate"]),"line-translate-anchor":new Cr(Ut.paint_line["line-translate-anchor"]),"line-width":new Pr(Ut.paint_line["line-width"]),"line-gap-width":new Pr(Ut.paint_line["line-gap-width"]),"line-offset":new Pr(Ut.paint_line["line-offset"]),"line-blur":new Pr(Ut.paint_line["line-blur"]),"line-dasharray":new Hs(Ut.paint_line["line-dasharray"]),"line-pattern":new no(Ut.paint_line["line-pattern"]),"line-gradient":new fa(Ut.paint_line["line-gradient"])}),layout:Vn};const Zl=new class extends Pr{possiblyEvaluate(i,t){return t=new Hi(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,zoomHistory:t.zoomHistory,transition:t.transition}),super.possiblyEvaluate(i,t)}evaluate(i,t,a,h){return t=ze({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(i,t,a,h)}}(ah.paint.properties["line-width"].specification);function hA(i,t){return t>0?t+2*i:i}Zl.useIntegerZoom=!0;const Lh=qi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Ep=qi([{name:"a_projected_pos",components:3,type:"Float32"}],4);qi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Ip=qi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);qi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const zh=qi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Sp=qi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function sh(i,t,a){return i.sections.forEach(h=>{h.text=function(f,v,w){const k=v.layout.get("text-transform").evaluate(w,{});return k==="uppercase"?f=f.toLocaleUpperCase():k==="lowercase"&&(f=f.toLocaleLowerCase()),da.applyArabicShaping&&(f=da.applyArabicShaping(f)),f}(h.text,t,a)}),i}qi([{name:"triangle",components:3,type:"Uint16"}]),qi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),qi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),qi([{type:"Float32",name:"offsetX"}]),qi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const ac={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};var aa=24,lh=fn,Rh=function(i,t,a,h,f){var v,w,k=8*f-h-1,L=(1<<k)-1,O=L>>1,Z=-7,re=a?f-1:0,he=a?-1:1,de=i[t+re];for(re+=he,v=de&(1<<-Z)-1,de>>=-Z,Z+=k;Z>0;v=256*v+i[t+re],re+=he,Z-=8);for(w=v&(1<<-Z)-1,v>>=-Z,Z+=h;Z>0;w=256*w+i[t+re],re+=he,Z-=8);if(v===0)v=1-O;else{if(v===L)return w?NaN:1/0*(de?-1:1);w+=Math.pow(2,h),v-=O}return(de?-1:1)*w*Math.pow(2,v-h)},Sc=function(i,t,a,h,f,v){var w,k,L,O=8*v-f-1,Z=(1<<O)-1,re=Z>>1,he=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,de=h?0:v-1,me=h?1:-1,Ue=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(k=isNaN(t)?1:0,w=Z):(w=Math.floor(Math.log(t)/Math.LN2),t*(L=Math.pow(2,-w))<1&&(w--,L*=2),(t+=w+re>=1?he/L:he*Math.pow(2,1-re))*L>=2&&(w++,L/=2),w+re>=Z?(k=0,w=Z):w+re>=1?(k=(t*L-1)*Math.pow(2,f),w+=re):(k=t*Math.pow(2,re-1)*Math.pow(2,f),w=0));f>=8;i[a+de]=255&k,de+=me,k/=256,f-=8);for(w=w<<f|k,O+=f;O>0;i[a+de]=255&w,de+=me,w/=256,O-=8);i[a+de-me]|=128*Ue};function fn(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}fn.Varint=0,fn.Fixed64=1,fn.Bytes=2,fn.Fixed32=5;var pA,Ah=4294967296,Oh=1/Ah,Hh=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function cl(i){return i.type===fn.Bytes?i.readVarint()+i.pos:i.pos+1}function dA(i,t,a){return a?4294967296*t+(i>>>0):4294967296*(t>>>0)+(i>>>0)}function DA(i,t,a){var h=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));a.realloc(h);for(var f=a.pos-1;f>=i;f--)a.buf[f+h]=a.buf[f]}function eu(i,t){for(var a=0;a<i.length;a++)t.writeVarint(i[a])}function yr(i,t){for(var a=0;a<i.length;a++)t.writeSVarint(i[a])}function Bl(i,t){for(var a=0;a<i.length;a++)t.writeFloat(i[a])}function Zo(i,t){for(var a=0;a<i.length;a++)t.writeDouble(i[a])}function as(i,t){for(var a=0;a<i.length;a++)t.writeBoolean(i[a])}function Iu(i,t){for(var a=0;a<i.length;a++)t.writeFixed32(i[a])}function rn(i,t){for(var a=0;a<i.length;a++)t.writeSFixed32(i[a])}function tu(i,t){for(var a=0;a<i.length;a++)t.writeFixed64(i[a])}function Vh(i,t){for(var a=0;a<i.length;a++)t.writeSFixed64(i[a])}function sc(i,t){return(i[t]|i[t+1]<<8|i[t+2]<<16)+16777216*i[t+3]}function lc(i,t,a){i[a]=t,i[a+1]=t>>>8,i[a+2]=t>>>16,i[a+3]=t>>>24}function Ac(i,t){return(i[t]|i[t+1]<<8|i[t+2]<<16)+(i[t+3]<<24)}function ch(i,t,a){i===1&&a.readMessage(Tp,t)}function Tp(i,t,a){if(i===3){const{id:h,bitmap:f,width:v,height:w,left:k,top:L,advance:O}=a.readMessage(uh,{});t.push({id:h,bitmap:new SA({width:v+6,height:w+6},f),metrics:{width:v,height:w,left:k,top:L,advance:O}})}}function uh(i,t,a){i===1?t.id=a.readVarint():i===2?t.bitmap=a.readBytes():i===3?t.width=a.readVarint():i===4?t.height=a.readVarint():i===5?t.left=a.readSVarint():i===6?t.top=a.readSVarint():i===7&&(t.advance=a.readVarint())}function cc(i){let t=0,a=0;for(const w of i)t+=w.w*w.h,a=Math.max(a,w.w);i.sort((w,k)=>k.h-w.h);const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),a),h:1/0}];let f=0,v=0;for(const w of i)for(let k=h.length-1;k>=0;k--){const L=h[k];if(!(w.w>L.w||w.h>L.h)){if(w.x=L.x,w.y=L.y,v=Math.max(v,w.y+w.h),f=Math.max(f,w.x+w.w),w.w===L.w&&w.h===L.h){const O=h.pop();k<h.length&&(h[k]=O)}else w.h===L.h?(L.x+=w.w,L.w-=w.w):w.w===L.w?(L.y+=w.h,L.h-=w.h):(h.push({x:L.x+w.w,y:L.y,w:L.w-w.w,h:w.h}),L.y+=w.h,L.h-=w.h);break}}return{w:f,h:v,fill:t/(f*v)||0}}fn.prototype={destroy:function(){this.buf=null},readFields:function(i,t,a){for(a=a||this.length;this.pos<a;){var h=this.readVarint(),f=h>>3,v=this.pos;this.type=7&h,i(f,t,this),this.pos===v&&this.skip(h)}return t},readMessage:function(i,t){return this.readFields(i,t,this.readVarint()+this.pos)},readFixed32:function(){var i=sc(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=Ac(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=sc(this.buf,this.pos)+sc(this.buf,this.pos+4)*Ah;return this.pos+=8,i},readSFixed64:function(){var i=sc(this.buf,this.pos)+Ac(this.buf,this.pos+4)*Ah;return this.pos+=8,i},readFloat:function(){var i=Rh(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=Rh(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var t,a,h=this.buf;return t=127&(a=h[this.pos++]),a<128?t:(t|=(127&(a=h[this.pos++]))<<7,a<128?t:(t|=(127&(a=h[this.pos++]))<<14,a<128?t:(t|=(127&(a=h[this.pos++]))<<21,a<128?t:function(f,v,w){var k,L,O=w.buf;if(k=(112&(L=O[w.pos++]))>>4,L<128||(k|=(127&(L=O[w.pos++]))<<3,L<128)||(k|=(127&(L=O[w.pos++]))<<10,L<128)||(k|=(127&(L=O[w.pos++]))<<17,L<128)||(k|=(127&(L=O[w.pos++]))<<24,L<128)||(k|=(1&(L=O[w.pos++]))<<31,L<128))return dA(f,k,v);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(a=h[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var i=this.readVarint()+this.pos,t=this.pos;return this.pos=i,i-t>=12&&Hh?function(a,h,f){return Hh.decode(a.subarray(h,f))}(this.buf,t,i):function(a,h,f){for(var v="",w=h;w<f;){var k,L,O,Z=a[w],re=null,he=Z>239?4:Z>223?3:Z>191?2:1;if(w+he>f)break;he===1?Z<128&&(re=Z):he===2?(192&(k=a[w+1]))==128&&(re=(31&Z)<<6|63&k)<=127&&(re=null):he===3?(L=a[w+2],(192&(k=a[w+1]))==128&&(192&L)==128&&((re=(15&Z)<<12|(63&k)<<6|63&L)<=2047||re>=55296&&re<=57343)&&(re=null)):he===4&&(L=a[w+2],O=a[w+3],(192&(k=a[w+1]))==128&&(192&L)==128&&(192&O)==128&&((re=(15&Z)<<18|(63&k)<<12|(63&L)<<6|63&O)<=65535||re>=1114112)&&(re=null)),re===null?(re=65533,he=1):re>65535&&(re-=65536,v+=String.fromCharCode(re>>>10&1023|55296),re=56320|1023&re),v+=String.fromCharCode(re),w+=he}return v}(this.buf,t,i)},readBytes:function(){var i=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,i);return this.pos=i,t},readPackedVarint:function(i,t){if(this.type!==fn.Bytes)return i.push(this.readVarint(t));var a=cl(this);for(i=i||[];this.pos<a;)i.push(this.readVarint(t));return i},readPackedSVarint:function(i){if(this.type!==fn.Bytes)return i.push(this.readSVarint());var t=cl(this);for(i=i||[];this.pos<t;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==fn.Bytes)return i.push(this.readBoolean());var t=cl(this);for(i=i||[];this.pos<t;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==fn.Bytes)return i.push(this.readFloat());var t=cl(this);for(i=i||[];this.pos<t;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==fn.Bytes)return i.push(this.readDouble());var t=cl(this);for(i=i||[];this.pos<t;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==fn.Bytes)return i.push(this.readFixed32());var t=cl(this);for(i=i||[];this.pos<t;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==fn.Bytes)return i.push(this.readSFixed32());var t=cl(this);for(i=i||[];this.pos<t;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==fn.Bytes)return i.push(this.readFixed64());var t=cl(this);for(i=i||[];this.pos<t;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==fn.Bytes)return i.push(this.readSFixed64());var t=cl(this);for(i=i||[];this.pos<t;)i.push(this.readSFixed64());return i},skip:function(i){var t=7&i;if(t===fn.Varint)for(;this.buf[this.pos++]>127;);else if(t===fn.Bytes)this.pos=this.readVarint()+this.pos;else if(t===fn.Fixed32)this.pos+=4;else{if(t!==fn.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(i,t){this.writeVarint(i<<3|t)},realloc:function(i){for(var t=this.length||16;t<this.pos+i;)t*=2;if(t!==this.length){var a=new Uint8Array(t);a.set(this.buf),this.buf=a,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),lc(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),lc(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),lc(this.buf,-1&i,this.pos),lc(this.buf,Math.floor(i*Oh),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),lc(this.buf,-1&i,this.pos),lc(this.buf,Math.floor(i*Oh),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(t,a){var h,f;if(t>=0?(h=t%4294967296|0,f=t/4294967296|0):(f=~(-t/4294967296),4294967295^(h=~(-t%4294967296))?h=h+1|0:(h=0,f=f+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");a.realloc(10),function(v,w,k){k.buf[k.pos++]=127&v|128,v>>>=7,k.buf[k.pos++]=127&v|128,v>>>=7,k.buf[k.pos++]=127&v|128,v>>>=7,k.buf[k.pos++]=127&v|128,k.buf[k.pos]=127&(v>>>=7)}(h,0,a),function(v,w){var k=(7&v)<<4;w.buf[w.pos++]|=k|((v>>>=3)?128:0),v&&(w.buf[w.pos++]=127&v|((v>>>=7)?128:0),v&&(w.buf[w.pos++]=127&v|((v>>>=7)?128:0),v&&(w.buf[w.pos++]=127&v|((v>>>=7)?128:0),v&&(w.buf[w.pos++]=127&v|((v>>>=7)?128:0),v&&(w.buf[w.pos++]=127&v)))))}(f,a)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(Boolean(i))},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var t=this.pos;this.pos=function(h,f,v){for(var w,k,L=0;L<f.length;L++){if((w=f.charCodeAt(L))>55295&&w<57344){if(!k){w>56319||L+1===f.length?(h[v++]=239,h[v++]=191,h[v++]=189):k=w;continue}if(w<56320){h[v++]=239,h[v++]=191,h[v++]=189,k=w;continue}w=k-55296<<10|w-56320|65536,k=null}else k&&(h[v++]=239,h[v++]=191,h[v++]=189,k=null);w<128?h[v++]=w:(w<2048?h[v++]=w>>6|192:(w<65536?h[v++]=w>>12|224:(h[v++]=w>>18|240,h[v++]=w>>12&63|128),h[v++]=w>>6&63|128),h[v++]=63&w|128)}return v}(this.buf,i,this.pos);var a=this.pos-t;a>=128&&DA(t,a,this),this.pos=t-1,this.writeVarint(a),this.pos+=a},writeFloat:function(i){this.realloc(4),Sc(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),Sc(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var t=i.length;this.writeVarint(t),this.realloc(t);for(var a=0;a<t;a++)this.buf[this.pos++]=i[a]},writeRawMessage:function(i,t){this.pos++;var a=this.pos;i(t,this);var h=this.pos-a;h>=128&&DA(a,h,this),this.pos=a-1,this.writeVarint(h),this.pos+=h},writeMessage:function(i,t,a){this.writeTag(i,fn.Bytes),this.writeRawMessage(t,a)},writePackedVarint:function(i,t){t.length&&this.writeMessage(i,eu,t)},writePackedSVarint:function(i,t){t.length&&this.writeMessage(i,yr,t)},writePackedBoolean:function(i,t){t.length&&this.writeMessage(i,as,t)},writePackedFloat:function(i,t){t.length&&this.writeMessage(i,Bl,t)},writePackedDouble:function(i,t){t.length&&this.writeMessage(i,Zo,t)},writePackedFixed32:function(i,t){t.length&&this.writeMessage(i,Iu,t)},writePackedSFixed32:function(i,t){t.length&&this.writeMessage(i,rn,t)},writePackedFixed64:function(i,t){t.length&&this.writeMessage(i,tu,t)},writePackedSFixed64:function(i,t){t.length&&this.writeMessage(i,Vh,t)},writeBytesField:function(i,t){this.writeTag(i,fn.Bytes),this.writeBytes(t)},writeFixed32Field:function(i,t){this.writeTag(i,fn.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(i,t){this.writeTag(i,fn.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(i,t){this.writeTag(i,fn.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(i,t){this.writeTag(i,fn.Fixed64),this.writeSFixed64(t)},writeVarintField:function(i,t){this.writeTag(i,fn.Varint),this.writeVarint(t)},writeSVarintField:function(i,t){this.writeTag(i,fn.Varint),this.writeSVarint(t)},writeStringField:function(i,t){this.writeTag(i,fn.Bytes),this.writeString(t)},writeFloatField:function(i,t){this.writeTag(i,fn.Fixed32),this.writeFloat(t)},writeDoubleField:function(i,t){this.writeTag(i,fn.Fixed64),this.writeDouble(t)},writeBooleanField:function(i,t){this.writeVarintField(i,Boolean(t))}};class Tc{constructor(t,{pixelRatio:a,version:h,stretchX:f,stretchY:v,content:w}){this.paddedRect=t,this.pixelRatio=a,this.stretchX=f,this.stretchY=v,this.content=w,this.version=h}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class hh{constructor(t,a){const h={},f={};this.haveRenderCallbacks=[];const v=[];this.addImages(t,h,v),this.addImages(a,f,v);const{w,h:k}=cc(v),L=new oa({width:w||1,height:k||1});for(const O in t){const Z=t[O],re=h[O].paddedRect;oa.copy(Z.data,L,{x:0,y:0},{x:re.x+1,y:re.y+1},Z.data)}for(const O in a){const Z=a[O],re=f[O].paddedRect,he=re.x+1,de=re.y+1,me=Z.data.width,Ue=Z.data.height;oa.copy(Z.data,L,{x:0,y:0},{x:he,y:de},Z.data),oa.copy(Z.data,L,{x:0,y:Ue-1},{x:he,y:de-1},{width:me,height:1}),oa.copy(Z.data,L,{x:0,y:0},{x:he,y:de+Ue},{width:me,height:1}),oa.copy(Z.data,L,{x:me-1,y:0},{x:he-1,y:de},{width:1,height:Ue}),oa.copy(Z.data,L,{x:0,y:0},{x:he+me,y:de},{width:1,height:Ue})}this.image=L,this.iconPositions=h,this.patternPositions=f}addImages(t,a,h){for(const f in t){const v=t[f],w={x:0,y:0,w:v.data.width+2,h:v.data.height+2};h.push(w),a[f]=new Tc(w,v),v.hasRenderCallback&&this.haveRenderCallbacks.push(f)}}patchUpdatedImages(t,a){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const h in t.updatedImages)this.patchUpdatedImage(this.iconPositions[h],t.getImage(h),a),this.patchUpdatedImage(this.patternPositions[h],t.getImage(h),a)}patchUpdatedImage(t,a,h){if(!t||!a||t.version===a.version)return;t.version=a.version;const[f,v]=t.tl;h.update(a.data,void 0,{x:f,y:v})}}xr("ImagePosition",Tc),xr("ImageAtlas",hh),o.WritingMode=void 0,(pA=o.WritingMode||(o.WritingMode={}))[pA.none=0]="none",pA[pA.horizontal=1]="horizontal",pA[pA.vertical=2]="vertical",pA[pA.horizontalOnly=3]="horizontalOnly";const Fc=-17;class Uc{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,a){const h=new Uc;return h.scale=t||1,h.fontStack=a,h}static forImage(t){const a=new Uc;return a.imageName=t,a}}class fA{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,a){const h=new fA;for(let f=0;f<t.sections.length;f++){const v=t.sections[f];v.image?h.addImageSection(v):h.addTextSection(v,a)}return h}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let a="";for(let h=0;h<t.length;h++){const f=t.charCodeAt(h+1)||null,v=t.charCodeAt(h-1)||null;a+=f&&io(f)&&!ac[t[h+1]]||v&&io(v)&&!ac[t[h-1]]||!ac[t[h]]?t[h]:ac[t[h]]}return a}(this.text)}trim(){let t=0;for(let h=0;h<this.text.length&&ru[this.text.charCodeAt(h)];h++)t++;let a=this.text.length;for(let h=this.text.length-1;h>=0&&h>=t&&ru[this.text.charCodeAt(h)];h--)a--;this.text=this.text.substring(t,a),this.sectionIndex=this.sectionIndex.slice(t,a)}substring(t,a){const h=new fA;return h.text=this.text.substring(t,a),h.sectionIndex=this.sectionIndex.slice(t,a),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,a)=>Math.max(t,this.sections[a].scale),0)}addTextSection(t,a){this.text+=t.text,this.sections.push(Uc.forText(t.scale,t.fontStack||a));const h=this.sections.length-1;for(let f=0;f<t.text.length;++f)this.sectionIndex.push(h)}addImageSection(t){const a=t.image?t.image.name:"";if(a.length===0)return void It("Can't add FormattedSection with an empty image.");const h=this.getNextImageSectionCharCode();h?(this.text+=String.fromCharCode(h),this.sections.push(Uc.forImage(a)),this.sectionIndex.push(this.sections.length-1)):It("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Mc(i,t,a,h,f,v,w,k,L,O,Z,re,he,de,me,Ue){const Qe=fA.fromFeature(i,f);let Ye;re===o.WritingMode.vertical&&Qe.verticalizePunctuation();const{processBidirectionalText:ot,processStyledBidirectionalText:nt}=da;if(ot&&Qe.sections.length===1){Ye=[];const ft=ot(Qe.toString(),iu(Qe,O,v,t,h,de,me));for(const $t of ft){const nr=new fA;nr.text=$t,nr.sections=Qe.sections;for(let Xt=0;Xt<$t.length;Xt++)nr.sectionIndex.push(0);Ye.push(nr)}}else if(nt){Ye=[];const ft=nt(Qe.text,Qe.sectionIndex,iu(Qe,O,v,t,h,de,me));for(const $t of ft){const nr=new fA;nr.text=$t[0],nr.sectionIndex=$t[1],nr.sections=Qe.sections,Ye.push(nr)}}else Ye=function(ft,$t){const nr=[],Xt=ft.text;let qt=0;for(const Kt of $t)nr.push(ft.substring(qt,Kt)),qt=Kt;return qt<Xt.length&&nr.push(ft.substring(qt,Xt.length)),nr}(Qe,iu(Qe,O,v,t,h,de,me));const At=[],Et={positionedLines:At,text:Qe.toString(),top:Z[1],bottom:Z[1],left:Z[0],right:Z[0],writingMode:re,iconsInText:!1,verticalizable:!1};return function(ft,$t,nr,Xt,qt,Kt,Wt,Yt,Ot,Ir,gr,Jr){let yi=0,Ui=Fc,jr=0,zi=0;const _i=Yt==="right"?1:Yt==="left"?0:.5;let Yr=0;for(const on of qt){on.trim();const ui=on.getMaxScale(),Fo=(ui-1)*aa,so={positionedGlyphs:[],lineOffset:0};ft.positionedLines[Yr]=so;const $o=so.positionedGlyphs;let An=0;if(!on.length()){Ui+=Kt,++Yr;continue}for(let Yn=0;Yn<on.length();Yn++){const Mi=on.getSection(Yn),Fa=on.getSectionIndex(Yn),Wo=on.getCharCode(Yn);let Qo=0,As=null,hl=null,Is=null,Il=aa;const Ks=!(Ot===o.WritingMode.horizontal||!gr&&!nA(Wo)||gr&&(ru[Wo]||(wn=Wo,pr.Arabic(wn)||pr["Arabic Supplement"](wn)||pr["Arabic Extended-A"](wn)||pr["Arabic Presentation Forms-A"](wn)||pr["Arabic Presentation Forms-B"](wn))));if(Mi.imageName){const Ss=Xt[Mi.imageName];if(!Ss)continue;Is=Mi.imageName,ft.iconsInText=ft.iconsInText||!0,hl=Ss.paddedRect;const Jo=Ss.displaySize;Mi.scale=Mi.scale*aa/Jr,As={width:Jo[0],height:Jo[1],left:1,top:-3,advance:Ks?Jo[1]:Jo[0]},Qo=Fo+(aa-Jo[1]*Mi.scale),Il=As.advance;const Sl=Ks?Jo[0]*Mi.scale-aa*ui:Jo[1]*Mi.scale-aa*ui;Sl>0&&Sl>An&&(An=Sl)}else{const Ss=nr[Mi.fontStack],Jo=Ss&&Ss[Wo];if(Jo&&Jo.rect)hl=Jo.rect,As=Jo.metrics;else{const Sl=$t[Mi.fontStack],RA=Sl&&Sl[Wo];if(!RA)continue;As=RA.metrics}Qo=(ui-Mi.scale)*aa}Ks?(ft.verticalizable=!0,$o.push({glyph:Wo,imageName:Is,x:yi,y:Ui+Qo,vertical:Ks,scale:Mi.scale,fontStack:Mi.fontStack,sectionIndex:Fa,metrics:As,rect:hl}),yi+=Il*Mi.scale+Ir):($o.push({glyph:Wo,imageName:Is,x:yi,y:Ui+Qo,vertical:Ks,scale:Mi.scale,fontStack:Mi.fontStack,sectionIndex:Fa,metrics:As,rect:hl}),yi+=As.advance*Mi.scale+Ir)}$o.length!==0&&(jr=Math.max(yi-Ir,jr),Su($o,0,$o.length-1,_i,An)),yi=0;const Mn=Kt*ui+An;so.lineOffset=Math.max(An,Fo),Ui+=Mn,zi=Math.max(Mn,zi),++Yr}var wn;const bn=Ui-Fc,{horizontalAlign:Qi,verticalAlign:mn}=mA(Wt);(function(on,ui,Fo,so,$o,An,Mn,Yn,Mi){const Fa=(ui-Fo)*$o;let Wo=0;Wo=An!==Mn?-Yn*so-Fc:(-so*Mi+.5)*Mn;for(const Qo of on)for(const As of Qo.positionedGlyphs)As.x+=Fa,As.y+=Wo})(ft.positionedLines,_i,Qi,mn,jr,zi,Kt,bn,qt.length),ft.top+=-mn*bn,ft.bottom=ft.top+bn,ft.left+=-Qi*jr,ft.right=ft.left+jr}(Et,t,a,h,Ye,w,k,L,re,O,he,Ue),!function(ft){for(const $t of ft)if($t.positionedGlyphs.length!==0)return!1;return!0}(At)&&Et}const ru={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ph={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Nh(i,t,a,h,f,v){if(t.imageName){const w=h[t.imageName];return w?w.displaySize[0]*t.scale*aa/v+f:0}{const w=a[t.fontStack],k=w&&w[i];return k?k.metrics.advance*t.scale+f:0}}function Kh(i,t,a,h){const f=Math.pow(i-t,2);return h?i<t?f/2:2*f:f+Math.abs(a)*a}function Gh(i,t,a){let h=0;return i===10&&(h-=1e4),a&&(h+=150),i!==40&&i!==65288||(h+=50),t!==41&&t!==65289||(h+=50),h}function kc(i,t,a,h,f,v){let w=null,k=Kh(t,a,f,v);for(const L of h){const O=Kh(t-L.x,a,f,v)+L.badness;O<=k&&(w=L,k=O)}return{index:i,x:t,priorBreak:w,badness:k}}function Ja(i){return i?Ja(i.priorBreak).concat(i.index):[]}function iu(i,t,a,h,f,v,w){if(v!=="point")return[];if(!i)return[];const k=[],L=function(he,de,me,Ue,Qe,Ye){let ot=0;for(let nt=0;nt<he.length();nt++){const At=he.getSection(nt);ot+=Nh(he.getCharCode(nt),At,Ue,Qe,de,Ye)}return ot/Math.max(1,Math.ceil(ot/me))}(i,t,a,h,f,w),O=i.text.indexOf("\u200B")>=0;let Z=0;for(let he=0;he<i.length();he++){const de=i.getSection(he),me=i.getCharCode(he);if(ru[me]||(Z+=Nh(me,de,h,f,t,w)),he<i.length()-1){const Ue=!((re=me)<11904||!(pr["Bopomofo Extended"](re)||pr.Bopomofo(re)||pr["CJK Compatibility Forms"](re)||pr["CJK Compatibility Ideographs"](re)||pr["CJK Compatibility"](re)||pr["CJK Radicals Supplement"](re)||pr["CJK Strokes"](re)||pr["CJK Symbols and Punctuation"](re)||pr["CJK Unified Ideographs Extension A"](re)||pr["CJK Unified Ideographs"](re)||pr["Enclosed CJK Letters and Months"](re)||pr["Halfwidth and Fullwidth Forms"](re)||pr.Hiragana(re)||pr["Ideographic Description Characters"](re)||pr["Kangxi Radicals"](re)||pr["Katakana Phonetic Extensions"](re)||pr.Katakana(re)||pr["Vertical Forms"](re)||pr["Yi Radicals"](re)||pr["Yi Syllables"](re)));(ph[me]||Ue||de.imageName)&&k.push(kc(he+1,Z,L,k,Gh(me,i.getCharCode(he+1),Ue&&O),!1))}}var re;return Ja(kc(i.length(),Z,L,k,0,!0))}function mA(i){let t=.5,a=.5;switch(i){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:t,verticalAlign:a}}function Su(i,t,a,h,f){if(!h&&!f)return;const v=i[a],w=(i[a].x+v.metrics.advance*v.scale)*h;for(let k=t;k<=a;k++)i[k].x-=w,i[k].y+=f}function Tu(i,t,a){const{horizontalAlign:h,verticalAlign:f}=mA(a),v=t[0]-i.displaySize[0]*h,w=t[1]-i.displaySize[1]*f;return{image:i,top:w,bottom:w+i.displaySize[1],left:v,right:v+i.displaySize[0]}}function gA(i,t,a,h,f,v){const w=i.image;let k;if(w.content){const Qe=w.content,Ye=w.pixelRatio||1;k=[Qe[0]/Ye,Qe[1]/Ye,w.displaySize[0]-Qe[2]/Ye,w.displaySize[1]-Qe[3]/Ye]}const L=t.left*v,O=t.right*v;let Z,re,he,de;a==="width"||a==="both"?(de=f[0]+L-h[3],re=f[0]+O+h[1]):(de=f[0]+(L+O-w.displaySize[0])/2,re=de+w.displaySize[0]);const me=t.top*v,Ue=t.bottom*v;return a==="height"||a==="both"?(Z=f[1]+me-h[0],he=f[1]+Ue+h[2]):(Z=f[1]+(me+Ue-w.displaySize[1])/2,he=Z+w.displaySize[1]),{image:w,top:Z,right:re,bottom:he,left:de,collisionPadding:k}}const Cs=128;function nu(i,t){const{expression:a}=t;if(a.kind==="constant")return{kind:"constant",layoutSize:a.evaluate(new Hi(i+1))};if(a.kind==="source")return{kind:"source"};{const{zoomStops:h,interpolationType:f}=a;let v=0;for(;v<h.length&&h[v]<=i;)v++;v=Math.max(0,v-1);let w=v;for(;w<h.length&&h[w]<i+1;)w++;w=Math.min(h.length-1,w);const k=h[v],L=h[w];return a.kind==="composite"?{kind:"composite",minZoom:k,maxZoom:L,interpolationType:f}:{kind:"camera",minZoom:k,maxZoom:L,minSize:a.evaluate(new Hi(k)),maxSize:a.evaluate(new Hi(L)),interpolationType:f}}}class LA extends Rt{constructor(t,a,h,f){super(t,a),this.angle=h,f!==void 0&&(this.segment=f)}clone(){return new LA(this.x,this.y,this.angle,this.segment)}}function ul(i,t,a,h,f){if(t.segment===void 0)return!0;let v=t,w=t.segment+1,k=0;for(;k>-a/2;){if(w--,w<0)return!1;k-=i[w].dist(v),v=i[w]}k+=i[w].dist(i[w+1]),w++;const L=[];let O=0;for(;k<a/2;){const Z=i[w],re=i[w+1];if(!re)return!1;let he=i[w-1].angleTo(Z)-Z.angleTo(re);for(he=Math.abs((he+3*Math.PI)%(2*Math.PI)-Math.PI),L.push({distance:k,angleDelta:he}),O+=he;k-L[0].distance>h;)O-=L.shift().angleDelta;if(O>f)return!1;w++,k+=Z.dist(re)}return!0}function Fu(i){let t=0;for(let a=0;a<i.length-1;a++)t+=i[a].dist(i[a+1]);return t}function dh(i,t,a){return i?.6*t*a:0}function ou(i,t){return Math.max(i?i.right-i.left:0,t?t.right-t.left:0)}function jh(i,t,a,h,f,v){const w=dh(a,f,v),k=ou(a,h)*v;let L=0;const O=Fu(i)/2;for(let Z=0;Z<i.length-1;Z++){const re=i[Z],he=i[Z+1],de=re.dist(he);if(L+de>O){const me=(O-L)/de,Ue=pn(re.x,he.x,me),Qe=pn(re.y,he.y,me),Ye=new LA(Ue,Qe,he.angleTo(re),Z);return Ye._round(),!w||ul(i,Ye,k,w,t)?Ye:void 0}L+=de}}function fh(i,t,a,h,f,v,w,k,L){const O=dh(h,v,w),Z=ou(h,f),re=Z*w,he=i[0].x===0||i[0].x===L||i[0].y===0||i[0].y===L;return t-re<t/4&&(t=re+t/4),$h(i,he?t/2*k%t:(Z/2+2*v)*w*k%t,t,O,a,re,he,!1,L)}function $h(i,t,a,h,f,v,w,k,L){const O=v/2,Z=Fu(i);let re=0,he=t-a,de=[];for(let me=0;me<i.length-1;me++){const Ue=i[me],Qe=i[me+1],Ye=Ue.dist(Qe),ot=Qe.angleTo(Ue);for(;he+a<re+Ye;){he+=a;const nt=(he-re)/Ye,At=pn(Ue.x,Qe.x,nt),Et=pn(Ue.y,Qe.y,nt);if(At>=0&&At<L&&Et>=0&&Et<L&&he-O>=0&&he+O<=Z){const ft=new LA(At,Et,ot,me);ft._round(),h&&!ul(i,ft,v,h,f)||de.push(ft)}}re+=Ye}return k||de.length||w||(de=$h(i,re/2,a,h,f,v,w,!0,L)),de}function qh(i,t,a,h,f){const v=[];for(let w=0;w<i.length;w++){const k=i[w];let L;for(let O=0;O<k.length-1;O++){let Z=k[O],re=k[O+1];Z.x<t&&re.x<t||(Z.x<t?Z=new Rt(t,Z.y+(t-Z.x)/(re.x-Z.x)*(re.y-Z.y))._round():re.x<t&&(re=new Rt(t,Z.y+(t-Z.x)/(re.x-Z.x)*(re.y-Z.y))._round()),Z.y<a&&re.y<a||(Z.y<a?Z=new Rt(Z.x+(a-Z.y)/(re.y-Z.y)*(re.x-Z.x),a)._round():re.y<a&&(re=new Rt(Z.x+(a-Z.y)/(re.y-Z.y)*(re.x-Z.x),a)._round()),Z.x>=h&&re.x>=h||(Z.x>=h?Z=new Rt(h,Z.y+(h-Z.x)/(re.x-Z.x)*(re.y-Z.y))._round():re.x>=h&&(re=new Rt(h,Z.y+(h-Z.x)/(re.x-Z.x)*(re.y-Z.y))._round()),Z.y>=f&&re.y>=f||(Z.y>=f?Z=new Rt(Z.x+(f-Z.y)/(re.y-Z.y)*(re.x-Z.x),f)._round():re.y>=f&&(re=new Rt(Z.x+(f-Z.y)/(re.y-Z.y)*(re.x-Z.x),f)._round()),L&&Z.equals(L[L.length-1])||(L=[Z],v.push(L)),L.push(re)))))}}return v}function Zh(i,t,a,h){const f=[],v=i.image,w=v.pixelRatio,k=v.paddedRect.w-2,L=v.paddedRect.h-2,O=i.right-i.left,Z=i.bottom-i.top,re=v.stretchX||[[0,k]],he=v.stretchY||[[0,L]],de=(Kt,Wt)=>Kt+Wt[1]-Wt[0],me=re.reduce(de,0),Ue=he.reduce(de,0),Qe=k-me,Ye=L-Ue;let ot=0,nt=me,At=0,Et=Ue,ft=0,$t=Qe,nr=0,Xt=Ye;if(v.content&&h){const Kt=v.content;ot=uc(re,0,Kt[0]),At=uc(he,0,Kt[1]),nt=uc(re,Kt[0],Kt[2]),Et=uc(he,Kt[1],Kt[3]),ft=Kt[0]-ot,nr=Kt[1]-At,$t=Kt[2]-Kt[0]-nt,Xt=Kt[3]-Kt[1]-Et}const qt=(Kt,Wt,Yt,Ot)=>{const Ir=Mu(Kt.stretch-ot,nt,O,i.left),gr=yA(Kt.fixed-ft,$t,Kt.stretch,me),Jr=Mu(Wt.stretch-At,Et,Z,i.top),yi=yA(Wt.fixed-nr,Xt,Wt.stretch,Ue),Ui=Mu(Yt.stretch-ot,nt,O,i.left),jr=yA(Yt.fixed-ft,$t,Yt.stretch,me),zi=Mu(Ot.stretch-At,Et,Z,i.top),_i=yA(Ot.fixed-nr,Xt,Ot.stretch,Ue),Yr=new Rt(Ir,Jr),wn=new Rt(Ui,Jr),bn=new Rt(Ui,zi),Qi=new Rt(Ir,zi),mn=new Rt(gr/w,yi/w),on=new Rt(jr/w,_i/w),ui=t*Math.PI/180;if(ui){const $o=Math.sin(ui),An=Math.cos(ui),Mn=[An,-$o,$o,An];Yr._matMult(Mn),wn._matMult(Mn),Qi._matMult(Mn),bn._matMult(Mn)}const Fo=Kt.stretch+Kt.fixed,so=Wt.stretch+Wt.fixed;return{tl:Yr,tr:wn,bl:Qi,br:bn,tex:{x:v.paddedRect.x+1+Fo,y:v.paddedRect.y+1+so,w:Yt.stretch+Yt.fixed-Fo,h:Ot.stretch+Ot.fixed-so},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:mn,pixelOffsetBR:on,minFontScaleX:$t/w/O,minFontScaleY:Xt/w/Z,isSDF:a}};if(h&&(v.stretchX||v.stretchY)){const Kt=Uu(re,Qe,me),Wt=Uu(he,Ye,Ue);for(let Yt=0;Yt<Kt.length-1;Yt++){const Ot=Kt[Yt],Ir=Kt[Yt+1];for(let gr=0;gr<Wt.length-1;gr++)f.push(qt(Ot,Wt[gr],Ir,Wt[gr+1]))}}else f.push(qt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:k+1},{fixed:0,stretch:L+1}));return f}function uc(i,t,a){let h=0;for(const f of i)h+=Math.max(t,Math.min(a,f[1]))-Math.max(t,Math.min(a,f[0]));return h}function Uu(i,t,a){const h=[{fixed:-1,stretch:0}];for(const[f,v]of i){const w=h[h.length-1];h.push({fixed:f-w.stretch,stretch:w.stretch}),h.push({fixed:f-w.stretch,stretch:w.stretch+(v-f)})}return h.push({fixed:t+1,stretch:a}),h}function Mu(i,t,a,h){return i/t*a+h}function yA(i,t,a,h){return i-t*a/h}xr("Anchor",LA);class zA{constructor(t,a,h,f,v,w,k,L,O,Z){if(this.boxStartIndex=t.length,O){let re=w.top,he=w.bottom;const de=w.collisionPadding;de&&(re-=de[1],he+=de[3]);let me=he-re;me>0&&(me=Math.max(10,me),this.circleDiameter=me)}else{let re=w.top*k-L[0],he=w.bottom*k+L[2],de=w.left*k-L[3],me=w.right*k+L[1];const Ue=w.collisionPadding;if(Ue&&(de-=Ue[0]*k,re-=Ue[1]*k,me+=Ue[2]*k,he+=Ue[3]*k),Z){const Qe=new Rt(de,re),Ye=new Rt(me,re),ot=new Rt(de,he),nt=new Rt(me,he),At=Z*Math.PI/180;Qe._rotate(At),Ye._rotate(At),ot._rotate(At),nt._rotate(At),de=Math.min(Qe.x,Ye.x,ot.x,nt.x),me=Math.max(Qe.x,Ye.x,ot.x,nt.x),re=Math.min(Qe.y,Ye.y,ot.y,nt.y),he=Math.max(Qe.y,Ye.y,ot.y,nt.y)}t.emplaceBack(a.x,a.y,de,re,me,he,h,f,v)}this.boxEndIndex=t.length}}class vn{constructor(t=[],a=Fp){if(this.data=t,this.length=this.data.length,this.compare=a,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const t=this.data[0],a=this.data.pop();return this.length--,this.length>0&&(this.data[0]=a,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:a,compare:h}=this,f=a[t];for(;t>0;){const v=t-1>>1,w=a[v];if(h(f,w)>=0)break;a[t]=w,t=v}a[t]=f}_down(t){const{data:a,compare:h}=this,f=this.length>>1,v=a[t];for(;t<f;){let w=1+(t<<1),k=a[w];const L=w+1;if(L<this.length&&h(a[L],k)<0&&(w=L,k=a[L]),h(k,v)>=0)break;a[t]=k,t=w}a[t]=v}}function Fp(i,t){return i<t?-1:i>t?1:0}function mh(i,t=1,a=!1){let h=1/0,f=1/0,v=-1/0,w=-1/0;const k=i[0];for(let de=0;de<k.length;de++){const me=k[de];(!de||me.x<h)&&(h=me.x),(!de||me.y<f)&&(f=me.y),(!de||me.x>v)&&(v=me.x),(!de||me.y>w)&&(w=me.y)}const L=Math.min(v-h,w-f);let O=L/2;const Z=new vn([],Pc);if(L===0)return new Rt(h,f);for(let de=h;de<v;de+=L)for(let me=f;me<w;me+=L)Z.push(new Qc(de+O,me+O,O,i));let re=function(de){let me=0,Ue=0,Qe=0;const Ye=de[0];for(let ot=0,nt=Ye.length,At=nt-1;ot<nt;At=ot++){const Et=Ye[ot],ft=Ye[At],$t=Et.x*ft.y-ft.x*Et.y;Ue+=(Et.x+ft.x)*$t,Qe+=(Et.y+ft.y)*$t,me+=3*$t}return new Qc(Ue/me,Qe/me,0,de)}(i),he=Z.length;for(;Z.length;){const de=Z.pop();(de.d>re.d||!re.d)&&(re=de,a&&console.log("found best %d after %d probes",Math.round(1e4*de.d)/1e4,he)),de.max-re.d<=t||(O=de.h/2,Z.push(new Qc(de.p.x-O,de.p.y-O,O,i)),Z.push(new Qc(de.p.x+O,de.p.y-O,O,i)),Z.push(new Qc(de.p.x-O,de.p.y+O,O,i)),Z.push(new Qc(de.p.x+O,de.p.y+O,O,i)),he+=4)}return a&&(console.log(`num probes: ${he}`),console.log(`best distance: ${re.d}`)),re.p}function Pc(i,t){return t.max-i.max}function Qc(i,t,a,h){this.p=new Rt(i,t),this.h=a,this.d=function(f,v){let w=!1,k=1/0;for(let L=0;L<v.length;L++){const O=v[L];for(let Z=0,re=O.length,he=re-1;Z<re;he=Z++){const de=O[Z],me=O[he];de.y>f.y!=me.y>f.y&&f.x<(me.x-de.x)*(f.y-de.y)/(me.y-de.y)+de.x&&(w=!w),k=Math.min(k,Ns(f,de,me))}}return(w?1:-1)*Math.sqrt(k)}(this.p,h),this.max=this.d+this.h*Math.SQRT2}const gh=Number.POSITIVE_INFINITY;function I(i,t){return t[1]!==gh?function(a,h,f){let v=0,w=0;switch(h=Math.abs(h),f=Math.abs(f),a){case"top-right":case"top-left":case"top":w=f-7;break;case"bottom-right":case"bottom-left":case"bottom":w=7-f}switch(a){case"top-right":case"bottom-right":case"right":v=-h;break;case"top-left":case"bottom-left":case"left":v=h}return[v,w]}(i,t[0],t[1]):function(a,h){let f=0,v=0;h<0&&(h=0);const w=h/Math.sqrt(2);switch(a){case"top-right":case"top-left":v=w-7;break;case"bottom-right":case"bottom-left":v=7-w;break;case"bottom":v=7-h;break;case"top":v=h-7}switch(a){case"top-right":case"bottom-right":f=-w;break;case"top-left":case"bottom-left":f=w;break;case"left":f=h;break;case"right":f=-h}return[f,v]}(i,t[0])}function B(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function U(i,t,a,h,f,v,w,k,L,O,Z){let re=v.textMaxSize.evaluate(t,{});re===void 0&&(re=w);const he=i.layers[0].layout,de=he.get("icon-offset").evaluate(t,{},Z),me=ue(a.horizontal),Ue=w/24,Qe=i.tilePixelRatio*Ue,Ye=i.tilePixelRatio*re/24,ot=i.tilePixelRatio*k,nt=i.tilePixelRatio*he.get("symbol-spacing"),At=he.get("text-padding")*i.tilePixelRatio,Et=function(Ot,Ir,gr,Jr=1){const yi=Ot.get("icon-padding").evaluate(Ir,{},gr),Ui=yi&&yi.values;return[Ui[0]*Jr,Ui[1]*Jr,Ui[2]*Jr,Ui[3]*Jr]}(he,t,Z,i.tilePixelRatio),ft=he.get("text-max-angle")/180*Math.PI,$t=he.get("text-rotation-alignment")!=="viewport"&&he.get("symbol-placement")!=="point",nr=he.get("icon-rotation-alignment")==="map"&&he.get("symbol-placement")!=="point",Xt=he.get("symbol-placement"),qt=nt/2,Kt=he.get("icon-text-fit");let Wt;h&&Kt!=="none"&&(i.allowVerticalPlacement&&a.vertical&&(Wt=gA(h,a.vertical,Kt,he.get("icon-text-fit-padding"),de,Ue)),me&&(h=gA(h,me,Kt,he.get("icon-text-fit-padding"),de,Ue)));const Yt=(Ot,Ir)=>{Ir.x<0||Ir.x>=en||Ir.y<0||Ir.y>=en||function(gr,Jr,yi,Ui,jr,zi,_i,Yr,wn,bn,Qi,mn,on,ui,Fo,so,$o,An,Mn,Yn,Mi,Fa,Wo,Qo,As){const hl=gr.addToLineVertexArray(Jr,yi);let Is,Il,Ks,Ss,Jo=0,Sl=0,RA=0,hc=0,Dc=-1,ku=-1;const Xl={};let Pu=bt.exports(""),au=0,Qu=0;if(Yr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[au,Qu]=Yr.layout.get("text-offset").evaluate(Mi,{},Qo).map(Ts=>Ts*aa):(au=Yr.layout.get("text-radial-offset").evaluate(Mi,{},Qo)*aa,Qu=gh),gr.allowVerticalPlacement&&Ui.vertical){const Ts=Yr.layout.get("text-rotate").evaluate(Mi,{},Qo)+90;Ks=new zA(wn,Jr,bn,Qi,mn,Ui.vertical,on,ui,Fo,Ts),_i&&(Ss=new zA(wn,Jr,bn,Qi,mn,_i,$o,An,Fo,Ts))}if(jr){const Ts=Yr.layout.get("icon-rotate").evaluate(Mi,{}),Wl=Yr.layout.get("icon-text-fit")!=="none",Ru=Zh(jr,Ts,Wo,Wl),lu=_i?Zh(_i,Ts,Wo,Wl):void 0;Il=new zA(wn,Jr,bn,Qi,mn,jr,$o,An,!1,Ts),Jo=4*Ru.length;const Gp=gr.iconSizeData;let _A=null;Gp.kind==="source"?(_A=[Cs*Yr.layout.get("icon-size").evaluate(Mi,{})],_A[0]>F&&It(`${gr.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Gp.kind==="composite"&&(_A=[Cs*Fa.compositeIconSizes[0].evaluate(Mi,{},Qo),Cs*Fa.compositeIconSizes[1].evaluate(Mi,{},Qo)],(_A[0]>F||_A[1]>F)&&It(`${gr.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),gr.addSymbols(gr.icon,Ru,_A,Yn,Mn,Mi,o.WritingMode.none,Jr,hl.lineStartIndex,hl.lineLength,-1,Qo),Dc=gr.icon.placedSymbolArray.length-1,lu&&(Sl=4*lu.length,gr.addSymbols(gr.icon,lu,_A,Yn,Mn,Mi,o.WritingMode.vertical,Jr,hl.lineStartIndex,hl.lineLength,-1,Qo),ku=gr.icon.placedSymbolArray.length-1)}const Du=Object.keys(Ui.horizontal);for(const Ts of Du){const Wl=Ui.horizontal[Ts];if(!Is){Pu=bt.exports(Wl.text);const lu=Yr.layout.get("text-rotate").evaluate(Mi,{},Qo);Is=new zA(wn,Jr,bn,Qi,mn,Wl,on,ui,Fo,lu)}const Ru=Wl.positionedLines.length===1;if(RA+=G(gr,Jr,Wl,zi,Yr,Fo,Mi,so,hl,Ui.vertical?o.WritingMode.horizontal:o.WritingMode.horizontalOnly,Ru?Du:[Ts],Xl,Dc,Fa,Qo),Ru)break}Ui.vertical&&(hc+=G(gr,Jr,Ui.vertical,zi,Yr,Fo,Mi,so,hl,o.WritingMode.vertical,["vertical"],Xl,ku,Fa,Qo));const yh=Is?Is.boxStartIndex:gr.collisionBoxArray.length,_h=Is?Is.boxEndIndex:gr.collisionBoxArray.length,Xh=Ks?Ks.boxStartIndex:gr.collisionBoxArray.length,Lu=Ks?Ks.boxEndIndex:gr.collisionBoxArray.length,Wh=Il?Il.boxStartIndex:gr.collisionBoxArray.length,zu=Il?Il.boxEndIndex:gr.collisionBoxArray.length,vh=Ss?Ss.boxStartIndex:gr.collisionBoxArray.length,su=Ss?Ss.boxEndIndex:gr.collisionBoxArray.length;let Gs=-1;const pc=(Ts,Wl)=>Ts&&Ts.circleDiameter?Math.max(Ts.circleDiameter,Wl):Wl;Gs=pc(Is,Gs),Gs=pc(Ks,Gs),Gs=pc(Il,Gs),Gs=pc(Ss,Gs);const Jh=Gs>-1?1:0;Jh&&(Gs*=As/aa),gr.glyphOffsetArray.length>=Nt.MAX_GLYPHS&&It("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Mi.sortKey!==void 0&&gr.addToSortKeyRanges(gr.symbolInstances.length,Mi.sortKey),gr.symbolInstances.emplaceBack(Jr.x,Jr.y,Xl.right>=0?Xl.right:-1,Xl.center>=0?Xl.center:-1,Xl.left>=0?Xl.left:-1,Xl.vertical||-1,Dc,ku,Pu,yh,_h,Xh,Lu,Wh,zu,vh,su,bn,RA,hc,Jo,Sl,Jh,0,on,au,Qu,Gs)}(i,Ir,Ot,a,h,f,Wt,i.layers[0],i.collisionBoxArray,t.index,t.sourceLayerIndex,i.index,Qe,[At,At,At,At],$t,L,ot,Et,nr,de,t,v,O,Z,w)};if(Xt==="line")for(const Ot of qh(t.geometry,0,0,en,en)){const Ir=fh(Ot,nt,ft,a.vertical||me,h,24,Ye,i.overscaling,en);for(const gr of Ir){const Jr=me;Jr&&_e(i,Jr.text,qt,gr)||Yt(Ot,gr)}}else if(Xt==="line-center"){for(const Ot of t.geometry)if(Ot.length>1){const Ir=jh(Ot,ft,a.vertical||me,h,24,Ye);Ir&&Yt(Ot,Ir)}}else if(t.type==="Polygon")for(const Ot of bu(t.geometry,0)){const Ir=mh(Ot,16);Yt(Ot[0],new LA(Ir.x,Ir.y,0))}else if(t.type==="LineString")for(const Ot of t.geometry)Yt(Ot,new LA(Ot[0].x,Ot[0].y,0));else if(t.type==="Point")for(const Ot of t.geometry)for(const Ir of Ot)Yt([Ir],new LA(Ir.x,Ir.y,0))}const F=32640;function G(i,t,a,h,f,v,w,k,L,O,Z,re,he,de,me){const Ue=function(ot,nt,At,Et,ft,$t,nr,Xt){const qt=Et.layout.get("text-rotate").evaluate($t,{})*Math.PI/180,Kt=[];for(const Wt of nt.positionedLines)for(const Yt of Wt.positionedGlyphs){if(!Yt.rect)continue;const Ot=Yt.rect||{};let Ir=4,gr=!0,Jr=1,yi=0;const Ui=(ft||Xt)&&Yt.vertical,jr=Yt.metrics.advance*Yt.scale/2;if(Xt&&nt.verticalizable){const Mn=(Yt.scale-1)*aa,Yn=(aa-Yt.metrics.width*Yt.scale)/2;yi=Wt.lineOffset/2-(Yt.imageName?-Yn:Mn)}if(Yt.imageName){const Mn=nr[Yt.imageName];gr=Mn.sdf,Jr=Mn.pixelRatio,Ir=1/Jr}const zi=ft?[Yt.x+jr,Yt.y]:[0,0];let _i=ft?[0,0]:[Yt.x+jr+At[0],Yt.y+At[1]-yi],Yr=[0,0];Ui&&(Yr=_i,_i=[0,0]);const wn=(Yt.metrics.left-Ir)*Yt.scale-jr+_i[0],bn=(-Yt.metrics.top-Ir)*Yt.scale+_i[1],Qi=wn+Ot.w*Yt.scale/Jr,mn=bn+Ot.h*Yt.scale/Jr,on=new Rt(wn,bn),ui=new Rt(Qi,bn),Fo=new Rt(wn,mn),so=new Rt(Qi,mn);if(Ui){const Mn=new Rt(-jr,jr-Fc),Yn=-Math.PI/2,Mi=12-jr,Fa=new Rt(22-Mi,-(Yt.imageName?Mi:0)),Wo=new Rt(...Yr);on._rotateAround(Yn,Mn)._add(Fa)._add(Wo),ui._rotateAround(Yn,Mn)._add(Fa)._add(Wo),Fo._rotateAround(Yn,Mn)._add(Fa)._add(Wo),so._rotateAround(Yn,Mn)._add(Fa)._add(Wo)}if(qt){const Mn=Math.sin(qt),Yn=Math.cos(qt),Mi=[Yn,-Mn,Mn,Yn];on._matMult(Mi),ui._matMult(Mi),Fo._matMult(Mi),so._matMult(Mi)}const $o=new Rt(0,0),An=new Rt(0,0);Kt.push({tl:on,tr:ui,bl:Fo,br:so,tex:Ot,writingMode:nt.writingMode,glyphOffset:zi,sectionIndex:Yt.sectionIndex,isSDF:gr,pixelOffsetTL:$o,pixelOffsetBR:An,minFontScaleX:0,minFontScaleY:0})}return Kt}(0,a,k,f,v,w,h,i.allowVerticalPlacement),Qe=i.textSizeData;let Ye=null;Qe.kind==="source"?(Ye=[Cs*f.layout.get("text-size").evaluate(w,{})],Ye[0]>F&&It(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):Qe.kind==="composite"&&(Ye=[Cs*de.compositeTextSizes[0].evaluate(w,{},me),Cs*de.compositeTextSizes[1].evaluate(w,{},me)],(Ye[0]>F||Ye[1]>F)&&It(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),i.addSymbols(i.text,Ue,Ye,k,v,w,O,t,L.lineStartIndex,L.lineLength,he,me);for(const ot of Z)re[ot]=i.text.placedSymbolArray.length-1;return 4*Ue.length}function ue(i){for(const t in i)return i[t];return null}function _e(i,t,a,h){const f=i.compareText;if(t in f){const v=f[t];for(let w=v.length-1;w>=0;w--)if(h.dist(v[w])<a)return!0}else f[t]=[];return f[t].push(h),!1}const Ge=jl.VectorTileFeature.types,Ve=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ut(i,t,a,h,f,v,w,k,L,O,Z,re,he){const de=k?Math.min(F,Math.round(k[0])):0,me=k?Math.min(F,Math.round(k[1])):0;i.emplaceBack(t,a,Math.round(32*h),Math.round(32*f),v,w,(de<<1)+(L?1:0),me,16*O,16*Z,256*re,256*he)}function pt(i,t,a){i.emplaceBack(t.x,t.y,a),i.emplaceBack(t.x,t.y,a),i.emplaceBack(t.x,t.y,a),i.emplaceBack(t.x,t.y,a)}function Pt(i){for(const t of i.sections)if(oA(t.text))return!0;return!1}class Qt{constructor(t){this.layoutVertexArray=new Be,this.indexArray=new qe,this.programConfigurations=t,this.segments=new at,this.dynamicLayoutVertexArray=new Ie,this.opacityVertexArray=new Te,this.placedSymbolArray=new jt}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,a,h,f){this.isEmpty()||(h&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Lh.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Ep.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Ve,!0),this.opacityVertexBuffer.itemSize=1),(h||f)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}xr("SymbolBuffers",Qt);class Fr{constructor(t,a,h){this.layoutVertexArray=new t,this.layoutAttributes=a,this.indexArray=new h,this.segments=new at,this.collisionVertexArray=new Le}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Ip.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}xr("CollisionBuffers",Fr);class Nt{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(w=>w.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Gl([]),this.placementViewportMatrix=Gl([]);const a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=nu(this.zoom,a["text-size"]),this.iconSizeData=nu(this.zoom,a["icon-size"]);const h=this.layers[0].layout,f=h.get("symbol-sort-key"),v=h.get("symbol-z-order");this.canOverlap=Gn(h,"text-overlap","text-allow-overlap")!=="never"||Gn(h,"icon-overlap","icon-allow-overlap")!=="never"||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey=v!=="viewport-y"&&!f.isConstant(),this.sortFeaturesByY=(v==="viewport-y"||v==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,h.get("symbol-placement")==="point"&&(this.writingModes=h.get("text-writing-mode").map(w=>o.WritingMode[w])),this.stateDependentLayerIds=this.layers.filter(w=>w.isStateDependent()).map(w=>w.id),this.sourceID=t.sourceID}createArrays(){this.text=new Qt(new Un(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new Qt(new Un(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new sr,this.lineVertexArray=new l,this.symbolInstances=new mr}calculateGlyphDependencies(t,a,h,f,v){for(let w=0;w<t.length;w++)if(a[t.charCodeAt(w)]=!0,(h||f)&&v){const k=ac[t.charAt(w)];k&&(a[k.charCodeAt(0)]=!0)}}populate(t,a,h){const f=this.layers[0],v=f.layout,w=v.get("text-font"),k=v.get("text-field"),L=v.get("icon-image"),O=(k.value.kind!=="constant"||k.value.value instanceof Me&&!k.value.value.isEmpty()||k.value.value.toString().length>0)&&(w.value.kind!=="constant"||w.value.value.length>0),Z=L.value.kind!=="constant"||!!L.value.value||Object.keys(L.parameters).length>0,re=v.get("symbol-sort-key");if(this.features=[],!O&&!Z)return;const he=a.iconDependencies,de=a.glyphDependencies,me=a.availableImages,Ue=new Hi(this.zoom);for(const{feature:Qe,id:Ye,index:ot,sourceLayerIndex:nt}of t){const At=f._featureFilter.needGeometry,Et=Ko(Qe,At);if(!f._featureFilter.filter(Ue,Et,h))continue;let ft,$t;if(At||(Et.geometry=ma(Qe)),O){const Xt=f.getValueAndResolveTokens("text-field",Et,h,me),qt=Me.factory(Xt);Pt(qt)&&(this.hasRTLText=!0),(!this.hasRTLText||_o()==="unavailable"||this.hasRTLText&&da.isParsed())&&(ft=sh(qt,f,Et))}if(Z){const Xt=f.getValueAndResolveTokens("icon-image",Et,h,me);$t=Xt instanceof Oe?Xt:Oe.fromString(Xt)}if(!ft&&!$t)continue;const nr=this.sortFeaturesByKey?re.evaluate(Et,{},h):void 0;if(this.features.push({id:Ye,text:ft,icon:$t,index:ot,sourceLayerIndex:nt,geometry:Et.geometry,properties:Qe.properties,type:Ge[Qe.type],sortKey:nr}),$t&&(he[$t.name]=!0),ft){const Xt=w.evaluate(Et,{},h).join(","),qt=v.get("text-rotation-alignment")!=="viewport"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(o.WritingMode.vertical)>=0;for(const Kt of ft.sections)if(Kt.image)he[Kt.image.name]=!0;else{const Wt=xa(ft.toString()),Yt=Kt.fontStack||Xt,Ot=de[Yt]=de[Yt]||{};this.calculateGlyphDependencies(Kt.text,Ot,qt,this.allowVerticalPlacement,Wt)}}}v.get("symbol-placement")==="line"&&(this.features=function(Qe){const Ye={},ot={},nt=[];let At=0;function Et(Xt){nt.push(Qe[Xt]),At++}function ft(Xt,qt,Kt){const Wt=ot[Xt];return delete ot[Xt],ot[qt]=Wt,nt[Wt].geometry[0].pop(),nt[Wt].geometry[0]=nt[Wt].geometry[0].concat(Kt[0]),Wt}function $t(Xt,qt,Kt){const Wt=Ye[qt];return delete Ye[qt],Ye[Xt]=Wt,nt[Wt].geometry[0].shift(),nt[Wt].geometry[0]=Kt[0].concat(nt[Wt].geometry[0]),Wt}function nr(Xt,qt,Kt){const Wt=Kt?qt[0][qt[0].length-1]:qt[0][0];return`${Xt}:${Wt.x}:${Wt.y}`}for(let Xt=0;Xt<Qe.length;Xt++){const qt=Qe[Xt],Kt=qt.geometry,Wt=qt.text?qt.text.toString():null;if(!Wt){Et(Xt);continue}const Yt=nr(Wt,Kt),Ot=nr(Wt,Kt,!0);if(Yt in ot&&Ot in Ye&&ot[Yt]!==Ye[Ot]){const Ir=$t(Yt,Ot,Kt),gr=ft(Yt,Ot,nt[Ir].geometry);delete Ye[Yt],delete ot[Ot],ot[nr(Wt,nt[gr].geometry,!0)]=gr,nt[Ir].geometry=null}else Yt in ot?ft(Yt,Ot,Kt):Ot in Ye?$t(Yt,Ot,Kt):(Et(Xt),Ye[Yt]=At-1,ot[Ot]=At-1)}return nt.filter(Xt=>Xt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Qe,Ye)=>Qe.sortKey-Ye.sortKey)}update(t,a,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,a,this.layers,h),this.icon.programConfigurations.updatePaintArrays(t,a,this.layers,h))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,a){const h=this.lineVertexArray.length;if(t.segment!==void 0){let f=t.dist(a[t.segment+1]),v=t.dist(a[t.segment]);const w={};for(let k=t.segment+1;k<a.length;k++)w[k]={x:a[k].x,y:a[k].y,tileUnitDistanceFromAnchor:f},k<a.length-1&&(f+=a[k+1].dist(a[k]));for(let k=t.segment||0;k>=0;k--)w[k]={x:a[k].x,y:a[k].y,tileUnitDistanceFromAnchor:v},k>0&&(v+=a[k-1].dist(a[k]));for(let k=0;k<a.length;k++){const L=w[k];this.lineVertexArray.emplaceBack(L.x,L.y,L.tileUnitDistanceFromAnchor)}}return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(t,a,h,f,v,w,k,L,O,Z,re,he){const de=t.indexArray,me=t.layoutVertexArray,Ue=t.segments.prepareSegment(4*a.length,me,de,this.canOverlap?w.sortKey:void 0),Qe=this.glyphOffsetArray.length,Ye=Ue.vertexLength,ot=this.allowVerticalPlacement&&k===o.WritingMode.vertical?Math.PI/2:0,nt=w.text&&w.text.sections;for(let At=0;At<a.length;At++){const{tl:Et,tr:ft,bl:$t,br:nr,tex:Xt,pixelOffsetTL:qt,pixelOffsetBR:Kt,minFontScaleX:Wt,minFontScaleY:Yt,glyphOffset:Ot,isSDF:Ir,sectionIndex:gr}=a[At],Jr=Ue.vertexLength,yi=Ot[1];ut(me,L.x,L.y,Et.x,yi+Et.y,Xt.x,Xt.y,h,Ir,qt.x,qt.y,Wt,Yt),ut(me,L.x,L.y,ft.x,yi+ft.y,Xt.x+Xt.w,Xt.y,h,Ir,Kt.x,qt.y,Wt,Yt),ut(me,L.x,L.y,$t.x,yi+$t.y,Xt.x,Xt.y+Xt.h,h,Ir,qt.x,Kt.y,Wt,Yt),ut(me,L.x,L.y,nr.x,yi+nr.y,Xt.x+Xt.w,Xt.y+Xt.h,h,Ir,Kt.x,Kt.y,Wt,Yt),pt(t.dynamicLayoutVertexArray,L,ot),de.emplaceBack(Jr,Jr+1,Jr+2),de.emplaceBack(Jr+1,Jr+2,Jr+3),Ue.vertexLength+=4,Ue.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ot[0]),At!==a.length-1&&gr===a[At+1].sectionIndex||t.programConfigurations.populatePaintArrays(me.length,w,w.index,{},he,nt&&nt[gr])}t.placedSymbolArray.emplaceBack(L.x,L.y,Qe,this.glyphOffsetArray.length-Qe,Ye,O,Z,L.segment,h?h[0]:0,h?h[1]:0,f[0],f[1],k,0,!1,0,re)}_addCollisionDebugVertex(t,a,h,f,v,w){return a.emplaceBack(0,0),t.emplaceBack(h.x,h.y,f,v,Math.round(w.x),Math.round(w.y))}addCollisionDebugVertices(t,a,h,f,v,w,k){const L=v.segments.prepareSegment(4,v.layoutVertexArray,v.indexArray),O=L.vertexLength,Z=v.layoutVertexArray,re=v.collisionVertexArray,he=k.anchorX,de=k.anchorY;this._addCollisionDebugVertex(Z,re,w,he,de,new Rt(t,a)),this._addCollisionDebugVertex(Z,re,w,he,de,new Rt(h,a)),this._addCollisionDebugVertex(Z,re,w,he,de,new Rt(h,f)),this._addCollisionDebugVertex(Z,re,w,he,de,new Rt(t,f)),L.vertexLength+=4;const me=v.indexArray;me.emplaceBack(O,O+1),me.emplaceBack(O+1,O+2),me.emplaceBack(O+2,O+3),me.emplaceBack(O+3,O),L.primitiveLength+=4}addDebugCollisionBoxes(t,a,h,f){for(let v=t;v<a;v++){const w=this.collisionBoxArray.get(v);this.addCollisionDebugVertices(w.x1,w.y1,w.x2,w.y2,f?this.textCollisionBox:this.iconCollisionBox,w.anchorPoint,h)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Fr(He,zh.members,ke),this.iconCollisionBox=new Fr(He,zh.members,ke);for(let t=0;t<this.symbolInstances.length;t++){const a=this.symbolInstances.get(t);this.addDebugCollisionBoxes(a.textBoxStartIndex,a.textBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.iconBoxStartIndex,a.iconBoxEndIndex,a,!1),this.addDebugCollisionBoxes(a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex,a,!1)}}_deserializeCollisionBoxesForSymbol(t,a,h,f,v,w,k,L,O){const Z={};for(let re=a;re<h;re++){const he=t.get(re);Z.textBox={x1:he.x1,y1:he.y1,x2:he.x2,y2:he.y2,anchorPointX:he.anchorPointX,anchorPointY:he.anchorPointY},Z.textFeatureIndex=he.featureIndex;break}for(let re=f;re<v;re++){const he=t.get(re);Z.verticalTextBox={x1:he.x1,y1:he.y1,x2:he.x2,y2:he.y2,anchorPointX:he.anchorPointX,anchorPointY:he.anchorPointY},Z.verticalTextFeatureIndex=he.featureIndex;break}for(let re=w;re<k;re++){const he=t.get(re);Z.iconBox={x1:he.x1,y1:he.y1,x2:he.x2,y2:he.y2,anchorPointX:he.anchorPointX,anchorPointY:he.anchorPointY},Z.iconFeatureIndex=he.featureIndex;break}for(let re=L;re<O;re++){const he=t.get(re);Z.verticalIconBox={x1:he.x1,y1:he.y1,x2:he.x2,y2:he.y2,anchorPointX:he.anchorPointX,anchorPointY:he.anchorPointY},Z.verticalIconFeatureIndex=he.featureIndex;break}return Z}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const h=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,a){const h=t.placedSymbolArray.get(a),f=h.vertexStartIndex+4*h.numGlyphs;for(let v=h.vertexStartIndex;v<f;v+=4)t.indexArray.emplaceBack(v,v+1,v+2),t.indexArray.emplaceBack(v+1,v+2,v+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const a=Math.sin(t),h=Math.cos(t),f=[],v=[],w=[];for(let k=0;k<this.symbolInstances.length;++k){w.push(k);const L=this.symbolInstances.get(k);f.push(0|Math.round(a*L.anchorX+h*L.anchorY)),v.push(L.featureIndex)}return w.sort((k,L)=>f[k]-f[L]||v[L]-v[k]),w}addToSortKeyRanges(t,a){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===a?h.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const h=this.symbolInstances.get(a);this.featureSortOrder.push(h.featureIndex),[h.rightJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.leftJustifiedTextSymbolIndex].forEach((f,v,w)=>{f>=0&&w.indexOf(f)===v&&this.addIndicesForPlacedSymbol(this.text,f)}),h.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,h.verticalPlacedTextSymbolIndex),h.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.placedIconSymbolIndex),h.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}xr("SymbolBucket",Nt,{omit:["layers","collisionBoxArray","features","compareText"]}),Nt.MAX_GLYPHS=65535,Nt.addDynamicAttributes=pt;const tr=new On({"symbol-placement":new Cr(Ut.layout_symbol["symbol-placement"]),"symbol-spacing":new Cr(Ut.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Cr(Ut.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Pr(Ut.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Cr(Ut.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Cr(Ut.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Cr(Ut.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Cr(Ut.layout_symbol["icon-ignore-placement"]),"icon-optional":new Cr(Ut.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Cr(Ut.layout_symbol["icon-rotation-alignment"]),"icon-size":new Pr(Ut.layout_symbol["icon-size"]),"icon-text-fit":new Cr(Ut.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Cr(Ut.layout_symbol["icon-text-fit-padding"]),"icon-image":new Pr(Ut.layout_symbol["icon-image"]),"icon-rotate":new Pr(Ut.layout_symbol["icon-rotate"]),"icon-padding":new Pr(Ut.layout_symbol["icon-padding"]),"icon-keep-upright":new Cr(Ut.layout_symbol["icon-keep-upright"]),"icon-offset":new Pr(Ut.layout_symbol["icon-offset"]),"icon-anchor":new Pr(Ut.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Cr(Ut.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Cr(Ut.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Cr(Ut.layout_symbol["text-rotation-alignment"]),"text-field":new Pr(Ut.layout_symbol["text-field"]),"text-font":new Pr(Ut.layout_symbol["text-font"]),"text-size":new Pr(Ut.layout_symbol["text-size"]),"text-max-width":new Pr(Ut.layout_symbol["text-max-width"]),"text-line-height":new Cr(Ut.layout_symbol["text-line-height"]),"text-letter-spacing":new Pr(Ut.layout_symbol["text-letter-spacing"]),"text-justify":new Pr(Ut.layout_symbol["text-justify"]),"text-radial-offset":new Pr(Ut.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Cr(Ut.layout_symbol["text-variable-anchor"]),"text-anchor":new Pr(Ut.layout_symbol["text-anchor"]),"text-max-angle":new Cr(Ut.layout_symbol["text-max-angle"]),"text-writing-mode":new Cr(Ut.layout_symbol["text-writing-mode"]),"text-rotate":new Pr(Ut.layout_symbol["text-rotate"]),"text-padding":new Cr(Ut.layout_symbol["text-padding"]),"text-keep-upright":new Cr(Ut.layout_symbol["text-keep-upright"]),"text-transform":new Pr(Ut.layout_symbol["text-transform"]),"text-offset":new Pr(Ut.layout_symbol["text-offset"]),"text-allow-overlap":new Cr(Ut.layout_symbol["text-allow-overlap"]),"text-overlap":new Cr(Ut.layout_symbol["text-overlap"]),"text-ignore-placement":new Cr(Ut.layout_symbol["text-ignore-placement"]),"text-optional":new Cr(Ut.layout_symbol["text-optional"])});var ji={paint:new On({"icon-opacity":new Pr(Ut.paint_symbol["icon-opacity"]),"icon-color":new Pr(Ut.paint_symbol["icon-color"]),"icon-halo-color":new Pr(Ut.paint_symbol["icon-halo-color"]),"icon-halo-width":new Pr(Ut.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Pr(Ut.paint_symbol["icon-halo-blur"]),"icon-translate":new Cr(Ut.paint_symbol["icon-translate"]),"icon-translate-anchor":new Cr(Ut.paint_symbol["icon-translate-anchor"]),"text-opacity":new Pr(Ut.paint_symbol["text-opacity"]),"text-color":new Pr(Ut.paint_symbol["text-color"],{runtimeType:_n,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new Pr(Ut.paint_symbol["text-halo-color"]),"text-halo-width":new Pr(Ut.paint_symbol["text-halo-width"]),"text-halo-blur":new Pr(Ut.paint_symbol["text-halo-blur"]),"text-translate":new Cr(Ut.paint_symbol["text-translate"]),"text-translate-anchor":new Cr(Ut.paint_symbol["text-translate-anchor"])}),layout:tr};class ci{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:Bo,this.defaultValue=t}evaluate(t){if(t.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(t.formattedSection))return a.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}xr("FormatSectionOverride",ci,{omit:["defaultValue"]});class oi extends Ba{constructor(t){super(t,ji)}recalculate(t,a){if(super.recalculate(t,a),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const h=this.layout.get("text-writing-mode");if(h){const f=[];for(const v of h)f.indexOf(v)<0&&f.push(v);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,a,h,f){const v=this.layout.get(t).evaluate(a,{},h,f),w=this._unevaluatedLayout._values[t];return w.isDataDriven()||So(w.value)||!v?v:function(k,L){return L.replace(/{([^{}]+)}/g,(O,Z)=>Z in k?String(k[Z]):"")}(a.properties,v)}createBucket(t){return new Nt(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of ji.paint.overridableProperties){if(!oi.hasPaintOverride(this.layout,t))continue;const a=this.paint.get(t),h=new ci(a),f=new ha(h,a.property.specification);let v=null;v=a.value.kind==="constant"||a.value.kind==="source"?new ta("source",f):new Ai("composite",f,a.value.zoomStops),this.paint._values[t]=new Xn(a.property,v,a.parameters)}}_handleOverridablePaintPropertyUpdate(t,a,h){return!(!this.layout||a.isDataDriven()||h.isDataDriven())&&oi.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,a){const h=t.get("text-field"),f=ji.paint.properties[a];let v=!1;const w=k=>{for(const L of k)if(f.overrides&&f.overrides.hasOverride(L))return void(v=!0)};if(h.value.kind==="constant"&&h.value.value instanceof Me)w(h.value.value.sections);else if(h.value.kind==="source"){const k=O=>{v||(O instanceof dt&&we(O.value)===In?w(O.value.sections):O instanceof ds?w(O.sections):O.eachChild(k))},L=h.value;L._styleExpression&&k(L._styleExpression.expression)}return v}}function Gn(i,t,a){let h="never";const f=i.get(t);return f?h=f:i.get(a)&&(h="always"),h}var Ii={paint:new On({"background-color":new Cr(Ut.paint_background["background-color"]),"background-pattern":new Hs(Ut.paint_background["background-pattern"]),"background-opacity":new Cr(Ut.paint_background["background-opacity"])})},Si={paint:new On({"raster-opacity":new Cr(Ut.paint_raster["raster-opacity"]),"raster-hue-rotate":new Cr(Ut.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Cr(Ut.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Cr(Ut.paint_raster["raster-brightness-max"]),"raster-saturation":new Cr(Ut.paint_raster["raster-saturation"]),"raster-contrast":new Cr(Ut.paint_raster["raster-contrast"]),"raster-resampling":new Cr(Ut.paint_raster["raster-resampling"]),"raster-fade-duration":new Cr(Ut.paint_raster["raster-fade-duration"])})};class ai extends Ba{constructor(t){super(t,{}),this.onAdd=a=>{this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)},this.onRemove=a=>{this.implementation.onRemove&&this.implementation.onRemove(a,a.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const nn={circle:class extends Ba{constructor(i){super(i,yc)}createBucket(i){return new xl(i)}queryRadius(i){const t=i;return ga("circle-radius",this,t)+ga("circle-stroke-width",this,t)+na(this.paint.get("circle-translate"))}queryIntersectsFeature(i,t,a,h,f,v,w,k){const L=ko(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),v.angle,w),O=this.paint.get("circle-radius").evaluate(t,a)+this.paint.get("circle-stroke-width").evaluate(t,a),Z=this.paint.get("circle-pitch-alignment")==="map",re=Z?L:function(de,me){return de.map(Ue=>Wu(Ue,me))}(L,k),he=Z?O*w:O;for(const de of h)for(const me of de){const Ue=Z?me:Wu(me,k);let Qe=he;const Ye=Gc([],[me.x,me.y,0,1],k);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Qe*=Ye[3]/v.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Qe*=v.cameraToCenterDistance/Ye[3]),IA(re,Ue,Qe))return!0}return!1}},heatmap:class extends Ba{constructor(i){super(i,jc),this._updateColorRamp()}createBucket(i){return new Sa(i)}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=_c({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}},hillshade:class extends Ba{constructor(i){super(i,vp)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}},fill:class extends Ba{constructor(i){super(i,Fh)}recalculate(i,t){super.recalculate(i,t);const a=this.paint._values["fill-outline-color"];a.value.kind==="constant"&&a.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new wc(i)}queryRadius(){return na(this.paint.get("fill-translate"))}queryIntersectsFeature(i,t,a,h,f,v,w){return AA(ko(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),v.angle,w),h)}isTileClipped(){return!0}},"fill-extrusion":class extends Ba{constructor(i){super(i,ql)}createBucket(i){return new bl(i)}queryRadius(){return na(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(i,t,a,h,f,v,w,k){const L=ko(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),v.angle,w),O=this.paint.get("fill-extrusion-height").evaluate(t,a),Z=this.paint.get("fill-extrusion-base").evaluate(t,a),re=function(de,me,Ue,Qe){const Ye=[];for(const ot of de){const nt=[ot.x,ot.y,0,1];Gc(nt,nt,me),Ye.push(new Rt(nt[0]/nt[3],nt[1]/nt[3]))}return Ye}(L,k),he=function(de,me,Ue,Qe){const Ye=[],ot=[],nt=Qe[8]*me,At=Qe[9]*me,Et=Qe[10]*me,ft=Qe[11]*me,$t=Qe[8]*Ue,nr=Qe[9]*Ue,Xt=Qe[10]*Ue,qt=Qe[11]*Ue;for(const Kt of de){const Wt=[],Yt=[];for(const Ot of Kt){const Ir=Ot.x,gr=Ot.y,Jr=Qe[0]*Ir+Qe[4]*gr+Qe[12],yi=Qe[1]*Ir+Qe[5]*gr+Qe[13],Ui=Qe[2]*Ir+Qe[6]*gr+Qe[14],jr=Qe[3]*Ir+Qe[7]*gr+Qe[15],zi=Ui+Et,_i=jr+ft,Yr=Jr+$t,wn=yi+nr,bn=Ui+Xt,Qi=jr+qt,mn=new Rt((Jr+nt)/_i,(yi+At)/_i);mn.z=zi/_i,Wt.push(mn);const on=new Rt(Yr/Qi,wn/Qi);on.z=bn/Qi,Yt.push(on)}Ye.push(Wt),ot.push(Yt)}return[Ye,ot]}(h,Z,O,k);return function(de,me,Ue){let Qe=1/0;AA(Ue,me)&&(Qe=nh(Ue,me[0]));for(let Ye=0;Ye<me.length;Ye++){const ot=me[Ye],nt=de[Ye];for(let At=0;At<ot.length-1;At++){const Et=ot[At],ft=[Et,ot[At+1],nt[At+1],nt[At],Et];ll(Ue,ft)&&(Qe=Math.min(Qe,nh(Ue,ft)))}}return Qe!==1/0&&Qe}(he[0],he[1],re)}},line:class extends Ba{constructor(i){super(i,ah),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(i){i==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Fs,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(i,t){super.recalculate(i,t),this.paint._values["line-floorwidth"]=Zl.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new Ic(i)}queryRadius(i){const t=i,a=hA(ga("line-width",this,t),ga("line-gap-width",this,t)),h=ga("line-offset",this,t);return a/2+Math.abs(h)+na(this.paint.get("line-translate"))}queryIntersectsFeature(i,t,a,h,f,v,w){const k=ko(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),v.angle,w),L=w/2*hA(this.paint.get("line-width").evaluate(t,a),this.paint.get("line-gap-width").evaluate(t,a)),O=this.paint.get("line-offset").evaluate(t,a);return O&&(h=function(Z,re){const he=[];for(let de=0;de<Z.length;de++){const me=Z[de],Ue=[];for(let Qe=0;Qe<me.length;Qe++){const Ye=me[Qe-1],ot=me[Qe],nt=me[Qe+1],At=Qe===0?new Rt(0,0):ot.sub(Ye)._unit()._perp(),Et=Qe===me.length-1?new Rt(0,0):nt.sub(ot)._unit()._perp(),ft=At._add(Et)._unit(),$t=ft.x*Et.x+ft.y*Et.y;$t!==0&&ft._mult(1/$t),Ue.push(ft._mult(re)._add(ot))}he.push(Ue)}return he}(h,O*w)),function(Z,re,he){for(let de=0;de<re.length;de++){const me=re[de];if(Z.length>=3){for(let Ue=0;Ue<me.length;Ue++)if(Wa(Z,me[Ue]))return!0}if(bs(Z,me,he))return!0}return!1}(k,h,L)}isTileClipped(){return!0}},symbol:oi,background:class extends Ba{constructor(i){super(i,Ii)}},raster:class extends Ba{constructor(i){super(i,Si)}}};class xn{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const Qr=63710088e-1;class Fi{constructor(t,a){if(isNaN(t)||isNaN(a))throw new Error(`Invalid LngLat object: (${t}, ${a})`);if(this.lng=+t,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Fi(be(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const a=Math.PI/180,h=this.lat*a,f=t.lat*a,v=Math.sin(h)*Math.sin(f)+Math.cos(h)*Math.cos(f)*Math.cos((t.lng-this.lng)*a);return Qr*Math.acos(Math.min(v,1))}toBounds(t=0){const a=360*t/40075017,h=a/Math.cos(Math.PI/180*this.lat);return new fo(new Fi(this.lng-h,this.lat-a),new Fi(this.lng+h,this.lat+a))}static convert(t){if(t instanceof Fi)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Fi(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Fi(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class fo{constructor(t,a){t&&(a?this.setSouthWest(t).setNorthEast(a):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof Fi?new Fi(t.lng,t.lat):Fi.convert(t),this}setSouthWest(t){return this._sw=t instanceof Fi?new Fi(t.lng,t.lat):Fi.convert(t),this}extend(t){const a=this._sw,h=this._ne;let f,v;if(t instanceof Fi)f=t,v=t;else{if(!(t instanceof fo))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(fo.convert(t)):this.extend(Fi.convert(t)):this;if(f=t._sw,v=t._ne,!f||!v)return this}return a||h?(a.lng=Math.min(f.lng,a.lng),a.lat=Math.min(f.lat,a.lat),h.lng=Math.max(v.lng,h.lng),h.lat=Math.max(v.lat,h.lat)):(this._sw=new Fi(f.lng,f.lat),this._ne=new Fi(v.lng,v.lat)),this}getCenter(){return new Fi((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Fi(this.getWest(),this.getNorth())}getSouthEast(){return new Fi(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:a,lat:h}=Fi.convert(t);let f=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=h&&h<=this._ne.lat&&f}static convert(t){return t instanceof fo?t:t&&new fo(t)}}const Va=2*Math.PI*Qr;function jn(i){return Va*Math.cos(i*Math.PI/180)}function Ta(i){return(180+i)/360}function Es(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function Xo(i,t){return i/jn(t)}function ss(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}class Cl{constructor(t,a,h=0){this.x=+t,this.y=+a,this.z=+h}static fromLngLat(t,a=0){const h=Fi.convert(t);return new Cl(Ta(h.lng),Es(h.lat),Xo(a,h.lat))}toLngLat(){return new Fi(360*this.x-180,ss(this.y))}toAltitude(){return this.z*jn(ss(this.y))}meterInMercatorCoordinateUnits(){return 1/Va*(t=ss(this.y),1/Math.cos(t*Math.PI/180));var t}}function El(i,t,a){var h=2*Math.PI*6378137/256/Math.pow(2,a);return[i*h-2*Math.PI*6378137/2,t*h-2*Math.PI*6378137/2]}class $n{constructor(t,a,h){if(t<0||t>25||h<0||h>=Math.pow(2,t)||a<0||a>=Math.pow(2,t))throw new Error(`x=${a}, y=${h}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=a,this.y=h,this.key=e(0,t,t,a,h)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,a,h){const f=(w=this.y,k=this.z,L=El(256*(v=this.x),256*(w=Math.pow(2,k)-w-1),k),O=El(256*(v+1),256*(w+1),k),L[0]+","+L[1]+","+O[0]+","+O[1]);var v,w,k,L,O;const Z=function(re,he,de){let me,Ue="";for(let Qe=re;Qe>0;Qe--)me=1<<Qe-1,Ue+=(he&me?1:0)+(de&me?2:0);return Ue}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(h==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,a>1?"@2x":"").replace(/{quadkey}/g,Z).replace(/{bbox-epsg-3857}/g,f)}isChildOf(t){const a=this.z-t.z;return a>0&&t.x===this.x>>a&&t.y===this.y>>a}getTilePoint(t){const a=Math.pow(2,this.z);return new Rt((t.x*a-this.x)*en,(t.y*a-this.y)*en)}toString(){return`${this.z}/${this.x}/${this.y}`}}class ls{constructor(t,a){this.wrap=t,this.canonical=a,this.key=e(t,a.z,a.z,a.x,a.y)}}class sa{constructor(t,a,h,f,v){if(t<h)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${h}`);this.overscaledZ=t,this.wrap=a,this.canonical=new $n(h,+f,+v),this.key=e(a,t,h,f,v)}clone(){return new sa(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const a=this.canonical.z-t;return t>this.canonical.z?new sa(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new sa(t,this.wrap,t,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(t,a){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-t;return t>this.canonical.z?e(this.wrap*+a,t,this.canonical.z,this.canonical.x,this.canonical.y):e(this.wrap*+a,t,t,this.canonical.x>>h,this.canonical.y>>h)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const a=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>a&&t.canonical.y===this.canonical.y>>a}children(t){if(this.overscaledZ>=t)return[new sa(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,h=2*this.canonical.x,f=2*this.canonical.y;return[new sa(a,this.wrap,a,h,f),new sa(a,this.wrap,a,h+1,f),new sa(a,this.wrap,a,h,f+1),new sa(a,this.wrap,a,h+1,f+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new sa(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new sa(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new ls(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new Cl(t.x-this.wrap,t.y))}}function e(i,t,a,h,f){(i*=2)<0&&(i=-1*i-1);const v=1<<a;return(v*v*i+v*f+h).toString(36)+a.toString(36)+t.toString(36)}xr("CanonicalTileID",$n),xr("OverscaledTileID",sa,{omit:["posMatrix"]});class n{constructor(t,a,h){if(this.uid=t,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(h&&h!=="mapbox"&&h!=="terrarium")return void It(`"${h}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=a.height;const f=this.dim=a.height-2;this.data=new Uint32Array(a.data.buffer),this.encoding=h||"mapbox";for(let v=0;v<f;v++)this.data[this._idx(-1,v)]=this.data[this._idx(0,v)],this.data[this._idx(f,v)]=this.data[this._idx(f-1,v)],this.data[this._idx(v,-1)]=this.data[this._idx(v,0)],this.data[this._idx(v,f)]=this.data[this._idx(v,f-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(f,-1)]=this.data[this._idx(f-1,0)],this.data[this._idx(-1,f)]=this.data[this._idx(0,f-1)],this.data[this._idx(f,f)]=this.data[this._idx(f-1,f-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let v=0;v<f;v++)for(let w=0;w<f;w++){const k=this.get(v,w);k>this.max&&(this.max=k),k<this.min&&(this.min=k)}}get(t,a){const h=new Uint8Array(this.data.buffer),f=4*this._idx(t,a);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(h[f],h[f+1],h[f+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(t,a){if(t<-1||t>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(t+1)}_unpackMapbox(t,a,h){return(256*t*256+256*a+h)/10-1e4}_unpackTerrarium(t,a,h){return 256*t+a+h/256-32768}getPixels(){return new oa({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,a,h){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let f=a*this.dim,v=a*this.dim+this.dim,w=h*this.dim,k=h*this.dim+this.dim;switch(a){case-1:f=v-1;break;case 1:v=f+1}switch(h){case-1:w=k-1;break;case 1:k=w+1}const L=-a*this.dim,O=-h*this.dim;for(let Z=w;Z<k;Z++)for(let re=f;re<v;re++)this.data[this._idx(re,Z)]=t.data[this._idx(re+L,Z+O)]}}xr("DEMData",n);class s{constructor(t){this._stringToNumber={},this._numberToString=[];for(let a=0;a<t.length;a++){const h=t[a];this._stringToNumber[h]=a,this._numberToString[a]=h}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class p{constructor(t,a,h,f,v){this.type="Feature",this._vectorTileFeature=t,t._z=a,t._x=h,t._y=f,this.properties=t.properties,this.id=v}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const a in this)a!=="_geometry"&&a!=="_vectorTileFeature"&&(t[a]=this[a]);return t}}class g{constructor(t,a){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Ho(en,16,0),this.grid3D=new Ho(en,16,0),this.featureIndexArray=new A,this.promoteId=a}insert(t,a,h,f,v,w){const k=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,f,v);const L=w?this.grid3D:this.grid;for(let O=0;O<a.length;O++){const Z=a[O],re=[1/0,1/0,-1/0,-1/0];for(let he=0;he<Z.length;he++){const de=Z[he];re[0]=Math.min(re[0],de.x),re[1]=Math.min(re[1],de.y),re[2]=Math.max(re[2],de.x),re[3]=Math.max(re[3],de.y)}re[0]<en&&re[1]<en&&re[2]>=0&&re[3]>=0&&L.insert(k,re[0],re[1],re[2],re[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new jl.VectorTile(new lh(this.rawTileData)).layers,this.sourceLayerCoder=new s(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,a,h,f){this.loadVTLayers();const v=t.params||{},w=en/t.tileSize/t.scale,k=_s(v.filter),L=t.queryGeometry,O=t.queryPadding*w,Z=T(L),re=this.grid.query(Z.minX-O,Z.minY-O,Z.maxX+O,Z.maxY+O),he=T(t.cameraQueryGeometry),de=this.grid3D.query(he.minX-O,he.minY-O,he.maxX+O,he.maxY+O,(Qe,Ye,ot,nt)=>function(At,Et,ft,$t,nr){for(const qt of At)if(Et<=qt.x&&ft<=qt.y&&$t>=qt.x&&nr>=qt.y)return!0;const Xt=[new Rt(Et,ft),new Rt(Et,nr),new Rt($t,nr),new Rt($t,ft)];if(At.length>2){for(const qt of Xt)if(Wa(At,qt))return!0}for(let qt=0;qt<At.length-1;qt++)if(tn(At[qt],At[qt+1],Xt))return!0;return!1}(t.cameraQueryGeometry,Qe-O,Ye-O,ot+O,nt+O));for(const Qe of de)re.push(Qe);re.sort(D);const me={};let Ue;for(let Qe=0;Qe<re.length;Qe++){const Ye=re[Qe];if(Ye===Ue)continue;Ue=Ye;const ot=this.featureIndexArray.get(Ye);let nt=null;this.loadMatchingFeature(me,ot.bucketIndex,ot.sourceLayerIndex,ot.featureIndex,k,v.layers,v.availableImages,a,h,f,(At,Et,ft)=>(nt||(nt=ma(At)),Et.queryIntersectsFeature(L,At,ft,nt,this.z,t.transform,w,t.pixelPosMatrix)))}return me}loadMatchingFeature(t,a,h,f,v,w,k,L,O,Z,re){const he=this.bucketLayerIDs[a];if(w&&!function(Qe,Ye){for(let ot=0;ot<Qe.length;ot++)if(Ye.indexOf(Qe[ot])>=0)return!0;return!1}(w,he))return;const de=this.sourceLayerCoder.decode(h),me=this.vtLayers[de].feature(f);if(v.needGeometry){const Qe=Ko(me,!0);if(!v.filter(new Hi(this.tileID.overscaledZ),Qe,this.tileID.canonical))return}else if(!v.filter(new Hi(this.tileID.overscaledZ),me))return;const Ue=this.getId(me,de);for(let Qe=0;Qe<he.length;Qe++){const Ye=he[Qe];if(w&&w.indexOf(Ye)<0)continue;const ot=L[Ye];if(!ot)continue;let nt={};Ue&&Z&&(nt=Z.getState(ot.sourceLayer||"_geojsonTileLayer",Ue));const At=ze({},O[Ye]);At.paint=x(At.paint,ot.paint,me,nt,k),At.layout=x(At.layout,ot.layout,me,nt,k);const Et=!re||re(me,ot,nt);if(!Et)continue;const ft=new p(me,this.z,this.x,this.y,Ue);ft.layer=At;let $t=t[Ye];$t===void 0&&($t=t[Ye]=[]),$t.push({featureIndex:f,feature:ft,intersectionZ:Et})}}lookupSymbolFeatures(t,a,h,f,v,w,k,L){const O={};this.loadVTLayers();const Z=_s(v);for(const re of t)this.loadMatchingFeature(O,h,f,re,Z,w,k,L,a);return O}hasLayer(t){for(const a of this.bucketLayerIDs)for(const h of a)if(t===h)return!0;return!1}getId(t,a){let h=t.id;return this.promoteId&&(h=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[a]],typeof h=="boolean"&&(h=Number(h))),h}}function x(i,t,a,h,f){return _t(i,(v,w)=>{const k=t instanceof pi?t.get(w):null;return k&&k.evaluate?k.evaluate(a,h,f):k})}function T(i){let t=1/0,a=1/0,h=-1/0,f=-1/0;for(const v of i)t=Math.min(t,v.x),a=Math.min(a,v.y),h=Math.max(h,v.x),f=Math.max(f,v.y);return{minX:t,minY:a,maxX:h,maxY:f}}function D(i,t){return t-i}var j;xr("FeatureIndex",g,{omit:["rawTileData","sourceLayerCoder"]}),o.PerformanceMarkers=void 0,(j=o.PerformanceMarkers||(o.PerformanceMarkers={})).create="create",j.load="load",j.fullLoad="fullLoad";let ee=null,oe=[];const le=1e3/30,ye={mark(i){performance.mark(i)},frame(i){const t=i;ee!=null&&oe.push(t-ee),ee=t},clearMetrics(){ee=null,oe=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime");for(const i in o.PerformanceMarkers)performance.clearMarks(o.PerformanceMarkers[i])},getPerformanceMetrics(){performance.measure("loadTime",o.PerformanceMarkers.create,o.PerformanceMarkers.load),performance.measure("fullLoadTime",o.PerformanceMarkers.create,o.PerformanceMarkers.fullLoad);const i=performance.getEntriesByName("loadTime")[0].duration,t=performance.getEntriesByName("fullLoadTime")[0].duration,a=oe.length,h=1/(oe.reduce((v,w)=>v+w,0)/a/1e3),f=oe.filter(v=>v>le).reduce((v,w)=>v+(w-le)/le,0);return{loadTime:i,fullLoadTime:t,fps:h,percentDroppedFrames:f/(a+f)*100}}};o.AJAXError=Wi,o.ARRAY_TYPE=Go,o.Actor=class{constructor(i,t,a){this.target=i,this.parent=t,this.mapId=a,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},tt(["receive","process"],this),this.invoker=new xn(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=dr()?i:window}send(i,t,a,h,f=!1){const v=Math.round(1e18*Math.random()).toString(36).substring(0,10);a&&(this.callbacks[v]=a);const w=ei(this.globalScope)?void 0:[];return this.target.postMessage({id:v,type:i,hasCallback:!!a,targetMapId:h,mustQueue:f,sourceMapId:this.mapId,data:_l(t,w)},w),{cancel:()=>{a&&delete this.callbacks[v],this.target.postMessage({id:v,type:"<cancel>",targetMapId:h,sourceMapId:this.mapId})}}}receive(i){const t=i.data,a=t.id;if(a&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[a];const h=this.cancelCallbacks[a];delete this.cancelCallbacks[a],h&&h()}else dr()||t.mustQueue?(this.tasks[a]=t,this.taskQueue.push(a),this.invoker.trigger()):this.processTask(a,t)}process(){if(!this.taskQueue.length)return;const i=this.taskQueue.shift(),t=this.tasks[i];delete this.tasks[i],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(i,t)}processTask(i,t){if(t.type==="<response>"){const a=this.callbacks[i];delete this.callbacks[i],a&&(t.error?a(rs(t.error)):a(null,rs(t.data)))}else{let a=!1;const h=ei(this.globalScope)?void 0:[],f=t.hasCallback?(k,L)=>{a=!0,delete this.cancelCallbacks[i],this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:k?_l(k):null,data:_l(L,h)},h)}:k=>{a=!0};let v=null;const w=rs(t.data);if(this.parent[t.type])v=this.parent[t.type](t.sourceMapId,w,f);else if(this.parent.getWorkerSource){const k=t.type.split(".");v=this.parent.getWorkerSource(t.sourceMapId,k[0],w.source)[k[1]](w,f)}else f(new Error(`Could not find function ${t.type}`));!a&&v&&v.cancel&&(this.cancelCallbacks[i]=v.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},o.AlphaImage=SA,o.CanonicalTileID=$n,o.CollisionBoxArray=Mt,o.CollisionCircleLayoutArray=class extends ce{},o.Color=se,o.DEMData=n,o.DataConstantProperty=Cr,o.DictionaryCoder=s,o.EXTENT=en,o.ErrorEvent=yn,o.EvaluationParameters=Hi,o.Event=$i,o.Evented=En,o.FeatureIndex=g,o.FillBucket=wc,o.FillExtrusionBucket=bl,o.GeoJSONFeature=p,o.ImageAtlas=hh,o.ImagePosition=Tc,o.LineBucket=Ic,o.LineStripIndexArray=class extends $e{},o.LngLat=Fi,o.LngLatBounds=fo,o.MercatorCoordinate=Cl,o.ONE_EM=aa,o.OverscaledTileID=sa,o.PerformanceUtils=ye,o.PosArray=d,o.Properties=On,o.QuadTriangleArray=class extends Ce{},o.RGBAImage=oa,o.RasterBoundsArray=class extends y{},o.RequestPerformance=class{constructor(i){this._marks={start:[i.url,"start"].join("#"),end:[i.url,"end"].join("#"),measure:i.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let i=performance.getEntriesByName(this._marks.measure);return i.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),i=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),i}},o.ResourceType=Ln,o.SegmentVector=at,o.SymbolBucket=Nt,o.Transitionable=Kl,o.TriangleIndexArray=qe,o.Uniform1f=zr,o.Uniform1i=class extends lr{constructor(i,t){super(i,t),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},o.Uniform2f=class extends lr{constructor(i,t){super(i,t),this.current=[0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))}},o.Uniform3f=class extends lr{constructor(i,t){super(i,t),this.current=[0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))}},o.Uniform4f=$r,o.UniformColor=qr,o.UniformMatrix4f=class extends lr{constructor(i,t){super(i,t),this.current=Zr}set(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let t=1;t<16;t++)if(i[t]!==this.current[t]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}},o.UnwrappedTileID=ls,o.ValidationError=ir,o.ZoomHistory=vl,o.add=function(i,t,a){return i[0]=t[0]+a[0],i[1]=t[1]+a[1],i[2]=t[2]+a[2],i},o.addDynamicAttributes=pt,o.asyncAll=function(i,t,a){if(!i.length)return a(null,[]);let h=i.length;const f=new Array(i.length);let v=null;i.forEach((w,k)=>{t(w,(L,O)=>{L&&(v=L),f[k]=O,--h==0&&a(v,f)})})},o.bezier=ae,o.bindAll=tt,o.cacheEntryPossiblyAdded=function(i){Zi++,Zi>ki&&(i.getActor().send("enforceCacheSizeLimit",ii),Zi=0)},o.clamp=ie,o.clearTileCache=function(i){const t=caches.delete(Kr);i&&t.catch(i).then(()=>i())},o.clipLine=qh,o.clone=function(i){var t=new Go(16);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],t},o.clone$1=Bt,o.clone$2=function(i){var t=new Go(3);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t},o.collisionCircleLayout=Sp,o.config=Or,o.copy=function(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},o.create=function(){var i=new Go(16);return Go!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},o.create$1=Kc,o.createExpression=zl,o.createFilter=_s,o.createLayout=qi,o.createStyleLayer=function(i){return i.type==="custom"?new ai(i):new nn[i.type](i)},o.cross=function(i,t,a){var h=t[0],f=t[1],v=t[2],w=a[0],k=a[1],L=a[2];return i[0]=f*L-v*k,i[1]=v*w-h*L,i[2]=h*k-f*w,i},o.dot=function(i,t){return i[0]*t[0]+i[1]*t[1]+i[2]*t[2]},o.dot$1=function(i,t){return i[0]*t[0]+i[1]*t[1]+i[2]*t[2]+i[3]*t[3]},o.ease=Y,o.emitValidationErrors=ln,o.enforceCacheSizeLimit=function(i){kn(),di&&di.then(t=>{t.keys().then(a=>{for(let h=0;h<a.length-i;h++)t.delete(a[h])})})},o.equals=function(i,t){var a=i[0],h=i[1],f=i[2],v=i[3],w=i[4],k=i[5],L=i[6],O=i[7],Z=i[8],re=i[9],he=i[10],de=i[11],me=i[12],Ue=i[13],Qe=i[14],Ye=i[15],ot=t[0],nt=t[1],At=t[2],Et=t[3],ft=t[4],$t=t[5],nr=t[6],Xt=t[7],qt=t[8],Kt=t[9],Wt=t[10],Yt=t[11],Ot=t[12],Ir=t[13],gr=t[14],Jr=t[15];return Math.abs(a-ot)<=Ia*Math.max(1,Math.abs(a),Math.abs(ot))&&Math.abs(h-nt)<=Ia*Math.max(1,Math.abs(h),Math.abs(nt))&&Math.abs(f-At)<=Ia*Math.max(1,Math.abs(f),Math.abs(At))&&Math.abs(v-Et)<=Ia*Math.max(1,Math.abs(v),Math.abs(Et))&&Math.abs(w-ft)<=Ia*Math.max(1,Math.abs(w),Math.abs(ft))&&Math.abs(k-$t)<=Ia*Math.max(1,Math.abs(k),Math.abs($t))&&Math.abs(L-nr)<=Ia*Math.max(1,Math.abs(L),Math.abs(nr))&&Math.abs(O-Xt)<=Ia*Math.max(1,Math.abs(O),Math.abs(Xt))&&Math.abs(Z-qt)<=Ia*Math.max(1,Math.abs(Z),Math.abs(qt))&&Math.abs(re-Kt)<=Ia*Math.max(1,Math.abs(re),Math.abs(Kt))&&Math.abs(he-Wt)<=Ia*Math.max(1,Math.abs(he),Math.abs(Wt))&&Math.abs(de-Yt)<=Ia*Math.max(1,Math.abs(de),Math.abs(Yt))&&Math.abs(me-Ot)<=Ia*Math.max(1,Math.abs(me),Math.abs(Ot))&&Math.abs(Ue-Ir)<=Ia*Math.max(1,Math.abs(Ue),Math.abs(Ir))&&Math.abs(Qe-gr)<=Ia*Math.max(1,Math.abs(Qe),Math.abs(gr))&&Math.abs(Ye-Jr)<=Ia*Math.max(1,Math.abs(Ye),Math.abs(Jr))},o.evaluateSizeForFeature=function(i,{uSize:t,uSizeT:a},{lowerSize:h,upperSize:f}){return i.kind==="source"?h/Cs:i.kind==="composite"?pn(h/Cs,f/Cs,a):t},o.evaluateSizeForZoom=function(i,t){let a=0,h=0;if(i.kind==="constant")h=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:f,minZoom:v,maxZoom:w}=i,k=f?ie(Li.interpolationFactor(f,t,v,w),0,1):0;i.kind==="camera"?h=pn(i.minSize,i.maxSize,k):a=k}return{uSizeT:a,uSize:h}},o.evaluateVariableOffset=I,o.evented=ba,o.exported=kt,o.exported$1=Bn,o.extend=ze,o.filterObject=yt,o.fromRotation=function(i,t){var a=Math.sin(t),h=Math.cos(t);return i[0]=h,i[1]=a,i[2]=0,i[3]=-a,i[4]=h,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},o.fromScaling=function(i,t){return i[0]=t[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=t[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=t[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},o.getAnchorAlignment=mA,o.getAnchorJustification=B,o.getArrayBuffer=qn,o.getImage=Hr,o.getJSON=function(i,t){return an(ze(i,{type:"json"}),t)},o.getOverlapMode=Gn,o.getRTLTextPluginStatus=_o,o.getReferrer=ni,o.getVideo=function(i,t){const a=window.document.createElement("video");a.muted=!0,a.onloadstart=function(){t(null,a)};for(let h=0;h<i.length;h++){const f=window.document.createElement("source");un(i[h])||(a.crossOrigin="Anonymous"),f.src=i[h],a.appendChild(f)}return{cancel:()=>{}}},o.identity=Gl,o.invert=function(i,t){var a=t[0],h=t[1],f=t[2],v=t[3],w=t[4],k=t[5],L=t[6],O=t[7],Z=t[8],re=t[9],he=t[10],de=t[11],me=t[12],Ue=t[13],Qe=t[14],Ye=t[15],ot=a*k-h*w,nt=a*L-f*w,At=a*O-v*w,Et=h*L-f*k,ft=h*O-v*k,$t=f*O-v*L,nr=Z*Ue-re*me,Xt=Z*Qe-he*me,qt=Z*Ye-de*me,Kt=re*Qe-he*Ue,Wt=re*Ye-de*Ue,Yt=he*Ye-de*Qe,Ot=ot*Yt-nt*Wt+At*Kt+Et*qt-ft*Xt+$t*nr;return Ot?(i[0]=(k*Yt-L*Wt+O*Kt)*(Ot=1/Ot),i[1]=(f*Wt-h*Yt-v*Kt)*Ot,i[2]=(Ue*$t-Qe*ft+Ye*Et)*Ot,i[3]=(he*ft-re*$t-de*Et)*Ot,i[4]=(L*qt-w*Yt-O*Xt)*Ot,i[5]=(a*Yt-f*qt+v*Xt)*Ot,i[6]=(Qe*At-me*$t-Ye*nt)*Ot,i[7]=(Z*$t-he*At+de*nt)*Ot,i[8]=(w*Wt-k*qt+O*nr)*Ot,i[9]=(h*qt-a*Wt-v*nr)*Ot,i[10]=(me*ft-Ue*At+Ye*ot)*Ot,i[11]=(re*At-Z*ft-de*ot)*Ot,i[12]=(k*Xt-w*Kt-L*nr)*Ot,i[13]=(a*Kt-h*Xt+f*nr)*Ot,i[14]=(Ue*nt-me*Et-Qe*ot)*Ot,i[15]=(Z*Et-re*nt+he*ot)*Ot,i):null},o.isImageBitmap=rr,o.isSafari=ei,o.isWorker=dr,o.keysDifference=function(i,t){const a=[];for(const h in i)h in t||a.push(h);return a},o.lazyLoadRTLTextPlugin=function(){da.isLoading()||da.isLoaded()||_o()!=="deferred"||lA()},o.makeRequest=an,o.mapObject=_t,o.mercatorXfromLng=Ta,o.mercatorYfromLat=Es,o.mercatorZfromAltitude=Xo,o.mul=JA,o.mul$1=function(i,t,a){return i[0]=t[0]*a[0],i[1]=t[1]*a[1],i[2]=t[2]*a[2],i[3]=t[3]*a[3],i},o.multiply=XA,o.nextPowerOfTwo=function(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))},o.normalize=function(i,t){var a=t[0],h=t[1],f=t[2],v=a*a+h*h+f*f;return v>0&&(v=1/Math.sqrt(v)),i[0]=t[0]*v,i[1]=t[1]*v,i[2]=t[2]*v,i},o.number=pn,o.ortho=function(i,t,a,h,f,v,w){var k=1/(t-a),L=1/(h-f),O=1/(v-w);return i[0]=-2*k,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*L,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*O,i[11]=0,i[12]=(t+a)*k,i[13]=(f+h)*L,i[14]=(w+v)*O,i[15]=1,i},o.parseCacheControl=Xr,o.parseGlyphPbf=function(i){return new lh(i).readFields(ch,[])},o.pbf=lh,o.performSymbolLayout=function(i){i.bucket.createArrays(),i.bucket.tilePixelRatio=en/(512*i.bucket.overscaling),i.bucket.compareText={},i.bucket.iconsNeedLinear=!1;const t=i.bucket.layers[0].layout,a=i.bucket.layers[0]._unevaluatedLayout._values,h={layoutIconSize:a["icon-size"].possiblyEvaluate(new Hi(i.bucket.zoom+1),i.canonical),layoutTextSize:a["text-size"].possiblyEvaluate(new Hi(i.bucket.zoom+1),i.canonical),textMaxSize:a["text-size"].possiblyEvaluate(new Hi(18))};if(i.bucket.textSizeData.kind==="composite"){const{minZoom:L,maxZoom:O}=i.bucket.textSizeData;h.compositeTextSizes=[a["text-size"].possiblyEvaluate(new Hi(L),i.canonical),a["text-size"].possiblyEvaluate(new Hi(O),i.canonical)]}if(i.bucket.iconSizeData.kind==="composite"){const{minZoom:L,maxZoom:O}=i.bucket.iconSizeData;h.compositeIconSizes=[a["icon-size"].possiblyEvaluate(new Hi(L),i.canonical),a["icon-size"].possiblyEvaluate(new Hi(O),i.canonical)]}const f=t.get("text-line-height")*aa,v=t.get("text-rotation-alignment")!=="viewport"&&t.get("symbol-placement")!=="point",w=t.get("text-keep-upright"),k=t.get("text-size");for(const L of i.bucket.features){const O=t.get("text-font").evaluate(L,{},i.canonical).join(","),Z=k.evaluate(L,{},i.canonical),re=h.layoutTextSize.evaluate(L,{},i.canonical),he=h.layoutIconSize.evaluate(L,{},i.canonical),de={horizontal:{},vertical:void 0},me=L.text;let Ue,Qe=[0,0];if(me){const nt=me.toString(),At=t.get("text-letter-spacing").evaluate(L,{},i.canonical)*aa,Et=yo(nt)?At:0,ft=t.get("text-anchor").evaluate(L,{},i.canonical),$t=t.get("text-variable-anchor");if(!$t){const Wt=t.get("text-radial-offset").evaluate(L,{},i.canonical);Qe=Wt?I(ft,[Wt*aa,gh]):t.get("text-offset").evaluate(L,{},i.canonical).map(Yt=>Yt*aa)}let nr=v?"center":t.get("text-justify").evaluate(L,{},i.canonical);const Xt=t.get("symbol-placement"),qt=Xt==="point"?t.get("text-max-width").evaluate(L,{},i.canonical)*aa:0,Kt=()=>{i.bucket.allowVerticalPlacement&&xa(nt)&&(de.vertical=Mc(me,i.glyphMap,i.glyphPositions,i.imagePositions,O,qt,f,ft,"left",Et,Qe,o.WritingMode.vertical,!0,Xt,re,Z))};if(!v&&$t){const Wt=nr==="auto"?$t.map(Ot=>B(Ot)):[nr];let Yt=!1;for(let Ot=0;Ot<Wt.length;Ot++){const Ir=Wt[Ot];if(!de.horizontal[Ir])if(Yt)de.horizontal[Ir]=de.horizontal[0];else{const gr=Mc(me,i.glyphMap,i.glyphPositions,i.imagePositions,O,qt,f,"center",Ir,Et,Qe,o.WritingMode.horizontal,!1,Xt,re,Z);gr&&(de.horizontal[Ir]=gr,Yt=gr.positionedLines.length===1)}}Kt()}else{nr==="auto"&&(nr=B(ft));const Wt=Mc(me,i.glyphMap,i.glyphPositions,i.imagePositions,O,qt,f,ft,nr,Et,Qe,o.WritingMode.horizontal,!1,Xt,re,Z);Wt&&(de.horizontal[nr]=Wt),Kt(),xa(nt)&&v&&w&&(de.vertical=Mc(me,i.glyphMap,i.glyphPositions,i.imagePositions,O,qt,f,ft,nr,Et,Qe,o.WritingMode.vertical,!1,Xt,re,Z))}}let Ye=!1;if(L.icon&&L.icon.name){const nt=i.imageMap[L.icon.name];nt&&(Ue=Tu(i.imagePositions[L.icon.name],t.get("icon-offset").evaluate(L,{},i.canonical),t.get("icon-anchor").evaluate(L,{},i.canonical)),Ye=!!nt.sdf,i.bucket.sdfIcons===void 0?i.bucket.sdfIcons=Ye:i.bucket.sdfIcons!==Ye&&It("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(nt.pixelRatio!==i.bucket.pixelRatio||t.get("icon-rotate").constantOr(1)!==0)&&(i.bucket.iconsNeedLinear=!0))}const ot=ue(de.horizontal)||de.vertical;i.bucket.iconsInText=!!ot&&ot.iconsInText,(ot||Ue)&&U(i.bucket,L,de,Ue,i.imageMap,h,re,he,Qe,Ye,i.canonical)}i.showCollisionBoxes&&i.bucket.generateCollisionDebugBuffers()},o.perspective=function(i,t,a,h,f){var v,w=1/Math.tan(t/2);return i[0]=w/a,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=w,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,f!=null&&f!==1/0?(i[10]=(f+h)*(v=1/(h-f)),i[14]=2*f*h*v):(i[10]=-1,i[14]=-2*h),i},o.pick=function(i,t){const a={};for(let h=0;h<t.length;h++){const f=t[h];f in i&&(a[f]=i[f])}return a},o.plugin=da,o.pointGeometry=Rt,o.polygonIntersectsPolygon=ll,o.potpack=cc,o.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.register=xr,o.registerForPluginStateChange=function(i){return i({pluginStatus:Gt,pluginURL:ws}),ba.on("pluginStateChange",i),i},o.renderColorRamp=_c,o.rotateX=function(i,t,a){var h=Math.sin(a),f=Math.cos(a),v=t[4],w=t[5],k=t[6],L=t[7],O=t[8],Z=t[9],re=t[10],he=t[11];return t!==i&&(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[4]=v*f+O*h,i[5]=w*f+Z*h,i[6]=k*f+re*h,i[7]=L*f+he*h,i[8]=O*f-v*h,i[9]=Z*f-w*h,i[10]=re*f-k*h,i[11]=he*f-L*h,i},o.rotateZ=function(i,t,a){var h=Math.sin(a),f=Math.cos(a),v=t[0],w=t[1],k=t[2],L=t[3],O=t[4],Z=t[5],re=t[6],he=t[7];return t!==i&&(i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[0]=v*f+O*h,i[1]=w*f+Z*h,i[2]=k*f+re*h,i[3]=L*f+he*h,i[4]=O*f-v*h,i[5]=Z*f-w*h,i[6]=re*f-k*h,i[7]=he*f-L*h,i},o.scale=function(i,t,a){var h=a[0],f=a[1],v=a[2];return i[0]=t[0]*h,i[1]=t[1]*h,i[2]=t[2]*h,i[3]=t[3]*h,i[4]=t[4]*f,i[5]=t[5]*f,i[6]=t[6]*f,i[7]=t[7]*f,i[8]=t[8]*v,i[9]=t[9]*v,i[10]=t[10]*v,i[11]=t[11]*v,i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},o.scale$1=function(i,t,a){return i[0]=t[0]*a,i[1]=t[1]*a,i[2]=t[2]*a,i},o.setCacheLimits=function(i,t){ii=i,ki=t},o.setRTLTextPlugin=function(i,t,a=!1){if(Gt===nl||Gt===ra||Gt===ia)throw new Error("setRTLTextPlugin cannot be called multiple times.");ws=kt.resolveURL(i),Gt=nl,aA=t,ol(),a||lA()},o.spec=Ut,o.sphericalToCartesian=function([i,t,a]){return t+=90,t*=Math.PI/180,a*=Math.PI/180,{x:i*Math.cos(t)*Math.sin(a),y:i*Math.sin(t)*Math.sin(a),z:i*Math.cos(a)}},o.sqrLen=function(i){var t=i[0],a=i[1];return t*t+a*a},o.sub=function(i,t,a){return i[0]=t[0]-a[0],i[1]=t[1]-a[1],i[2]=t[2]-a[2],i},o.toEvaluationFeature=Ko,o.transformMat3=function(i,t,a){var h=t[0],f=t[1],v=t[2];return i[0]=h*a[0]+f*a[3]+v*a[6],i[1]=h*a[1]+f*a[4]+v*a[7],i[2]=h*a[2]+f*a[5]+v*a[8],i},o.transformMat4=Gc,o.transformMat4$1=function(i,t,a){var h=t[0],f=t[1];return i[0]=a[0]*h+a[4]*f+a[12],i[1]=a[1]*h+a[5]*f+a[13],i},o.translate=function(i,t,a){var h,f,v,w,k,L,O,Z,re,he,de,me,Ue=a[0],Qe=a[1],Ye=a[2];return t===i?(i[12]=t[0]*Ue+t[4]*Qe+t[8]*Ye+t[12],i[13]=t[1]*Ue+t[5]*Qe+t[9]*Ye+t[13],i[14]=t[2]*Ue+t[6]*Qe+t[10]*Ye+t[14],i[15]=t[3]*Ue+t[7]*Qe+t[11]*Ye+t[15]):(f=t[1],v=t[2],w=t[3],k=t[4],L=t[5],O=t[6],Z=t[7],re=t[8],he=t[9],de=t[10],me=t[11],i[0]=h=t[0],i[1]=f,i[2]=v,i[3]=w,i[4]=k,i[5]=L,i[6]=O,i[7]=Z,i[8]=re,i[9]=he,i[10]=de,i[11]=me,i[12]=h*Ue+k*Qe+re*Ye+t[12],i[13]=f*Ue+L*Qe+he*Ye+t[13],i[14]=v*Ue+O*Qe+de*Ye+t[14],i[15]=w*Ue+Z*Qe+me*Ye+t[15]),i},o.triggerPluginCompletionEvent=sA,o.unicodeBlockLookup=pr,o.uniqueId=function(){return it++},o.validateCustomStyleLayer=function(i){const t=[],a=i.id;return a===void 0&&t.push({message:`layers.${a}: missing required property "id"`}),i.render===void 0&&t.push({message:`layers.${a}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&t.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),t},o.validateLight=xs,o.validateStyle=il,o.vectorTile=jl,o.warnOnce=It,o.wrap=be}),V(["./shared"],function(o){function q(X){const H=typeof X;if(H==="number"||H==="boolean"||H==="string"||X==null)return JSON.stringify(X);if(Array.isArray(X)){let se="[";for(const Se of X)se+=`${q(Se)},`;return`${se}]`}const te=Object.keys(X).sort();let pe="{";for(let se=0;se<te.length;se++)pe+=`${JSON.stringify(te[se])}:${q(X[te[se]])},`;return`${pe}}`}function K(X){let H="";for(const te of o.refProperties)H+=`/${q(X[te])}`;return H}class ae{constructor(H){this.keyCache={},H&&this.replace(H)}replace(H){this._layerConfigs={},this._layers={},this.update(H,[])}update(H,te){for(const se of H){this._layerConfigs[se.id]=se;const Se=this._layers[se.id]=o.createStyleLayer(se);Se._featureFilter=o.createFilter(Se.filter),this.keyCache[se.id]&&delete this.keyCache[se.id]}for(const se of te)delete this.keyCache[se],delete this._layerConfigs[se],delete this._layers[se];this.familiesBySource={};const pe=function(se,Se){const Ne={};for(let ve=0;ve<se.length;ve++){const Oe=Se&&Se[se[ve].id]||K(se[ve]);Se&&(Se[se[ve].id]=Oe);let Je=Ne[Oe];Je||(Je=Ne[Oe]=[]),Je.push(se[ve])}const Me=[];for(const ve in Ne)Me.push(Ne[ve]);return Me}(Object.values(this._layerConfigs),this.keyCache);for(const se of pe){const Se=se.map(ct=>this._layers[ct.id]),Ne=Se[0];if(Ne.visibility==="none")continue;const Me=Ne.source||"";let ve=this.familiesBySource[Me];ve||(ve=this.familiesBySource[Me]={});const Oe=Ne.sourceLayer||"_geojsonTileLayer";let Je=ve[Oe];Je||(Je=ve[Oe]=[]),Je.push(Se)}}}class Y{constructor(H){const te={},pe=[];for(const Me in H){const ve=H[Me],Oe=te[Me]={};for(const Je in ve){const ct=ve[+Je];if(!ct||ct.bitmap.width===0||ct.bitmap.height===0)continue;const we={x:0,y:0,w:ct.bitmap.width+2,h:ct.bitmap.height+2};pe.push(we),Oe[Je]={rect:we,metrics:ct.metrics}}}const{w:se,h:Se}=o.potpack(pe),Ne=new o.AlphaImage({width:se||1,height:Se||1});for(const Me in H){const ve=H[Me];for(const Oe in ve){const Je=ve[+Oe];if(!Je||Je.bitmap.width===0||Je.bitmap.height===0)continue;const ct=te[Me][Oe].rect;o.AlphaImage.copy(Je.bitmap,Ne,{x:0,y:0},{x:ct.x+1,y:ct.y+1},Je.bitmap)}}this.image=Ne,this.positions=te}}o.register("GlyphAtlas",Y);class ie{constructor(H){this.tileID=new o.OverscaledTileID(H.tileID.overscaledZ,H.tileID.wrap,H.tileID.canonical.z,H.tileID.canonical.x,H.tileID.canonical.y),this.uid=H.uid,this.zoom=H.zoom,this.pixelRatio=H.pixelRatio,this.tileSize=H.tileSize,this.source=H.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=H.showCollisionBoxes,this.collectResourceTiming=!!H.collectResourceTiming,this.returnDependencies=!!H.returnDependencies,this.promoteId=H.promoteId}parse(H,te,pe,se,Se){this.status="parsing",this.data=H,this.collisionBoxArray=new o.CollisionBoxArray;const Ne=new o.DictionaryCoder(Object.keys(H.layers).sort()),Me=new o.FeatureIndex(this.tileID,this.promoteId);Me.bucketLayerIDs=[];const ve={},Oe={featureIndex:Me,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:pe},Je=te.familiesBySource[this.source];for(const or in Je){const Ar=H.layers[or];if(!Ar)continue;Ar.version===1&&o.warnOnce(`Vector tile source "${this.source}" layer "${or}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Br=Ne.encode(or),vr=[];for(let Sr=0;Sr<Ar.length;Sr++){const Tr=Ar.feature(Sr),li=Me.getId(Tr,or);vr.push({feature:Tr,id:li,index:Sr,sourceLayerIndex:Br})}for(const Sr of Je[or]){const Tr=Sr[0];Tr.source!==this.source&&o.warnOnce(`layer.source = ${Tr.source} does not equal this.source = ${this.source}`),Tr.minzoom&&this.zoom<Math.floor(Tr.minzoom)||Tr.maxzoom&&this.zoom>=Tr.maxzoom||Tr.visibility!=="none"&&(be(Sr,this.zoom,pe),(ve[Tr.id]=Tr.createBucket({index:Me.bucketLayerIDs.length,layers:Sr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Br,sourceID:this.source})).populate(vr,Oe,this.tileID.canonical),Me.bucketLayerIDs.push(Sr.map(li=>li.id)))}}let ct,we,Pe,dt;const xt=o.mapObject(Oe.glyphDependencies,or=>Object.keys(or).map(Number));Object.keys(xt).length?se.send("getGlyphs",{uid:this.uid,stacks:xt},(or,Ar)=>{ct||(ct=or,we=Ar,Jt.call(this))}):we={};const Lt=Object.keys(Oe.iconDependencies);Lt.length?se.send("getImages",{icons:Lt,source:this.source,tileID:this.tileID,type:"icons"},(or,Ar)=>{ct||(ct=or,Pe=Ar,Jt.call(this))}):Pe={};const zt=Object.keys(Oe.patternDependencies);function Jt(){if(ct)return Se(ct);if(we&&Pe&&dt){const or=new Y(we),Ar=new o.ImageAtlas(Pe,dt);for(const Br in ve){const vr=ve[Br];vr instanceof o.SymbolBucket?(be(vr.layers,this.zoom,pe),o.performSymbolLayout({bucket:vr,glyphMap:we,glyphPositions:or.positions,imageMap:Pe,imagePositions:Ar.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):vr.hasPattern&&(vr instanceof o.LineBucket||vr instanceof o.FillBucket||vr instanceof o.FillExtrusionBucket)&&(be(vr.layers,this.zoom,pe),vr.addFeatures(Oe,this.tileID.canonical,Ar.patternPositions))}this.status="done",Se(null,{buckets:Object.values(ve).filter(Br=>!Br.isEmpty()),featureIndex:Me,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:or.image,imageAtlas:Ar,glyphMap:this.returnDependencies?we:null,iconMap:this.returnDependencies?Pe:null,glyphPositions:this.returnDependencies?or.positions:null})}}zt.length?se.send("getImages",{icons:zt,source:this.source,tileID:this.tileID,type:"patterns"},(or,Ar)=>{ct||(ct=or,dt=Ar,Jt.call(this))}):dt={},Jt.call(this)}}function be(X,H,te){const pe=new o.EvaluationParameters(H);for(const se of X)se.recalculate(pe,te)}function ze(X,H){const te=o.getArrayBuffer(X.request,(pe,se,Se,Ne)=>{pe?H(pe):se&&H(null,{vectorTile:new o.vectorTile.VectorTile(new o.pbf(se)),rawData:se,cacheControl:Se,expires:Ne})});return()=>{te.cancel(),H()}}class it{constructor(H,te,pe,se){this.actor=H,this.layerIndex=te,this.availableImages=pe,this.loadVectorData=se||ze,this.loading={},this.loaded={}}loadTile(H,te){const pe=H.uid;this.loading||(this.loading={});const se=!!(H&&H.request&&H.request.collectResourceTiming)&&new o.RequestPerformance(H.request),Se=this.loading[pe]=new ie(H);Se.abort=this.loadVectorData(H,(Ne,Me)=>{if(delete this.loading[pe],Ne||!Me)return Se.status="done",this.loaded[pe]=Se,te(Ne);const ve=Me.rawData,Oe={};Me.expires&&(Oe.expires=Me.expires),Me.cacheControl&&(Oe.cacheControl=Me.cacheControl);const Je={};if(se){const ct=se.finish();ct&&(Je.resourceTiming=JSON.parse(JSON.stringify(ct)))}Se.vectorTile=Me.vectorTile,Se.parse(Me.vectorTile,this.layerIndex,this.availableImages,this.actor,(ct,we)=>{if(ct||!we)return te(ct);te(null,o.extend({rawTileData:ve.slice(0)},we,Oe,Je))}),this.loaded=this.loaded||{},this.loaded[pe]=Se})}reloadTile(H,te){const pe=this.loaded,se=H.uid,Se=this;if(pe&&pe[se]){const Ne=pe[se];Ne.showCollisionBoxes=H.showCollisionBoxes;const Me=(ve,Oe)=>{const Je=Ne.reloadCallback;Je&&(delete Ne.reloadCallback,Ne.parse(Ne.vectorTile,Se.layerIndex,this.availableImages,Se.actor,Je)),te(ve,Oe)};Ne.status==="parsing"?Ne.reloadCallback=Me:Ne.status==="done"&&(Ne.vectorTile?Ne.parse(Ne.vectorTile,this.layerIndex,this.availableImages,this.actor,Me):Me())}}abortTile(H,te){const pe=this.loading,se=H.uid;pe&&pe[se]&&pe[se].abort&&(pe[se].abort(),delete pe[se]),te()}removeTile(H,te){const pe=this.loaded,se=H.uid;pe&&pe[se]&&delete pe[se],te()}}class tt{constructor(){this.loaded={}}loadTile(H,te){const{uid:pe,encoding:se,rawImageData:Se}=H,Ne=o.isImageBitmap(Se)?this.getImageData(Se):Se,Me=new o.DEMData(pe,Ne,se);this.loaded=this.loaded||{},this.loaded[pe]=Me,te(null,Me)}getImageData(H){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(H.width,H.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=H.width,this.offscreenCanvas.height=H.height,this.offscreenCanvasContext.drawImage(H,0,0,H.width,H.height);const te=this.offscreenCanvasContext.getImageData(-1,-1,H.width+2,H.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new o.RGBAImage({width:te.width,height:te.height},te.data)}removeTile(H){const te=this.loaded,pe=H.uid;te&&te[pe]&&delete te[pe]}}var _t=function X(H,te){var pe,se=H&&H.type;if(se==="FeatureCollection")for(pe=0;pe<H.features.length;pe++)X(H.features[pe],te);else if(se==="GeometryCollection")for(pe=0;pe<H.geometries.length;pe++)X(H.geometries[pe],te);else if(se==="Feature")X(H.geometry,te);else if(se==="Polygon")yt(H.coordinates,te);else if(se==="MultiPolygon")for(pe=0;pe<H.coordinates.length;pe++)yt(H.coordinates[pe],te);return H};function yt(X,H){if(X.length!==0){Bt(X[0],H);for(var te=1;te<X.length;te++)Bt(X[te],!H)}}function Bt(X,H){for(var te=0,pe=0,se=0,Se=X.length,Ne=Se-1;se<Se;Ne=se++){var Me=(X[se][0]-X[Ne][0])*(X[Ne][1]+X[se][1]),ve=te+Me;pe+=Math.abs(te)>=Math.abs(Me)?te-ve+Me:Me-ve+te,te=ve}te+pe>=0!=!!H&&X.reverse()}const rt=o.vectorTile.VectorTileFeature.prototype.toGeoJSON;class It{constructor(H){this._feature=H,this.extent=o.EXTENT,this.type=H.type,this.properties=H.tags,"id"in H&&!isNaN(H.id)&&(this.id=parseInt(H.id,10))}loadGeometry(){if(this._feature.type===1){const H=[];for(const te of this._feature.geometry)H.push([new o.pointGeometry(te[0],te[1])]);return H}{const H=[];for(const te of this._feature.geometry){const pe=[];for(const se of te)pe.push(new o.pointGeometry(se[0],se[1]));H.push(pe)}return H}}toGeoJSON(H,te,pe){return rt.call(this,H,te,pe)}}class gt{constructor(H){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.EXTENT,this.length=H.length,this._features=H}feature(H){return new It(this._features[H])}}var Zt={exports:{}},dr=o.pointGeometry,Xr=o.vectorTile.VectorTileFeature,ur=_r;function _r(X,H){this.options=H||{},this.features=X,this.length=X.length}function Rr(X,H){this.id=typeof X.id=="number"?X.id:void 0,this.type=X.type,this.rawGeometry=X.type===1?[X.geometry]:X.geometry,this.properties=X.tags,this.extent=H||4096}_r.prototype.feature=function(X){return new Rr(this.features[X],this.options.extent)},Rr.prototype.loadGeometry=function(){var X=this.rawGeometry;this.geometry=[];for(var H=0;H<X.length;H++){for(var te=X[H],pe=[],se=0;se<te.length;se++)pe.push(new dr(te[se][0],te[se][1]));this.geometry.push(pe)}return this.geometry},Rr.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var X=this.geometry,H=1/0,te=-1/0,pe=1/0,se=-1/0,Se=0;Se<X.length;Se++)for(var Ne=X[Se],Me=0;Me<Ne.length;Me++){var ve=Ne[Me];H=Math.min(H,ve.x),te=Math.max(te,ve.x),pe=Math.min(pe,ve.y),se=Math.max(se,ve.y)}return[H,pe,te,se]},Rr.prototype.toGeoJSON=Xr.prototype.toGeoJSON;var ei=o.pbf,rr=ur;function kt(X){var H=new ei;return function(te,pe){for(var se in te.layers)pe.writeMessage(3,Rt,te.layers[se])}(X,H),H.finish()}function Rt(X,H){var te;H.writeVarintField(15,X.version||1),H.writeStringField(1,X.name||""),H.writeVarintField(5,X.extent||4096);var pe={keys:[],values:[],keycache:{},valuecache:{}};for(te=0;te<X.length;te++)pe.feature=X.feature(te),H.writeMessage(2,br,pe);var se=pe.keys;for(te=0;te<se.length;te++)H.writeStringField(3,se[te]);var Se=pe.values;for(te=0;te<Se.length;te++)H.writeMessage(4,ii,Se[te])}function br(X,H){var te=X.feature;te.id!==void 0&&H.writeVarintField(1,te.id),H.writeMessage(2,Or,X),H.writeVarintField(3,te.type),H.writeMessage(4,ri,te)}function Or(X,H){var te=X.feature,pe=X.keys,se=X.values,Se=X.keycache,Ne=X.valuecache;for(var Me in te.properties){var ve=te.properties[Me],Oe=Se[Me];if(ve!==null){Oe===void 0&&(pe.push(Me),Se[Me]=Oe=pe.length-1),H.writeVarint(Oe);var Je=typeof ve;Je!=="string"&&Je!=="boolean"&&Je!=="number"&&(ve=JSON.stringify(ve));var ct=Je+":"+ve,we=Ne[ct];we===void 0&&(se.push(ve),Ne[ct]=we=se.length-1),H.writeVarint(we)}}}function Kr(X,H){return(H<<3)+(7&X)}function di(X){return X<<1^X>>31}function ri(X,H){for(var te=X.loadGeometry(),pe=X.type,se=0,Se=0,Ne=te.length,Me=0;Me<Ne;Me++){var ve=te[Me],Oe=1;pe===1&&(Oe=ve.length),H.writeVarint(Kr(1,Oe));for(var Je=pe===3?ve.length-1:ve.length,ct=0;ct<Je;ct++){ct===1&&pe!==1&&H.writeVarint(Kr(2,Je-1));var we=ve[ct].x-se,Pe=ve[ct].y-Se;H.writeVarint(di(we)),H.writeVarint(di(Pe)),se+=we,Se+=Pe}pe===3&&H.writeVarint(Kr(7,1))}}function ii(X,H){var te=typeof X;te==="string"?H.writeStringField(1,X):te==="boolean"?H.writeBooleanField(7,X):te==="number"&&(X%1!=0?H.writeDoubleField(3,X):X<0?H.writeSVarintField(6,X):H.writeVarintField(5,X))}function ki(X,H,te,pe,se,Se){if(se-pe<=te)return;const Ne=pe+se>>1;kn(X,H,Ne,pe,se,Se%2),ki(X,H,te,pe,Ne-1,Se+1),ki(X,H,te,Ne+1,se,Se+1)}function kn(X,H,te,pe,se,Se){for(;se>pe;){if(se-pe>600){const Oe=se-pe+1,Je=te-pe+1,ct=Math.log(Oe),we=.5*Math.exp(2*ct/3),Pe=.5*Math.sqrt(ct*we*(Oe-we)/Oe)*(Je-Oe/2<0?-1:1);kn(X,H,te,Math.max(pe,Math.floor(te-Je*we/Oe+Pe)),Math.min(se,Math.floor(te+(Oe-Je)*we/Oe+Pe)),Se)}const Ne=H[2*te+Se];let Me=pe,ve=se;for(Zi(X,H,pe,te),H[2*se+Se]>Ne&&Zi(X,H,pe,se);Me<ve;){for(Zi(X,H,Me,ve),Me++,ve--;H[2*Me+Se]<Ne;)Me++;for(;H[2*ve+Se]>Ne;)ve--}H[2*pe+Se]===Ne?Zi(X,H,pe,ve):(ve++,Zi(X,H,ve,se)),ve<=te&&(pe=ve+1),te<=ve&&(se=ve-1)}}function Zi(X,H,te,pe){Bn(X,te,pe),Bn(H,2*te,2*pe),Bn(H,2*te+1,2*pe+1)}function Bn(X,H,te){const pe=X[H];X[H]=X[te],X[te]=pe}function la(X,H,te,pe){const se=X-te,Se=H-pe;return se*se+Se*Se}Zt.exports=kt,Zt.exports.fromVectorTileJs=kt,Zt.exports.fromGeojsonVt=function(X,H){H=H||{};var te={};for(var pe in X)te[pe]=new rr(X[pe].features,H),te[pe].name=pe,te[pe].version=H.version,te[pe].extent=H.extent;return kt({layers:te})},Zt.exports.GeoJSONWrapper=rr;const Xi=X=>X[0],cn=X=>X[1];class wi{constructor(H,te=Xi,pe=cn,se=64,Se=Float64Array){this.nodeSize=se,this.points=H;const Ne=H.length<65536?Uint16Array:Uint32Array,Me=this.ids=new Ne(H.length),ve=this.coords=new Se(2*H.length);for(let Oe=0;Oe<H.length;Oe++)Me[Oe]=Oe,ve[2*Oe]=te(H[Oe]),ve[2*Oe+1]=pe(H[Oe]);ki(Me,ve,se,0,Me.length-1,0)}range(H,te,pe,se){return function(Se,Ne,Me,ve,Oe,Je,ct){const we=[0,Se.length-1,0],Pe=[];let dt,xt;for(;we.length;){const Lt=we.pop(),zt=we.pop(),Jt=we.pop();if(zt-Jt<=ct){for(let Br=Jt;Br<=zt;Br++)dt=Ne[2*Br],xt=Ne[2*Br+1],dt>=Me&&dt<=Oe&&xt>=ve&&xt<=Je&&Pe.push(Se[Br]);continue}const or=Math.floor((Jt+zt)/2);dt=Ne[2*or],xt=Ne[2*or+1],dt>=Me&&dt<=Oe&&xt>=ve&&xt<=Je&&Pe.push(Se[or]);const Ar=(Lt+1)%2;(Lt===0?Me<=dt:ve<=xt)&&(we.push(Jt),we.push(or-1),we.push(Ar)),(Lt===0?Oe>=dt:Je>=xt)&&(we.push(or+1),we.push(zt),we.push(Ar))}return Pe}(this.ids,this.coords,H,te,pe,se,this.nodeSize)}within(H,te,pe){return function(se,Se,Ne,Me,ve,Oe){const Je=[0,se.length-1,0],ct=[],we=ve*ve;for(;Je.length;){const Pe=Je.pop(),dt=Je.pop(),xt=Je.pop();if(dt-xt<=Oe){for(let Ar=xt;Ar<=dt;Ar++)la(Se[2*Ar],Se[2*Ar+1],Ne,Me)<=we&&ct.push(se[Ar]);continue}const Lt=Math.floor((xt+dt)/2),zt=Se[2*Lt],Jt=Se[2*Lt+1];la(zt,Jt,Ne,Me)<=we&&ct.push(se[Lt]);const or=(Pe+1)%2;(Pe===0?Ne-ve<=zt:Me-ve<=Jt)&&(Je.push(xt),Je.push(Lt-1),Je.push(or)),(Pe===0?Ne+ve>=zt:Me+ve>=Jt)&&(Je.push(Lt+1),Je.push(dt),Je.push(or))}return ct}(this.ids,this.coords,H,te,pe,this.nodeSize)}}const Vi={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:X=>X},Ln=Math.fround||(Wi=new Float32Array(1),X=>(Wi[0]=+X,Wi[0]));var Wi;class ni{constructor(H){this.options=Hr(Object.create(Vi),H),this.trees=new Array(this.options.maxZoom+1)}load(H){const{log:te,minZoom:pe,maxZoom:se,nodeSize:Se}=this.options;te&&console.time("total time");const Ne=`prepare ${H.length} points`;te&&console.time(Ne),this.points=H;let Me=[];for(let ve=0;ve<H.length;ve++)H[ve].geometry&&Me.push(an(H[ve],ve));this.trees[se+1]=new wi(Me,Ji,Cn,Se,Float32Array),te&&console.timeEnd(Ne);for(let ve=se;ve>=pe;ve--){const Oe=+Date.now();Me=this._cluster(Me,ve),this.trees[ve]=new wi(Me,Ji,Cn,Se,Float32Array),te&&console.log("z%d: %d clusters in %dms",ve,Me.length,+Date.now()-Oe)}return te&&console.timeEnd("total time"),this}getClusters(H,te){let pe=((H[0]+180)%360+360)%360-180;const se=Math.max(-90,Math.min(90,H[1]));let Se=H[2]===180?180:((H[2]+180)%360+360)%360-180;const Ne=Math.max(-90,Math.min(90,H[3]));if(H[2]-H[0]>=360)pe=-180,Se=180;else if(pe>Se){const Je=this.getClusters([pe,se,180,Ne],te),ct=this.getClusters([-180,se,Se,Ne],te);return Je.concat(ct)}const Me=this.trees[this._limitZoom(te)],ve=Me.range(Wr(pe),Nn(Ne),Wr(Se),Nn(se)),Oe=[];for(const Je of ve){const ct=Me.points[Je];Oe.push(ct.numPoints?qn(ct):this.points[ct.index])}return Oe}getChildren(H){const te=this._getOriginId(H),pe=this._getOriginZoom(H),se="No cluster with the specified id.",Se=this.trees[pe];if(!Se)throw new Error(se);const Ne=Se.points[te];if(!Ne)throw new Error(se);const Me=this.options.radius/(this.options.extent*Math.pow(2,pe-1)),ve=Se.within(Ne.x,Ne.y,Me),Oe=[];for(const Je of ve){const ct=Se.points[Je];ct.parentId===H&&Oe.push(ct.numPoints?qn(ct):this.points[ct.index])}if(Oe.length===0)throw new Error(se);return Oe}getLeaves(H,te,pe){const se=[];return this._appendLeaves(se,H,te=te||10,pe=pe||0,0),se}getTile(H,te,pe){const se=this.trees[this._limitZoom(H)],Se=Math.pow(2,H),{extent:Ne,radius:Me}=this.options,ve=Me/Ne,Oe=(pe-ve)/Se,Je=(pe+1+ve)/Se,ct={features:[]};return this._addTileFeatures(se.range((te-ve)/Se,Oe,(te+1+ve)/Se,Je),se.points,te,pe,Se,ct),te===0&&this._addTileFeatures(se.range(1-ve/Se,Oe,1,Je),se.points,Se,pe,Se,ct),te===Se-1&&this._addTileFeatures(se.range(0,Oe,ve/Se,Je),se.points,-1,pe,Se,ct),ct.features.length?ct:null}getClusterExpansionZoom(H){let te=this._getOriginZoom(H)-1;for(;te<=this.options.maxZoom;){const pe=this.getChildren(H);if(te++,pe.length!==1)break;H=pe[0].properties.cluster_id}return te}_appendLeaves(H,te,pe,se,Se){const Ne=this.getChildren(te);for(const Me of Ne){const ve=Me.properties;if(ve&&ve.cluster?Se+ve.point_count<=se?Se+=ve.point_count:Se=this._appendLeaves(H,ve.cluster_id,pe,se,Se):Se<se?Se++:H.push(Me),H.length===pe)break}return Se}_addTileFeatures(H,te,pe,se,Se,Ne){for(const Me of H){const ve=te[Me],Oe=ve.numPoints;let Je,ct,we;if(Oe)Je=un(ve),ct=ve.x,we=ve.y;else{const xt=this.points[ve.index];Je=xt.properties,ct=Wr(xt.geometry.coordinates[0]),we=Nn(xt.geometry.coordinates[1])}const Pe={type:1,geometry:[[Math.round(this.options.extent*(ct*Se-pe)),Math.round(this.options.extent*(we*Se-se))]],tags:Je};let dt;Oe?dt=ve.id:this.options.generateId?dt=ve.index:this.points[ve.index].id&&(dt=this.points[ve.index].id),dt!==void 0&&(Pe.id=dt),Ne.features.push(Pe)}}_limitZoom(H){return Math.max(this.options.minZoom,Math.min(Math.floor(+H),this.options.maxZoom+1))}_cluster(H,te){const pe=[],{radius:se,extent:Se,reduce:Ne,minPoints:Me}=this.options,ve=se/(Se*Math.pow(2,te));for(let Oe=0;Oe<H.length;Oe++){const Je=H[Oe];if(Je.zoom<=te)continue;Je.zoom=te;const ct=this.trees[te+1],we=ct.within(Je.x,Je.y,ve),Pe=Je.numPoints||1;let dt=Pe;for(const xt of we){const Lt=ct.points[xt];Lt.zoom>te&&(dt+=Lt.numPoints||1)}if(dt>Pe&&dt>=Me){let xt=Je.x*Pe,Lt=Je.y*Pe,zt=Ne&&Pe>1?this._map(Je,!0):null;const Jt=(Oe<<5)+(te+1)+this.points.length;for(const or of we){const Ar=ct.points[or];if(Ar.zoom<=te)continue;Ar.zoom=te;const Br=Ar.numPoints||1;xt+=Ar.x*Br,Lt+=Ar.y*Br,Ar.parentId=Jt,Ne&&(zt||(zt=this._map(Je,!0)),Ne(zt,this._map(Ar)))}Je.parentId=Jt,pe.push(Pn(xt/dt,Lt/dt,Jt,dt,zt))}else if(pe.push(Je),dt>1)for(const xt of we){const Lt=ct.points[xt];Lt.zoom<=te||(Lt.zoom=te,pe.push(Lt))}}return pe}_getOriginId(H){return H-this.points.length>>5}_getOriginZoom(H){return(H-this.points.length)%32}_map(H,te){if(H.numPoints)return te?Hr({},H.properties):H.properties;const pe=this.points[H.index].properties,se=this.options.map(pe);return te&&se===pe?Hr({},se):se}}function Pn(X,H,te,pe,se){return{x:Ln(X),y:Ln(H),zoom:1/0,id:te,parentId:-1,numPoints:pe,properties:se}}function an(X,H){const[te,pe]=X.geometry.coordinates;return{x:Ln(Wr(te)),y:Ln(Nn(pe)),zoom:1/0,index:H,parentId:-1}}function qn(X){return{type:"Feature",id:X.id,properties:un(X),geometry:{type:"Point",coordinates:[(H=X.x,360*(H-.5)),Ri(X.y)]}};var H}function un(X){const H=X.numPoints,te=H>=1e4?`${Math.round(H/1e3)}k`:H>=1e3?Math.round(H/100)/10+"k":H;return Hr(Hr({},X.properties),{cluster:!0,cluster_id:X.id,point_count:H,point_count_abbreviated:te})}function Wr(X){return X/360+.5}function Nn(X){const H=Math.sin(X*Math.PI/180),te=.5-.25*Math.log((1+H)/(1-H))/Math.PI;return te<0?0:te>1?1:te}function Ri(X){const H=(180-360*X)*Math.PI/180;return 360*Math.atan(Math.exp(H))/Math.PI-90}function Hr(X,H){for(const te in H)X[te]=H[te];return X}function Ji(X){return X.x}function Cn(X){return X.y}function $i(X,H,te,pe){for(var se,Se=pe,Ne=te-H>>1,Me=te-H,ve=X[H],Oe=X[H+1],Je=X[te],ct=X[te+1],we=H+3;we<te;we+=3){var Pe=yn(X[we],X[we+1],ve,Oe,Je,ct);if(Pe>Se)se=we,Se=Pe;else if(Pe===Se){var dt=Math.abs(we-Ne);dt<Me&&(se=we,Me=dt)}}Se>pe&&(se-H>3&&$i(X,H,se,pe),X[se+2]=Se,te-se>3&&$i(X,se,te,pe))}function yn(X,H,te,pe,se,Se){var Ne=se-te,Me=Se-pe;if(Ne!==0||Me!==0){var ve=((X-te)*Ne+(H-pe)*Me)/(Ne*Ne+Me*Me);ve>1?(te=se,pe=Se):ve>0&&(te+=Ne*ve,pe+=Me*ve)}return(Ne=X-te)*Ne+(Me=H-pe)*Me}function En(X,H,te,pe){var se={id:X===void 0?null:X,type:H,geometry:te,tags:pe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Se){var Ne=Se.geometry,Me=Se.type;if(Me==="Point"||Me==="MultiPoint"||Me==="LineString")Ut(Se,Ne);else if(Me==="Polygon"||Me==="MultiLineString")for(var ve=0;ve<Ne.length;ve++)Ut(Se,Ne[ve]);else if(Me==="MultiPolygon")for(ve=0;ve<Ne.length;ve++)for(var Oe=0;Oe<Ne[ve].length;Oe++)Ut(Se,Ne[ve][Oe])}(se),se}function Ut(X,H){for(var te=0;te<H.length;te+=3)X.minX=Math.min(X.minX,H[te]),X.minY=Math.min(X.minY,H[te+1]),X.maxX=Math.max(X.maxX,H[te]),X.maxY=Math.max(X.maxY,H[te+1])}function ir(X,H,te,pe){if(H.geometry){var se=H.geometry.coordinates,Se=H.geometry.type,Ne=Math.pow(te.tolerance/((1<<te.maxZoom)*te.extent),2),Me=[],ve=H.id;if(te.promoteId?ve=H.properties[te.promoteId]:te.generateId&&(ve=pe||0),Se==="Point")Ma(se,Me);else if(Se==="MultiPoint")for(var Oe=0;Oe<se.length;Oe++)Ma(se[Oe],Me);else if(Se==="LineString")lo(se,Me,Ne,!1);else if(Se==="MultiLineString"){if(te.lineMetrics){for(Oe=0;Oe<se.length;Oe++)lo(se[Oe],Me=[],Ne,!1),X.push(En(ve,"LineString",Me,H.properties));return}bi(se,Me,Ne,!1)}else if(Se==="Polygon")bi(se,Me,Ne,!0);else{if(Se!=="MultiPolygon"){if(Se==="GeometryCollection"){for(Oe=0;Oe<H.geometry.geometries.length;Oe++)ir(X,{id:ve,geometry:H.geometry.geometries[Oe],properties:H.properties},te,pe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Oe=0;Oe<se.length;Oe++){var Je=[];bi(se[Oe],Je,Ne,!0),Me.push(Je)}}X.push(En(ve,Se,Me,H.properties))}}function Ma(X,H){H.push(bo(X[0])),H.push(ro(X[1])),H.push(0)}function lo(X,H,te,pe){for(var se,Se,Ne=0,Me=0;Me<X.length;Me++){var ve=bo(X[Me][0]),Oe=ro(X[Me][1]);H.push(ve),H.push(Oe),H.push(0),Me>0&&(Ne+=pe?(se*Oe-ve*Se)/2:Math.sqrt(Math.pow(ve-se,2)+Math.pow(Oe-Se,2))),se=ve,Se=Oe}var Je=H.length-3;H[2]=1,$i(H,0,Je,te),H[Je+2]=1,H.size=Math.abs(Ne),H.start=0,H.end=H.size}function bi(X,H,te,pe){for(var se=0;se<X.length;se++){var Se=[];lo(X[se],Se,te,pe),H.push(Se)}}function bo(X){return X/360+.5}function ro(X){var H=Math.sin(X*Math.PI/180),te=.5-.25*Math.log((1+H)/(1-H))/Math.PI;return te<0?0:te>1?1:te}function Ao(X,H,te,pe,se,Se,Ne,Me){if(pe/=H,Se>=(te/=H)&&Ne<pe)return X;if(Ne<te||Se>=pe)return null;for(var ve=[],Oe=0;Oe<X.length;Oe++){var Je=X[Oe],ct=Je.geometry,we=Je.type,Pe=se===0?Je.minX:Je.minY,dt=se===0?Je.maxX:Je.maxY;if(Pe>=te&&dt<pe)ve.push(Je);else if(!(dt<te||Pe>=pe)){var xt=[];if(we==="Point"||we==="MultiPoint")Bo(ct,xt,te,pe,se);else if(we==="LineString")er(ct,xt,te,pe,se,!1,Me.lineMetrics);else if(we==="MultiLineString")Nr(ct,xt,te,pe,se,!1);else if(we==="Polygon")Nr(ct,xt,te,pe,se,!0);else if(we==="MultiPolygon")for(var Lt=0;Lt<ct.length;Lt++){var zt=[];Nr(ct[Lt],zt,te,pe,se,!0),zt.length&&xt.push(zt)}if(xt.length){if(Me.lineMetrics&&we==="LineString"){for(Lt=0;Lt<xt.length;Lt++)ve.push(En(Je.id,we,xt[Lt],Je.tags));continue}we!=="LineString"&&we!=="MultiLineString"||(xt.length===1?(we="LineString",xt=xt[0]):we="MultiLineString"),we!=="Point"&&we!=="MultiPoint"||(we=xt.length===3?"Point":"MultiPoint"),ve.push(En(Je.id,we,xt,Je.tags))}}}return ve.length?ve:null}function Bo(X,H,te,pe,se){for(var Se=0;Se<X.length;Se+=3){var Ne=X[Se+se];Ne>=te&&Ne<=pe&&(H.push(X[Se]),H.push(X[Se+1]),H.push(X[Se+2]))}}function er(X,H,te,pe,se,Se,Ne){for(var Me,ve,Oe=Vr(X),Je=se===0?Qn:Gr,ct=X.start,we=0;we<X.length-3;we+=3){var Pe=X[we],dt=X[we+1],xt=X[we+2],Lt=X[we+3],zt=X[we+4],Jt=se===0?Pe:dt,or=se===0?Lt:zt,Ar=!1;Ne&&(Me=Math.sqrt(Math.pow(Pe-Lt,2)+Math.pow(dt-zt,2))),Jt<te?or>te&&(ve=Je(Oe,Pe,dt,Lt,zt,te),Ne&&(Oe.start=ct+Me*ve)):Jt>pe?or<pe&&(ve=Je(Oe,Pe,dt,Lt,zt,pe),Ne&&(Oe.start=ct+Me*ve)):_n(Oe,Pe,dt,xt),or<te&&Jt>=te&&(ve=Je(Oe,Pe,dt,Lt,zt,te),Ar=!0),or>pe&&Jt<=pe&&(ve=Je(Oe,Pe,dt,Lt,zt,pe),Ar=!0),!Se&&Ar&&(Ne&&(Oe.end=ct+Me*ve),H.push(Oe),Oe=Vr(X)),Ne&&(ct+=Me)}var Br=X.length-3;Pe=X[Br],dt=X[Br+1],xt=X[Br+2],(Jt=se===0?Pe:dt)>=te&&Jt<=pe&&_n(Oe,Pe,dt,xt),Br=Oe.length-3,Se&&Br>=3&&(Oe[Br]!==Oe[0]||Oe[Br+1]!==Oe[1])&&_n(Oe,Oe[0],Oe[1],Oe[2]),Oe.length&&H.push(Oe)}function Vr(X){var H=[];return H.size=X.size,H.start=X.start,H.end=X.end,H}function Nr(X,H,te,pe,se,Se){for(var Ne=0;Ne<X.length;Ne++)er(X[Ne],H,te,pe,se,Se,!1)}function _n(X,H,te,pe){X.push(H),X.push(te),X.push(pe)}function Qn(X,H,te,pe,se,Se){var Ne=(Se-H)/(pe-H);return X.push(Se),X.push(te+(se-te)*Ne),X.push(1),Ne}function Gr(X,H,te,pe,se,Se){var Ne=(Se-te)/(se-te);return X.push(H+(pe-H)*Ne),X.push(Se),X.push(1),Ne}function mo(X,H){for(var te=[],pe=0;pe<X.length;pe++){var se,Se=X[pe],Ne=Se.type;if(Ne==="Point"||Ne==="MultiPoint"||Ne==="LineString")se=In(Se.geometry,H);else if(Ne==="MultiLineString"||Ne==="Polygon"){se=[];for(var Me=0;Me<Se.geometry.length;Me++)se.push(In(Se.geometry[Me],H))}else if(Ne==="MultiPolygon")for(se=[],Me=0;Me<Se.geometry.length;Me++){for(var ve=[],Oe=0;Oe<Se.geometry[Me].length;Oe++)ve.push(In(Se.geometry[Me][Oe],H));se.push(ve)}te.push(En(Se.id,Ne,se,Se.tags))}return te}function In(X,H){var te=[];te.size=X.size,X.start!==void 0&&(te.start=X.start,te.end=X.end);for(var pe=0;pe<X.length;pe+=3)te.push(X[pe]+H,X[pe+1],X[pe+2]);return te}function ka(X,H){if(X.transformed)return X;var te,pe,se,Se=1<<X.z,Ne=X.x,Me=X.y;for(te=0;te<X.features.length;te++){var ve=X.features[te],Oe=ve.geometry,Je=ve.type;if(ve.geometry=[],Je===1)for(pe=0;pe<Oe.length;pe+=2)ve.geometry.push(mi(Oe[pe],Oe[pe+1],H,Se,Ne,Me));else for(pe=0;pe<Oe.length;pe++){var ct=[];for(se=0;se<Oe[pe].length;se+=2)ct.push(mi(Oe[pe][se],Oe[pe][se+1],H,Se,Ne,Me));ve.geometry.push(ct)}}return X.transformed=!0,X}function mi(X,H,te,pe,se,Se){return[Math.round(te*(X*pe-se)),Math.round(te*(H*pe-Se))]}function ne(X,H,te,pe,se){for(var Se=H===se.maxZoom?0:se.tolerance/((1<<H)*se.extent),Ne={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:te,y:pe,z:H,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Me=0;Me<X.length;Me++){Ne.numFeatures++,fe(Ne,X[Me],Se,se);var ve=X[Me].minX,Oe=X[Me].minY,Je=X[Me].maxX,ct=X[Me].maxY;ve<Ne.minX&&(Ne.minX=ve),Oe<Ne.minY&&(Ne.minY=Oe),Je>Ne.maxX&&(Ne.maxX=Je),ct>Ne.maxY&&(Ne.maxY=ct)}return Ne}function fe(X,H,te,pe){var se=H.geometry,Se=H.type,Ne=[];if(Se==="Point"||Se==="MultiPoint")for(var Me=0;Me<se.length;Me+=3)Ne.push(se[Me]),Ne.push(se[Me+1]),X.numPoints++,X.numSimplified++;else if(Se==="LineString")xe(Ne,se,X,te,!1,!1);else if(Se==="MultiLineString"||Se==="Polygon")for(Me=0;Me<se.length;Me++)xe(Ne,se[Me],X,te,Se==="Polygon",Me===0);else if(Se==="MultiPolygon")for(var ve=0;ve<se.length;ve++){var Oe=se[ve];for(Me=0;Me<Oe.length;Me++)xe(Ne,Oe[Me],X,te,!0,Me===0)}if(Ne.length){var Je=H.tags||null;if(Se==="LineString"&&pe.lineMetrics){for(var ct in Je={},H.tags)Je[ct]=H.tags[ct];Je.mapbox_clip_start=se.start/se.size,Je.mapbox_clip_end=se.end/se.size}var we={geometry:Ne,type:Se==="Polygon"||Se==="MultiPolygon"?3:Se==="LineString"||Se==="MultiLineString"?2:1,tags:Je};H.id!==null&&(we.id=H.id),X.features.push(we)}}function xe(X,H,te,pe,se,Se){var Ne=pe*pe;if(pe>0&&H.size<(se?Ne:pe))te.numPoints+=H.length/3;else{for(var Me=[],ve=0;ve<H.length;ve+=3)(pe===0||H[ve+2]>Ne)&&(te.numSimplified++,Me.push(H[ve]),Me.push(H[ve+1])),te.numPoints++;se&&function(Oe,Je){for(var ct=0,we=0,Pe=Oe.length,dt=Pe-2;we<Pe;dt=we,we+=2)ct+=(Oe[we]-Oe[dt])*(Oe[we+1]+Oe[dt+1]);if(ct>0===Je)for(we=0,Pe=Oe.length;we<Pe/2;we+=2){var xt=Oe[we],Lt=Oe[we+1];Oe[we]=Oe[Pe-2-we],Oe[we+1]=Oe[Pe-1-we],Oe[Pe-2-we]=xt,Oe[Pe-1-we]=Lt}}(Me,Se),X.push(Me)}}function Fe(X,H){var te=(H=this.options=function(se,Se){for(var Ne in Se)se[Ne]=Se[Ne];return se}(Object.create(this.options),H)).debug;if(te&&console.time("preprocess data"),H.maxZoom<0||H.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(H.promoteId&&H.generateId)throw new Error("promoteId and generateId cannot be used together.");var pe=function(se,Se){var Ne=[];if(se.type==="FeatureCollection")for(var Me=0;Me<se.features.length;Me++)ir(Ne,se.features[Me],Se,Me);else ir(Ne,se.type==="Feature"?se:{geometry:se},Se);return Ne}(X,H);this.tiles={},this.tileCoords=[],te&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",H.indexMaxZoom,H.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),pe=function(se,Se){var Ne=Se.buffer/Se.extent,Me=se,ve=Ao(se,1,-1-Ne,Ne,0,-1,2,Se),Oe=Ao(se,1,1-Ne,2+Ne,0,-1,2,Se);return(ve||Oe)&&(Me=Ao(se,1,-Ne,1+Ne,0,-1,2,Se)||[],ve&&(Me=mo(ve,1).concat(Me)),Oe&&(Me=Me.concat(mo(Oe,-1)))),Me}(pe,H),pe.length&&this.splitTile(pe,0,0,0),te&&(pe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Re(X,H,te){return 32*((1<<X)*te+H)+X}function We(X,H){const te=X.tileID.canonical;if(!this._geoJSONIndex)return H(null,null);const pe=this._geoJSONIndex.getTile(te.z,te.x,te.y);if(!pe)return H(null,null);const se=new gt(pe.features);let Se=Zt.exports(se);Se.byteOffset===0&&Se.byteLength===Se.buffer.byteLength||(Se=new Uint8Array(Se)),H(null,{vectorTile:se,rawData:Se.buffer})}Fe.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Fe.prototype.splitTile=function(X,H,te,pe,se,Se,Ne){for(var Me=[X,H,te,pe],ve=this.options,Oe=ve.debug;Me.length;){pe=Me.pop(),te=Me.pop(),H=Me.pop(),X=Me.pop();var Je=1<<H,ct=Re(H,te,pe),we=this.tiles[ct];if(!we&&(Oe>1&&console.time("creation"),we=this.tiles[ct]=ne(X,H,te,pe,ve),this.tileCoords.push({z:H,x:te,y:pe}),Oe)){Oe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",H,te,pe,we.numFeatures,we.numPoints,we.numSimplified),console.timeEnd("creation"));var Pe="z"+H;this.stats[Pe]=(this.stats[Pe]||0)+1,this.total++}if(we.source=X,se){if(H===ve.maxZoom||H===se)continue;var dt=1<<se-H;if(te!==Math.floor(Se/dt)||pe!==Math.floor(Ne/dt))continue}else if(H===ve.indexMaxZoom||we.numPoints<=ve.indexMaxPoints)continue;if(we.source=null,X.length!==0){Oe>1&&console.time("clipping");var xt,Lt,zt,Jt,or,Ar,Br=.5*ve.buffer/ve.extent,vr=.5-Br,Sr=.5+Br,Tr=1+Br;xt=Lt=zt=Jt=null,or=Ao(X,Je,te-Br,te+Sr,0,we.minX,we.maxX,ve),Ar=Ao(X,Je,te+vr,te+Tr,0,we.minX,we.maxX,ve),X=null,or&&(xt=Ao(or,Je,pe-Br,pe+Sr,1,we.minY,we.maxY,ve),Lt=Ao(or,Je,pe+vr,pe+Tr,1,we.minY,we.maxY,ve),or=null),Ar&&(zt=Ao(Ar,Je,pe-Br,pe+Sr,1,we.minY,we.maxY,ve),Jt=Ao(Ar,Je,pe+vr,pe+Tr,1,we.minY,we.maxY,ve),Ar=null),Oe>1&&console.timeEnd("clipping"),Me.push(xt||[],H+1,2*te,2*pe),Me.push(Lt||[],H+1,2*te,2*pe+1),Me.push(zt||[],H+1,2*te+1,2*pe),Me.push(Jt||[],H+1,2*te+1,2*pe+1)}}},Fe.prototype.getTile=function(X,H,te){var pe=this.options,se=pe.extent,Se=pe.debug;if(X<0||X>24)return null;var Ne=1<<X,Me=Re(X,H=(H%Ne+Ne)%Ne,te);if(this.tiles[Me])return ka(this.tiles[Me],se);Se>1&&console.log("drilling down to z%d-%d-%d",X,H,te);for(var ve,Oe=X,Je=H,ct=te;!ve&&Oe>0;)Oe--,Je=Math.floor(Je/2),ct=Math.floor(ct/2),ve=this.tiles[Re(Oe,Je,ct)];return ve&&ve.source?(Se>1&&console.log("found parent tile z%d-%d-%d",Oe,Je,ct),Se>1&&console.time("drilling down"),this.splitTile(ve.source,Oe,Je,ct,X,H,te),Se>1&&console.timeEnd("drilling down"),this.tiles[Me]?ka(this.tiles[Me],se):null):null};class st extends it{constructor(H,te,pe,se){super(H,te,pe,We),se&&(this.loadGeoJSON=se)}loadData(H,te){var pe;(pe=this._pendingRequest)===null||pe===void 0||pe.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const se=!!(H&&H.request&&H.request.collectResourceTiming)&&new o.RequestPerformance(H.request);this._pendingCallback=te,this._pendingRequest=this.loadGeoJSON(H,(Se,Ne)=>{if(delete this._pendingCallback,delete this._pendingRequest,Se||!Ne)return te(Se);if(typeof Ne!="object")return te(new Error(`Input data given to '${H.source}' is not a valid GeoJSON object.`));{_t(Ne,!0);try{if(H.filter){const ve=o.createExpression(H.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ve.result==="error")throw new Error(ve.value.map(Je=>`${Je.key}: ${Je.message}`).join(", "));Ne={type:"FeatureCollection",features:Ne.features.filter(Je=>ve.value.evaluate({zoom:0},Je))}}this._geoJSONIndex=H.cluster?new ni(function({superclusterOptions:ve,clusterProperties:Oe}){if(!Oe||!ve)return ve;const Je={},ct={},we={accumulated:null,zoom:0},Pe={properties:null},dt=Object.keys(Oe);for(const xt of dt){const[Lt,zt]=Oe[xt],Jt=o.createExpression(zt),or=o.createExpression(typeof Lt=="string"?[Lt,["accumulated"],["get",xt]]:Lt);Je[xt]=Jt.value,ct[xt]=or.value}return ve.map=xt=>{Pe.properties=xt;const Lt={};for(const zt of dt)Lt[zt]=Je[zt].evaluate(we,Pe);return Lt},ve.reduce=(xt,Lt)=>{Pe.properties=Lt;for(const zt of dt)we.accumulated=xt[zt],xt[zt]=ct[zt].evaluate(we,Pe)},ve}(H)).load(Ne.features):function(ve,Oe){return new Fe(ve,Oe)}(Ne,H.geojsonVtOptions)}catch(ve){return te(ve)}this.loaded={};const Me={};if(se){const ve=se.finish();ve&&(Me.resourceTiming={},Me.resourceTiming[H.source]=JSON.parse(JSON.stringify(ve)))}te(null,Me)}})}reloadTile(H,te){const pe=this.loaded;return pe&&pe[H.uid]?super.reloadTile(H,te):this.loadTile(H,te)}loadGeoJSON(H,te){if(H.request)return o.getJSON(H.request,te);if(typeof H.data=="string")try{te(null,JSON.parse(H.data))}catch{te(new Error(`Input data given to '${H.source}' is not a valid GeoJSON object.`))}else te(new Error(`Input data given to '${H.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}}removeSource(H,te){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),te()}getClusterExpansionZoom(H,te){try{te(null,this._geoJSONIndex.getClusterExpansionZoom(H.clusterId))}catch(pe){te(pe)}}getClusterChildren(H,te){try{te(null,this._geoJSONIndex.getChildren(H.clusterId))}catch(pe){te(pe)}}getClusterLeaves(H,te){try{te(null,this._geoJSONIndex.getLeaves(H.clusterId,H.limit,H.offset))}catch(pe){te(pe)}}}class Ee{constructor(H){this.self=H,this.actor=new o.Actor(H,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:it,geojson:st},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(te,pe)=>{if(this.workerSourceTypes[te])throw new Error(`Worker source with name "${te}" already registered.`);this.workerSourceTypes[te]=pe},this.self.registerRTLTextPlugin=te=>{if(o.plugin.isParsed())throw new Error("RTL text plugin already registered.");o.plugin.applyArabicShaping=te.applyArabicShaping,o.plugin.processBidirectionalText=te.processBidirectionalText,o.plugin.processStyledBidirectionalText=te.processStyledBidirectionalText}}setReferrer(H,te){this.referrer=te}setImages(H,te,pe){this.availableImages[H]=te;for(const se in this.workerSources[H]){const Se=this.workerSources[H][se];for(const Ne in Se)Se[Ne].availableImages=te}pe()}setLayers(H,te,pe){this.getLayerIndex(H).replace(te),pe()}updateLayers(H,te,pe){this.getLayerIndex(H).update(te.layers,te.removedIds),pe()}loadTile(H,te,pe){this.getWorkerSource(H,te.type,te.source).loadTile(te,pe)}loadDEMTile(H,te,pe){this.getDEMWorkerSource(H,te.source).loadTile(te,pe)}reloadTile(H,te,pe){this.getWorkerSource(H,te.type,te.source).reloadTile(te,pe)}abortTile(H,te,pe){this.getWorkerSource(H,te.type,te.source).abortTile(te,pe)}removeTile(H,te,pe){this.getWorkerSource(H,te.type,te.source).removeTile(te,pe)}removeDEMTile(H,te){this.getDEMWorkerSource(H,te.source).removeTile(te)}removeSource(H,te,pe){if(!this.workerSources[H]||!this.workerSources[H][te.type]||!this.workerSources[H][te.type][te.source])return;const se=this.workerSources[H][te.type][te.source];delete this.workerSources[H][te.type][te.source],se.removeSource!==void 0?se.removeSource(te,pe):pe()}loadWorkerSource(H,te,pe){try{this.self.importScripts(te.url),pe()}catch(se){pe(se.toString())}}syncRTLPluginState(H,te,pe){try{o.plugin.setState(te);const se=o.plugin.getPluginURL();if(o.plugin.isLoaded()&&!o.plugin.isParsed()&&se!=null){this.self.importScripts(se);const Se=o.plugin.isParsed();pe(Se?void 0:new Error(`RTL Text Plugin failed to import scripts from ${se}`),Se)}}catch(se){pe(se.toString())}}getAvailableImages(H){let te=this.availableImages[H];return te||(te=[]),te}getLayerIndex(H){let te=this.layerIndexes[H];return te||(te=this.layerIndexes[H]=new ae),te}getWorkerSource(H,te,pe){if(this.workerSources[H]||(this.workerSources[H]={}),this.workerSources[H][te]||(this.workerSources[H][te]={}),!this.workerSources[H][te][pe]){const se={send:(Se,Ne,Me)=>{this.actor.send(Se,Ne,Me,H)}};this.workerSources[H][te][pe]=new this.workerSourceTypes[te](se,this.getLayerIndex(H),this.getAvailableImages(H))}return this.workerSources[H][te][pe]}getDEMWorkerSource(H,te){return this.demWorkerSources[H]||(this.demWorkerSources[H]={}),this.demWorkerSources[H][te]||(this.demWorkerSources[H][te]=new tt),this.demWorkerSources[H][te]}enforceCacheSizeLimit(H,te){o.enforceCacheSizeLimit(te)}}return o.isWorker()&&(self.worker=new Ee(self)),Ee}),V(["./shared"],function(o){var q=K;function K(y){return!function(r){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var m,_,S=new Blob([""],{type:"text/javascript"}),z=URL.createObjectURL(S);try{_=new Worker(z),m=!0}catch{m=!1}return _&&_.terminate(),URL.revokeObjectURL(z),m}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var m=document.createElement("canvas");m.width=m.height=1;var _=m.getContext("2d");if(!_)return!1;var S=_.getImageData(0,0,1,1);return S&&S.width===m.width}()?(ae[c=r&&r.failIfMajorPerformanceCaveat]===void 0&&(ae[c]=function(m){var _,S=function(z){var N=document.createElement("canvas"),$=Object.create(K.webGLContextAttributes);return $.failIfMajorPerformanceCaveat=z,N.getContext("webgl",$)||N.getContext("experimental-webgl",$)}(m);if(!S)return!1;try{_=S.createShader(S.VERTEX_SHADER)}catch{return!1}return!(!_||S.isContextLost())&&(S.shaderSource(_,"void main() {}"),S.compileShader(_),S.getShaderParameter(_,S.COMPILE_STATUS)===!0)}(c)),ae[c]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var c}(y)}var ae={};function Y(y,r){if(Array.isArray(y)){if(!Array.isArray(r)||y.length!==r.length)return!1;for(let c=0;c<y.length;c++)if(!Y(y[c],r[c]))return!1;return!0}if(typeof y=="object"&&y!==null&&r!==null){if(typeof r!="object"||Object.keys(y).length!==Object.keys(r).length)return!1;for(const c in y)if(!Y(y[c],r[c]))return!1;return!0}return y===r}K.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class ie{static testProp(r){if(!ie.docStyle)return r[0];for(let c=0;c<r.length;c++)if(r[c]in ie.docStyle)return r[c];return r[0]}static create(r,c,m){const _=window.document.createElement(r);return c!==void 0&&(_.className=c),m&&m.appendChild(_),_}static createNS(r,c){return window.document.createElementNS(r,c)}static disableDrag(){ie.docStyle&&ie.selectProp&&(ie.userSelect=ie.docStyle[ie.selectProp],ie.docStyle[ie.selectProp]="none")}static enableDrag(){ie.docStyle&&ie.selectProp&&(ie.docStyle[ie.selectProp]=ie.userSelect)}static setTransform(r,c){r.style[ie.transformProp]=c}static addEventListener(r,c,m,_={}){r.addEventListener(c,m,"passive"in _?_:_.capture)}static removeEventListener(r,c,m,_={}){r.removeEventListener(c,m,"passive"in _?_:_.capture)}static suppressClickInternal(r){r.preventDefault(),r.stopPropagation(),window.removeEventListener("click",ie.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",ie.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",ie.suppressClickInternal,!0)},0)}static mousePos(r,c){const m=r.getBoundingClientRect();return new o.pointGeometry(c.clientX-m.left-r.clientLeft,c.clientY-m.top-r.clientTop)}static touchPos(r,c){const m=r.getBoundingClientRect(),_=[];for(let S=0;S<c.length;S++)_.push(new o.pointGeometry(c[S].clientX-m.left-r.clientLeft,c[S].clientY-m.top-r.clientTop));return _}static mouseButton(r){return r.button}static remove(r){r.parentNode&&r.parentNode.removeChild(r)}}ie.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,ie.selectProp=ie.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),ie.transformProp=ie.testProp(["transform","WebkitTransform"]);class be{constructor(r){this._transformRequestFn=r}transformRequest(r,c){return this._transformRequestFn&&this._transformRequestFn(r,c)||{url:r}}normalizeSpriteURL(r,c,m){const _=function(S){const z=S.match(ze);if(!z)throw new Error(`Unable to parse URL "${S}"`);return{protocol:z[1],authority:z[2],path:z[3]||"/",params:z[4]?z[4].split("&"):[]}}(r);return _.path+=`${c}${m}`,function(S){const z=S.params.length?`?${S.params.join("&")}`:"";return`${S.protocol}://${S.authority}${S.path}${z}`}(_)}setTransformRequest(r){this._transformRequestFn=r}}const ze=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;class it{constructor(r,c,m,_){this.context=r,this.format=m,this.texture=r.gl.createTexture(),this.update(c,_)}update(r,c,m){const{width:_,height:S}=r,z=!(this.size&&this.size[0]===_&&this.size[1]===S||m),{context:N}=this,{gl:$}=N;if(this.useMipmap=Boolean(c&&c.useMipmap),$.bindTexture($.TEXTURE_2D,this.texture),N.pixelStoreUnpackFlipY.set(!1),N.pixelStoreUnpack.set(1),N.pixelStoreUnpackPremultiplyAlpha.set(this.format===$.RGBA&&(!c||c.premultiply!==!1)),z)this.size=[_,S],r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||o.isImageBitmap(r)?$.texImage2D($.TEXTURE_2D,0,this.format,this.format,$.UNSIGNED_BYTE,r):$.texImage2D($.TEXTURE_2D,0,this.format,_,S,0,this.format,$.UNSIGNED_BYTE,r.data);else{const{x:W,y:ce}=m||{x:0,y:0};r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||o.isImageBitmap(r)?$.texSubImage2D($.TEXTURE_2D,0,W,ce,$.RGBA,$.UNSIGNED_BYTE,r):$.texSubImage2D($.TEXTURE_2D,0,W,ce,_,S,$.RGBA,$.UNSIGNED_BYTE,r.data)}this.useMipmap&&this.isSizePowerOfTwo()&&$.generateMipmap($.TEXTURE_2D)}bind(r,c,m){const{context:_}=this,{gl:S}=_;S.bindTexture(S.TEXTURE_2D,this.texture),m!==S.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(m=S.LINEAR),r!==this.filter&&(S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MAG_FILTER,r),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_MIN_FILTER,m||r),this.filter=r),c!==this.wrap&&(S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_S,c),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_T,c),this.wrap=c)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:r}=this.context;r.deleteTexture(this.texture),this.texture=null}}function tt(y){const{userImage:r}=y;return!!(r&&r.render&&r.render())&&(y.data.replace(new Uint8Array(r.data.buffer)),!0)}class _t extends o.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(r){if(this.loaded!==r&&(this.loaded=r,r)){for(const{ids:c,callback:m}of this.requestors)this._notify(c,m);this.requestors=[]}}getImage(r){return this.images[r]}addImage(r,c){if(this.images[r])throw new Error(`Image id ${r} already exist, use updateImage instead`);this._validate(r,c)&&(this.images[r]=c)}_validate(r,c){let m=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new o.ErrorEvent(new Error(`Image "${r}" has invalid "stretchX" value`))),m=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new o.ErrorEvent(new Error(`Image "${r}" has invalid "stretchY" value`))),m=!1),this._validateContent(c.content,c)||(this.fire(new o.ErrorEvent(new Error(`Image "${r}" has invalid "content" value`))),m=!1),m}_validateStretch(r,c){if(!r)return!0;let m=0;for(const _ of r){if(_[0]<m||_[1]<_[0]||c<_[1])return!1;m=_[1]}return!0}_validateContent(r,c){return!(r&&(r.length!==4||r[0]<0||c.data.width<r[0]||r[1]<0||c.data.height<r[1]||r[2]<0||c.data.width<r[2]||r[3]<0||c.data.height<r[3]||r[2]<r[0]||r[3]<r[1]))}updateImage(r,c){const m=this.images[r];if(m.data.width!==c.data.width||m.data.height!==c.data.height)throw new Error(`size mismatch between old image (${m.data.width}x${m.data.height}) and new image (${c.data.width}x${c.data.height}).`);c.version=m.version+1,this.images[r]=c,this.updatedImages[r]=!0}removeImage(r){const c=this.images[r];delete this.images[r],delete this.patterns[r],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(r,c){let m=!0;if(!this.isLoaded())for(const _ of r)this.images[_]||(m=!1);this.isLoaded()||m?this._notify(r,c):this.requestors.push({ids:r,callback:c})}_notify(r,c){const m={};for(const _ of r){this.images[_]||this.fire(new o.Event("styleimagemissing",{id:_}));const S=this.images[_];S?m[_]={data:S.data.clone(),pixelRatio:S.pixelRatio,sdf:S.sdf,version:S.version,stretchX:S.stretchX,stretchY:S.stretchY,content:S.content,hasRenderCallback:Boolean(S.userImage&&S.userImage.render)}:o.warnOnce(`Image "${_}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}c(null,m)}getPixelSize(){const{width:r,height:c}=this.atlasImage;return{width:r,height:c}}getPattern(r){const c=this.patterns[r],m=this.getImage(r);if(!m)return null;if(c&&c.position.version===m.version)return c.position;if(c)c.position.version=m.version;else{const _={w:m.data.width+2,h:m.data.height+2,x:0,y:0},S=new o.ImagePosition(_,m);this.patterns[r]={bin:_,position:S}}return this._updatePatternAtlas(),this.patterns[r].position}bind(r){const c=r.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new it(r,this.atlasImage,c.RGBA),this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)}_updatePatternAtlas(){const r=[];for(const S in this.patterns)r.push(this.patterns[S].bin);const{w:c,h:m}=o.potpack(r),_=this.atlasImage;_.resize({width:c||1,height:m||1});for(const S in this.patterns){const{bin:z}=this.patterns[S],N=z.x+1,$=z.y+1,W=this.images[S].data,ce=W.width,ge=W.height;o.RGBAImage.copy(W,_,{x:0,y:0},{x:N,y:$},{width:ce,height:ge}),o.RGBAImage.copy(W,_,{x:0,y:ge-1},{x:N,y:$-1},{width:ce,height:1}),o.RGBAImage.copy(W,_,{x:0,y:0},{x:N,y:$+ge},{width:ce,height:1}),o.RGBAImage.copy(W,_,{x:ce-1,y:0},{x:N-1,y:$},{width:1,height:ge}),o.RGBAImage.copy(W,_,{x:0,y:0},{x:N+ce,y:$},{width:1,height:ge})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(r){for(const c of r){if(this.callbackDispatchedThisFrame[c])continue;this.callbackDispatchedThisFrame[c]=!0;const m=this.images[c];m||o.warnOnce(`Image with ID: "${c}" was not found`),tt(m)&&this.updateImage(c,m)}}}const yt=1e20;function Bt(y,r,c,m,_,S,z,N,$){for(let W=r;W<r+m;W++)rt(y,c*S+W,S,_,z,N,$);for(let W=c;W<c+_;W++)rt(y,W*S+r,1,m,z,N,$)}function rt(y,r,c,m,_,S,z){S[0]=0,z[0]=-yt,z[1]=yt,_[0]=y[r];for(let N=1,$=0,W=0;N<m;N++){_[N]=y[r+N*c];const ce=N*N;do{const ge=S[$];W=(_[N]-_[ge]+ce-ge*ge)/(N-ge)/2}while(W<=z[$]&&--$>-1);$++,S[$]=N,z[$]=W,z[$+1]=yt}for(let N=0,$=0;N<m;N++){for(;z[$+1]<N;)$++;const W=S[$],ce=N-W;y[r+N*c]=_[W]+ce*ce}}class It{constructor(r,c){this.requestManager=r,this.localIdeographFontFamily=c,this.entries={}}setURL(r){this.url=r}getGlyphs(r,c){const m=[];for(const _ in r)for(const S of r[_])m.push({stack:_,id:S});o.asyncAll(m,({stack:_,id:S},z)=>{let N=this.entries[_];N||(N=this.entries[_]={glyphs:{},requests:{},ranges:{}});let $=N.glyphs[S];if($!==void 0)return void z(null,{stack:_,id:S,glyph:$});if($=this._tinySDF(N,_,S),$)return N.glyphs[S]=$,void z(null,{stack:_,id:S,glyph:$});const W=Math.floor(S/256);if(256*W>65535)return void z(new Error("glyphs > 65535 not supported"));if(N.ranges[W])return void z(null,{stack:_,id:S,glyph:$});let ce=N.requests[W];ce||(ce=N.requests[W]=[],It.loadGlyphRange(_,W,this.url,this.requestManager,(ge,Ce)=>{if(Ce){for(const je in Ce)this._doesCharSupportLocalGlyph(+je)||(N.glyphs[+je]=Ce[+je]);N.ranges[W]=!0}for(const je of ce)je(ge,Ce);delete N.requests[W]})),ce.push((ge,Ce)=>{ge?z(ge):Ce&&z(null,{stack:_,id:S,glyph:Ce[S]||null})})},(_,S)=>{if(_)c(_);else if(S){const z={};for(const{stack:N,id:$,glyph:W}of S)(z[N]||(z[N]={}))[$]=W&&{id:W.id,bitmap:W.bitmap.clone(),metrics:W.metrics};c(null,z)}})}_doesCharSupportLocalGlyph(r){return!!this.localIdeographFontFamily&&(o.unicodeBlockLookup["CJK Unified Ideographs"](r)||o.unicodeBlockLookup["Hangul Syllables"](r)||o.unicodeBlockLookup.Hiragana(r)||o.unicodeBlockLookup.Katakana(r))}_tinySDF(r,c,m){const _=this.localIdeographFontFamily;if(!_||!this._doesCharSupportLocalGlyph(m))return;let S=r.tinySDF;if(!S){let N="400";/bold/i.test(c)?N="900":/medium/i.test(c)?N="500":/light/i.test(c)&&(N="200"),S=r.tinySDF=new It.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:_,fontWeight:N})}const z=S.draw(String.fromCharCode(m));return{id:m,bitmap:new o.AlphaImage({width:z.width||30,height:z.height||30},z.data),metrics:{width:z.glyphWidth||24,height:z.glyphHeight||24,left:z.glyphLeft||0,top:z.glyphTop-27||-8,advance:z.glyphAdvance||24}}}}It.loadGlyphRange=function(y,r,c,m,_){const S=256*r,z=S+255,N=m.transformRequest(c.replace("{fontstack}",y).replace("{range}",`${S}-${z}`),o.ResourceType.Glyphs);o.getArrayBuffer(N,($,W)=>{if($)_($);else if(W){const ce={};for(const ge of o.parseGlyphPbf(W))ce[ge.id]=ge;_(null,ce)}})},It.TinySDF=class{constructor({fontSize:y=24,buffer:r=3,radius:c=8,cutoff:m=.25,fontFamily:_="sans-serif",fontWeight:S="normal",fontStyle:z="normal"}={}){this.buffer=r,this.cutoff=m,this.radius=c;const N=this.size=y+4*r,$=this._createCanvas(N),W=this.ctx=$.getContext("2d",{willReadFrequently:!0});W.font=`${z} ${S} ${y}px ${_}`,W.textBaseline="alphabetic",W.textAlign="left",W.fillStyle="black",this.gridOuter=new Float64Array(N*N),this.gridInner=new Float64Array(N*N),this.f=new Float64Array(N),this.z=new Float64Array(N+1),this.v=new Uint16Array(N)}_createCanvas(y){const r=document.createElement("canvas");return r.width=r.height=y,r}draw(y){const{width:r,actualBoundingBoxAscent:c,actualBoundingBoxDescent:m,actualBoundingBoxLeft:_,actualBoundingBoxRight:S}=this.ctx.measureText(y),z=Math.ceil(c),N=Math.min(this.size-this.buffer,Math.ceil(S-_)),$=Math.min(this.size-this.buffer,z+Math.ceil(m)),W=N+2*this.buffer,ce=$+2*this.buffer,ge=Math.max(W*ce,0),Ce=new Uint8ClampedArray(ge),je={data:Ce,width:W,height:ce,glyphWidth:N,glyphHeight:$,glyphTop:z,glyphLeft:0,glyphAdvance:r};if(N===0||$===0)return je;const{ctx:De,buffer:Ke,gridInner:lt,gridOuter:ht}=this;De.clearRect(Ke,Ke,N,$),De.fillText(y,Ke,Ke+z);const vt=De.getImageData(Ke,Ke,N,$);ht.fill(yt,0,ge),lt.fill(0,0,ge);for(let $e=0;$e<$;$e++)for(let Ct=0;Ct<N;Ct++){const wt=vt.data[4*($e*N+Ct)+3]/255;if(wt===0)continue;const Mt=($e+Ke)*W+Ct+Ke;if(wt===1)ht[Mt]=0,lt[Mt]=yt;else{const Ft=.5-wt;ht[Mt]=Ft>0?Ft*Ft:0,lt[Mt]=Ft<0?Ft*Ft:0}}Bt(ht,0,0,W,ce,W,this.f,this.v,this.z),Bt(lt,Ke,Ke,N,$,W,this.f,this.v,this.z);for(let $e=0;$e<ge;$e++){const Ct=Math.sqrt(ht[$e])-Math.sqrt(lt[$e]);Ce[$e]=Math.round(255-255*(Ct/this.radius+this.cutoff))}return je}};const gt=new o.Properties({anchor:new o.DataConstantProperty(o.spec.light.anchor),position:new class{constructor(){this.specification=o.spec.light.position}possiblyEvaluate(y,r){return o.sphericalToCartesian(y.expression.evaluate(r))}interpolate(y,r,c){return{x:o.number(y.x,r.x,c),y:o.number(y.y,r.y,c),z:o.number(y.z,r.z,c)}}},color:new o.DataConstantProperty(o.spec.light.color),intensity:new o.DataConstantProperty(o.spec.light.intensity)}),Zt="-transition";class dr extends o.Evented{constructor(r){super(),this._transitionable=new o.Transitionable(gt),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,c={}){if(!this._validate(o.validateLight,r,c))for(const m in r){const _=r[m];m.endsWith(Zt)?this._transitionable.setTransition(m.slice(0,-Zt.length),_):this._transitionable.setValue(m,_)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,c,m){return(!m||m.validate!==!1)&&o.emitValidationErrors(this,r.call(o.validateStyle,o.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}class Xr{constructor(r,c){this.width=r,this.height=c,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(r,c){const m=r.join(",")+String(c);return this.dashEntry[m]||(this.dashEntry[m]=this.addDash(r,c)),this.dashEntry[m]}getDashRanges(r,c,m){const _=[];let S=r.length%2==1?-r[r.length-1]*m:0,z=r[0]*m,N=!0;_.push({left:S,right:z,isDash:N,zeroLength:r[0]===0});let $=r[0];for(let W=1;W<r.length;W++){N=!N;const ce=r[W];S=$*m,$+=ce,z=$*m,_.push({left:S,right:z,isDash:N,zeroLength:ce===0})}return _}addRoundDash(r,c,m){const _=c/2;for(let S=-m;S<=m;S++){const z=this.width*(this.nextRow+m+S);let N=0,$=r[N];for(let W=0;W<this.width;W++){W/$.right>1&&($=r[++N]);const ce=Math.abs(W-$.left),ge=Math.abs(W-$.right),Ce=Math.min(ce,ge);let je;const De=S/m*(_+1);if($.isDash){const Ke=_-Math.abs(De);je=Math.sqrt(Ce*Ce+Ke*Ke)}else je=_-Math.sqrt(Ce*Ce+De*De);this.data[z+W]=Math.max(0,Math.min(255,je+128))}}}addRegularDash(r){for(let N=r.length-1;N>=0;--N){const $=r[N],W=r[N+1];$.zeroLength?r.splice(N,1):W&&W.isDash===$.isDash&&(W.left=$.left,r.splice(N,1))}const c=r[0],m=r[r.length-1];c.isDash===m.isDash&&(c.left=m.left-this.width,m.right=c.right+this.width);const _=this.width*this.nextRow;let S=0,z=r[S];for(let N=0;N<this.width;N++){N/z.right>1&&(z=r[++S]);const $=Math.abs(N-z.left),W=Math.abs(N-z.right),ce=Math.min($,W);this.data[_+N]=Math.max(0,Math.min(255,(z.isDash?ce:-ce)+128))}}addDash(r,c){const m=c?7:0,_=2*m+1;if(this.nextRow+_>this.height)return o.warnOnce("LineAtlas out of space"),null;let S=0;for(let N=0;N<r.length;N++)S+=r[N];if(S!==0){const N=this.width/S,$=this.getDashRanges(r,this.width,N);c?this.addRoundDash($,N,m):this.addRegularDash($)}const z={y:(this.nextRow+m+.5)/this.height,height:2*m/this.height,width:S};return this.nextRow+=_,this.dirty=!0,z}bind(r){const c=r.gl;this.texture?(c.bindTexture(c.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,c.texSubImage2D(c.TEXTURE_2D,0,0,0,this.width,this.height,c.ALPHA,c.UNSIGNED_BYTE,this.data))):(this.texture=c.createTexture(),c.bindTexture(c.TEXTURE_2D,this.texture),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.REPEAT),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.REPEAT),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.LINEAR),c.texImage2D(c.TEXTURE_2D,0,c.ALPHA,this.width,this.height,0,c.ALPHA,c.UNSIGNED_BYTE,this.data))}}class ur{constructor(r,c){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=o.uniqueId();const m=this.workerPool.acquire(this.id);for(let _=0;_<m.length;_++){const S=new ur.Actor(m[_],c,this.id);S.name=`Worker ${_}`,this.actors.push(S)}if(!this.actors.length)throw new Error("No actors found")}broadcast(r,c,m){o.asyncAll(this.actors,(_,S)=>{_.send(r,c,S)},m=m||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(r=>{r.remove()}),this.actors=[],this.workerPool.release(this.id)}}function _r(y,r,c){const m=function(_,S){if(_)return c(_);if(S){const z=o.pick(o.extend(S,y),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);S.vector_layers&&(z.vectorLayers=S.vector_layers,z.vectorLayerIds=z.vectorLayers.map(N=>N.id)),c(null,z)}};return y.url?o.getJSON(r.transformRequest(y.url,o.ResourceType.Source),m):o.exported.frame(()=>m(null,y))}ur.Actor=o.Actor;class Rr{constructor(r,c,m){this.bounds=o.LngLatBounds.convert(this.validateBounds(r)),this.minzoom=c||0,this.maxzoom=m||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const c=Math.pow(2,r.z),m=Math.floor(o.mercatorXfromLng(this.bounds.getWest())*c),_=Math.floor(o.mercatorYfromLat(this.bounds.getNorth())*c),S=Math.ceil(o.mercatorXfromLng(this.bounds.getEast())*c),z=Math.ceil(o.mercatorYfromLat(this.bounds.getSouth())*c);return r.x>=m&&r.x<S&&r.y>=_&&r.y<z}}class ei extends o.Evented{constructor(r,c,m,_){if(super(),this.id=r,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.extend(this,o.pick(c,["url","scheme","tileSize","promoteId"])),this._options=o.extend({type:"vector"},c),this._collectResourceTiming=c.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_)}load(){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=_r(this._options,this.map._requestManager,(r,c)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),r?this.fire(new o.ErrorEvent(r)):c&&(o.extend(this,c),c.bounds&&(this.tileBounds=new Rr(c.bounds,this.minzoom,this.maxzoom)),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}setSourceProperty(r){this._tileJSONRequest&&this._tileJSONRequest.cancel(),r(),this.load()}setTiles(r){return this.setSourceProperty(()=>{this._options.tiles=r}),this}setUrl(r){return this.setSourceProperty(()=>{this.url=r,this._options.url=r}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return o.extend({},this._options)}loadTile(r,c){const m=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),_={request:this.map._requestManager.transformRequest(m,o.ResourceType.Tile),uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function S(z,N){return delete r.request,r.aborted?c(null):z&&z.status!==404?c(z):(N&&N.resourceTiming&&(r.resourceTiming=N.resourceTiming),this.map._refreshExpiredTiles&&N&&r.setExpiryData(N),r.loadVectorData(N,this.map.painter),o.cacheEntryPossiblyAdded(this.dispatcher),c(null),void(r.reloadCallback&&(this.loadTile(r,r.reloadCallback),r.reloadCallback=null)))}_.request.collectResourceTiming=this._collectResourceTiming,r.actor&&r.state!=="expired"?r.state==="loading"?r.reloadCallback=c:r.request=r.actor.send("reloadTile",_,S.bind(this)):(r.actor=this.dispatcher.getActor(),r.request=r.actor.send("loadTile",_,S.bind(this)))}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.actor&&r.actor.send("abortTile",{uid:r.uid,type:this.type,source:this.id},void 0)}unloadTile(r){r.unloadVectorData(),r.actor&&r.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class rr extends o.Evented{constructor(r,c,m,_){super(),this.id=r,this.dispatcher=m,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.extend({type:"raster"},c),o.extend(this,o.pick(c,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=_r(this._options,this.map._requestManager,(r,c)=>{this._tileJSONRequest=null,this._loaded=!0,r?this.fire(new o.ErrorEvent(r)):c&&(o.extend(this,c),c.bounds&&(this.tileBounds=new Rr(c.bounds,this.minzoom,this.maxzoom)),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return o.extend({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,c){const m=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);r.request=o.getImage(this.map._requestManager.transformRequest(m,o.ResourceType.Tile),(_,S,z)=>{if(delete r.request,r.aborted)r.state="unloaded",c(null);else if(_)r.state="errored",c(_);else if(S){this.map._refreshExpiredTiles&&r.setExpiryData(z);const N=this.map.painter.context,$=N.gl;r.texture=this.map.painter.getTileTexture(S.width),r.texture?r.texture.update(S,{useMipmap:!0}):(r.texture=new it(N,S,$.RGBA,{useMipmap:!0}),r.texture.bind($.LINEAR,$.CLAMP_TO_EDGE,$.LINEAR_MIPMAP_NEAREST),N.extTextureFilterAnisotropic&&$.texParameterf($.TEXTURE_2D,N.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,N.extTextureFilterAnisotropicMax)),r.state="loaded",o.cacheEntryPossiblyAdded(this.dispatcher),c(null)}})}abortTile(r,c){r.request&&(r.request.cancel(),delete r.request),c()}unloadTile(r,c){r.texture&&this.map.painter.saveTileTexture(r.texture),c()}hasTransition(){return!1}}let kt;class Rt extends rr{constructor(r,c,m,_){super(r,c,m,_),this.type="raster-dem",this.maxzoom=22,this._options=o.extend({type:"raster-dem"},c),this.encoding=c.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(r,c){const m=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function _(S,z){S&&(r.state="errored",c(S)),z&&(r.dem=z,r.needsHillshadePrepare=!0,r.needsTerrainPrepare=!0,r.state="loaded",c(null))}r.request=o.getImage(this.map._requestManager.transformRequest(m,o.ResourceType.Tile),function(S,z){if(delete r.request,r.aborted)r.state="unloaded",c(null);else if(S)r.state="errored",c(S);else if(z){this.map._refreshExpiredTiles&&r.setExpiryData(z),delete z.cacheControl,delete z.expires;const N=o.isImageBitmap(z)&&(kt==null&&(kt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),kt)?z:o.exported.getImageData(z,1),$={uid:r.uid,coord:r.tileID,source:this.id,rawImageData:N,encoding:this.encoding};r.actor&&r.state!=="expired"||(r.actor=this.dispatcher.getActor(),r.actor.send("loadDEMTile",$,_.bind(this)))}}.bind(this)),r.neighboringTiles=this._getNeighboringTiles(r.tileID)}_getNeighboringTiles(r){const c=r.canonical,m=Math.pow(2,c.z),_=(c.x-1+m)%m,S=c.x===0?r.wrap-1:r.wrap,z=(c.x+1+m)%m,N=c.x+1===m?r.wrap+1:r.wrap,$={};return $[new o.OverscaledTileID(r.overscaledZ,S,c.z,_,c.y).key]={backfilled:!1},$[new o.OverscaledTileID(r.overscaledZ,N,c.z,z,c.y).key]={backfilled:!1},c.y>0&&($[new o.OverscaledTileID(r.overscaledZ,S,c.z,_,c.y-1).key]={backfilled:!1},$[new o.OverscaledTileID(r.overscaledZ,r.wrap,c.z,c.x,c.y-1).key]={backfilled:!1},$[new o.OverscaledTileID(r.overscaledZ,N,c.z,z,c.y-1).key]={backfilled:!1}),c.y+1<m&&($[new o.OverscaledTileID(r.overscaledZ,S,c.z,_,c.y+1).key]={backfilled:!1},$[new o.OverscaledTileID(r.overscaledZ,r.wrap,c.z,c.x,c.y+1).key]={backfilled:!1},$[new o.OverscaledTileID(r.overscaledZ,N,c.z,z,c.y+1).key]={backfilled:!1}),$}unloadTile(r){r.demTexture&&this.map.painter.saveTileTexture(r.demTexture),r.fbo&&(r.fbo.destroy(),delete r.fbo),r.dem&&delete r.dem,delete r.neighboringTiles,r.state="unloaded",r.actor&&r.actor.send("removeDEMTile",{uid:r.uid,source:this.id})}}class br extends o.Evented{constructor(r,c,m,_){super(),this.id=r,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=m.getActor(),this.setEventedParent(_),this._data=c.data,this._options=o.extend({},c),this._collectResourceTiming=c.collectResourceTiming,c.maxzoom!==void 0&&(this.maxzoom=c.maxzoom),c.type&&(this.type=c.type),c.attribution&&(this.attribution=c.attribution),this.promoteId=c.promoteId;const S=o.EXTENT/this.tileSize;this.workerOptions=o.extend({source:this.id,cluster:c.cluster||!1,geojsonVtOptions:{buffer:(c.buffer!==void 0?c.buffer:128)*S,tolerance:(c.tolerance!==void 0?c.tolerance:.375)*S,extent:o.EXTENT,maxZoom:this.maxzoom,lineMetrics:c.lineMetrics||!1,generateId:c.generateId||!1},superclusterOptions:{maxZoom:c.clusterMaxZoom!==void 0?c.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,c.clusterMinPoints||2),extent:o.EXTENT,radius:(c.clusterRadius||50)*S,log:!1,generateId:c.generateId||!1},clusterProperties:c.clusterProperties,filter:c.filter},c.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(r){this.map=r,this.load()}setData(r){return this._data=r,this._updateWorkerData("content"),this}getClusterExpansionZoom(r,c){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:r,source:this.id},c),this}getClusterChildren(r,c){return this.actor.send("geojson.getClusterChildren",{clusterId:r,source:this.id},c),this}getClusterLeaves(r,c,m,_){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:r,limit:c,offset:m},_),this}_updateWorkerData(r){const c=o.extend({},this.workerOptions),m=this._data;typeof m=="string"?(c.request=this.map._requestManager.transformRequest(o.exported.resolveURL(m),o.ResourceType.Source),c.request.collectResourceTiming=this._collectResourceTiming):c.data=JSON.stringify(m),this._pendingLoads++,this.fire(new o.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,c,(_,S)=>{if(this._pendingLoads--,this._removed||S&&S.abandoned)return void this.fire(new o.Event("dataabort",{dataType:"source",sourceDataType:r}));let z=null;if(S&&S.resourceTiming&&S.resourceTiming[this.id]&&(z=S.resourceTiming[this.id].slice(0)),_)return void this.fire(new o.ErrorEvent(_));const N={dataType:"source",sourceDataType:r};this._collectResourceTiming&&z&&z.length>0&&o.extend(N,{resourceTiming:z}),this.fire(new o.Event("data",N))})}loaded(){return this._pendingLoads===0}loadTile(r,c){const m=r.actor?"reloadTile":"loadTile";r.actor=this.actor;const _={type:this.type,uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};r.request=this.actor.send(m,_,(S,z)=>(delete r.request,r.unloadVectorData(),r.aborted?c(null):S?c(S):(r.loadVectorData(z,this.map.painter,m==="reloadTile"),c(null))))}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.aborted=!0}unloadTile(r){r.unloadVectorData(),this.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return o.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var Or=o.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Kr extends o.Evented{constructor(r,c,m,_){super(),this.id=r,this.dispatcher=m,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=c}load(r,c){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this.url=this.options.url,o.getImage(this.map._requestManager.transformRequest(this.url,o.ResourceType.Image),(m,_)=>{this._loaded=!0,m?this.fire(new o.ErrorEvent(m)):_&&(this.image=_,r&&(this.coordinates=r),c&&c(),this._finishLoading())})}loaded(){return this._loaded}updateImage(r){return this.image&&r.url?(this.options.url=r.url,this.load(r.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}setCoordinates(r){this.coordinates=r;const c=r.map(o.MercatorCoordinate.fromLngLat);this.tileID=function(_){let S=1/0,z=1/0,N=-1/0,$=-1/0;for(const Ce of _)S=Math.min(S,Ce.x),z=Math.min(z,Ce.y),N=Math.max(N,Ce.x),$=Math.max($,Ce.y);const W=Math.max(N-S,$-z),ce=Math.max(0,Math.floor(-Math.log(W)/Math.LN2)),ge=Math.pow(2,ce);return new o.CanonicalTileID(ce,Math.floor((S+N)/2*ge),Math.floor((z+$)/2*ge))}(c),this.minzoom=this.maxzoom=this.tileID.z;const m=c.map(_=>this.tileID.getTilePoint(_)._round());return this._boundsArray=new o.RasterBoundsArray,this._boundsArray.emplaceBack(m[0].x,m[0].y,0,0),this._boundsArray.emplaceBack(m[1].x,m[1].y,o.EXTENT,0),this._boundsArray.emplaceBack(m[3].x,m[3].y,0,o.EXTENT),this._boundsArray.emplaceBack(m[2].x,m[2].y,o.EXTENT,o.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const r=this.map.painter.context,c=r.gl;this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,Or.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new it(r,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE));for(const m in this.tiles){const _=this.tiles[m];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture)}}loadTile(r,c){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={},c(null)):(r.state="errored",c(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class di extends Kr{constructor(r,c,m,_){super(r,c,m,_),this.roundZoom=!0,this.type="video",this.options=c}load(){this._loaded=!1;const r=this.options;this.urls=[];for(const c of r.urls)this.urls.push(this.map._requestManager.transformRequest(c,o.ResourceType.Source).url);o.getVideo(this.urls,(c,m)=>{this._loaded=!0,c?this.fire(new o.ErrorEvent(c)):m&&(this.video=m,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(r){if(this.video){const c=this.video.seekable;r<c.start(0)||r>c.end(0)?this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${c.start(0)} and ${c.end(0)}-second mark.`))):this.video.currentTime=r}}getVideo(){return this.video}onAdd(r){this.map||(this.map=r,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const r=this.map.painter.context,c=r.gl;this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,Or.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.texSubImage2D(c.TEXTURE_2D,0,0,0,c.RGBA,c.UNSIGNED_BYTE,this.video)):(this.texture=new it(r,this.video,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE));for(const m in this.tiles){const _=this.tiles[m];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class ri extends Kr{constructor(r,c,m,_){super(r,c,m,_),c.coordinates?Array.isArray(c.coordinates)&&c.coordinates.length===4&&!c.coordinates.some(S=>!Array.isArray(S)||S.length!==2||S.some(z=>typeof z!="number"))||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${r}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${r}`,null,'missing required property "coordinates"'))),c.animate&&typeof c.animate!="boolean"&&this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${r}`,null,'optional "animate" property must be a boolean value'))),c.canvas?typeof c.canvas=="string"||c.canvas instanceof HTMLCanvasElement||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${r}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${r}`,null,'missing required property "canvas"'))),this.options=c,this.animate=c.animate===void 0||c.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(r){this.map=r,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let r=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,r=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,r=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const c=this.map.painter.context,m=c.gl;this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,Or.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(r||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new it(c,this.canvas,m.RGBA,{premultiply:!0});for(const _ in this.tiles){const S=this.tiles[_];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const r of[this.canvas.width,this.canvas.height])if(isNaN(r)||r<=0)return!0;return!1}}const ii={vector:ei,raster:rr,"raster-dem":Rt,geojson:br,video:di,image:Kr,canvas:ri};function ki(y,r){const c=o.create();return o.translate(c,c,[1,1,0]),o.scale(c,c,[.5*y.width,.5*y.height,1]),o.multiply(c,c,y.calculatePosMatrix(r.toUnwrapped()))}function kn(y,r,c,m,_,S){const z=function(ge,Ce,je){if(ge)for(const De of ge){const Ke=Ce[De];if(Ke&&Ke.source===je&&Ke.type==="fill-extrusion")return!0}else for(const De in Ce){const Ke=Ce[De];if(Ke.source===je&&Ke.type==="fill-extrusion")return!0}return!1}(_&&_.layers,r,y.id),N=S.maxPitchScaleFactor(),$=y.tilesIn(m,N,z);$.sort(Zi);const W=[];for(const ge of $)W.push({wrappedTileID:ge.tileID.wrapped().key,queryResults:ge.tile.queryRenderedFeatures(r,c,y._state,ge.queryGeometry,ge.cameraQueryGeometry,ge.scale,_,S,N,ki(y.transform,ge.tileID))});const ce=function(ge){const Ce={},je={};for(const De of ge){const Ke=De.queryResults,lt=De.wrappedTileID,ht=je[lt]=je[lt]||{};for(const vt in Ke){const $e=Ke[vt],Ct=ht[vt]=ht[vt]||{},wt=Ce[vt]=Ce[vt]||[];for(const Mt of $e)Ct[Mt.featureIndex]||(Ct[Mt.featureIndex]=!0,wt.push(Mt))}}return Ce}(W);for(const ge in ce)ce[ge].forEach(Ce=>{const je=Ce.feature,De=y.getFeatureState(je.layer["source-layer"],je.id);je.source=je.layer.source,je.layer["source-layer"]&&(je.sourceLayer=je.layer["source-layer"]),je.state=De});return ce}function Zi(y,r){const c=y.tileID,m=r.tileID;return c.overscaledZ-m.overscaledZ||c.canonical.y-m.canonical.y||c.wrap-m.wrap||c.canonical.x-m.canonical.x}class Bn{constructor(r,c){this.tileID=r,this.uid=o.uniqueId(),this.uses=0,this.tileSize=c,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.textures=[],this.textureCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(r){const c=r+this.timeAdded;c<o.exported.now()||this.fadeEndTime&&c<this.fadeEndTime||(this.fadeEndTime=c)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(r){this.demTexture&&r.saveTileTexture(this.demTexture),this.textures.forEach(c=>r.saveTileTexture(c)),this.demTexture=null,this.textures=[],this.textureCoords={}}loadVectorData(r,c,m){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=function(_,S){const z={};if(!S)return z;for(const N of _){const $=N.layerIds.map(W=>S.getLayer(W)).filter(Boolean);if($.length!==0){N.layers=$,N.stateDependentLayerIds&&(N.stateDependentLayers=N.stateDependentLayerIds.map(W=>$.filter(ce=>ce.id===W)[0]));for(const W of $)z[W.id]=N}}return z}(r.buckets,c.style),this.hasSymbolBuckets=!1;for(const _ in this.buckets){const S=this.buckets[_];if(S instanceof o.SymbolBucket){if(this.hasSymbolBuckets=!0,!m)break;S.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const _ in this.buckets){const S=this.buckets[_];if(S instanceof o.SymbolBucket&&S.hasRTLText){this.hasRTLText=!0,o.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const _ in this.buckets){const S=this.buckets[_];this.queryPadding=Math.max(this.queryPadding,c.style.getLayer(_).queryRadius(S))}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage)}else this.collisionBoxArray=new o.CollisionBoxArray}unloadVectorData(){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(r){return this.buckets[r.id]}upload(r){for(const m in this.buckets){const _=this.buckets[m];_.uploadPending()&&_.upload(r)}const c=r.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new it(r,this.imageAtlas.image,c.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new it(r,this.glyphAtlasImage,c.ALPHA),this.glyphAtlasImage=null)}prepare(r){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture)}queryRenderedFeatures(r,c,m,_,S,z,N,$,W,ce){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:_,cameraQueryGeometry:S,scale:z,tileSize:this.tileSize,pixelPosMatrix:ce,transform:$,params:N,queryPadding:this.queryPadding*W},r,c,m):{}}querySourceFeatures(r,c){const m=this.latestFeatureIndex;if(!m||!m.rawTileData)return;const _=m.loadVTLayers(),S=c?c.sourceLayer:"",z=_._geojsonTileLayer||_[S];if(!z)return;const N=o.createFilter(c&&c.filter),{z:$,x:W,y:ce}=this.tileID.canonical,ge={z:$,x:W,y:ce};for(let Ce=0;Ce<z.length;Ce++){const je=z.feature(Ce);if(N.needGeometry){const lt=o.toEvaluationFeature(je,!0);if(!N.filter(new o.EvaluationParameters(this.tileID.overscaledZ),lt,this.tileID.canonical))continue}else if(!N.filter(new o.EvaluationParameters(this.tileID.overscaledZ),je))continue;const De=m.getId(je,S),Ke=new o.GeoJSONFeature(je,$,W,ce,De);Ke.tile=ge,r.push(Ke)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const c=this.expirationTime;if(r.cacheControl){const m=o.parseCacheControl(r.cacheControl);m["max-age"]&&(this.expirationTime=Date.now()+1e3*m["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const m=Date.now();let _=!1;if(this.expirationTime>m)_=!1;else if(c)if(this.expirationTime<c)_=!0;else{const S=this.expirationTime-c;S?this.expirationTime=m+Math.max(S,3e4):_=!0}else _=!0;_?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(r,c){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(r).length===0)return;const m=this.latestFeatureIndex.loadVTLayers();for(const _ in this.buckets){if(!c.style.hasLayer(_))continue;const S=this.buckets[_],z=S.layers[0].sourceLayer||"_geojsonTileLayer",N=m[z],$=r[z];if(!N||!$||Object.keys($).length===0)continue;S.update($,N,this.imageAtlas&&this.imageAtlas.patternPositions||{});const W=c&&c.style&&c.style.getLayer(_);W&&(this.queryPadding=Math.max(this.queryPadding,W.queryRadius(S)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<o.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=o.exported.now()+r}setDependencies(r,c){const m={};for(const _ of c)m[_]=!0;this.dependencies[r]=m}hasDependency(r,c){for(const m of r){const _=this.dependencies[m];if(_){for(const S of c)if(_[S])return!0}}return!1}}class la{constructor(r,c){this.max=r,this.onRemove=c,this.reset()}reset(){for(const r in this.data)for(const c of this.data[r])c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value);return this.data={},this.order=[],this}add(r,c,m){const _=r.wrapped().key;this.data[_]===void 0&&(this.data[_]=[]);const S={value:c,timeout:void 0};if(m!==void 0&&(S.timeout=setTimeout(()=>{this.remove(r,S)},m)),this.data[_].push(S),this.order.push(_),this.order.length>this.max){const z=this._getAndRemoveByKey(this.order[0]);z&&this.onRemove(z)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const c=this.data[r].shift();return c.timeout&&clearTimeout(c.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),c.value}getByKey(r){const c=this.data[r];return c?c[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,c){if(!this.has(r))return this;const m=r.wrapped().key,_=c===void 0?0:this.data[m].indexOf(c),S=this.data[m][_];return this.data[m].splice(_,1),S.timeout&&clearTimeout(S.timeout),this.data[m].length===0&&delete this.data[m],this.onRemove(S.value),this.order.splice(this.order.indexOf(m),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const c=this._getAndRemoveByKey(this.order[0]);c&&this.onRemove(c)}return this}filter(r){const c=[];for(const m in this.data)for(const _ of this.data[m])r(_.value)||c.push(_);for(const m of c)this.remove(m.value.tileID,m)}}class Xi{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,c,m){const _=String(c);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][_]=this.stateChanges[r][_]||{},o.extend(this.stateChanges[r][_],m),this.deletedStates[r]===null){this.deletedStates[r]={};for(const S in this.state[r])S!==_&&(this.deletedStates[r][S]=null)}else if(this.deletedStates[r]&&this.deletedStates[r][_]===null){this.deletedStates[r][_]={};for(const S in this.state[r][_])m[S]||(this.deletedStates[r][_][S]=null)}else for(const S in m)this.deletedStates[r]&&this.deletedStates[r][_]&&this.deletedStates[r][_][S]===null&&delete this.deletedStates[r][_][S]}removeFeatureState(r,c,m){if(this.deletedStates[r]===null)return;const _=String(c);if(this.deletedStates[r]=this.deletedStates[r]||{},m&&c!==void 0)this.deletedStates[r][_]!==null&&(this.deletedStates[r][_]=this.deletedStates[r][_]||{},this.deletedStates[r][_][m]=null);else if(c!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][_])for(m in this.deletedStates[r][_]={},this.stateChanges[r][_])this.deletedStates[r][_][m]=null;else this.deletedStates[r][_]=null;else this.deletedStates[r]=null}getState(r,c){const m=String(c),_=o.extend({},(this.state[r]||{})[m],(this.stateChanges[r]||{})[m]);if(this.deletedStates[r]===null)return{};if(this.deletedStates[r]){const S=this.deletedStates[r][c];if(S===null)return{};for(const z in S)delete _[z]}return _}initializeTileState(r,c){r.setFeatureState(this.state,c)}coalesceChanges(r,c){const m={};for(const _ in this.stateChanges){this.state[_]=this.state[_]||{};const S={};for(const z in this.stateChanges[_])this.state[_][z]||(this.state[_][z]={}),o.extend(this.state[_][z],this.stateChanges[_][z]),S[z]=this.state[_][z];m[_]=S}for(const _ in this.deletedStates){this.state[_]=this.state[_]||{};const S={};if(this.deletedStates[_]===null)for(const z in this.state[_])S[z]={},this.state[_][z]={};else for(const z in this.deletedStates[_]){if(this.deletedStates[_][z]===null)this.state[_][z]={};else for(const N of Object.keys(this.deletedStates[_][z]))delete this.state[_][z][N];S[z]=this.state[_][z]}m[_]=m[_]||{},o.extend(m[_],S)}if(this.stateChanges={},this.deletedStates={},Object.keys(m).length!==0)for(const _ in r)r[_].setFeatureState(m,c)}}class cn extends o.Evented{constructor(r,c,m){super(),this.id=r,this.dispatcher=m,this.on("data",_=>{_.dataType==="source"&&_.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&_.dataType==="source"&&_.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain))}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(_,S,z,N){const $=new ii[S.type](_,S,z,N);if($.id!==_)throw new Error(`Expected Source id to be ${_} instead of ${$.id}`);return o.bindAll(["load","abort","unload","serialize","prepare"],$),$}(r,c,m,this),this._tiles={},this._cache=new la(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Xi}onAdd(r){this.map=r,this._maxTileCacheSize=r?r._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(r)}onRemove(r){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(r)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const r in this._tiles){const c=this._tiles[r];if(c.state!=="loaded"&&c.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(r,c){return this._source.loadTile(r,c)}_unloadTile(r){if(this._source.unloadTile)return this._source.unloadTile(r,()=>{})}_abortTile(r){this._source.abortTile&&this._source.abortTile(r,()=>{}),this._source.fire(new o.Event("dataabort",{tile:r,coord:r.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const c in this._tiles){const m=this._tiles[c];m.upload(r),m.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(r=>r.tileID).sort(wi).map(r=>r.key)}getRenderableIds(r){const c=[];for(const m in this._tiles)this._isIdRenderable(m,r)&&c.push(this._tiles[m]);return r?c.sort((m,_)=>{const S=m.tileID,z=_.tileID,N=new o.pointGeometry(S.canonical.x,S.canonical.y)._rotate(this.transform.angle),$=new o.pointGeometry(z.canonical.x,z.canonical.y)._rotate(this.transform.angle);return S.overscaledZ-z.overscaledZ||$.y-N.y||$.x-N.x}).map(m=>m.tileID.key):c.map(m=>m.tileID).sort(wi).map(m=>m.key)}hasRenderableParent(r){const c=this.findLoadedParent(r,0);return!!c&&this._isIdRenderable(c.tileID.key)}_isIdRenderable(r,c){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(c||!this._tiles[r].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)this._tiles[r].state!=="errored"&&this._reloadTile(r,"reloading")}}_reloadTile(r,c){const m=this._tiles[r];m&&(m.state!=="loading"&&(m.state=c),this._loadTile(m,this._tileLoaded.bind(this,m,r,c)))}_tileLoaded(r,c,m,_){if(_)return r.state="errored",void(_.status!==404?this._source.fire(new o.ErrorEvent(_,{tile:r})):this.update(this.transform,this.terrain));r.timeAdded=o.exported.now(),m==="expired"&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(c,r),this.getSource().type==="raster-dem"&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),r.aborted||this._source.fire(new o.Event("data",{dataType:"source",tile:r,coord:r.tileID}))}_backfillDEM(r){const c=this.getRenderableIds();for(let _=0;_<c.length;_++){const S=c[_];if(r.neighboringTiles&&r.neighboringTiles[S]){const z=this.getTileByID(S);m(r,z),m(z,r)}}function m(_,S){_.needsHillshadePrepare=!0,_.needsTerrainPrepare=!0;let z=S.tileID.canonical.x-_.tileID.canonical.x;const N=S.tileID.canonical.y-_.tileID.canonical.y,$=Math.pow(2,_.tileID.canonical.z),W=S.tileID.key;z===0&&N===0||Math.abs(N)>1||(Math.abs(z)>1&&(Math.abs(z+$)===1?z+=$:Math.abs(z-$)===1&&(z-=$)),S.dem&&_.dem&&(_.dem.backfillBorder(S.dem,z,N),_.neighboringTiles&&_.neighboringTiles[W]&&(_.neighboringTiles[W].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,c,m,_){for(const S in this._tiles){let z=this._tiles[S];if(_[S]||!z.hasData()||z.tileID.overscaledZ<=c||z.tileID.overscaledZ>m)continue;let N=z.tileID;for(;z&&z.tileID.overscaledZ>c+1;){const W=z.tileID.scaledTo(z.tileID.overscaledZ-1);z=this._tiles[W.key],z&&z.hasData()&&(N=W)}let $=N;for(;$.overscaledZ>c;)if($=$.scaledTo($.overscaledZ-1),r[$.key]){_[N.key]=N;break}}}findLoadedParent(r,c){if(r.key in this._loadedParentTiles){const m=this._loadedParentTiles[r.key];return m&&m.tileID.overscaledZ>=c?m:null}for(let m=r.overscaledZ-1;m>=c;m--){const _=r.scaledTo(m),S=this._getLoadedTile(_);if(S)return S}}_getLoadedTile(r){const c=this._tiles[r.key];return c&&c.hasData()?c:this._cache.getByKey(r.wrapped().key)}updateCacheSize(r){const c=Math.ceil(r.width/this._source.tileSize)+1,m=Math.ceil(r.height/this._source.tileSize)+1,_=Math.floor(c*m*5),S=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,_):_;this._cache.setMaxSize(S)}handleWrapJump(r){const c=Math.round((r-(this._prevLng===void 0?r:this._prevLng))/360);if(this._prevLng=r,c){const m={};for(const _ in this._tiles){const S=this._tiles[_];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+c),m[S.tileID.key]=S}this._tiles=m;for(const _ in this._timers)clearTimeout(this._timers[_]),delete this._timers[_];for(const _ in this._tiles)this._setTileReloadTimer(_,this._tiles[_])}}update(r,c){if(this.transform=r,this.terrain=c,!this._sourceLoaded||this._paused)return;let m;this.updateCacheSize(r),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?m=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(W=>new o.OverscaledTileID(W.canonical.z,W.wrap,W.canonical.z,W.canonical.x,W.canonical.y)):(m=r.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:c}),this._source.hasTile&&(m=m.filter(W=>this._source.hasTile(W)))):m=[];const _=r.coveringZoomLevel(this._source),S=Math.max(_-cn.maxOverzooming,this._source.minzoom),z=Math.max(_+cn.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const W={};for(const ce of m)if(ce.canonical.z>this._source.minzoom){const ge=ce.scaledTo(ce.canonical.z-1);W[ge.key]=ge;const Ce=ce.scaledTo(Math.max(this._source.minzoom,Math.min(ce.canonical.z,5)));W[Ce.key]=Ce}m=m.concat(Object.values(W))}const N=this._updateRetainedTiles(m,_);if(Vi(this._source.type)){const W={},ce={},ge=Object.keys(N);for(const Ce of ge){const je=N[Ce],De=this._tiles[Ce];if(!De||De.fadeEndTime&&De.fadeEndTime<=o.exported.now())continue;const Ke=this.findLoadedParent(je,S);Ke&&(this._addTile(Ke.tileID),W[Ke.tileID.key]=Ke.tileID),ce[Ce]=je}this._retainLoadedChildren(ce,_,z,N);for(const Ce in W)N[Ce]||(this._coveredTiles[Ce]=!0,N[Ce]=W[Ce]);if(c){const Ce={},je={};for(const De of m)this._tiles[De.key].hasData()?Ce[De.key]=De:je[De.key]=De;for(const De in je){const Ke=je[De].children(this._source.maxzoom);this._tiles[Ke[0].key]&&this._tiles[Ke[1].key]&&this._tiles[Ke[2].key]&&this._tiles[Ke[3].key]&&(Ce[Ke[0].key]=N[Ke[0].key]=Ke[0],Ce[Ke[1].key]=N[Ke[1].key]=Ke[1],Ce[Ke[2].key]=N[Ke[2].key]=Ke[2],Ce[Ke[3].key]=N[Ke[3].key]=Ke[3],delete je[De])}for(const De in je){const Ke=this.findLoadedParent(je[De],this._source.minzoom);if(Ke){Ce[Ke.tileID.key]=N[Ke.tileID.key]=Ke.tileID;for(const lt in Ce)Ce[lt].isChildOf(Ke.tileID)&&delete Ce[lt]}}for(const De in this._tiles)Ce[De]||(this._coveredTiles[De]=!0)}}for(const W in N)this._tiles[W].clearFadeHold();const $=o.keysDifference(this._tiles,N);for(const W of $){const ce=this._tiles[W];ce.hasSymbolBuckets&&!ce.holdingForFade()?ce.setHoldDuration(this.map._fadeDuration):ce.hasSymbolBuckets&&!ce.symbolFadeFinished()||this._removeTile(W)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(r)}_updateRetainedTiles(r,c){const m={},_={},S=Math.max(c-cn.maxOverzooming,this._source.minzoom),z=Math.max(c+cn.maxUnderzooming,this._source.minzoom),N={};for(const $ of r){const W=this._addTile($);m[$.key]=$,W.hasData()||c<this._source.maxzoom&&(N[$.key]=$)}this._retainLoadedChildren(N,c,z,m);for(const $ of r){let W=this._tiles[$.key];if(W.hasData())continue;if(c+1>this._source.maxzoom){const ge=$.children(this._source.maxzoom)[0],Ce=this.getTile(ge);if(Ce&&Ce.hasData()){m[ge.key]=ge;continue}}else{const ge=$.children(this._source.maxzoom);if(m[ge[0].key]&&m[ge[1].key]&&m[ge[2].key]&&m[ge[3].key])continue}let ce=W.wasRequested();for(let ge=$.overscaledZ-1;ge>=S;--ge){const Ce=$.scaledTo(ge);if(_[Ce.key]||(_[Ce.key]=!0,W=this.getTile(Ce),!W&&ce&&(W=this._addTile(Ce)),W&&(m[Ce.key]=Ce,ce=W.wasRequested(),W.hasData())))break}}return m}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const c=[];let m,_=this._tiles[r].tileID;for(;_.overscaledZ>0;){if(_.key in this._loadedParentTiles){m=this._loadedParentTiles[_.key];break}c.push(_.key);const S=_.scaledTo(_.overscaledZ-1);if(m=this._getLoadedTile(S),m)break;_=S}for(const S of c)this._loadedParentTiles[S]=m}}_addTile(r){let c=this._tiles[r.key];if(c)return c;c=this._cache.getAndRemove(r),c&&(this._setTileReloadTimer(r.key,c),c.tileID=r,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,c)));const m=c;return c||(c=new Bn(r,this._source.tileSize*r.overscaleFactor()),this._loadTile(c,this._tileLoaded.bind(this,c,r.key,c.state))),c.uses++,this._tiles[r.key]=c,m||this._source.fire(new o.Event("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c}_setTileReloadTimer(r,c){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const m=c.getExpiryTimeout();m&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},m))}_removeTile(r){const c=this._tiles[r];c&&(c.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),c.uses>0||(c.hasData()&&c.state!=="reloading"?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(r);this._cache.reset()}tilesIn(r,c,m){const _=[],S=this.transform;if(!S)return _;const z=m?S.getCameraQueryGeometry(r):r,N=r.map(De=>S.pointCoordinate(De,this.terrain)),$=z.map(De=>S.pointCoordinate(De,this.terrain)),W=this.getIds();let ce=1/0,ge=1/0,Ce=-1/0,je=-1/0;for(const De of $)ce=Math.min(ce,De.x),ge=Math.min(ge,De.y),Ce=Math.max(Ce,De.x),je=Math.max(je,De.y);for(let De=0;De<W.length;De++){const Ke=this._tiles[W[De]];if(Ke.holdingForFade())continue;const lt=Ke.tileID,ht=Math.pow(2,S.zoom-Ke.tileID.overscaledZ),vt=c*Ke.queryPadding*o.EXTENT/Ke.tileSize/ht,$e=[lt.getTilePoint(new o.MercatorCoordinate(ce,ge)),lt.getTilePoint(new o.MercatorCoordinate(Ce,je))];if($e[0].x-vt<o.EXTENT&&$e[0].y-vt<o.EXTENT&&$e[1].x+vt>=0&&$e[1].y+vt>=0){const Ct=N.map(Mt=>lt.getTilePoint(Mt)),wt=$.map(Mt=>lt.getTilePoint(Mt));_.push({tile:Ke,tileID:lt,queryGeometry:Ct,cameraQueryGeometry:wt,scale:ht})}}return _}getVisibleCoordinates(r){const c=this.getRenderableIds(r).map(m=>this._tiles[m].tileID);for(const m of c)m.posMatrix=this.transform.calculatePosMatrix(m.toUnwrapped());return c}hasTransition(){if(this._source.hasTransition())return!0;if(Vi(this._source.type))for(const r in this._tiles){const c=this._tiles[r];if(c.fadeEndTime!==void 0&&c.fadeEndTime>=o.exported.now())return!0}return!1}setFeatureState(r,c,m){this._state.updateState(r=r||"_geojsonTileLayer",c,m)}removeFeatureState(r,c,m){this._state.removeFeatureState(r=r||"_geojsonTileLayer",c,m)}getFeatureState(r,c){return this._state.getState(r=r||"_geojsonTileLayer",c)}setDependencies(r,c,m){const _=this._tiles[r];_&&_.setDependencies(c,m)}reloadTilesForDependencies(r,c){for(const m in this._tiles)this._tiles[m].hasDependency(r,c)&&this._reloadTile(m,"reloading");this._cache.filter(m=>!m.hasDependency(r,c))}}function wi(y,r){const c=Math.abs(2*y.wrap)-+(y.wrap<0),m=Math.abs(2*r.wrap)-+(r.wrap<0);return y.overscaledZ-r.overscaledZ||m-c||r.canonical.y-y.canonical.y||r.canonical.x-y.canonical.x}function Vi(y){return y==="raster"||y==="image"||y==="video"}cn.maxOverzooming=10,cn.maxUnderzooming=3;const Ln="mapboxgl_preloaded_worker_pool";class Wi{constructor(){this.active={}}acquire(r){if(!this.workers)for(this.workers=[];this.workers.length<Wi.workerCount;)this.workers.push(new Worker(eo.workerUrl));return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.numActive()===0&&(this.workers.forEach(c=>{c.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Ln]}numActive(){return Object.keys(this.active).length}}const ni=Math.floor(o.exported.hardwareConcurrency/2);let Pn;function an(){return Pn||(Pn=new Wi),Pn}function qn(y,r){const c={};for(const m in y)m!=="ref"&&(c[m]=y[m]);return o.refProperties.forEach(m=>{m in r&&(c[m]=r[m])}),c}function un(y){y=y.slice();const r=Object.create(null);for(let c=0;c<y.length;c++)r[y[c].id]=y[c];for(let c=0;c<y.length;c++)"ref"in y[c]&&(y[c]=qn(y[c],r[y[c].ref]));return y}Wi.workerCount=Math.max(Math.min(ni,6),1);const Wr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Nn(y,r,c){c.push({command:Wr.addSource,args:[y,r[y]]})}function Ri(y,r,c){r.push({command:Wr.removeSource,args:[y]}),c[y]=!0}function Hr(y,r,c,m){Ri(y,c,m),Nn(y,r,c)}function Ji(y,r,c){let m;for(m in y[c])if(Object.prototype.hasOwnProperty.call(y[c],m)&&m!=="data"&&!Y(y[c][m],r[c][m]))return!1;for(m in r[c])if(Object.prototype.hasOwnProperty.call(r[c],m)&&m!=="data"&&!Y(y[c][m],r[c][m]))return!1;return!0}function Cn(y,r,c,m,_,S){let z;for(z in r=r||{},y=y||{})Object.prototype.hasOwnProperty.call(y,z)&&(Y(y[z],r[z])||c.push({command:S,args:[m,z,r[z],_]}));for(z in r)Object.prototype.hasOwnProperty.call(r,z)&&!Object.prototype.hasOwnProperty.call(y,z)&&(Y(y[z],r[z])||c.push({command:S,args:[m,z,r[z],_]}))}function $i(y){return y.id}function yn(y,r){return y[r.id]=r,y}class En{constructor(r,c){this.reset(r,c)}reset(r,c){this.points=r||[],this._distances=[0];for(let m=1;m<this.points.length;m++)this._distances[m]=this._distances[m-1]+this.points[m].dist(this.points[m-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=o.clamp(r,0,1);let c=1,m=this._distances[c];const _=r*this.paddedLength+this.padding;for(;m<_&&c<this._distances.length;)m=this._distances[++c];const S=c-1,z=this._distances[S],N=m-z,$=N>0?(_-z)/N:0;return this.points[S].mult(1-$).add(this.points[c].mult($))}}function Ut(y,r){let c=!0;return y==="always"||y!=="never"&&r!=="never"||(c=!1),c}class ir{constructor(r,c,m){const _=this.boxCells=[],S=this.circleCells=[];this.xCellCount=Math.ceil(r/m),this.yCellCount=Math.ceil(c/m);for(let z=0;z<this.xCellCount*this.yCellCount;z++)_.push([]),S.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=c,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,c,m,_,S){this._forEachCell(c,m,_,S,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(c),this.bboxes.push(m),this.bboxes.push(_),this.bboxes.push(S)}insertCircle(r,c,m,_){this._forEachCell(c-_,m-_,c+_,m+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(c),this.circles.push(m),this.circles.push(_)}_insertBoxCell(r,c,m,_,S,z){this.boxCells[S].push(z)}_insertCircleCell(r,c,m,_,S,z){this.circleCells[S].push(z)}_query(r,c,m,_,S,z,N){if(m<0||r>this.width||_<0||c>this.height)return[];const $=[];if(r<=0&&c<=0&&this.width<=m&&this.height<=_){if(S)return[{key:null,x1:r,y1:c,x2:m,y2:_}];for(let W=0;W<this.boxKeys.length;W++)$.push({key:this.boxKeys[W],x1:this.bboxes[4*W],y1:this.bboxes[4*W+1],x2:this.bboxes[4*W+2],y2:this.bboxes[4*W+3]});for(let W=0;W<this.circleKeys.length;W++){const ce=this.circles[3*W],ge=this.circles[3*W+1],Ce=this.circles[3*W+2];$.push({key:this.circleKeys[W],x1:ce-Ce,y1:ge-Ce,x2:ce+Ce,y2:ge+Ce})}}else this._forEachCell(r,c,m,_,this._queryCell,$,{hitTest:S,overlapMode:z,seenUids:{box:{},circle:{}}},N);return $}query(r,c,m,_){return this._query(r,c,m,_,!1,null)}hitTest(r,c,m,_,S,z){return this._query(r,c,m,_,!0,S,z).length>0}hitTestCircle(r,c,m,_,S){const z=r-m,N=r+m,$=c-m,W=c+m;if(N<0||z>this.width||W<0||$>this.height)return!1;const ce=[];return this._forEachCell(z,$,N,W,this._queryCellCircle,ce,{hitTest:!0,overlapMode:_,circle:{x:r,y:c,radius:m},seenUids:{box:{},circle:{}}},S),ce.length>0}_queryCell(r,c,m,_,S,z,N,$){const{seenUids:W,hitTest:ce,overlapMode:ge}=N,Ce=this.boxCells[S];if(Ce!==null){const De=this.bboxes;for(const Ke of Ce)if(!W.box[Ke]){W.box[Ke]=!0;const lt=4*Ke,ht=this.boxKeys[Ke];if(r<=De[lt+2]&&c<=De[lt+3]&&m>=De[lt+0]&&_>=De[lt+1]&&(!$||$(ht))&&(!ce||!Ut(ge,ht.overlapMode))&&(z.push({key:ht,x1:De[lt],y1:De[lt+1],x2:De[lt+2],y2:De[lt+3]}),ce))return!0}}const je=this.circleCells[S];if(je!==null){const De=this.circles;for(const Ke of je)if(!W.circle[Ke]){W.circle[Ke]=!0;const lt=3*Ke,ht=this.circleKeys[Ke];if(this._circleAndRectCollide(De[lt],De[lt+1],De[lt+2],r,c,m,_)&&(!$||$(ht))&&(!ce||!Ut(ge,ht.overlapMode))){const vt=De[lt],$e=De[lt+1],Ct=De[lt+2];if(z.push({key:ht,x1:vt-Ct,y1:$e-Ct,x2:vt+Ct,y2:$e+Ct}),ce)return!0}}}return!1}_queryCellCircle(r,c,m,_,S,z,N,$){const{circle:W,seenUids:ce,overlapMode:ge}=N,Ce=this.boxCells[S];if(Ce!==null){const De=this.bboxes;for(const Ke of Ce)if(!ce.box[Ke]){ce.box[Ke]=!0;const lt=4*Ke,ht=this.boxKeys[Ke];if(this._circleAndRectCollide(W.x,W.y,W.radius,De[lt+0],De[lt+1],De[lt+2],De[lt+3])&&(!$||$(ht))&&!Ut(ge,ht.overlapMode))return z.push(!0),!0}}const je=this.circleCells[S];if(je!==null){const De=this.circles;for(const Ke of je)if(!ce.circle[Ke]){ce.circle[Ke]=!0;const lt=3*Ke,ht=this.circleKeys[Ke];if(this._circlesCollide(De[lt],De[lt+1],De[lt+2],W.x,W.y,W.radius)&&(!$||$(ht))&&!Ut(ge,ht.overlapMode))return z.push(!0),!0}}}_forEachCell(r,c,m,_,S,z,N,$){const W=this._convertToXCellCoord(r),ce=this._convertToYCellCoord(c),ge=this._convertToXCellCoord(m),Ce=this._convertToYCellCoord(_);for(let je=W;je<=ge;je++)for(let De=ce;De<=Ce;De++)if(S.call(this,r,c,m,_,this.xCellCount*De+je,z,N,$))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,c,m,_,S,z){const N=_-r,$=S-c,W=m+z;return W*W>N*N+$*$}_circleAndRectCollide(r,c,m,_,S,z,N){const $=(z-_)/2,W=Math.abs(r-(_+$));if(W>$+m)return!1;const ce=(N-S)/2,ge=Math.abs(c-(S+ce));if(ge>ce+m)return!1;if(W<=$||ge<=ce)return!0;const Ce=W-$,je=ge-ce;return Ce*Ce+je*je<=m*m}}function Ma(y,r,c,m,_){const S=o.create();return r?(o.scale(S,S,[1/_,1/_,1]),c||o.rotateZ(S,S,m.angle)):o.multiply(S,m.labelPlaneMatrix,y),S}function lo(y,r,c,m,_){if(r){const S=o.clone(y);return o.scale(S,S,[_,_,1]),c||o.rotateZ(S,S,-m.angle),S}return m.glCoordMatrix}function bi(y,r,c){let m;c?(m=[y.x,y.y,c(y.x,y.y),1],o.transformMat4(m,m,r)):(m=[y.x,y.y,0,1],mo(m,m,r));const _=m[3];return{point:new o.pointGeometry(m[0]/_,m[1]/_),signedDistanceFromCamera:_}}function bo(y,r){return .5+y/r*.5}function ro(y,r){const c=y[0]/y[3],m=y[1]/y[3];return c>=-r[0]&&c<=r[0]&&m>=-r[1]&&m<=r[1]}function Ao(y,r,c,m,_,S,z,N,$,W){const ce=m?y.textSizeData:y.iconSizeData,ge=o.evaluateSizeForZoom(ce,c.transform.zoom),Ce=[256/c.width*2+1,256/c.height*2+1],je=m?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;je.clear();const De=y.lineVertexArray,Ke=m?y.text.placedSymbolArray:y.icon.placedSymbolArray,lt=c.transform.width/c.transform.height;let ht=!1;for(let vt=0;vt<Ke.length;vt++){const $e=Ke.get(vt);if($e.hidden||$e.writingMode===o.WritingMode.vertical&&!ht){Gr($e.numGlyphs,je);continue}let Ct;if(ht=!1,W?(Ct=[$e.anchorX,$e.anchorY,W($e.anchorX,$e.anchorY),1],o.transformMat4(Ct,Ct,r)):(Ct=[$e.anchorX,$e.anchorY,0,1],mo(Ct,Ct,r)),!ro(Ct,Ce)){Gr($e.numGlyphs,je);continue}const wt=bo(c.transform.cameraToCenterDistance,Ct[3]),Mt=o.evaluateSizeForFeature(ce,ge,$e),Ft=z?Mt/wt:Mt*wt,jt=new o.pointGeometry($e.anchorX,$e.anchorY),St=bi(jt,_,W).point,mr={},sr=Vr($e,Ft,!1,N,r,_,S,y.glyphOffsetArray,De,je,St,jt,mr,lt,$,W);ht=sr.useVertical,(sr.notEnoughRoom||ht||sr.needsFlipping&&Vr($e,Ft,!0,N,r,_,S,y.glyphOffsetArray,De,je,St,jt,mr,lt,$,W).notEnoughRoom)&&Gr($e.numGlyphs,je)}m?y.text.dynamicLayoutVertexBuffer.updateData(je):y.icon.dynamicLayoutVertexBuffer.updateData(je)}function Bo(y,r,c,m,_,S,z,N,$,W,ce,ge,Ce){const je=N.glyphStartIndex+N.numGlyphs,De=N.lineStartIndex,Ke=N.lineStartIndex+N.lineLength,lt=r.getoffsetX(N.glyphStartIndex),ht=r.getoffsetX(je-1),vt=_n(y*lt,c,m,_,S,z,N.segment,De,Ke,$,W,ce,ge,Ce);if(!vt)return null;const $e=_n(y*ht,c,m,_,S,z,N.segment,De,Ke,$,W,ce,ge,Ce);return $e?{first:vt,last:$e}:null}function er(y,r,c,m){return y===o.WritingMode.horizontal&&Math.abs(c.y-r.y)>Math.abs(c.x-r.x)*m?{useVertical:!0}:(y===o.WritingMode.vertical?r.y<c.y:r.x>c.x)?{needsFlipping:!0}:null}function Vr(y,r,c,m,_,S,z,N,$,W,ce,ge,Ce,je,De,Ke){const lt=r/24,ht=y.lineOffsetX*lt,vt=y.lineOffsetY*lt;let $e;if(y.numGlyphs>1){const Ct=y.glyphStartIndex+y.numGlyphs,wt=y.lineStartIndex,Mt=y.lineStartIndex+y.lineLength,Ft=Bo(lt,N,ht,vt,c,ce,ge,y,$,S,Ce,De,Ke);if(!Ft)return{notEnoughRoom:!0};const jt=bi(Ft.first.point,z,Ke).point,St=bi(Ft.last.point,z,Ke).point;if(m&&!c){const mr=er(y.writingMode,jt,St,je);if(mr)return mr}$e=[Ft.first];for(let mr=y.glyphStartIndex+1;mr<Ct-1;mr++)$e.push(_n(lt*N.getoffsetX(mr),ht,vt,c,ce,ge,y.segment,wt,Mt,$,S,Ce,De,Ke));$e.push(Ft.last)}else{if(m&&!c){const wt=bi(ge,_,Ke).point,Mt=y.lineStartIndex+y.segment+1,Ft=new o.pointGeometry($.getx(Mt),$.gety(Mt)),jt=bi(Ft,_,Ke),St=jt.signedDistanceFromCamera>0?jt.point:Nr(ge,Ft,wt,1,_,Ke),mr=er(y.writingMode,wt,St,je);if(mr)return mr}const Ct=_n(lt*N.getoffsetX(y.glyphStartIndex),ht,vt,c,ce,ge,y.segment,y.lineStartIndex,y.lineStartIndex+y.lineLength,$,S,Ce,De,Ke);if(!Ct)return{notEnoughRoom:!0};$e=[Ct]}for(const Ct of $e)o.addDynamicAttributes(W,Ct.point,Ct.angle);return{}}function Nr(y,r,c,m,_,S){const z=bi(y.add(y.sub(r)._unit()),_,S).point,N=c.sub(z);return c.add(N._mult(m/N.mag()))}function _n(y,r,c,m,_,S,z,N,$,W,ce,ge,Ce,je){const De=m?y-r:y+r;let Ke=De>0?1:-1,lt=0;m&&(Ke*=-1,lt=Math.PI),Ke<0&&(lt+=Math.PI);let ht=Ke>0?N+z:N+z+1,vt=_,$e=_,Ct=0,wt=0;const Mt=Math.abs(De),Ft=[];for(;Ct+wt<=Mt;){if(ht+=Ke,ht<N||ht>=$)return null;if($e=vt,Ft.push(vt),vt=ge[ht],vt===void 0){const l=new o.pointGeometry(W.getx(ht),W.gety(ht)),u=bi(l,ce,je);if(u.signedDistanceFromCamera>0)vt=ge[ht]=u.point;else{const A=ht-Ke;vt=Nr(Ct===0?S:new o.pointGeometry(W.getx(A),W.gety(A)),l,$e,Mt-Ct+1,ce,je)}}Ct+=wt,wt=$e.dist(vt)}const jt=(Mt-Ct)/wt,St=vt.sub($e),mr=St.mult(jt)._add($e);mr._add(St._unit()._perp()._mult(c*Ke));const sr=lt+Math.atan2(vt.y-$e.y,vt.x-$e.x);return Ft.push(mr),{point:mr,angle:Ce?sr:0,path:Ft}}const Qn=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Gr(y,r){for(let c=0;c<y;c++){const m=r.length;r.resize(m+4),r.float32.set(Qn,3*m)}}function mo(y,r,c){const m=r[0],_=r[1];return y[0]=c[0]*m+c[4]*_+c[12],y[1]=c[1]*m+c[5]*_+c[13],y[3]=c[3]*m+c[7]*_+c[15],y}const In=100;class ka{constructor(r,c=new ir(r.width+200,r.height+200,25),m=new ir(r.width+200,r.height+200,25)){this.transform=r,this.grid=c,this.ignoredGrid=m,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+In,this.screenBottomBoundary=r.height+In,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(r,c,m,_,S,z){const N=this.projectAndGetPerspectiveRatio(_,r.anchorPointX,r.anchorPointY,z),$=m*N.perspectiveRatio,W=r.x1*$+N.point.x,ce=r.y1*$+N.point.y,ge=r.x2*$+N.point.x,Ce=r.y2*$+N.point.y;return!this.isInsideGrid(W,ce,ge,Ce)||c!=="always"&&this.grid.hitTest(W,ce,ge,Ce,c,S)||N.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[W,ce,ge,Ce],offscreen:this.isOffscreen(W,ce,ge,Ce)}}placeCollisionCircles(r,c,m,_,S,z,N,$,W,ce,ge,Ce,je,De){const Ke=[],lt=new o.pointGeometry(c.anchorX,c.anchorY),ht=bi(lt,z,De),vt=bo(this.transform.cameraToCenterDistance,ht.signedDistanceFromCamera),$e=(ce?S/vt:S*vt)/o.ONE_EM,Ct=bi(lt,N,De).point,wt=Bo($e,_,c.lineOffsetX*$e,c.lineOffsetY*$e,!1,Ct,lt,c,m,N,{},!1,De);let Mt=!1,Ft=!1,jt=!0;if(wt){const St=.5*Ce*vt+je,mr=new o.pointGeometry(-100,-100),sr=new o.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),l=new En,u=wt.first,A=wt.last;let d=[];for(let Q=u.path.length-1;Q>=1;Q--)d.push(u.path[Q]);for(let Q=1;Q<A.path.length;Q++)d.push(A.path[Q]);const b=2.5*St;if($){const Q=d.map(R=>bi(R,$,De));d=Q.some(R=>R.signedDistanceFromCamera<=0)?[]:Q.map(R=>R.point)}let M=[];if(d.length>0){const Q=d[0].clone(),R=d[0].clone();for(let J=1;J<d.length;J++)Q.x=Math.min(Q.x,d[J].x),Q.y=Math.min(Q.y,d[J].y),R.x=Math.max(R.x,d[J].x),R.y=Math.max(R.y,d[J].y);M=Q.x>=mr.x&&R.x<=sr.x&&Q.y>=mr.y&&R.y<=sr.y?[d]:R.x<mr.x||Q.x>sr.x||R.y<mr.y||Q.y>sr.y?[]:o.clipLine([d],mr.x,mr.y,sr.x,sr.y)}for(const Q of M){l.reset(Q,.25*St);let R=0;R=l.length<=.5*St?1:Math.ceil(l.paddedLength/b)+1;for(let J=0;J<R;J++){const Ae=J/Math.max(R-1,1),Be=l.lerp(Ae),Ie=Be.x+In,Te=Be.y+In;Ke.push(Ie,Te,St,0);const He=Ie-St,Le=Te-St,qe=Ie+St,ke=Te+St;if(jt=jt&&this.isOffscreen(He,Le,qe,ke),Ft=Ft||this.isInsideGrid(He,Le,qe,ke),r!=="always"&&this.grid.hitTestCircle(Ie,Te,St,r,ge)&&(Mt=!0,!W))return{circles:[],offscreen:!1,collisionDetected:Mt}}}}return{circles:!W&&Mt||!Ft||vt<this.perspectiveRatioCutoff?[]:Ke,offscreen:jt,collisionDetected:Mt}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const c=[];let m=1/0,_=1/0,S=-1/0,z=-1/0;for(const ce of r){const ge=new o.pointGeometry(ce.x+In,ce.y+In);m=Math.min(m,ge.x),_=Math.min(_,ge.y),S=Math.max(S,ge.x),z=Math.max(z,ge.y),c.push(ge)}const N=this.grid.query(m,_,S,z).concat(this.ignoredGrid.query(m,_,S,z)),$={},W={};for(const ce of N){const ge=ce.key;if($[ge.bucketInstanceId]===void 0&&($[ge.bucketInstanceId]={}),$[ge.bucketInstanceId][ge.featureIndex])continue;const Ce=[new o.pointGeometry(ce.x1,ce.y1),new o.pointGeometry(ce.x2,ce.y1),new o.pointGeometry(ce.x2,ce.y2),new o.pointGeometry(ce.x1,ce.y2)];o.polygonIntersectsPolygon(c,Ce)&&($[ge.bucketInstanceId][ge.featureIndex]=!0,W[ge.bucketInstanceId]===void 0&&(W[ge.bucketInstanceId]=[]),W[ge.bucketInstanceId].push(ge.featureIndex))}return W}insertCollisionBox(r,c,m,_,S,z){(m?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:S,collisionGroupID:z,overlapMode:c},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,c,m,_,S,z){const N=m?this.ignoredGrid:this.grid,$={bucketInstanceId:_,featureIndex:S,collisionGroupID:z,overlapMode:c};for(let W=0;W<r.length;W+=4)N.insertCircle($,r[W],r[W+1],r[W+2])}projectAndGetPerspectiveRatio(r,c,m,_){let S;return _?(S=[c,m,_(c,m),1],o.transformMat4(S,S,r)):(S=[c,m,0,1],mo(S,S,r)),{point:new o.pointGeometry((S[0]/S[3]+1)/2*this.transform.width+In,(-S[1]/S[3]+1)/2*this.transform.height+In),perspectiveRatio:.5+this.transform.cameraToCenterDistance/S[3]*.5}}isOffscreen(r,c,m,_){return m<In||r>=this.screenRightBoundary||_<In||c>this.screenBottomBoundary}isInsideGrid(r,c,m,_){return m>=0&&r<this.gridRightBoundary&&_>=0&&c<this.gridBottomBoundary}getViewportMatrix(){const r=o.identity([]);return o.translate(r,r,[-100,-100,0]),r}}function mi(y,r,c){return r*(o.EXTENT/(y.tileSize*Math.pow(2,c-y.tileID.overscaledZ)))}class ne{constructor(r,c,m,_){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?c:-c))):_&&m?1:0,this.placed=m}isHidden(){return this.opacity===0&&!this.placed}}class fe{constructor(r,c,m,_,S){this.text=new ne(r?r.text:null,c,m,S),this.icon=new ne(r?r.icon:null,c,_,S)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class xe{constructor(r,c,m){this.text=r,this.icon=c,this.skipFade=m}}class Fe{constructor(){this.invProjMatrix=o.create(),this.viewportMatrix=o.create(),this.circles=[]}}class Re{constructor(r,c,m,_,S){this.bucketInstanceId=r,this.featureIndex=c,this.sourceLayerIndex=m,this.bucketIndex=_,this.tileID=S}}class We{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const c=++this.maxGroupID;this.collisionGroups[r]={ID:c,predicate:m=>m.collisionGroupID===c}}return this.collisionGroups[r]}}function st(y,r,c,m,_){const{horizontalAlign:S,verticalAlign:z}=o.getAnchorAlignment(y),N=-(S-.5)*r,$=-(z-.5)*c,W=o.evaluateVariableOffset(y,m);return new o.pointGeometry(N+W[0]*_,$+W[1]*_)}function Ee(y,r,c,m,_,S){const{x1:z,x2:N,y1:$,y2:W,anchorPointX:ce,anchorPointY:ge}=y,Ce=new o.pointGeometry(r,c);return m&&Ce._rotate(_?S:-S),{x1:z+Ce.x,y1:$+Ce.y,x2:N+Ce.x,y2:W+Ce.y,anchorPointX:ce,anchorPointY:ge}}class X{constructor(r,c,m,_,S){this.transform=r.clone(),this.terrain=c,this.collisionIndex=new ka(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=m,this.retainedQueryData={},this.collisionGroups=new We(_),this.collisionCircleArrays={},this.prevPlacement=S,S&&(S.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,c,m,_){const S=m.getBucket(c),z=m.latestFeatureIndex;if(!S||!z||c.id!==S.layerIds[0])return;const N=m.collisionBoxArray,$=S.layers[0].layout,W=Math.pow(2,this.transform.zoom-m.tileID.overscaledZ),ce=m.tileSize/o.EXTENT,ge=this.transform.calculatePosMatrix(m.tileID.toUnwrapped()),Ce=$.get("text-pitch-alignment")==="map",je=$.get("text-rotation-alignment")==="map",De=mi(m,1,this.transform.zoom),Ke=Ma(ge,Ce,je,this.transform,De);let lt=null;if(Ce){const vt=lo(ge,Ce,je,this.transform,De);lt=o.multiply([],this.transform.labelPlaneMatrix,vt)}this.retainedQueryData[S.bucketInstanceId]=new Re(S.bucketInstanceId,z,S.sourceLayerIndex,S.index,m.tileID);const ht={bucket:S,layout:$,posMatrix:ge,textLabelPlaneMatrix:Ke,labelToScreenMatrix:lt,scale:W,textPixelRatio:ce,holdingForFade:m.holdingForFade(),collisionBoxArray:N,partiallyEvaluatedTextSize:o.evaluateSizeForZoom(S.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(S.sourceID)};if(_)for(const vt of S.sortKeyRanges){const{sortKey:$e,symbolInstanceStart:Ct,symbolInstanceEnd:wt}=vt;r.push({sortKey:$e,symbolInstanceStart:Ct,symbolInstanceEnd:wt,parameters:ht})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:S.symbolInstances.length,parameters:ht})}attemptAnchorPlacement(r,c,m,_,S,z,N,$,W,ce,ge,Ce,je,De,Ke,lt){const ht=[Ce.textOffset0,Ce.textOffset1],vt=st(r,m,_,ht,S),$e=this.collisionIndex.placeCollisionBox(Ee(c,vt.x,vt.y,z,N,this.transform.angle),ge,$,W,ce.predicate,lt);if((!Ke||this.collisionIndex.placeCollisionBox(Ee(Ke,vt.x,vt.y,z,N,this.transform.angle),ge,$,W,ce.predicate,lt).box.length!==0)&&$e.box.length>0){let Ct;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ce.crossTileID]&&this.prevPlacement.placements[Ce.crossTileID]&&this.prevPlacement.placements[Ce.crossTileID].text&&(Ct=this.prevPlacement.variableOffsets[Ce.crossTileID].anchor),Ce.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Ce.crossTileID]={textOffset:ht,width:m,height:_,anchor:r,textBoxScale:S,prevAnchor:Ct},this.markUsedJustification(je,r,Ce,De),je.allowVerticalPlacement&&(this.markUsedOrientation(je,De,Ce),this.placedOrientations[Ce.crossTileID]=De),{shift:vt,placedGlyphBoxes:$e}}}placeLayerBucketPart(r,c,m){const{bucket:_,layout:S,posMatrix:z,textLabelPlaneMatrix:N,labelToScreenMatrix:$,textPixelRatio:W,holdingForFade:ce,collisionBoxArray:ge,partiallyEvaluatedTextSize:Ce,collisionGroup:je}=r.parameters,De=S.get("text-optional"),Ke=S.get("icon-optional"),lt=o.getOverlapMode(S,"text-overlap","text-allow-overlap"),ht=lt==="always",vt=o.getOverlapMode(S,"icon-overlap","icon-allow-overlap"),$e=vt==="always",Ct=S.get("text-rotation-alignment")==="map",wt=S.get("text-pitch-alignment")==="map",Mt=S.get("icon-text-fit")!=="none",Ft=S.get("symbol-z-order")==="viewport-y",jt=ht&&($e||!_.hasIconData()||Ke),St=$e&&(ht||!_.hasTextData()||De);!_.collisionArrays&&ge&&_.deserializeCollisionBoxes(ge);const mr=(sr,l)=>{if(c[sr.crossTileID])return;if(ce)return void(this.placements[sr.crossTileID]=new xe(!1,!1,!1));let u=!1,A=!1,d=!0,b=null,M={box:null,offscreen:null},Q={box:null,offscreen:null},R=null,J=null,Ae=null,Be=0,Ie=0,Te=0;l.textFeatureIndex?Be=l.textFeatureIndex:sr.useRuntimeCollisionCircles&&(Be=sr.featureIndex),l.verticalTextFeatureIndex&&(Ie=l.verticalTextFeatureIndex);const He=this.retainedQueryData[_.bucketInstanceId].tileID,Le=this.terrain?(et,at)=>this.terrain.getElevation(He,et,at):null;for(const et of["textBox","verticalTextBox","iconBox","verticalIconBox"]){const at=l[et];at&&(at.elevation=Le?Le(at.anchorPointX,at.anchorPointY):0)}const qe=l.textBox;if(qe){const et=mt=>{let Ze=o.WritingMode.horizontal;if(_.allowVerticalPlacement&&!mt&&this.prevPlacement){const bt=this.prevPlacement.placedOrientations[sr.crossTileID];bt&&(this.placedOrientations[sr.crossTileID]=bt,Ze=bt,this.markUsedOrientation(_,Ze,sr))}return Ze},at=(mt,Ze)=>{if(_.allowVerticalPlacement&&sr.numVerticalGlyphVertices>0&&l.verticalTextBox){for(const bt of _.writingModes)if(bt===o.WritingMode.vertical?(M=Ze(),Q=M):M=mt(),M&&M.box&&M.box.length)break}else M=mt()};if(S.get("text-variable-anchor")){let mt=S.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[sr.crossTileID]){const Tt=this.prevPlacement.variableOffsets[sr.crossTileID];mt.indexOf(Tt.anchor)>0&&(mt=mt.filter(Vt=>Vt!==Tt.anchor),mt.unshift(Tt.anchor))}const Ze=(Tt,Vt,Ht)=>{const hr=Tt.x2-Tt.x1,Er=Tt.y2-Tt.y1,Mr=sr.textBoxScale,Ur=Mt&&vt==="never"?Vt:null;let gi={box:[],offscreen:!1};const lr=lt!=="never"?2*mt.length:mt.length;for(let zr=0;zr<lr;++zr){const $r=this.attemptAnchorPlacement(mt[zr%mt.length],Tt,hr,Er,Mr,Ct,wt,W,z,je,zr>=mt.length?lt:"never",sr,_,Ht,Ur,Le);if($r&&(gi=$r.placedGlyphBoxes,gi&&gi.box&&gi.box.length)){u=!0,b=$r.shift;break}}return gi};at(()=>Ze(qe,l.iconBox,o.WritingMode.horizontal),()=>{const Tt=l.verticalTextBox;return _.allowVerticalPlacement&&!(M&&M.box&&M.box.length)&&sr.numVerticalGlyphVertices>0&&Tt?Ze(Tt,l.verticalIconBox,o.WritingMode.vertical):{box:null,offscreen:null}}),M&&(u=M.box,d=M.offscreen);const bt=et(M&&M.box);if(!u&&this.prevPlacement){const Tt=this.prevPlacement.variableOffsets[sr.crossTileID];Tt&&(this.variableOffsets[sr.crossTileID]=Tt,this.markUsedJustification(_,Tt.anchor,sr,bt))}}else{const mt=(Ze,bt)=>{const Tt=this.collisionIndex.placeCollisionBox(Ze,lt,W,z,je.predicate,Le);return Tt&&Tt.box&&Tt.box.length&&(this.markUsedOrientation(_,bt,sr),this.placedOrientations[sr.crossTileID]=bt),Tt};at(()=>mt(qe,o.WritingMode.horizontal),()=>{const Ze=l.verticalTextBox;return _.allowVerticalPlacement&&sr.numVerticalGlyphVertices>0&&Ze?mt(Ze,o.WritingMode.vertical):{box:null,offscreen:null}}),et(M&&M.box&&M.box.length)}}if(R=M,u=R&&R.box&&R.box.length>0,d=R&&R.offscreen,sr.useRuntimeCollisionCircles){const et=_.text.placedSymbolArray.get(sr.centerJustifiedTextSymbolIndex),at=o.evaluateSizeForFeature(_.textSizeData,Ce,et),mt=S.get("text-padding");J=this.collisionIndex.placeCollisionCircles(lt,et,_.lineVertexArray,_.glyphOffsetArray,at,z,N,$,m,wt,je.predicate,sr.collisionCircleDiameter,mt,Le),J.circles.length&&J.collisionDetected&&!m&&o.warnOnce("Collisions detected, but collision boxes are not shown"),u=ht||J.circles.length>0&&!J.collisionDetected,d=d&&J.offscreen}if(l.iconFeatureIndex&&(Te=l.iconFeatureIndex),l.iconBox){const et=at=>{const mt=Mt&&b?Ee(at,b.x,b.y,Ct,wt,this.transform.angle):at;return this.collisionIndex.placeCollisionBox(mt,vt,W,z,je.predicate,Le)};Q&&Q.box&&Q.box.length&&l.verticalIconBox?(Ae=et(l.verticalIconBox),A=Ae.box.length>0):(Ae=et(l.iconBox),A=Ae.box.length>0),d=d&&Ae.offscreen}const ke=De||sr.numHorizontalGlyphVertices===0&&sr.numVerticalGlyphVertices===0,Xe=Ke||sr.numIconVertices===0;if(ke||Xe?Xe?ke||(A=A&&u):u=A&&u:A=u=A&&u,u&&R&&R.box&&this.collisionIndex.insertCollisionBox(R.box,lt,S.get("text-ignore-placement"),_.bucketInstanceId,Q&&Q.box&&Ie?Ie:Be,je.ID),A&&Ae&&this.collisionIndex.insertCollisionBox(Ae.box,vt,S.get("icon-ignore-placement"),_.bucketInstanceId,Te,je.ID),J&&(u&&this.collisionIndex.insertCollisionCircles(J.circles,lt,S.get("text-ignore-placement"),_.bucketInstanceId,Be,je.ID),m)){const et=_.bucketInstanceId;let at=this.collisionCircleArrays[et];at===void 0&&(at=this.collisionCircleArrays[et]=new Fe);for(let mt=0;mt<J.circles.length;mt+=4)at.circles.push(J.circles[mt+0]),at.circles.push(J.circles[mt+1]),at.circles.push(J.circles[mt+2]),at.circles.push(J.collisionDetected?1:0)}if(sr.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(_.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[sr.crossTileID]=new xe(u||jt,A||St,d||_.justReloaded),c[sr.crossTileID]=!0};if(Ft){if(r.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const sr=_.getSortedSymbolIndexes(this.transform.angle);for(let l=sr.length-1;l>=0;--l){const u=sr[l];mr(_.symbolInstances.get(u),_.collisionArrays[u])}}else for(let sr=r.symbolInstanceStart;sr<r.symbolInstanceEnd;sr++)mr(_.symbolInstances.get(sr),_.collisionArrays[sr]);if(m&&_.bucketInstanceId in this.collisionCircleArrays){const sr=this.collisionCircleArrays[_.bucketInstanceId];o.invert(sr.invProjMatrix,z),sr.viewportMatrix=this.collisionIndex.getViewportMatrix()}_.justReloaded=!1}markUsedJustification(r,c,m,_){let S;S=_===o.WritingMode.vertical?m.verticalPlacedTextSymbolIndex:{left:m.leftJustifiedTextSymbolIndex,center:m.centerJustifiedTextSymbolIndex,right:m.rightJustifiedTextSymbolIndex}[o.getAnchorJustification(c)];const z=[m.leftJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.rightJustifiedTextSymbolIndex,m.verticalPlacedTextSymbolIndex];for(const N of z)N>=0&&(r.text.placedSymbolArray.get(N).crossTileID=S>=0&&N!==S?0:m.crossTileID)}markUsedOrientation(r,c,m){const _=c===o.WritingMode.horizontal||c===o.WritingMode.horizontalOnly?c:0,S=c===o.WritingMode.vertical?c:0,z=[m.leftJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.rightJustifiedTextSymbolIndex];for(const N of z)r.text.placedSymbolArray.get(N).placedOrientation=_;m.verticalPlacedTextSymbolIndex&&(r.text.placedSymbolArray.get(m.verticalPlacedTextSymbolIndex).placedOrientation=S)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const c=this.prevPlacement;let m=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;const _=c?c.symbolFadeChange(r):1,S=c?c.opacities:{},z=c?c.variableOffsets:{},N=c?c.placedOrientations:{};for(const $ in this.placements){const W=this.placements[$],ce=S[$];ce?(this.opacities[$]=new fe(ce,_,W.text,W.icon),m=m||W.text!==ce.text.placed||W.icon!==ce.icon.placed):(this.opacities[$]=new fe(null,_,W.text,W.icon,W.skipFade),m=m||W.text||W.icon)}for(const $ in S){const W=S[$];if(!this.opacities[$]){const ce=new fe(W,_,!1,!1);ce.isHidden()||(this.opacities[$]=ce,m=m||W.text.placed||W.icon.placed)}}for(const $ in z)this.variableOffsets[$]||!this.opacities[$]||this.opacities[$].isHidden()||(this.variableOffsets[$]=z[$]);for(const $ in N)this.placedOrientations[$]||!this.opacities[$]||this.opacities[$].isHidden()||(this.placedOrientations[$]=N[$]);if(c&&c.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");m?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:r)}updateLayerOpacities(r,c){const m={};for(const _ of c){const S=_.getBucket(r);S&&_.latestFeatureIndex&&r.id===S.layerIds[0]&&this.updateBucketOpacities(S,m,_.collisionBoxArray)}}updateBucketOpacities(r,c,m){r.hasTextData()&&r.text.opacityVertexArray.clear(),r.hasIconData()&&r.icon.opacityVertexArray.clear(),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const _=r.layers[0].layout,S=new fe(null,0,!1,!1,!0),z=_.get("text-allow-overlap"),N=_.get("icon-allow-overlap"),$=_.get("text-variable-anchor"),W=_.get("text-rotation-alignment")==="map",ce=_.get("text-pitch-alignment")==="map",ge=_.get("icon-text-fit")!=="none",Ce=new fe(null,0,z&&(N||!r.hasIconData()||_.get("icon-optional")),N&&(z||!r.hasTextData()||_.get("text-optional")),!0);!r.collisionArrays&&m&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(m);const je=(De,Ke,lt)=>{for(let ht=0;ht<Ke/4;ht++)De.opacityVertexArray.emplaceBack(lt)};for(let De=0;De<r.symbolInstances.length;De++){const Ke=r.symbolInstances.get(De),{numHorizontalGlyphVertices:lt,numVerticalGlyphVertices:ht,crossTileID:vt}=Ke;let $e=this.opacities[vt];c[vt]?$e=S:$e||($e=Ce,this.opacities[vt]=$e),c[vt]=!0;const Ct=Ke.numIconVertices>0,wt=this.placedOrientations[Ke.crossTileID],Mt=wt===o.WritingMode.vertical,Ft=wt===o.WritingMode.horizontal||wt===o.WritingMode.horizontalOnly;if(lt>0||ht>0){const jt=Oe($e.text);je(r.text,lt,Mt?Je:jt),je(r.text,ht,Ft?Je:jt);const St=$e.text.isHidden();[Ke.rightJustifiedTextSymbolIndex,Ke.centerJustifiedTextSymbolIndex,Ke.leftJustifiedTextSymbolIndex].forEach(l=>{l>=0&&(r.text.placedSymbolArray.get(l).hidden=St||Mt?1:0)}),Ke.verticalPlacedTextSymbolIndex>=0&&(r.text.placedSymbolArray.get(Ke.verticalPlacedTextSymbolIndex).hidden=St||Ft?1:0);const mr=this.variableOffsets[Ke.crossTileID];mr&&this.markUsedJustification(r,mr.anchor,Ke,wt);const sr=this.placedOrientations[Ke.crossTileID];sr&&(this.markUsedJustification(r,"left",Ke,sr),this.markUsedOrientation(r,sr,Ke))}if(Ct){const jt=Oe($e.icon),St=!(ge&&Ke.verticalPlacedIconSymbolIndex&&Mt);Ke.placedIconSymbolIndex>=0&&(je(r.icon,Ke.numIconVertices,St?jt:Je),r.icon.placedSymbolArray.get(Ke.placedIconSymbolIndex).hidden=$e.icon.isHidden()),Ke.verticalPlacedIconSymbolIndex>=0&&(je(r.icon,Ke.numVerticalIconVertices,St?Je:jt),r.icon.placedSymbolArray.get(Ke.verticalPlacedIconSymbolIndex).hidden=$e.icon.isHidden())}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const jt=r.collisionArrays[De];if(jt){let St=new o.pointGeometry(0,0);if(jt.textBox||jt.verticalTextBox){let sr=!0;if($){const l=this.variableOffsets[vt];l?(St=st(l.anchor,l.width,l.height,l.textOffset,l.textBoxScale),W&&St._rotate(ce?this.transform.angle:-this.transform.angle)):sr=!1}jt.textBox&&H(r.textCollisionBox.collisionVertexArray,$e.text.placed,!sr||Mt,St.x,St.y),jt.verticalTextBox&&H(r.textCollisionBox.collisionVertexArray,$e.text.placed,!sr||Ft,St.x,St.y)}const mr=Boolean(!Ft&&jt.verticalIconBox);jt.iconBox&&H(r.iconCollisionBox.collisionVertexArray,$e.icon.placed,mr,ge?St.x:0,ge?St.y:0),jt.verticalIconBox&&H(r.iconCollisionBox.collisionVertexArray,$e.icon.placed,!mr,ge?St.x:0,ge?St.y:0)}}}if(r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.text.opacityVertexArray.length!==r.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${r.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${r.text.layoutVertexArray.length}) / 4`);if(r.icon.opacityVertexArray.length!==r.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${r.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${r.icon.layoutVertexArray.length}) / 4`);if(r.bucketInstanceId in this.collisionCircleArrays){const De=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=De.invProjMatrix,r.placementViewportMatrix=De.viewportMatrix,r.collisionCircleArray=De.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,c){const m=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*m>r}setStale(){this.stale=!0}}function H(y,r,c,m,_){y.emplaceBack(r?1:0,c?1:0,m||0,_||0),y.emplaceBack(r?1:0,c?1:0,m||0,_||0),y.emplaceBack(r?1:0,c?1:0,m||0,_||0),y.emplaceBack(r?1:0,c?1:0,m||0,_||0)}const te=Math.pow(2,25),pe=Math.pow(2,24),se=Math.pow(2,17),Se=Math.pow(2,16),Ne=Math.pow(2,9),Me=Math.pow(2,8),ve=Math.pow(2,1);function Oe(y){if(y.opacity===0&&!y.placed)return 0;if(y.opacity===1&&y.placed)return 4294967295;const r=y.placed?1:0,c=Math.floor(127*y.opacity);return c*te+r*pe+c*se+r*Se+c*Ne+r*Me+c*ve+r}const Je=0;class ct{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&!r.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(r,c,m,_,S){const z=this._bucketParts;for(;this._currentTileIndex<r.length;)if(c.getBucketParts(z,_,r[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,S())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,z.sort((N,$)=>N.sortKey-$.sortKey));this._currentPartIndex<z.length;)if(c.placeLayerBucketPart(z[this._currentPartIndex],this._seenCrossTileIDs,m),this._currentPartIndex++,S())return!0;return!1}}class we{constructor(r,c,m,_,S,z,N,$){this.placement=new X(r,c,z,N,$),this._currentPlacementIndex=m.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=S,this._done=!1}isDone(){return this._done}continuePlacement(r,c,m){const _=o.exported.now(),S=()=>{const z=o.exported.now()-_;return!this._forceFullPlacement&&z>2};for(;this._currentPlacementIndex>=0;){const z=c[r[this._currentPlacementIndex]],N=this.placement.collisionIndex.transform.zoom;if(z.type==="symbol"&&(!z.minzoom||z.minzoom<=N)&&(!z.maxzoom||z.maxzoom>N)){if(this._inProgressLayer||(this._inProgressLayer=new ct(z)),this._inProgressLayer.continuePlacement(m[z.source],this.placement,this._showCollisionBoxes,z,S))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const Pe=512/o.EXTENT/2;class dt{constructor(r,c,m){this.tileID=r,this.indexedSymbolInstances={},this.bucketInstanceId=m;for(let _=0;_<c.length;_++){const S=c.get(_),z=S.key;this.indexedSymbolInstances[z]||(this.indexedSymbolInstances[z]=[]),this.indexedSymbolInstances[z].push({crossTileID:S.crossTileID,coord:this.getScaledCoordinates(S,r)})}}getScaledCoordinates(r,c){const m=Pe/Math.pow(2,c.canonical.z-this.tileID.canonical.z);return{x:Math.floor((c.canonical.x*o.EXTENT+r.anchorX)*m),y:Math.floor((c.canonical.y*o.EXTENT+r.anchorY)*m)}}findMatches(r,c,m){const _=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z);for(let S=0;S<r.length;S++){const z=r.get(S);if(z.crossTileID)continue;const N=this.indexedSymbolInstances[z.key];if(!N)continue;const $=this.getScaledCoordinates(z,c);for(const W of N)if(Math.abs(W.coord.x-$.x)<=_&&Math.abs(W.coord.y-$.y)<=_&&!m[W.crossTileID]){m[W.crossTileID]=!0,z.crossTileID=W.crossTileID;break}}}}class xt{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Lt{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const c=Math.round((r-this.lng)/360);if(c!==0)for(const m in this.indexes){const _=this.indexes[m],S={};for(const z in _){const N=_[z];N.tileID=N.tileID.unwrapTo(N.tileID.wrap+c),S[N.tileID.key]=N}this.indexes[m]=S}this.lng=r}addBucket(r,c,m){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let S=0;S<c.symbolInstances.length;S++)c.symbolInstances.get(S).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]={});const _=this.usedCrossTileIDs[r.overscaledZ];for(const S in this.indexes){const z=this.indexes[S];if(Number(S)>r.overscaledZ)for(const N in z){const $=z[N];$.tileID.isChildOf(r)&&$.findMatches(c.symbolInstances,r,_)}else{const N=z[r.scaledTo(Number(S)).key];N&&N.findMatches(c.symbolInstances,r,_)}}for(let S=0;S<c.symbolInstances.length;S++){const z=c.symbolInstances.get(S);z.crossTileID||(z.crossTileID=m.generate(),_[z.crossTileID]=!0)}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new dt(r,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(r,c){for(const m in c.indexedSymbolInstances)for(const _ of c.indexedSymbolInstances[m])delete this.usedCrossTileIDs[r][_.crossTileID]}removeStaleBuckets(r){let c=!1;for(const m in this.indexes){const _=this.indexes[m];for(const S in _)r[_[S].bucketInstanceId]||(this.removeBucketCrossTileIDs(m,_[S]),delete _[S],c=!0)}return c}}class zt{constructor(){this.layerIndexes={},this.crossTileIDs=new xt,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,c,m){let _=this.layerIndexes[r.id];_===void 0&&(_=this.layerIndexes[r.id]=new Lt);let S=!1;const z={};_.handleWrapJump(m);for(const N of c){const $=N.getBucket(r);$&&r.id===$.layerIds[0]&&($.bucketInstanceId||($.bucketInstanceId=++this.maxBucketInstanceId),_.addBucket(N.tileID,$,this.crossTileIDs)&&(S=!0),z[$.bucketInstanceId]=!0)}return _.removeStaleBuckets(z)&&(S=!0),S}pruneUnusedLayers(r){const c={};r.forEach(m=>{c[m]=!0});for(const m in this.layerIndexes)c[m]||delete this.layerIndexes[m]}}var Jt=o.createLayout([{name:"a_pos",type:"Int16",components:2}]);class or extends o.Evented{constructor(r){super(),this.sourceCache=r,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.renderHistory=[],this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,this.renderHistorySize=r._cache.max,r.usedForTerrain=!0,r.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null;for(const r in this._tiles){const c=this._tiles[r];c.textures.forEach(m=>m.destroy()),c.textures=[]}}update(r,c){this.sourceCache.update(r,c),this._renderableTilesKeys=[];for(const m of r.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:c}))this._renderableTilesKeys.push(m.key),this._tiles[m.key]||(m.posMatrix=new Float64Array(16),o.ortho(m.posMatrix,0,o.EXTENT,0,o.EXTENT,0,1),this._tiles[m.key]=new Bn(m,this.tileSize))}removeOutdated(r){const c={};this.renderHistory=this.renderHistory.filter((m,_)=>this.renderHistory.indexOf(m)===_).slice(0,this.renderHistorySize);for(const m of this._renderableTilesKeys)c[m]=!0;for(const m of this.renderHistory)c[m]=!0;for(const m in this._tiles)c[m]||(this._tiles[m].clearTextures(r),delete this._tiles[m])}getRenderableTiles(){return this._renderableTilesKeys.map(r=>this.getTileByID(r))}getTileByID(r){return this._tiles[r]}getTerrainCoords(r){const c={};for(const m of this._renderableTilesKeys){const _=this._tiles[m].tileID;if(_.canonical.equals(r.canonical)){const S=r.clone();S.posMatrix=new Float64Array(16),o.ortho(S.posMatrix,0,o.EXTENT,0,o.EXTENT,0,1),c[m]=S}else if(_.canonical.isChildOf(r.canonical)){const S=r.clone();S.posMatrix=new Float64Array(16);const z=_.canonical.z-r.canonical.z,N=_.canonical.x-(_.canonical.x>>z<<z),$=_.canonical.y-(_.canonical.y>>z<<z),W=o.EXTENT>>z;o.ortho(S.posMatrix,0,W,0,W,0,1),o.translate(S.posMatrix,S.posMatrix,[-N*W,-$*W,0]),c[m]=S}else if(r.canonical.isChildOf(_.canonical)){const S=r.clone();S.posMatrix=new Float64Array(16);const z=r.canonical.z-_.canonical.z,N=r.canonical.x-(r.canonical.x>>z<<z),$=r.canonical.y-(r.canonical.y>>z<<z),W=o.EXTENT>>z;o.ortho(S.posMatrix,0,o.EXTENT,0,o.EXTENT,0,1),o.translate(S.posMatrix,S.posMatrix,[N*W,$*W,0]),o.scale(S.posMatrix,S.posMatrix,[1/2**z,1/2**z,0]),c[m]=S}}return c}getSourceTile(r,c){const m=this.sourceCache._source;let _=r.overscaledZ-this.deltaZoom;if(_>m.maxzoom&&(_=m.maxzoom),_<m.minzoom)return null;this._sourceTileCache[r.key]||(this._sourceTileCache[r.key]=r.scaledTo(_).key);let S=this.sourceCache.getTileByID(this._sourceTileCache[r.key]);if((!S||!S.dem)&&c)for(;_>=m.minzoom&&(!S||!S.dem);)S=this.sourceCache.getTileByID(r.scaledTo(_--).key);return S}tilesAfterTime(r=Date.now()){return Object.values(this._tiles).filter(c=>c.timeLoaded>=r)}}class Ar{constructor(r,c,m){this.style=r,this.sourceCache=new or(c),this.options=m,this.exaggeration=typeof m.exaggeration=="number"?m.exaggeration:1,this.elevationOffset=typeof m.elevationOffset=="number"?m.elevationOffset:450,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024,this.clearRerenderCache()}getDEMElevation(r,c,m,_=o.EXTENT){if(!(c>=0&&c<_&&m>=0&&m<_))return this.elevationOffset;let S=0;const z=this.getTerrainData(r);if(z.tile&&z.tile.dem){const N=o.transformMat4$1([],[c/_*o.EXTENT,m/_*o.EXTENT],z.u_terrain_matrix),$=[N[0]*z.tile.dem.dim,N[1]*z.tile.dem.dim],W=[Math.floor($[0]),Math.floor($[1])],ce=z.tile.dem.get(W[0],W[1]),ge=z.tile.dem.get(W[0],W[1]+1),Ce=z.tile.dem.get(W[0]+1,W[1]),je=z.tile.dem.get(W[0]+1,W[1]+1);S=o.number(o.number(ce,ge,$[0]-W[0]),o.number(Ce,je,$[0]-W[0]),$[1]-W[1])}return S}rememberForRerender(r,c){for(const m in this.sourceCache._tiles){const _=this.sourceCache._tiles[m];(_.tileID.equals(c)||_.tileID.isChildOf(c))&&(r===this.sourceCache.sourceCache.id&&(_.timeLoaded=Date.now()),this._rerender[r]=this._rerender[r]||{},this._rerender[r][_.tileID.key]=!0)}}needsRerender(r,c){return this._rerender[r]&&this._rerender[r][c.key]}clearRerenderCache(){this._rerender={}}getElevation(r,c,m,_=o.EXTENT){return(this.getDEMElevation(r,c,m,_)+this.elevationOffset)*this.exaggeration}getTerrainData(r){if(!this._emptyDemTexture){const _=this.style.map.painter.context,S=new o.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new it(_,S,_.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new it(_,new o.RGBAImage({width:1,height:1}),_.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.identity([])}const c=this.sourceCache.getSourceTile(r,!0);if(c&&c.dem&&(!c.demTexture||c.needsTerrainPrepare)){const _=this.style.map.painter.context;c.demTexture=this.style.map.painter.getTileTexture(c.dem.stride),c.demTexture?c.demTexture.update(c.dem.getPixels(),{premultiply:!1}):c.demTexture=new it(_,c.dem.getPixels(),_.gl.RGBA,{premultiply:!1}),c.demTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),c.needsTerrainPrepare=!1}const m=c&&c+c.tileID.key+r.key;if(m&&!this._demMatrixCache[m]){const _=this.sourceCache.sourceCache._source.maxzoom;let S=r.canonical.z-c.tileID.canonical.z;r.overscaledZ>r.canonical.z&&(r.canonical.z>=_?S=r.canonical.z-_:o.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const z=r.canonical.x-(r.canonical.x>>S<<S),N=r.canonical.y-(r.canonical.y>>S<<S),$=o.fromScaling(new Float64Array(16),[1/(o.EXTENT<<S),1/(o.EXTENT<<S),0]);o.translate($,$,[z*o.EXTENT,N*o.EXTENT,0]),this._demMatrixCache[r.key]={matrix:$,coord:r}}return{u_depth:2,u_terrain:3,u_terrain_dim:c&&c.dem&&c.dem.dim||1,u_terrain_matrix:m?this._demMatrixCache[r.key].matrix:this._emptyDemMatrix,u_terrain_unpack:c&&c.dem&&c.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_offset:this.elevationOffset,u_terrain_exaggeration:this.exaggeration,texture:(c&&c.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:c}}getRTTFramebuffer(){const r=this.style.map.painter;if(!this._rttFramebuffer){const c=this.sourceCache.tileSize*this.qualityFactor;this._rttFramebuffer=r.context.createFramebuffer(c,c,!0),this._rttFramebuffer.depthAttachment.set(r.context.createRenderbuffer(r.context.gl.DEPTH_COMPONENT16,c,c))}return this._rttFramebuffer}getFramebuffer(r){const c=this.style.map.painter,m=c.width/devicePixelRatio,_=c.height/devicePixelRatio;return!this._fbo||this._fbo.width===m&&this._fbo.height===_||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new it(c.context,{width:m,height:_,data:null},c.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(c.context.gl.NEAREST,c.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new it(c.context,{width:m,height:_,data:null},c.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(c.context.gl.NEAREST,c.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=c.context.createFramebuffer(m,_,!0),this._fbo.depthAttachment.set(c.context.createRenderbuffer(c.context.gl.DEPTH_COMPONENT16,m,_))),this._fbo.colorAttachment.set(r==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const r=this.style.map.painter.context;if(this._coordsTexture)return this._coordsTexture;const c=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let S=0,z=0;S<this._coordsTextureSize;S++)for(let N=0;N<this._coordsTextureSize;N++,z+=4)c[z+0]=255&N,c[z+1]=255&S,c[z+2]=N>>8<<4|S>>8,c[z+3]=0;const m=new o.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(c.buffer)),_=new it(r,m,r.gl.RGBA,{premultiply:!1});return _.bind(r.gl.NEAREST,r.gl.CLAMP_TO_EDGE),this._coordsTexture=_,_}pointCoordinate(r){const c=new Uint8Array(4),m=this.style.map.painter,_=m.context,S=_.gl;_.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),S.readPixels(r.x,m.height/devicePixelRatio-r.y-1,1,1,S.RGBA,S.UNSIGNED_BYTE,c),_.bindFramebuffer.set(null);const z=c[0]+(c[2]>>4<<8),N=c[1]+((15&c[2])<<8),$=this.coordsIndex[255-c[3]],W=$&&this.sourceCache.getTileByID($);if(!W)return null;const ce=this._coordsTextureSize,ge=(1<<W.tileID.canonical.z)*ce;return new o.MercatorCoordinate((W.tileID.canonical.x*ce+z)/ge,(W.tileID.canonical.y*ce+N)/ge,this.getElevation(W.tileID,z,N,ce))}getTerrainMesh(){if(this._mesh)return this._mesh;const r=this.style.map.painter.context,c=new o.PosArray,m=new o.TriangleIndexArray,_=this.meshSize,S=o.EXTENT/_,z=_*_;for(let N=0;N<=_;N++)for(let $=0;$<=_;$++)c.emplaceBack($*S,N*S);for(let N=0;N<z;N+=_+1)for(let $=0;$<_;$++)m.emplaceBack($+N,_+$+N+1,_+$+N+2),m.emplaceBack($+N,_+$+N+2,$+N+1);return this._mesh={indexBuffer:r.createIndexBuffer(m),vertexBuffer:r.createVertexBuffer(c,Jt.members),segments:o.SegmentVector.simpleSegment(0,0,c.length,m.length)},this._mesh}getMinMaxElevation(r){const c=this.getTerrainData(r).tile,m={minElevation:null,maxElevation:null};return c&&c.dem&&(m.minElevation=(c.dem.min+this.elevationOffset)*this.exaggeration,m.maxElevation=(c.dem.max+this.elevationOffset)*this.exaggeration),m}}const Br=(y,r)=>o.emitValidationErrors(y,r&&r.filter(c=>c.identifier!=="source.canvas")),vr=o.pick(Wr,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Sr=o.pick(Wr,["setCenter","setZoom","setBearing","setPitch"]),Tr=function(){const y={},r=o.spec.$version;for(const c in o.spec.$root){const m=o.spec.$root[c];if(m.required){let _=null;_=c==="version"?r:m.type==="array"?[]:{},_!=null&&(y[c]=_)}}return y}();class li extends o.Evented{constructor(r,c={}){super(),this.map=r,this.dispatcher=new ur(an(),this),this.imageManager=new _t,this.imageManager.setEventedParent(this),this.glyphManager=new It(r._requestManager,c.localIdeographFontFamily),this.lineAtlas=new Xr(256,512),this.crossTileSymbolIndex=new zt,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.getReferrer());const m=this;this._rtlTextPluginCallback=li.registerForPluginStateChange(_=>{m.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:_.pluginStatus,pluginURL:_.pluginURL},(S,z)=>{if(o.triggerPluginCompletionEvent(S),z&&z.every(N=>N))for(const N in m.sourceCaches)m.sourceCaches[N].reload()})}),this.on("data",_=>{if(_.dataType!=="source"||_.sourceDataType!=="metadata")return;const S=this.sourceCaches[_.sourceId];if(!S)return;const z=S.getSource();if(z&&z.vectorLayerIds)for(const N in this._layers){const $=this._layers[N];$.source===z.id&&this._validateLayer($)}})}loadURL(r,c={}){this.fire(new o.Event("dataloading",{dataType:"style"}));const m=typeof c.validate!="boolean"||c.validate,_=this.map._requestManager.transformRequest(r,o.ResourceType.Style);this._request=o.getJSON(_,(S,z)=>{this._request=null,S?this.fire(new o.ErrorEvent(S)):z&&this._load(z,m)})}loadJSON(r,c={}){this.fire(new o.Event("dataloading",{dataType:"style"})),this._request=o.exported.frame(()=>{this._request=null,this._load(r,c.validate!==!1)})}loadEmpty(){this.fire(new o.Event("dataloading",{dataType:"style"})),this._load(Tr,!1)}_load(r,c){if(c&&Br(this,o.validateStyle(r)))return;this._loaded=!0,this.stylesheet=r;for(const _ in r.sources)this.addSource(_,r.sources[_],{validate:!1});r.sprite?this._loadSprite(r.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(r.glyphs);const m=un(this.stylesheet.layers);this._order=m.map(_=>_.id),this._layers={},this._serializedLayers={};for(let _ of m)_=o.createStyleLayer(_),_.setEventedParent(this,{layer:{id:_.id}}),this._layers[_.id]=_,this._serializedLayers[_.id]=_.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new dr(this.stylesheet.light),this.setTerrain(this.stylesheet.terrain),this.fire(new o.Event("data",{dataType:"style"})),this.fire(new o.Event("style.load"))}_loadSprite(r){this._spriteRequest=function(c,m,_,S){let z,N,$;const W=_>1?"@2x":"";let ce=o.getJSON(m.transformRequest(m.normalizeSpriteURL(c,W,".json"),o.ResourceType.SpriteJSON),(je,De)=>{ce=null,$||($=je,z=De,Ce())}),ge=o.getImage(m.transformRequest(m.normalizeSpriteURL(c,W,".png"),o.ResourceType.SpriteImage),(je,De)=>{ge=null,$||($=je,N=De,Ce())});function Ce(){if($)S($);else if(z&&N){const je=o.exported.getImageData(N),De={};for(const Ke in z){const{width:lt,height:ht,x:vt,y:$e,sdf:Ct,pixelRatio:wt,stretchX:Mt,stretchY:Ft,content:jt}=z[Ke],St=new o.RGBAImage({width:lt,height:ht});o.RGBAImage.copy(je,St,{x:vt,y:$e},{x:0,y:0},{width:lt,height:ht}),De[Ke]={data:St,pixelRatio:wt,sdf:Ct,stretchX:Mt,stretchY:Ft,content:jt}}S(null,De)}}return{cancel(){ce&&(ce.cancel(),ce=null),ge&&(ge.cancel(),ge=null)}}}(r,this.map._requestManager,this.map.getPixelRatio(),(c,m)=>{if(this._spriteRequest=null,c)this.fire(new o.ErrorEvent(c));else if(m)for(const _ in m)this.imageManager.addImage(_,m[_]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))})}_validateLayer(r){const c=this.sourceCaches[r.source];if(!c)return;const m=r.sourceLayer;if(!m)return;const _=c.getSource();(_.type==="geojson"||_.vectorLayerIds&&_.vectorLayerIds.indexOf(m)===-1)&&this.fire(new o.ErrorEvent(new Error(`Source layer "${m}" does not exist on source "${_.id}" as specified by style layer "${r.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const r in this.sourceCaches)if(!this.sourceCaches[r].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(r){const c=[];for(const m of r){const _=this._layers[m];_.type!=="custom"&&c.push(_.serialize())}return c}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const r in this.sourceCaches)if(this.sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(r){if(!this._loaded)return;const c=this._changed;if(this._changed){const _=Object.keys(this._updatedLayers),S=Object.keys(this._removedLayers);(_.length||S.length)&&this._updateWorkerLayers(_,S);for(const z in this._updatedSources){const N=this._updatedSources[z];if(N==="reload")this._reloadSource(z);else{if(N!=="clear")throw new Error(`Invalid action ${N}`);this._clearSource(z)}}this._updateTilesForChangedImages();for(const z in this._updatedPaintProps)this._layers[z].updateTransitions(r);this.light.updateTransitions(r),this._resetUpdates()}const m={};for(const _ in this.sourceCaches){const S=this.sourceCaches[_];m[_]=S.used,S.used=!1}for(const _ of this._order){const S=this._layers[_];S.recalculate(r,this._availableImages),!S.isHidden(r.zoom)&&S.source&&(this.sourceCaches[S.source].used=!0)}for(const _ in m){const S=this.sourceCaches[_];m[_]!==S.used&&S.fire(new o.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:_}))}this.light.recalculate(r),this.z=r.zoom,c&&this.fire(new o.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=Object.keys(this._changedImages);if(r.length){for(const c in this.sourceCaches)this.sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],r);this._changedImages={}}}_updateWorkerLayers(r,c){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(r),removedIds:c})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setTerrain(r){if(this._checkLoaded(),this._terrainDataCallback&&this.off("data",this._terrainDataCallback),this._terrainfreezeElevationCallback&&this.map.off("freezeElevation",this._terrainfreezeElevationCallback),r){const c=this.sourceCaches[r.source];if(!c)throw new Error(`cannot load terrain, because there exists no source with ID: ${r.source}`);this.terrain=new Ar(this,c,r),this.map.transform.updateElevation(this.terrain),this._terrainfreezeElevationCallback=m=>{m.freeze?this.map.transform.freezeElevation=!0:(this.map.transform.freezeElevation=!1,this.map.transform.recalculateZoom(this.terrain))},this._terrainDataCallback=m=>{m.tile&&(m.sourceId===r.source?(this.map.transform.updateElevation(this.terrain),this.terrain.rememberForRerender(m.sourceId,m.tile.tileID)):m.source.type==="geojson"&&this.terrain.rememberForRerender(m.sourceId,m.tile.tileID))},this.on("data",this._terrainDataCallback),this.map.on("freezeElevation",this._terrainfreezeElevationCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.map.transform.updateElevation(this.terrain);this.map.fire(new o.Event("terrain",{terrain:r}))}setState(r){if(this._checkLoaded(),Br(this,o.validateStyle(r)))return!1;(r=o.clone$1(r)).layers=un(r.layers);const c=function(_,S){if(!_)return[{command:Wr.setStyle,args:[S]}];let z=[];try{if(!Y(_.version,S.version))return[{command:Wr.setStyle,args:[S]}];Y(_.center,S.center)||z.push({command:Wr.setCenter,args:[S.center]}),Y(_.zoom,S.zoom)||z.push({command:Wr.setZoom,args:[S.zoom]}),Y(_.bearing,S.bearing)||z.push({command:Wr.setBearing,args:[S.bearing]}),Y(_.pitch,S.pitch)||z.push({command:Wr.setPitch,args:[S.pitch]}),Y(_.sprite,S.sprite)||z.push({command:Wr.setSprite,args:[S.sprite]}),Y(_.glyphs,S.glyphs)||z.push({command:Wr.setGlyphs,args:[S.glyphs]}),Y(_.transition,S.transition)||z.push({command:Wr.setTransition,args:[S.transition]}),Y(_.light,S.light)||z.push({command:Wr.setLight,args:[S.light]});const N={},$=[];(function(ce,ge,Ce,je){let De;for(De in ge=ge||{},ce=ce||{})Object.prototype.hasOwnProperty.call(ce,De)&&(Object.prototype.hasOwnProperty.call(ge,De)||Ri(De,Ce,je));for(De in ge)Object.prototype.hasOwnProperty.call(ge,De)&&(Object.prototype.hasOwnProperty.call(ce,De)?Y(ce[De],ge[De])||(ce[De].type==="geojson"&&ge[De].type==="geojson"&&Ji(ce,ge,De)?Ce.push({command:Wr.setGeoJSONSourceData,args:[De,ge[De].data]}):Hr(De,ge,Ce,je)):Nn(De,ge,Ce))})(_.sources,S.sources,$,N);const W=[];_.layers&&_.layers.forEach(ce=>{N[ce.source]?z.push({command:Wr.removeLayer,args:[ce.id]}):W.push(ce)}),z=z.concat($),function(ce,ge,Ce){ge=ge||[];const je=(ce=ce||[]).map($i),De=ge.map($i),Ke=ce.reduce(yn,{}),lt=ge.reduce(yn,{}),ht=je.slice(),vt=Object.create(null);let $e,Ct,wt,Mt,Ft,jt,St;for($e=0,Ct=0;$e<je.length;$e++)wt=je[$e],Object.prototype.hasOwnProperty.call(lt,wt)?Ct++:(Ce.push({command:Wr.removeLayer,args:[wt]}),ht.splice(ht.indexOf(wt,Ct),1));for($e=0,Ct=0;$e<De.length;$e++)wt=De[De.length-1-$e],ht[ht.length-1-$e]!==wt&&(Object.prototype.hasOwnProperty.call(Ke,wt)?(Ce.push({command:Wr.removeLayer,args:[wt]}),ht.splice(ht.lastIndexOf(wt,ht.length-Ct),1)):Ct++,jt=ht[ht.length-$e],Ce.push({command:Wr.addLayer,args:[lt[wt],jt]}),ht.splice(ht.length-$e,0,wt),vt[wt]=!0);for($e=0;$e<De.length;$e++)if(wt=De[$e],Mt=Ke[wt],Ft=lt[wt],!vt[wt]&&!Y(Mt,Ft))if(Y(Mt.source,Ft.source)&&Y(Mt["source-layer"],Ft["source-layer"])&&Y(Mt.type,Ft.type)){for(St in Cn(Mt.layout,Ft.layout,Ce,wt,null,Wr.setLayoutProperty),Cn(Mt.paint,Ft.paint,Ce,wt,null,Wr.setPaintProperty),Y(Mt.filter,Ft.filter)||Ce.push({command:Wr.setFilter,args:[wt,Ft.filter]}),Y(Mt.minzoom,Ft.minzoom)&&Y(Mt.maxzoom,Ft.maxzoom)||Ce.push({command:Wr.setLayerZoomRange,args:[wt,Ft.minzoom,Ft.maxzoom]}),Mt)Object.prototype.hasOwnProperty.call(Mt,St)&&St!=="layout"&&St!=="paint"&&St!=="filter"&&St!=="metadata"&&St!=="minzoom"&&St!=="maxzoom"&&(St.indexOf("paint.")===0?Cn(Mt[St],Ft[St],Ce,wt,St.slice(6),Wr.setPaintProperty):Y(Mt[St],Ft[St])||Ce.push({command:Wr.setLayerProperty,args:[wt,St,Ft[St]]}));for(St in Ft)Object.prototype.hasOwnProperty.call(Ft,St)&&!Object.prototype.hasOwnProperty.call(Mt,St)&&St!=="layout"&&St!=="paint"&&St!=="filter"&&St!=="metadata"&&St!=="minzoom"&&St!=="maxzoom"&&(St.indexOf("paint.")===0?Cn(Mt[St],Ft[St],Ce,wt,St.slice(6),Wr.setPaintProperty):Y(Mt[St],Ft[St])||Ce.push({command:Wr.setLayerProperty,args:[wt,St,Ft[St]]}))}else Ce.push({command:Wr.removeLayer,args:[wt]}),jt=ht[ht.lastIndexOf(wt)+1],Ce.push({command:Wr.addLayer,args:[Ft,jt]})}(W,S.layers,z)}catch(N){console.warn("Unable to compute style diff:",N),z=[{command:Wr.setStyle,args:[S]}]}return z}(this.serialize(),r).filter(_=>!(_.command in Sr));if(c.length===0)return!1;const m=c.filter(_=>!(_.command in vr));if(m.length>0)throw new Error(`Unimplemented: ${m.map(_=>_.command).join(", ")}.`);return c.forEach(_=>{_.command!=="setTransition"&&this[_.command].apply(this,_.args)}),this.stylesheet=r,!0}addImage(r,c){if(this.getImage(r))return this.fire(new o.ErrorEvent(new Error(`An image named "${r}" already exists.`)));this.imageManager.addImage(r,c),this._afterImageUpdated(r)}updateImage(r,c){this.imageManager.updateImage(r,c)}getImage(r){return this.imageManager.getImage(r)}removeImage(r){if(!this.getImage(r))return this.fire(new o.ErrorEvent(new Error(`An image named "${r}" does not exist.`)));this.imageManager.removeImage(r),this._afterImageUpdated(r)}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(),this._changedImages[r]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(r,c,m={}){if(this._checkLoaded(),this.sourceCaches[r]!==void 0)throw new Error(`Source "${r}" already exists.`);if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(o.validateStyle.source,`sources.${r}`,c,null,m))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);const _=this.sourceCaches[r]=new cn(r,c,this.dispatcher);_.style=this,_.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:_.serialize(),sourceId:r})),_.onAdd(this.map),this._changed=!0}removeSource(r){if(this._checkLoaded(),this.sourceCaches[r]===void 0)throw new Error("There is no source with this ID");for(const m in this._layers)if(this._layers[m].source===r)return this.fire(new o.ErrorEvent(new Error(`Source "${r}" cannot be removed while layer "${m}" is using it.`)));const c=this.sourceCaches[r];delete this.sourceCaches[r],delete this._updatedSources[r],c.fire(new o.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:r})),c.setEventedParent(null),c.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(r,c){if(this._checkLoaded(),this.sourceCaches[r]===void 0)throw new Error(`There is no source with this ID=${r}`);const m=this.sourceCaches[r].getSource();if(m.type!=="geojson")throw new Error(`geojsonSource.type is ${m.type}, which is !== 'geojson`);m.setData(c),this._changed=!0}getSource(r){return this.sourceCaches[r]&&this.sourceCaches[r].getSource()}addLayer(r,c,m={}){this._checkLoaded();const _=r.id;if(this.getLayer(_))return void this.fire(new o.ErrorEvent(new Error(`Layer "${_}" already exists on this map.`)));let S;if(r.type==="custom"){if(Br(this,o.validateCustomStyleLayer(r)))return;S=o.createStyleLayer(r)}else{if(typeof r.source=="object"&&(this.addSource(_,r.source),r=o.clone$1(r),r=o.extend(r,{source:_})),this._validate(o.validateStyle.layer,`layers.${_}`,r,{arrayIndex:-1},m))return;S=o.createStyleLayer(r),this._validateLayer(S),S.setEventedParent(this,{layer:{id:_}}),this._serializedLayers[S.id]=S.serialize()}const z=c?this._order.indexOf(c):this._order.length;if(c&&z===-1)this.fire(new o.ErrorEvent(new Error(`Cannot add layer "${_}" before non-existing layer "${c}".`)));else{if(this._order.splice(z,0,_),this._layerOrderChanged=!0,this._layers[_]=S,this._removedLayers[_]&&S.source&&S.type!=="custom"){const N=this._removedLayers[_];delete this._removedLayers[_],N.type!==S.type?this._updatedSources[S.source]="clear":(this._updatedSources[S.source]="reload",this.sourceCaches[S.source].pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map)}}moveLayer(r,c){if(this._checkLoaded(),this._changed=!0,!this._layers[r])return void this.fire(new o.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be moved.`)));if(r===c)return;const m=this._order.indexOf(r);this._order.splice(m,1);const _=c?this._order.indexOf(c):this._order.length;c&&_===-1?this.fire(new o.ErrorEvent(new Error(`Cannot move layer "${r}" before non-existing layer "${c}".`))):(this._order.splice(_,0,r),this._layerOrderChanged=!0)}removeLayer(r){this._checkLoaded();const c=this._layers[r];if(!c)return void this.fire(new o.ErrorEvent(new Error(`Cannot remove non-existing layer "${r}".`)));c.setEventedParent(null);const m=this._order.indexOf(r);this._order.splice(m,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[r]=c,delete this._layers[r],delete this._serializedLayers[r],delete this._updatedLayers[r],delete this._updatedPaintProps[r],c.onRemove&&c.onRemove(this.map)}getLayer(r){return this._layers[r]}hasLayer(r){return r in this._layers}setLayerZoomRange(r,c,m){this._checkLoaded();const _=this.getLayer(r);_?_.minzoom===c&&_.maxzoom===m||(c!=null&&(_.minzoom=c),m!=null&&(_.maxzoom=m),this._updateLayer(_)):this.fire(new o.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${r}".`)))}setFilter(r,c,m={}){this._checkLoaded();const _=this.getLayer(r);if(_){if(!Y(_.filter,c))return c==null?(_.filter=void 0,void this._updateLayer(_)):void(this._validate(o.validateStyle.filter,`layers.${_.id}.filter`,c,null,m)||(_.filter=o.clone$1(c),this._updateLayer(_)))}else this.fire(new o.ErrorEvent(new Error(`Cannot filter non-existing layer "${r}".`)))}getFilter(r){return o.clone$1(this.getLayer(r).filter)}setLayoutProperty(r,c,m,_={}){this._checkLoaded();const S=this.getLayer(r);S?Y(S.getLayoutProperty(c),m)||(S.setLayoutProperty(c,m,_),this._updateLayer(S)):this.fire(new o.ErrorEvent(new Error(`Cannot style non-existing layer "${r}".`)))}getLayoutProperty(r,c){const m=this.getLayer(r);if(m)return m.getLayoutProperty(c);this.fire(new o.ErrorEvent(new Error(`Cannot get style of non-existing layer "${r}".`)))}setPaintProperty(r,c,m,_={}){this._checkLoaded();const S=this.getLayer(r);S?Y(S.getPaintProperty(c),m)||(S.setPaintProperty(c,m,_)&&this._updateLayer(S),this._changed=!0,this._updatedPaintProps[r]=!0):this.fire(new o.ErrorEvent(new Error(`Cannot style non-existing layer "${r}".`)))}getPaintProperty(r,c){return this.getLayer(r).getPaintProperty(c)}setFeatureState(r,c){this._checkLoaded();const m=r.source,_=r.sourceLayer,S=this.sourceCaches[m];if(S===void 0)return void this.fire(new o.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)));const z=S.getSource().type;z==="geojson"&&_?this.fire(new o.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):z!=="vector"||_?(r.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),S.setFeatureState(_,r.id,c)):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(r,c){this._checkLoaded();const m=r.source,_=this.sourceCaches[m];if(_===void 0)return void this.fire(new o.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)));const S=_.getSource().type,z=S==="vector"?r.sourceLayer:void 0;S!=="vector"||z?c&&typeof r.id!="string"&&typeof r.id!="number"?this.fire(new o.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):_.removeFeatureState(z,r.id,c):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(r){this._checkLoaded();const c=r.source,m=r.sourceLayer,_=this.sourceCaches[c];if(_!==void 0)return _.getSource().type!=="vector"||m?(r.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),_.getFeatureState(m,r.id)):void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new o.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)))}getTransition(){return o.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return o.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:o.mapObject(this.sourceCaches,r=>r.serialize()),layers:this._serializeLayers(this._order)},r=>r!==void 0)}_updateLayer(r){this._updatedLayers[r.id]=!0,r.source&&!this._updatedSources[r.source]&&this.sourceCaches[r.source].getSource().type!=="raster"&&(this._updatedSources[r.source]="reload",this.sourceCaches[r.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(r){const c=z=>this._layers[z].type==="fill-extrusion",m={},_=[];for(let z=this._order.length-1;z>=0;z--){const N=this._order[z];if(c(N)){m[N]=z;for(const $ of r){const W=$[N];if(W)for(const ce of W)_.push(ce)}}}_.sort((z,N)=>N.intersectionZ-z.intersectionZ);const S=[];for(let z=this._order.length-1;z>=0;z--){const N=this._order[z];if(c(N))for(let $=_.length-1;$>=0;$--){const W=_[$].feature;if(m[W.layer.id]<z)break;S.push(W),_.pop()}else for(const $ of r){const W=$[N];if(W)for(const ce of W)S.push(ce.feature)}}return S}queryRenderedFeatures(r,c,m){c&&c.filter&&this._validate(o.validateStyle.filter,"queryRenderedFeatures.filter",c.filter,null,c);const _={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new o.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const z of c.layers){const N=this._layers[z];if(!N)return this.fire(new o.ErrorEvent(new Error(`The layer '${z}' does not exist in the map's style and cannot be queried for features.`))),[];_[N.source]=!0}}const S=[];c.availableImages=this._availableImages;for(const z in this.sourceCaches)c.layers&&!_[z]||S.push(kn(this.sourceCaches[z],this._layers,this._serializedLayers,r,c,m));return this.placement&&S.push(function(z,N,$,W,ce,ge,Ce){const je={},De=ge.queryRenderedSymbols(W),Ke=[];for(const lt of Object.keys(De).map(Number))Ke.push(Ce[lt]);Ke.sort(Zi);for(const lt of Ke){const ht=lt.featureIndex.lookupSymbolFeatures(De[lt.bucketInstanceId],N,lt.bucketIndex,lt.sourceLayerIndex,ce.filter,ce.layers,ce.availableImages,z);for(const vt in ht){const $e=je[vt]=je[vt]||[],Ct=ht[vt];Ct.sort((wt,Mt)=>{const Ft=lt.featureSortOrder;if(Ft){const jt=Ft.indexOf(wt.featureIndex);return Ft.indexOf(Mt.featureIndex)-jt}return Mt.featureIndex-wt.featureIndex});for(const wt of Ct)$e.push(wt)}}for(const lt in je)je[lt].forEach(ht=>{const vt=ht.feature,$e=$[z[lt].source].getFeatureState(vt.layer["source-layer"],vt.id);vt.source=vt.layer.source,vt.layer["source-layer"]&&(vt.sourceLayer=vt.layer["source-layer"]),vt.state=$e});return je}(this._layers,this._serializedLayers,this.sourceCaches,r,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(S)}querySourceFeatures(r,c){c&&c.filter&&this._validate(o.validateStyle.filter,"querySourceFeatures.filter",c.filter,null,c);const m=this.sourceCaches[r];return m?function(_,S){const z=_.getRenderableIds().map(W=>_.getTileByID(W)),N=[],$={};for(let W=0;W<z.length;W++){const ce=z[W],ge=ce.tileID.canonical.key;$[ge]||($[ge]=!0,ce.querySourceFeatures(N,S))}return N}(m,c):[]}addSourceType(r,c,m){return li.getSourceType(r)?m(new Error(`A source type called "${r}" already exists.`)):(li.setSourceType(r,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:c.workerSourceURL},m):m(null,null))}getLight(){return this.light.getLight()}setLight(r,c={}){this._checkLoaded();const m=this.light.getLight();let _=!1;for(const z in r)if(!Y(r[z],m[z])){_=!0;break}if(!_)return;const S={now:o.exported.now(),transition:o.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(r,c),this.light.updateTransitions(S)}_validate(r,c,m,_,S={}){return(!S||S.validate!==!1)&&Br(this,r.call(o.validateStyle,o.extend({key:c,style:this.serialize(),value:m,styleSpec:o.spec},_)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const r in this._layers)this._layers[r].setEventedParent(null);for(const r in this.sourceCaches){const c=this.sourceCaches[r];c.setEventedParent(null),c.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(r){this.sourceCaches[r].clearTiles()}_reloadSource(r){this.sourceCaches[r].resume(),this.sourceCaches[r].reload()}_updateSources(r){for(const c in this.sourceCaches)this.sourceCaches[c].update(r,this.terrain)}_generateCollisionBoxes(){for(const r in this.sourceCaches)this._reloadSource(r)}_updatePlacement(r,c,m,_,S=!1){let z=!1,N=!1;const $={};for(const W of this._order){const ce=this._layers[W];if(ce.type!=="symbol")continue;if(!$[ce.source]){const Ce=this.sourceCaches[ce.source];$[ce.source]=Ce.getRenderableIds(!0).map(je=>Ce.getTileByID(je)).sort((je,De)=>De.tileID.overscaledZ-je.tileID.overscaledZ||(je.tileID.isLessThan(De.tileID)?-1:1))}const ge=this.crossTileSymbolIndex.addLayer(ce,$[ce.source],r.center.lng);z=z||ge}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((S=S||this._layerOrderChanged||m===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.exported.now(),r.zoom))&&(this.pauseablePlacement=new we(r,this.terrain,this._order,S,c,m,_,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,$),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.exported.now()),N=!0),z&&this.pauseablePlacement.placement.setStale()),N||z)for(const W of this._order){const ce=this._layers[W];ce.type==="symbol"&&this.placement.updateLayerOpacities(ce,$[ce.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.exported.now())}_releaseSymbolFadeTiles(){for(const r in this.sourceCaches)this.sourceCaches[r].releaseSymbolFadeTiles()}getImages(r,c,m){this.imageManager.getImages(c.icons,m),this._updateTilesForChangedImages();const _=this.sourceCaches[c.source];_&&_.setDependencies(c.tileID.key,c.type,c.icons)}getGlyphs(r,c,m){this.glyphManager.getGlyphs(c.stacks,m)}getResource(r,c,m){return o.makeRequest(c,m)}}li.getSourceType=function(y){return ii[y]},li.setSourceType=function(y,r){ii[y]=r},li.registerForPluginStateChange=o.registerForPluginStateChange;var Co="attribute vec2 a_pos;uniform mat4 u_matrix;varying vec2 v_texture_pos;varying float v_depth;void main() {v_texture_pos=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);v_depth=gl_Position.z/gl_Position.w;}";const Bi={prelude:hi(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_offset;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return (elevation+u_terrain_offset)*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:hi(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:hi(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:hi(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:hi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:hi(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:hi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:hi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:hi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:hi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:hi(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:hi(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:hi(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:hi(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:hi(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:hi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:hi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:hi(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:hi(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:hi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:hi(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:hi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:hi(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:hi(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:hi(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:hi(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:hi("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Co),terrainDepth:hi("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Co),terrainCoords:hi("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Co)};function hi(y,r){const c=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,m=r.match(/attribute ([\w]+) ([\w]+)/g),_=y.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=r.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),z=S?S.concat(_):_,N={};return{fragmentSource:y=y.replace(c,($,W,ce,ge,Ce)=>(N[Ce]=!0,W==="define"?`
#ifndef HAS_UNIFORM_u_${Ce}
varying ${ce} ${ge} ${Ce};
#else
uniform ${ce} ${ge} u_${Ce};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Ce}
    ${ce} ${ge} ${Ce} = u_${Ce};
#endif
`)),vertexSource:r=r.replace(c,($,W,ce,ge,Ce)=>{const je=ge==="float"?"vec2":"vec4",De=Ce.match(/color/)?"color":je;return N[Ce]?W==="define"?`
#ifndef HAS_UNIFORM_u_${Ce}
uniform lowp float u_${Ce}_t;
attribute ${ce} ${je} a_${Ce};
varying ${ce} ${ge} ${Ce};
#else
uniform ${ce} ${ge} u_${Ce};
#endif
`:De==="vec4"?`
#ifndef HAS_UNIFORM_u_${Ce}
    ${Ce} = a_${Ce};
#else
    ${ce} ${ge} ${Ce} = u_${Ce};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Ce}
    ${Ce} = unpack_mix_${De}(a_${Ce}, u_${Ce}_t);
#else
    ${ce} ${ge} ${Ce} = u_${Ce};
#endif
`:W==="define"?`
#ifndef HAS_UNIFORM_u_${Ce}
uniform lowp float u_${Ce}_t;
attribute ${ce} ${je} a_${Ce};
#else
uniform ${ce} ${ge} u_${Ce};
#endif
`:De==="vec4"?`
#ifndef HAS_UNIFORM_u_${Ce}
    ${ce} ${ge} ${Ce} = a_${Ce};
#else
    ${ce} ${ge} ${Ce} = u_${Ce};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Ce}
    ${ce} ${ge} ${Ce} = unpack_mix_${De}(a_${Ce}, u_${Ce}_t);
#else
    ${ce} ${ge} ${Ce} = u_${Ce};
#endif
`}),staticAttributes:m,staticUniforms:z}}class Na{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(r,c,m,_,S,z,N,$,W){this.context=r;let ce=this.boundPaintVertexBuffers.length!==_.length;for(let ge=0;!ce&&ge<_.length;ge++)this.boundPaintVertexBuffers[ge]!==_[ge]&&(ce=!0);r.extVertexArrayObject&&this.vao&&this.boundProgram===c&&this.boundLayoutVertexBuffer===m&&!ce&&this.boundIndexBuffer===S&&this.boundVertexOffset===z&&this.boundDynamicVertexBuffer===N&&this.boundDynamicVertexBuffer2===$&&this.boundDynamicVertexBuffer3===W?(r.bindVertexArrayOES.set(this.vao),N&&N.bind(),S&&S.dynamicDraw&&S.bind(),$&&$.bind(),W&&W.bind()):this.freshBind(c,m,_,S,z,N,$,W)}freshBind(r,c,m,_,S,z,N,$){let W;const ce=r.numAttributes,ge=this.context,Ce=ge.gl;if(ge.extVertexArrayObject)this.vao&&this.destroy(),this.vao=ge.extVertexArrayObject.createVertexArrayOES(),ge.bindVertexArrayOES.set(this.vao),W=0,this.boundProgram=r,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=m,this.boundIndexBuffer=_,this.boundVertexOffset=S,this.boundDynamicVertexBuffer=z,this.boundDynamicVertexBuffer2=N,this.boundDynamicVertexBuffer3=$;else{W=ge.currentNumAttributes||0;for(let je=ce;je<W;je++)Ce.disableVertexAttribArray(je)}c.enableAttributes(Ce,r);for(const je of m)je.enableAttributes(Ce,r);z&&z.enableAttributes(Ce,r),N&&N.enableAttributes(Ce,r),$&&$.enableAttributes(Ce,r),c.bind(),c.setVertexAttribPointers(Ce,r,S);for(const je of m)je.bind(),je.setVertexAttribPointers(Ce,r,S);z&&(z.bind(),z.setVertexAttribPointers(Ce,r,S)),_&&_.bind(),N&&(N.bind(),N.setVertexAttribPointers(Ce,r,S)),$&&($.bind(),$.setVertexAttribPointers(Ce,r,S)),ge.currentNumAttributes=ce}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Pa(y){const r=[];for(let c=0;c<y.length;c++){if(y[c]===null)continue;const m=y[c].split(" ");r.push(m.pop())}return r}class zn{constructor(r,c,m,_,S,z,N){const $=r.gl;this.program=$.createProgram();const W=Pa(m.staticAttributes),ce=_?_.getBinderAttributes():[],ge=W.concat(ce),Ce=Bi.prelude.staticUniforms?Pa(Bi.prelude.staticUniforms):[],je=m.staticUniforms?Pa(m.staticUniforms):[],De=_?_.getBinderUniforms():[],Ke=Ce.concat(je).concat(De),lt=[];for(const Ft of Ke)lt.indexOf(Ft)<0&&lt.push(Ft);const ht=_?_.defines():[];z&&ht.push("#define OVERDRAW_INSPECTOR;"),N&&ht.push("#define TERRAIN3D;");const vt=ht.concat(Bi.prelude.fragmentSource,m.fragmentSource).join(`
`),$e=ht.concat(Bi.prelude.vertexSource,m.vertexSource).join(`
`),Ct=$.createShader($.FRAGMENT_SHADER);if($.isContextLost())return void(this.failedToCreate=!0);$.shaderSource(Ct,vt),$.compileShader(Ct),$.attachShader(this.program,Ct);const wt=$.createShader($.VERTEX_SHADER);if($.isContextLost())return void(this.failedToCreate=!0);$.shaderSource(wt,$e),$.compileShader(wt),$.attachShader(this.program,wt),this.attributes={};const Mt={};this.numAttributes=ge.length;for(let Ft=0;Ft<this.numAttributes;Ft++)ge[Ft]&&($.bindAttribLocation(this.program,Ft,ge[Ft]),this.attributes[ge[Ft]]=Ft);$.linkProgram(this.program),$.deleteShader(wt),$.deleteShader(Ct);for(let Ft=0;Ft<lt.length;Ft++){const jt=lt[Ft];if(jt&&!Mt[jt]){const St=$.getUniformLocation(this.program,jt);St&&(Mt[jt]=St)}}this.fixedUniforms=S(r,Mt),this.terrainUniforms=((Ft,jt)=>({u_depth:new o.Uniform1i(Ft,jt.u_depth),u_terrain:new o.Uniform1i(Ft,jt.u_terrain),u_terrain_dim:new o.Uniform1f(Ft,jt.u_terrain_dim),u_terrain_matrix:new o.UniformMatrix4f(Ft,jt.u_terrain_matrix),u_terrain_unpack:new o.Uniform4f(Ft,jt.u_terrain_unpack),u_terrain_offset:new o.Uniform1f(Ft,jt.u_terrain_offset),u_terrain_exaggeration:new o.Uniform1f(Ft,jt.u_terrain_exaggeration)}))(r,Mt),this.binderUniforms=_?_.getUniforms(r,Mt):[]}draw(r,c,m,_,S,z,N,$,W,ce,ge,Ce,je,De,Ke,lt,ht,vt){const $e=r.gl;if(this.failedToCreate)return;if(r.program.set(this.program),r.setDepthMode(m),r.setStencilMode(_),r.setColorMode(S),r.setCullFace(z),$){r.activeTexture.set($e.TEXTURE2),$e.bindTexture($e.TEXTURE_2D,$.depthTexture),r.activeTexture.set($e.TEXTURE3),$e.bindTexture($e.TEXTURE_2D,$.texture);for(const wt in this.terrainUniforms)this.terrainUniforms[wt].set($[wt])}for(const wt in this.fixedUniforms)this.fixedUniforms[wt].set(N[wt]);Ke&&Ke.setUniforms(r,this.binderUniforms,je,{zoom:De});let Ct=0;switch(c){case $e.LINES:Ct=2;break;case $e.TRIANGLES:Ct=3;break;case $e.LINE_STRIP:Ct=1}for(const wt of Ce.get()){const Mt=wt.vaos||(wt.vaos={});(Mt[W]||(Mt[W]=new Na)).bind(r,this,ce,Ke?Ke.getPaintVertexBuffers():[],ge,wt.vertexOffset,lt,ht,vt),$e.drawElements(c,wt.primitiveLength*Ct,$e.UNSIGNED_SHORT,wt.primitiveOffset*Ct*2)}}}function js(y,r,c){const m=1/mi(c,1,r.transform.tileZoom),_=Math.pow(2,c.tileID.overscaledZ),S=c.tileSize*Math.pow(2,r.transform.tileZoom)/_,z=S*(c.tileID.canonical.x+c.tileID.wrap*_),N=S*c.tileID.canonical.y;return{u_image:0,u_texsize:c.imageAtlasTexture.size,u_scale:[m,y.fromScale,y.toScale],u_fade:y.t,u_pixel_coord_upper:[z>>16,N>>16],u_pixel_coord_lower:[65535&z,65535&N]}}const Eo=(y,r,c,m)=>{const _=r.style.light,S=_.properties.get("position"),z=[S.x,S.y,S.z],N=o.create$1();_.properties.get("anchor")==="viewport"&&o.fromRotation(N,-r.transform.angle),o.transformMat3(z,z,N);const $=_.properties.get("color");return{u_matrix:y,u_lightpos:z,u_lightintensity:_.properties.get("intensity"),u_lightcolor:[$.r,$.g,$.b],u_vertical_gradient:+c,u_opacity:m}},fi=(y,r,c,m,_,S,z)=>o.extend(Eo(y,r,c,m),js(S,r,z),{u_height_factor:-Math.pow(2,_.overscaledZ)/z.tileSize/8}),vi=y=>({u_matrix:y}),Ni=(y,r,c,m)=>o.extend(vi(y),js(c,r,m)),go=(y,r)=>({u_matrix:y,u_world:r}),Uo=(y,r,c,m,_)=>o.extend(Ni(y,r,c,m),{u_world:_}),ea=(y,r,c,m)=>{const _=y.transform;let S,z;if(m.paint.get("circle-pitch-alignment")==="map"){const N=mi(c,1,_.zoom);S=!0,z=[N,N]}else S=!1,z=_.pixelsToGLUnits;return{u_camera_to_center_distance:_.cameraToCenterDistance,u_scale_with_map:+(m.paint.get("circle-pitch-scale")==="map"),u_matrix:y.translatePosMatrix(r.posMatrix,c,m.paint.get("circle-translate"),m.paint.get("circle-translate-anchor")),u_pitch_with_map:+S,u_device_pixel_ratio:y.pixelRatio,u_extrude_scale:z}},Dn=(y,r,c)=>{const m=mi(c,1,r.zoom),_=Math.pow(2,r.zoom-c.tileID.overscaledZ),S=c.tileID.overscaleFactor();return{u_matrix:y,u_camera_to_center_distance:r.cameraToCenterDistance,u_pixels_to_tile_units:m,u_extrude_scale:[r.pixelsToGLUnits[0]/(m*_),r.pixelsToGLUnits[1]/(m*_)],u_overscale_factor:S}},Aa=(y,r,c=1)=>({u_matrix:y,u_color:r,u_overlay:0,u_overlay_scale:c}),co=y=>({u_matrix:y}),hn=(y,r,c,m)=>({u_matrix:y,u_extrude_scale:mi(r,1,c),u_intensity:m});function Io(y,r){const c=Math.pow(2,r.canonical.z),m=r.canonical.y;return[new o.MercatorCoordinate(0,m/c).toLngLat().lat,new o.MercatorCoordinate(0,(m+1)/c).toLngLat().lat]}const Sn=(y,r,c,m)=>{const _=y.transform;return{u_matrix:hs(y,r,c,m),u_ratio:1/mi(r,1,_.zoom),u_device_pixel_ratio:y.pixelRatio,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},Ka=(y,r,c,m,_)=>o.extend(Sn(y,r,c,_),{u_image:0,u_image_height:m}),Qa=(y,r,c,m,_)=>{const S=y.transform,z=pn(r,S);return{u_matrix:hs(y,r,c,_),u_texsize:r.imageAtlasTexture.size,u_ratio:1/mi(r,1,S.zoom),u_device_pixel_ratio:y.pixelRatio,u_image:0,u_scale:[z,m.fromScale,m.toScale],u_fade:m.t,u_units_to_pixels:[1/S.pixelsToGLUnits[0],1/S.pixelsToGLUnits[1]]}},Fs=(y,r,c,m,_,S)=>{const z=y.lineAtlas,N=pn(r,y.transform),$=c.layout.get("line-cap")==="round",W=z.getDash(m.from,$),ce=z.getDash(m.to,$),ge=W.width*_.fromScale,Ce=ce.width*_.toScale;return o.extend(Sn(y,r,c,S),{u_patternscale_a:[N/ge,-W.height/2],u_patternscale_b:[N/Ce,-ce.height/2],u_sdfgamma:z.width/(256*Math.min(ge,Ce)*y.pixelRatio)/2,u_image:0,u_tex_y_a:W.y,u_tex_y_b:ce.y,u_mix:_.t})};function pn(y,r){return 1/mi(y,1,r.tileZoom)}function hs(y,r,c,m){return y.translatePosMatrix(m?m.posMatrix:r.tileID.posMatrix,r,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}const kl=(y,r,c,m,_)=>{return{u_matrix:y,u_tl_parent:r,u_scale_parent:c,u_buffer_scale:1,u_fade_t:m.mix,u_opacity:m.opacity*_.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:_.paint.get("raster-brightness-min"),u_brightness_high:_.paint.get("raster-brightness-max"),u_saturation_factor:(z=_.paint.get("raster-saturation"),z>0?1-1/(1.001-z):-z),u_contrast_factor:(S=_.paint.get("raster-contrast"),S>0?1/(1-S):1+S),u_spin_weights:fl(_.paint.get("raster-hue-rotate"))};var S,z};function fl(y){y*=Math.PI/180;const r=Math.sin(y),c=Math.cos(y);return[(2*c+1)/3,(-Math.sqrt(3)*r-c+1)/3,(Math.sqrt(3)*r-c+1)/3]}const Us=(y,r,c,m,_,S,z,N,$,W)=>{const ce=_.transform;return{u_is_size_zoom_constant:+(y==="constant"||y==="source"),u_is_size_feature_constant:+(y==="constant"||y==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:ce.cameraToCenterDistance,u_pitch:ce.pitch/360*2*Math.PI,u_rotate_symbol:+c,u_aspect_ratio:ce.width/ce.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_matrix:S,u_label_plane_matrix:z,u_coord_matrix:N,u_is_text:+$,u_pitch_with_map:+m,u_texsize:W,u_texture:0}},ya=(y,r,c,m,_,S,z,N,$,W,ce)=>{const ge=_.transform;return o.extend(Us(y,r,c,m,_,S,z,N,$,W),{u_gamma_scale:m?Math.cos(ge._pitch)*ge.cameraToCenterDistance:1,u_device_pixel_ratio:_.pixelRatio,u_is_halo:+ce})},$s=(y,r,c,m,_,S,z,N,$,W)=>o.extend(ya(y,r,c,m,_,S,z,N,!0,$,!0),{u_texsize_icon:W,u_texture_icon:1}),vA=(y,r,c)=>({u_matrix:y,u_opacity:r,u_color:c}),Pl=(y,r,c,m,_,S)=>o.extend(function(z,N,$,W){const ce=$.imageManager.getPattern(z.from.toString()),ge=$.imageManager.getPattern(z.to.toString()),{width:Ce,height:je}=$.imageManager.getPixelSize(),De=Math.pow(2,W.tileID.overscaledZ),Ke=W.tileSize*Math.pow(2,$.transform.tileZoom)/De,lt=Ke*(W.tileID.canonical.x+W.tileID.wrap*De),ht=Ke*W.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:ce.tl,u_pattern_br_a:ce.br,u_pattern_tl_b:ge.tl,u_pattern_br_b:ge.br,u_texsize:[Ce,je],u_mix:N.t,u_pattern_size_a:ce.displaySize,u_pattern_size_b:ge.displaySize,u_scale_a:N.fromScale,u_scale_b:N.toScale,u_tile_units_to_pixels:1/mi(W,1,$.transform.tileZoom),u_pixel_coord_upper:[lt>>16,ht>>16],u_pixel_coord_lower:[65535&lt,65535&ht]}}(m,S,c,_),{u_matrix:y,u_opacity:r}),xA={fillExtrusion:(y,r)=>({u_matrix:new o.UniformMatrix4f(y,r.u_matrix),u_lightpos:new o.Uniform3f(y,r.u_lightpos),u_lightintensity:new o.Uniform1f(y,r.u_lightintensity),u_lightcolor:new o.Uniform3f(y,r.u_lightcolor),u_vertical_gradient:new o.Uniform1f(y,r.u_vertical_gradient),u_opacity:new o.Uniform1f(y,r.u_opacity)}),fillExtrusionPattern:(y,r)=>({u_matrix:new o.UniformMatrix4f(y,r.u_matrix),u_lightpos:new o.Uniform3f(y,r.u_lightpos),u_lightintensity:new o.Uniform1f(y,r.u_lightintensity),u_lightcolor:new o.Uniform3f(y,r.u_lightcolor),u_vertical_gradient:new o.Uniform1f(y,r.u_vertical_gradient),u_height_factor:new o.Uniform1f(y,r.u_height_factor),u_image:new o.Uniform1i(y,r.u_image),u_texsize:new o.Uniform2f(y,r.u_texsize),u_pixel_coord_upper:new o.Uniform2f(y,r.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(y,r.u_pixel_coord_lower),u_scale:new o.Uniform3f(y,r.u_scale),u_fade:new o.Uniform1f(y,r.u_fade),u_opacity:new o.Uniform1f(y,r.u_opacity)}),fill:(y,r)=>({u_matrix:new o.UniformMatrix4f(y,r.u_matrix)}),fillPattern:(y,r)=>({u_matrix:new o.UniformMatrix4f(y,r.u_matrix),u_image:new o.Uniform1i(y,r.u_image),u_texsize:new o.Uniform2f(y,r.u_texsize),u_pixel_coord_upper:new o.Uniform2f(y,r.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(y,r.u_pixel_coord_lower),u_scale:new o.Uniform3f(y,r.u_scale),u_fade:new o.Uniform1f(y,r.u_fade)}),fillOutline:(y,r)=>({u_matrix:new o.UniformMatrix4f(y,r.u_matrix),u_world:new o.Uniform2f(y,r.u_world)}),fillOutlinePattern:(y,r)=>({u_matrix:new o.UniformMatrix4f(y,r.u_matrix),u_world:new o.Uniform2f(y,r.u_world),u_image:new o.Uniform1i(y,r.u_image),u_texsize:new o.Uniform2f(y,r.u_texsize),u_pixel_coord_upper:new o.Uniform2f(y,r.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(y,r.u_pixel_coord_lower),u_scale:new o.Uniform3f(y,r.u_scale),u_fade:new o.Uniform1f(y,r.u_fade)}),circle:(y,r)=>({u_camera_to_center_distance:new o.Uniform1f(y,r.u_camera_to_center_distance),u_scale_with_map:new o.Uniform1i(y,r.u_scale_with_map),u_pitch_with_map:new o.Uniform1i(y,r.u_pitch_with_map),u_extrude_scale:new o.Uniform2f(y,r.u_extrude_scale),u_device_pixel_ratio:new o.Uniform1f(y,r.u_device_pixel_ratio),u_matrix:new o.UniformMatrix4f(y,r.u_matrix)}),collisionBox:(y,r)=>({u_matrix:new o.UniformMatrix4f(y,r.u_matrix),u_camera_to_center_distance:new o.Uniform1f(y,r.u_camera_to_center_distance),u_pixels_to_tile_units:new o.Uniform1f(y,r.u_pixels_to_tile_units),u_extrude_scale:new o.Uniform2f(y,r.u_extrude_scale),u_overscale_factor:new o.Uniform1f(y,r.u_overscale_factor)}),collisionCircle:(y,r)=>({u_matrix:new o.UniformMatrix4f(y,r.u_matrix),u_inv_matrix:new o.UniformMatrix4f(y,r.u_inv_matrix),u_camera_to_center_distance:new o.Uniform1f(y,r.u_camera_to_center_distance),u_viewport_size:new o.Uniform2f(y,r.u_viewport_size)}),debug:(y,r)=>({u_color:new o.UniformColor(y,r.u_color),u_matrix:new o.UniformMatrix4f(y,r.u_matrix),u_overlay:new o.Uniform1i(y,r.u_overlay),u_overlay_scale:new o.Uniform1f(y,r.u_overlay_scale)}),clippingMask:(y,r)=>({u_matrix:new o.UniformMatrix4f(y,r.u_matrix)}),heatmap:(y,r)=>({u_extrude_scale:new o.Uniform1f(y,r.u_extrude_scale),u_intensity:new o.Uniform1f(y,r.u_intensity),u_matrix:new o.UniformMatrix4f(y,r.u_matrix)}),heatmapTexture:(y,r)=>({u_matrix:new o.UniformMatrix4f(y,r.u_matrix),u_world:new o.Uniform2f(y,r.u_world),u_image:new o.Uniform1i(y,r.u_image),u_color_ramp:new o.Uniform1i(y,r.u_color_ramp),u_opacity:new o.Uniform1f(y,r.u_opacity)}),hillshade:(y,r)=>({u_matrix:new o.UniformMatrix4f(y,r.u_matrix),u_image:new o.Uniform1i(y,r.u_image),u_latrange:new o.Uniform2f(y,r.u_latrange),u_light:new o.Uniform2f(y,r.u_light),u_shadow:new o.UniformColor(y,r.u_shadow),u_highlight:new o.UniformColor(y,r.u_highlight),u_accent:new o.UniformColor(y,r.u_accent)}),hillshadePrepare:(y,r)=>({u_matrix:new o.UniformMatrix4f(y,r.u_matrix),u_image:new o.Uniform1i(y,r.u_image),u_dimension:new o.Uniform2f(y,r.u_dimension),u_zoom:new o.Uniform1f(y,r.u_zoom),u_unpack:new o.Uniform4f(y,r.u_unpack)}),line:(y,r)=>({u_matrix:new o.UniformMatrix4f(y,r.u_matrix),u_ratio:new o.Uniform1f(y,r.u_ratio),u_device_pixel_ratio:new o.Uniform1f(y,r.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(y,r.u_units_to_pixels)}),lineGradient:(y,r)=>({u_matrix:new o.UniformMatrix4f(y,r.u_matrix),u_ratio:new o.Uniform1f(y,r.u_ratio),u_device_pixel_ratio:new o.Uniform1f(y,r.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(y,r.u_units_to_pixels),u_image:new o.Uniform1i(y,r.u_image),u_image_height:new o.Uniform1f(y,r.u_image_height)}),linePattern:(y,r)=>({u_matrix:new o.UniformMatrix4f(y,r.u_matrix),u_texsize:new o.Uniform2f(y,r.u_texsize),u_ratio:new o.Uniform1f(y,r.u_ratio),u_device_pixel_ratio:new o.Uniform1f(y,r.u_device_pixel_ratio),u_image:new o.Uniform1i(y,r.u_image),u_units_to_pixels:new o.Uniform2f(y,r.u_units_to_pixels),u_scale:new o.Uniform3f(y,r.u_scale),u_fade:new o.Uniform1f(y,r.u_fade)}),lineSDF:(y,r)=>({u_matrix:new o.UniformMatrix4f(y,r.u_matrix),u_ratio:new o.Uniform1f(y,r.u_ratio),u_device_pixel_ratio:new o.Uniform1f(y,r.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(y,r.u_units_to_pixels),u_patternscale_a:new o.Uniform2f(y,r.u_patternscale_a),u_patternscale_b:new o.Uniform2f(y,r.u_patternscale_b),u_sdfgamma:new o.Uniform1f(y,r.u_sdfgamma),u_image:new o.Uniform1i(y,r.u_image),u_tex_y_a:new o.Uniform1f(y,r.u_tex_y_a),u_tex_y_b:new o.Uniform1f(y,r.u_tex_y_b),u_mix:new o.Uniform1f(y,r.u_mix)}),raster:(y,r)=>({u_matrix:new o.UniformMatrix4f(y,r.u_matrix),u_tl_parent:new o.Uniform2f(y,r.u_tl_parent),u_scale_parent:new o.Uniform1f(y,r.u_scale_parent),u_buffer_scale:new o.Uniform1f(y,r.u_buffer_scale),u_fade_t:new o.Uniform1f(y,r.u_fade_t),u_opacity:new o.Uniform1f(y,r.u_opacity),u_image0:new o.Uniform1i(y,r.u_image0),u_image1:new o.Uniform1i(y,r.u_image1),u_brightness_low:new o.Uniform1f(y,r.u_brightness_low),u_brightness_high:new o.Uniform1f(y,r.u_brightness_high),u_saturation_factor:new o.Uniform1f(y,r.u_saturation_factor),u_contrast_factor:new o.Uniform1f(y,r.u_contrast_factor),u_spin_weights:new o.Uniform3f(y,r.u_spin_weights)}),symbolIcon:(y,r)=>({u_is_size_zoom_constant:new o.Uniform1i(y,r.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(y,r.u_is_size_feature_constant),u_size_t:new o.Uniform1f(y,r.u_size_t),u_size:new o.Uniform1f(y,r.u_size),u_camera_to_center_distance:new o.Uniform1f(y,r.u_camera_to_center_distance),u_pitch:new o.Uniform1f(y,r.u_pitch),u_rotate_symbol:new o.Uniform1i(y,r.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(y,r.u_aspect_ratio),u_fade_change:new o.Uniform1f(y,r.u_fade_change),u_matrix:new o.UniformMatrix4f(y,r.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(y,r.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(y,r.u_coord_matrix),u_is_text:new o.Uniform1i(y,r.u_is_text),u_pitch_with_map:new o.Uniform1i(y,r.u_pitch_with_map),u_texsize:new o.Uniform2f(y,r.u_texsize),u_texture:new o.Uniform1i(y,r.u_texture)}),symbolSDF:(y,r)=>({u_is_size_zoom_constant:new o.Uniform1i(y,r.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(y,r.u_is_size_feature_constant),u_size_t:new o.Uniform1f(y,r.u_size_t),u_size:new o.Uniform1f(y,r.u_size),u_camera_to_center_distance:new o.Uniform1f(y,r.u_camera_to_center_distance),u_pitch:new o.Uniform1f(y,r.u_pitch),u_rotate_symbol:new o.Uniform1i(y,r.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(y,r.u_aspect_ratio),u_fade_change:new o.Uniform1f(y,r.u_fade_change),u_matrix:new o.UniformMatrix4f(y,r.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(y,r.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(y,r.u_coord_matrix),u_is_text:new o.Uniform1i(y,r.u_is_text),u_pitch_with_map:new o.Uniform1i(y,r.u_pitch_with_map),u_texsize:new o.Uniform2f(y,r.u_texsize),u_texture:new o.Uniform1i(y,r.u_texture),u_gamma_scale:new o.Uniform1f(y,r.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(y,r.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(y,r.u_is_halo)}),symbolTextAndIcon:(y,r)=>({u_is_size_zoom_constant:new o.Uniform1i(y,r.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(y,r.u_is_size_feature_constant),u_size_t:new o.Uniform1f(y,r.u_size_t),u_size:new o.Uniform1f(y,r.u_size),u_camera_to_center_distance:new o.Uniform1f(y,r.u_camera_to_center_distance),u_pitch:new o.Uniform1f(y,r.u_pitch),u_rotate_symbol:new o.Uniform1i(y,r.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(y,r.u_aspect_ratio),u_fade_change:new o.Uniform1f(y,r.u_fade_change),u_matrix:new o.UniformMatrix4f(y,r.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(y,r.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(y,r.u_coord_matrix),u_is_text:new o.Uniform1i(y,r.u_is_text),u_pitch_with_map:new o.Uniform1i(y,r.u_pitch_with_map),u_texsize:new o.Uniform2f(y,r.u_texsize),u_texsize_icon:new o.Uniform2f(y,r.u_texsize_icon),u_texture:new o.Uniform1i(y,r.u_texture),u_texture_icon:new o.Uniform1i(y,r.u_texture_icon),u_gamma_scale:new o.Uniform1f(y,r.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(y,r.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(y,r.u_is_halo)}),background:(y,r)=>({u_matrix:new o.UniformMatrix4f(y,r.u_matrix),u_opacity:new o.Uniform1f(y,r.u_opacity),u_color:new o.UniformColor(y,r.u_color)}),backgroundPattern:(y,r)=>({u_matrix:new o.UniformMatrix4f(y,r.u_matrix),u_opacity:new o.Uniform1f(y,r.u_opacity),u_image:new o.Uniform1i(y,r.u_image),u_pattern_tl_a:new o.Uniform2f(y,r.u_pattern_tl_a),u_pattern_br_a:new o.Uniform2f(y,r.u_pattern_br_a),u_pattern_tl_b:new o.Uniform2f(y,r.u_pattern_tl_b),u_pattern_br_b:new o.Uniform2f(y,r.u_pattern_br_b),u_texsize:new o.Uniform2f(y,r.u_texsize),u_mix:new o.Uniform1f(y,r.u_mix),u_pattern_size_a:new o.Uniform2f(y,r.u_pattern_size_a),u_pattern_size_b:new o.Uniform2f(y,r.u_pattern_size_b),u_scale_a:new o.Uniform1f(y,r.u_scale_a),u_scale_b:new o.Uniform1f(y,r.u_scale_b),u_pixel_coord_upper:new o.Uniform2f(y,r.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(y,r.u_pixel_coord_lower),u_tile_units_to_pixels:new o.Uniform1f(y,r.u_tile_units_to_pixels)}),terrain:(y,r)=>({u_matrix:new o.UniformMatrix4f(y,r.u_matrix),u_texture:new o.Uniform1i(y,r.u_texture)}),terrainDepth:(y,r)=>({u_matrix:new o.UniformMatrix4f(y,r.u_matrix)}),terrainCoords:(y,r)=>({u_matrix:new o.UniformMatrix4f(y,r.u_matrix),u_texture:new o.Uniform1i(y,r.u_texture),u_terrain_coords_id:new o.Uniform1f(y,r.u_terrain_coords_id)})};class Ql{constructor(r,c,m){this.context=r;const _=r.gl;this.buffer=_.createBuffer(),this.dynamicDraw=Boolean(m),this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),_.bufferData(_.ELEMENT_ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete c.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){const c=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const _a={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ya{constructor(r,c,m,_){this.length=c.length,this.attributes=m,this.itemSize=c.bytesPerElement,this.dynamicDraw=_,this.context=r;const S=r.gl;this.buffer=S.createBuffer(),r.bindVertexBuffer.set(this.buffer),S.bufferData(S.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||delete c.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){if(r.length!==this.length)throw new Error(`Length of new data is ${r.length}, which doesn't match current length of ${this.length}`);const c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,c){for(let m=0;m<this.attributes.length;m++){const _=c.attributes[this.attributes[m].name];_!==void 0&&r.enableVertexAttribArray(_)}}setVertexAttribPointers(r,c,m){for(let _=0;_<this.attributes.length;_++){const S=this.attributes[_],z=c.attributes[S.name];z!==void 0&&r.vertexAttribPointer(z,S.components,r[_a[S.type]],!1,this.itemSize,S.offset+this.itemSize*(m||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Ti{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ms extends Ti{getDefault(){return o.Color.transparent}set(r){const c=this.current;(r.r!==c.r||r.g!==c.g||r.b!==c.b||r.a!==c.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class qs extends Ti{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class Ga extends Ti{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class uo extends Ti{getDefault(){return[!0,!0,!0,!0]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||r[2]!==c[2]||r[3]!==c[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class ca extends Ti{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class Li extends Ti{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class Zs extends Ti{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const c=this.current;(r.func!==c.func||r.ref!==c.ref||r.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class Yl extends Ti{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||r[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class wA extends Ti{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=r,this.dirty=!1}}class NA extends Ti{getDefault(){return[0,1]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class Xs extends Ti{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=r,this.dirty=!1}}class ks extends Ti{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class Dl extends Ti{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.BLEND):c.disable(c.BLEND),this.current=r,this.dirty=!1}}class eA extends Ti{getDefault(){const r=this.gl;return[r.ONE,r.ZERO]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(r[0],r[1]),this.current=r,this.dirty=!1)}}class ja extends Ti{getDefault(){return o.Color.transparent}set(r){const c=this.current;(r.r!==c.r||r.g!==c.g||r.b!==c.b||r.a!==c.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Ll extends Ti{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquation(r),this.current=r,this.dirty=!1)}}class bA extends Ti{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;r?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=r,this.dirty=!1}}class ps extends Ti{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class tA extends Ti{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}class mc extends Ti{getDefault(){return null}set(r){(r!==this.current||this.dirty)&&(this.gl.useProgram(r),this.current=r,this.dirty=!1)}}class Ro extends Ti{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class KA extends Ti{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const c=this.current;(r[0]!==c[0]||r[1]!==c[1]||r[2]!==c[2]||r[3]!==c[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Ws extends Ti{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class Js extends Ti{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Ps extends Ti{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindTexture(c.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class ds extends Ti{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class fs extends Ti{getDefault(){return null}set(r){const c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class Qs extends Ti{constructor(r){super(r),this.vao=r.extVertexArrayObject}getDefault(){return null}set(r){this.vao&&(r!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(r),this.current=r,this.dirty=!1)}}class $a extends Ti{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class qa extends Ti{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class GA extends Ti{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class rA extends Ti{constructor(r,c){super(r),this.context=r,this.parent=c}getDefault(){return null}}class Ki extends rA{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class gc extends rA{set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Ds{constructor(r,c,m,_){this.context=r,this.width=c,this.height=m;const S=r.gl,z=this.framebuffer=S.createFramebuffer();if(this.colorAttachment=new Ki(r,z),_&&(this.depthAttachment=new gc(r,z)),S.checkFramebufferStatus(S.FRAMEBUFFER)!==S.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const r=this.context.gl,c=this.colorAttachment.get();if(c&&r.deleteTexture(c),this.depthAttachment){const m=this.depthAttachment.get();m&&r.deleteRenderbuffer(m)}r.deleteFramebuffer(this.framebuffer)}}class Rn{constructor(r,c,m){this.blendFunction=r,this.blendColor=c,this.mask=m}}Rn.Replace=[1,0],Rn.disabled=new Rn(Rn.Replace,o.Color.transparent,[!1,!1,!1,!1]),Rn.unblended=new Rn(Rn.Replace,o.Color.transparent,[!0,!0,!0,!0]),Rn.alphaBlended=new Rn([1,771],o.Color.transparent,[!0,!0,!0,!0]);class jA{constructor(r){this.gl=r,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Ms(this),this.clearDepth=new qs(this),this.clearStencil=new Ga(this),this.colorMask=new uo(this),this.depthMask=new ca(this),this.stencilMask=new Li(this),this.stencilFunc=new Zs(this),this.stencilOp=new Yl(this),this.stencilTest=new wA(this),this.depthRange=new NA(this),this.depthTest=new Xs(this),this.depthFunc=new ks(this),this.blend=new Dl(this),this.blendFunc=new eA(this),this.blendColor=new ja(this),this.blendEquation=new Ll(this),this.cullFace=new bA(this),this.cullFaceSide=new ps(this),this.frontFace=new tA(this),this.program=new mc(this),this.activeTexture=new Ro(this),this.viewport=new KA(this),this.bindFramebuffer=new Ws(this),this.bindRenderbuffer=new Js(this),this.bindTexture=new Ps(this),this.bindVertexBuffer=new ds(this),this.bindElementBuffer=new fs(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Qs(this),this.pixelStoreUnpack=new $a(this),this.pixelStoreUnpackPremultiplyAlpha=new qa(this),this.pixelStoreUnpackFlipY=new GA(this),this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=r.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(r.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=r.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=r.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,c){return new Ql(this,r,c)}createVertexBuffer(r,c,m){return new Ya(this,r,c,m)}createRenderbuffer(r,c,m){const _=this.gl,S=_.createRenderbuffer();return this.bindRenderbuffer.set(S),_.renderbufferStorage(_.RENDERBUFFER,r,c,m),this.bindRenderbuffer.set(null),S}createFramebuffer(r,c,m){return new Ds(this,r,c,m)}clear({color:r,depth:c}){const m=this.gl;let _=0;r&&(_|=m.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set([!0,!0,!0,!0])),c!==void 0&&(_|=m.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),m.clear(_)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){Y(r.blendFunction,Rn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor)),this.colorMask.set(r.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Pi{constructor(r,c,m){this.func=r,this.mask=c,this.range=m}}Pi.ReadOnly=!1,Pi.ReadWrite=!0,Pi.disabled=new Pi(519,Pi.ReadOnly,[0,1]);const Gi=7680;class Yi{constructor(r,c,m,_,S,z){this.test=r,this.ref=c,this.mask=m,this.fail=_,this.depthFail=S,this.pass=z}}Yi.disabled=new Yi({func:519,mask:0},0,0,Gi,Gi,Gi);class sn{constructor(r,c,m){this.enable=r,this.mode=c,this.frontFace=m}}let ua;function Za(y,r,c,m,_,S,z){const N=y.context,$=N.gl,W=y.useProgram("collisionBox"),ce=[];let ge=0,Ce=0;for(let $e=0;$e<m.length;$e++){const Ct=m[$e],wt=r.getTile(Ct),Mt=wt.getBucket(c);if(!Mt)continue;let Ft=Ct.posMatrix;_[0]===0&&_[1]===0||(Ft=y.translatePosMatrix(Ct.posMatrix,wt,_,S));const jt=z?Mt.textCollisionBox:Mt.iconCollisionBox,St=Mt.collisionCircleArray;if(St.length>0){const mr=o.create(),sr=Ft;o.mul(mr,Mt.placementInvProjMatrix,y.transform.glCoordMatrix),o.mul(mr,mr,Mt.placementViewportMatrix),ce.push({circleArray:St,circleOffset:Ce,transform:sr,invTransform:mr,coord:Ct}),ge+=St.length/4,Ce=ge}jt&&W.draw(N,$.LINES,Pi.disabled,Yi.disabled,y.colorModeForRenderPass(),sn.disabled,Dn(Ft,y.transform,wt),y.style.terrain&&y.style.terrain.getTerrainData(Ct),c.id,jt.layoutVertexBuffer,jt.indexBuffer,jt.segments,null,y.transform.zoom,null,null,jt.collisionVertexBuffer)}if(!z||!ce.length)return;const je=y.useProgram("collisionCircle"),De=new o.CollisionCircleLayoutArray;De.resize(4*ge),De._trim();let Ke=0;for(const $e of ce)for(let Ct=0;Ct<$e.circleArray.length/4;Ct++){const wt=4*Ct,Mt=$e.circleArray[wt+0],Ft=$e.circleArray[wt+1],jt=$e.circleArray[wt+2],St=$e.circleArray[wt+3];De.emplace(Ke++,Mt,Ft,jt,St,0),De.emplace(Ke++,Mt,Ft,jt,St,1),De.emplace(Ke++,Mt,Ft,jt,St,2),De.emplace(Ke++,Mt,Ft,jt,St,3)}(!ua||ua.length<2*ge)&&(ua=function($e){const Ct=2*$e,wt=new o.QuadTriangleArray;wt.resize(Ct),wt._trim();for(let Mt=0;Mt<Ct;Mt++){const Ft=6*Mt;wt.uint16[Ft+0]=4*Mt+0,wt.uint16[Ft+1]=4*Mt+1,wt.uint16[Ft+2]=4*Mt+2,wt.uint16[Ft+3]=4*Mt+2,wt.uint16[Ft+4]=4*Mt+3,wt.uint16[Ft+5]=4*Mt+0}return wt}(ge));const lt=N.createIndexBuffer(ua,!0),ht=N.createVertexBuffer(De,o.collisionCircleLayout.members,!0);for(const $e of ce){const Ct={u_matrix:$e.transform,u_inv_matrix:$e.invTransform,u_camera_to_center_distance:(vt=y.transform).cameraToCenterDistance,u_viewport_size:[vt.width,vt.height]};je.draw(N,$.TRIANGLES,Pi.disabled,Yi.disabled,y.colorModeForRenderPass(),sn.disabled,Ct,y.style.terrain&&y.style.terrain.getTerrainData($e.coord),c.id,ht,lt,o.SegmentVector.simpleSegment(0,2*$e.circleOffset,$e.circleArray.length,$e.circleArray.length/2),null,y.transform.zoom,null,null,null)}var vt;ht.destroy(),lt.destroy()}sn.disabled=new sn(!1,1029,2305),sn.backCCW=new sn(!0,1029,2305);const Tn=o.identity(new Float32Array(16));function $A(y,r,c,m,_,S){const{horizontalAlign:z,verticalAlign:N}=o.getAnchorAlignment(y),$=-(z-.5)*r,W=-(N-.5)*c,ce=o.evaluateVariableOffset(y,m);return new o.pointGeometry(($/_+ce[0])*S,(W/_+ce[1])*S)}function ms(y,r,c,m,_,S,z,N,$,W,ce){const ge=y.text.placedSymbolArray,Ce=y.text.dynamicLayoutVertexArray,je=y.icon.dynamicLayoutVertexArray,De={};Ce.clear();for(let Ke=0;Ke<ge.length;Ke++){const lt=ge.get(Ke),ht=y.allowVerticalPlacement&&!lt.placedOrientation,vt=lt.hidden||!lt.crossTileID||ht?null:m[lt.crossTileID];if(vt){const $e=new o.pointGeometry(lt.anchorX,lt.anchorY),Ct=bi($e,c?z:S,ce),wt=bo(_.cameraToCenterDistance,Ct.signedDistanceFromCamera);let Mt=o.evaluateSizeForFeature(y.textSizeData,$,lt)*wt/o.ONE_EM;c&&(Mt*=y.tilePixelRatio/N);const{width:Ft,height:jt,anchor:St,textOffset:mr,textBoxScale:sr}=vt,l=$A(St,Ft,jt,mr,sr,Mt),u=c?bi($e.add(l),S,ce).point:Ct.point.add(r?l.rotate(-_.angle):l),A=y.allowVerticalPlacement&&lt.placedOrientation===o.WritingMode.vertical?Math.PI/2:0;for(let d=0;d<lt.numGlyphs;d++)o.addDynamicAttributes(Ce,u,A);W&&lt.associatedIconIndex>=0&&(De[lt.associatedIconIndex]={shiftedAnchor:u,angle:A})}else Gr(lt.numGlyphs,Ce)}if(W){je.clear();const Ke=y.icon.placedSymbolArray;for(let lt=0;lt<Ke.length;lt++){const ht=Ke.get(lt);if(ht.hidden)Gr(ht.numGlyphs,je);else{const vt=De[lt];if(vt)for(let $e=0;$e<ht.numGlyphs;$e++)o.addDynamicAttributes(je,vt.shiftedAnchor,vt.angle);else Gr(ht.numGlyphs,je)}}y.icon.dynamicLayoutVertexBuffer.updateData(je)}y.text.dynamicLayoutVertexBuffer.updateData(Ce)}function qA(y,r,c){return c.iconsInText&&r?"symbolTextAndIcon":y?"symbolSDF":"symbolIcon"}function ha(y,r,c,m,_,S,z,N,$,W,ce,ge){const Ce=y.context,je=Ce.gl,De=y.transform,Ke=N==="map",lt=$==="map",ht=N!=="viewport"&&c.layout.get("symbol-placement")!=="point",vt=Ke&&!lt&&!ht,$e=!c.layout.get("symbol-sort-key").isConstant();let Ct=!1;const wt=y.depthModeForSublayer(0,Pi.ReadOnly),Mt=c.layout.get("text-variable-anchor"),Ft=[];for(const jt of m){const St=r.getTile(jt),mr=St.getBucket(c);if(!mr)continue;const sr=_?mr.text:mr.icon;if(!sr||!sr.segments.get().length)continue;const l=sr.programConfigurations.get(c.id),u=_||mr.sdfIcons,A=_?mr.textSizeData:mr.iconSizeData,d=lt||De.pitch!==0,b=y.useProgram(qA(u,_,mr),l),M=o.evaluateSizeForZoom(A,De.zoom),Q=y.style.terrain&&y.style.terrain.getTerrainData(jt);let R,J,Ae,Be,Ie=[0,0],Te=null;if(_){if(J=St.glyphAtlasTexture,Ae=je.LINEAR,R=St.glyphAtlasTexture.size,mr.iconsInText){Ie=St.imageAtlasTexture.size,Te=St.imageAtlasTexture;const Vt=A.kind==="composite"||A.kind==="camera";Be=d||y.options.rotating||y.options.zooming||Vt?je.LINEAR:je.NEAREST}}else{const Vt=c.layout.get("icon-size").constantOr(0)!==1||mr.iconsNeedLinear;J=St.imageAtlasTexture,Ae=u||y.options.rotating||y.options.zooming||Vt||d?je.LINEAR:je.NEAREST,R=St.imageAtlasTexture.size}const He=mi(St,1,y.transform.zoom),Le=Ma(jt.posMatrix,lt,Ke,y.transform,He),qe=lo(jt.posMatrix,lt,Ke,y.transform,He),ke=Mt&&mr.hasTextData(),Xe=c.layout.get("icon-text-fit")!=="none"&&ke&&mr.hasIconData();if(ht){const Vt=y.style.terrain?(hr,Er)=>y.style.terrain.getElevation(jt,hr,Er):null,Ht=c.layout.get("text-rotation-alignment")==="map";Ao(mr,jt.posMatrix,y,_,Le,qe,lt,W,Ht,Vt)}const et=y.translatePosMatrix(jt.posMatrix,St,S,z),at=ht||_&&Mt||Xe?Tn:Le,mt=y.translatePosMatrix(qe,St,S,z,!0),Ze=u&&c.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let bt;bt=u?mr.iconsInText?$s(A.kind,M,vt,lt,y,et,at,mt,R,Ie):ya(A.kind,M,vt,lt,y,et,at,mt,_,R,!0):Us(A.kind,M,vt,lt,y,et,at,mt,_,R);const Tt={program:b,buffers:sr,uniformValues:bt,atlasTexture:J,atlasTextureIcon:Te,atlasInterpolation:Ae,atlasInterpolationIcon:Be,isSDF:u,hasHalo:Ze};if($e&&mr.canOverlap){Ct=!0;const Vt=sr.segments.get();for(const Ht of Vt)Ft.push({segments:new o.SegmentVector([Ht]),sortKey:Ht.sortKey,state:Tt,terrainData:Q})}else Ft.push({segments:sr.segments,sortKey:0,state:Tt,terrainData:Q})}Ct&&Ft.sort((jt,St)=>jt.sortKey-St.sortKey);for(const jt of Ft){const St=jt.state;if(Ce.activeTexture.set(je.TEXTURE0),St.atlasTexture.bind(St.atlasInterpolation,je.CLAMP_TO_EDGE),St.atlasTextureIcon&&(Ce.activeTexture.set(je.TEXTURE1),St.atlasTextureIcon&&St.atlasTextureIcon.bind(St.atlasInterpolationIcon,je.CLAMP_TO_EDGE)),St.isSDF){const mr=St.uniformValues;St.hasHalo&&(mr.u_is_halo=1,So(St.buffers,jt.segments,c,y,St.program,wt,ce,ge,mr,jt.terrainData)),mr.u_is_halo=0}So(St.buffers,jt.segments,c,y,St.program,wt,ce,ge,St.uniformValues,jt.terrainData)}}function So(y,r,c,m,_,S,z,N,$,W){const ce=m.context;_.draw(ce,ce.gl.TRIANGLES,S,z,N,sn.disabled,$,W,c.id,y.layoutVertexBuffer,y.indexBuffer,r,c.paint,m.transform.zoom,y.programConfigurations.get(c.id),y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer)}function zl(y,r,c,m,_,S,z){const N=y.context.gl,$=c.paint.get("fill-pattern"),W=$&&$.constantOr(1),ce=c.getCrossfadeParameters();let ge,Ce,je,De,Ke;z?(Ce=W&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ge=N.LINES):(Ce=W?"fillPattern":"fill",ge=N.TRIANGLES);for(const lt of m){const ht=r.getTile(lt);if(W&&!ht.patternsLoaded())continue;const vt=ht.getBucket(c);if(!vt)continue;const $e=vt.programConfigurations.get(c.id),Ct=y.useProgram(Ce,$e),wt=y.style.terrain&&y.style.terrain.getTerrainData(lt);W&&(y.context.activeTexture.set(N.TEXTURE0),ht.imageAtlasTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),$e.updatePaintBuffers(ce));const Mt=$.constantOr(null);if(Mt&&ht.imageAtlas){const St=ht.imageAtlas,mr=St.patternPositions[Mt.to.toString()],sr=St.patternPositions[Mt.from.toString()];mr&&sr&&$e.setConstantPatternPositions(mr,sr)}const Ft=wt?lt:null,jt=y.translatePosMatrix(Ft?Ft.posMatrix:lt.posMatrix,ht,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));if(z){De=vt.indexBuffer2,Ke=vt.segments2;const St=[N.drawingBufferWidth,N.drawingBufferHeight];je=Ce==="fillOutlinePattern"&&W?Uo(jt,y,ce,ht,St):go(jt,St)}else De=vt.indexBuffer,Ke=vt.segments,je=W?Ni(jt,y,ce,ht):vi(jt);Ct.draw(y.context,ge,_,y.stencilModeForClipping(lt),S,sn.disabled,je,wt,c.id,vt.layoutVertexBuffer,De,Ke,c.paint,y.transform.zoom,$e)}}function ta(y,r,c,m,_,S,z){const N=y.context,$=N.gl,W=c.paint.get("fill-extrusion-pattern"),ce=W.constantOr(1),ge=c.getCrossfadeParameters(),Ce=c.paint.get("fill-extrusion-opacity");for(const je of m){const De=r.getTile(je),Ke=De.getBucket(c);if(!Ke)continue;const lt=y.style.terrain&&y.style.terrain.getTerrainData(je),ht=Ke.programConfigurations.get(c.id),vt=y.useProgram(ce?"fillExtrusionPattern":"fillExtrusion",ht);ce&&(y.context.activeTexture.set($.TEXTURE0),De.imageAtlasTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),ht.updatePaintBuffers(ge));const $e=W.constantOr(null);if($e&&De.imageAtlas){const Ft=De.imageAtlas,jt=Ft.patternPositions[$e.to.toString()],St=Ft.patternPositions[$e.from.toString()];jt&&St&&ht.setConstantPatternPositions(jt,St)}const Ct=y.translatePosMatrix(je.posMatrix,De,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),wt=c.paint.get("fill-extrusion-vertical-gradient"),Mt=ce?fi(Ct,y,wt,Ce,je,ge,De):Eo(Ct,y,wt,Ce);vt.draw(N,N.gl.TRIANGLES,_,S,z,sn.backCCW,Mt,lt,c.id,Ke.layoutVertexBuffer,Ke.indexBuffer,Ke.segments,c.paint,y.transform.zoom,ht,y.style.terrain&&Ke.centroidVertexBuffer)}}function Ai(y,r,c,m,_,S,z){const N=y.context,$=N.gl,W=c.fbo;if(!W)return;const ce=y.useProgram("hillshade"),ge=y.style.terrain&&y.style.terrain.getTerrainData(r);N.activeTexture.set($.TEXTURE0),$.bindTexture($.TEXTURE_2D,W.colorAttachment.get()),ce.draw(N,$.TRIANGLES,_,S,z,sn.disabled,((Ce,je,De,Ke)=>{const lt=De.paint.get("hillshade-shadow-color"),ht=De.paint.get("hillshade-highlight-color"),vt=De.paint.get("hillshade-accent-color");let $e=De.paint.get("hillshade-illumination-direction")*(Math.PI/180);De.paint.get("hillshade-illumination-anchor")==="viewport"&&($e-=Ce.transform.angle);const Ct=!Ce.options.moving;return{u_matrix:Ke?Ke.posMatrix:Ce.transform.calculatePosMatrix(je.tileID.toUnwrapped(),Ct),u_image:0,u_latrange:Io(0,je.tileID),u_light:[De.paint.get("hillshade-exaggeration"),$e],u_shadow:lt,u_highlight:ht,u_accent:vt}})(y,c,m,ge?r:null),ge,m.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}function Rl(y,r,c,m,_,S){const z=y.context,N=z.gl,$=r.dem;if($&&$.data){const W=$.dim,ce=$.stride,ge=$.getPixels();if(z.activeTexture.set(N.TEXTURE1),z.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||y.getTileTexture(ce),r.demTexture){const je=r.demTexture;je.update(ge,{premultiply:!1}),je.bind(N.NEAREST,N.CLAMP_TO_EDGE)}else r.demTexture=new it(z,ge,N.RGBA,{premultiply:!1}),r.demTexture.bind(N.NEAREST,N.CLAMP_TO_EDGE);z.activeTexture.set(N.TEXTURE0);let Ce=r.fbo;if(!Ce){const je=new it(z,{width:W,height:W,data:null},N.RGBA);je.bind(N.LINEAR,N.CLAMP_TO_EDGE),Ce=r.fbo=z.createFramebuffer(W,W,!0),Ce.colorAttachment.set(je.texture)}z.bindFramebuffer.set(Ce.framebuffer),z.viewport.set([0,0,W,W]),y.useProgram("hillshadePrepare").draw(z,N.TRIANGLES,m,_,S,sn.disabled,((je,De)=>{const Ke=De.stride,lt=o.create();return o.ortho(lt,0,o.EXTENT,-o.EXTENT,0,0,1),o.translate(lt,lt,[0,-o.EXTENT,0]),{u_matrix:lt,u_image:1,u_dimension:[Ke,Ke],u_zoom:je.overscaledZ,u_unpack:De.getUnpackVector()}})(r.tileID,$),null,c.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments),r.needsHillshadePrepare=!1}}function To(y,r,c,m,_,S){const z=m.paint.get("raster-fade-duration");if(!S&&z>0){const N=o.exported.now(),$=(N-y.timeAdded)/z,W=r?(N-r.timeAdded)/z:-1,ce=c.getSource(),ge=_.coveringZoomLevel({tileSize:ce.tileSize,roundZoom:ce.roundZoom}),Ce=!r||Math.abs(r.tileID.overscaledZ-ge)>Math.abs(y.tileID.overscaledZ-ge),je=Ce&&y.refreshedUponExpiration?1:o.clamp(Ce?$:1-W,0,1);return y.refreshedUponExpiration&&$>=1&&(y.refreshedUponExpiration=!1),r?{opacity:1,mix:1-je}:{opacity:je,mix:0}}return{opacity:1,mix:0}}const es=new o.Color(1,0,0,1),Mo=new o.Color(0,1,0,1),Ol=new o.Color(0,0,1,1),Fn=new o.Color(1,0,1,1),Hl=new o.Color(0,1,1,1);function Da(y,r,c,m){ys(y,0,r+c/2,y.transform.width,c,m)}function gs(y,r,c,m){ys(y,r-c/2,0,c,y.transform.height,m)}function ys(y,r,c,m,_,S){const z=y.context,N=z.gl;N.enable(N.SCISSOR_TEST),N.scissor(r*y.pixelRatio,c*y.pixelRatio,m*y.pixelRatio,_*y.pixelRatio),z.clear({color:S}),N.disable(N.SCISSOR_TEST)}function Ys(y,r,c){const m=y.context,_=m.gl,S=c.posMatrix,z=y.useProgram("debug"),N=Pi.disabled,$=Yi.disabled,W=y.colorModeForRenderPass(),ce="$debug",ge=y.style.terrain&&y.style.terrain.getTerrainData(c);m.activeTexture.set(_.TEXTURE0),y.emptyTexture.bind(_.LINEAR,_.CLAMP_TO_EDGE);const Ce=r.getTileByID(c.key).latestRawTileData,je=Math.floor((Ce&&Ce.byteLength||0)/1024),De=r.getTile(c).tileSize,Ke=512/Math.min(De,512)*(c.overscaledZ/y.transform.zoom)*.5;let lt=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(lt+=` => ${c.overscaledZ}`),function(ht,vt){ht.initDebugOverlayCanvas();const $e=ht.debugOverlayCanvas,Ct=ht.context.gl,wt=ht.debugOverlayCanvas.getContext("2d");wt.clearRect(0,0,$e.width,$e.height),wt.shadowColor="white",wt.shadowBlur=2,wt.lineWidth=1.5,wt.strokeStyle="white",wt.textBaseline="top",wt.font="bold 36px Open Sans, sans-serif",wt.fillText(vt,5,5),wt.strokeText(vt,5,5),ht.debugOverlayTexture.update($e),ht.debugOverlayTexture.bind(Ct.LINEAR,Ct.CLAMP_TO_EDGE)}(y,`${lt} ${je}kB`),z.draw(m,_.TRIANGLES,N,$,Rn.alphaBlended,sn.disabled,Aa(S,o.Color.transparent,Ke),null,ce,y.debugBuffer,y.quadTriangleIndexBuffer,y.debugSegments),z.draw(m,_.LINE_STRIP,N,$,W,sn.disabled,Aa(S,o.Color.red),ge,ce,y.debugBuffer,y.tileBorderIndexBuffer,y.debugSegments)}function _s(y,r,c){const m=y.context,_=m.gl,S=y.colorModeForRenderPass(),z=new Pi(_.LEQUAL,Pi.ReadWrite,y.depthRangeFor3D),N=y.useProgram("terrain"),$=r.getTerrainMesh(),W=r.getTerrainData(c.tileID);m.bindFramebuffer.set(null),m.viewport.set([0,0,y.width,y.height]),m.activeTexture.set(_.TEXTURE0),_.bindTexture(_.TEXTURE_2D,r.getRTTFramebuffer().colorAttachment.get());const ce=y.transform.calculatePosMatrix(c.tileID.toUnwrapped());N.draw(m,_.TRIANGLES,z,Yi.disabled,S,sn.backCCW,{u_matrix:ce,u_texture:0},W,"terrain",$.vertexBuffer,$.indexBuffer,$.segments)}function BA(y,r,c,m){const _=y.context,S=c.tileSize*r.qualityFactor;c.textures[m]||(c.textures[m]=y.getTileTexture(S)||new it(_,{width:S,height:S,data:null},_.gl.RGBA),c.textures[m].bind(_.gl.LINEAR,_.gl.CLAMP_TO_EDGE),m===0&&r.sourceCache.renderHistory.unshift(c.tileID.key));const z=r.getRTTFramebuffer();z.colorAttachment.set(c.textures[m].texture),_.bindFramebuffer.set(z.framebuffer),_.viewport.set([0,0,S,S])}class Oo{constructor(r){this._coordsDescendingInv={},this._coordsDescendingInvStr={},this.painter=r,this._renderToTexture={background:!0,fill:!0,line:!0,raster:!0},this._coordsDescendingInv={},this._coordsDescendingInvStr={},this._stacks=[],this._prevType=null,this._rerender={},this._renderableTiles=r.style.terrain.sourceCache.getRenderableTiles(),this._init()}_init(){const r=this.painter.style,c=r.terrain;for(const m in r.sourceCaches){this._coordsDescendingInv[m]={};const _=r.sourceCaches[m].getVisibleCoordinates();for(const S of _){const z=c.sourceCache.getTerrainCoords(S);for(const N in z)this._coordsDescendingInv[m][N]||(this._coordsDescendingInv[m][N]=[]),this._coordsDescendingInv[m][N].push(z[N])}}for(const m of r._order){const _=r._layers[m],S=_.source;if(this._renderToTexture[_.type]&&!this._coordsDescendingInvStr[S]){this._coordsDescendingInvStr[S]={};for(const z in this._coordsDescendingInv[S])this._coordsDescendingInvStr[S][z]=this._coordsDescendingInv[S][z].map(N=>N.key).sort().join()}}return this._renderableTiles.forEach(m=>{for(const _ in this._coordsDescendingInvStr){const S=this._coordsDescendingInvStr[_][m.tileID.key];S&&S!==m.textureCoords[_]&&m.clearTextures(this.painter),c.needsRerender(_,m.tileID)&&m.clearTextures(this.painter)}this._rerender[m.tileID.key]=!m.textures.length}),c.clearRerenderCache(),c.sourceCache.removeOutdated(this.painter),this}renderLayer(r){const c=r.type,m=this.painter,_=m.style._order,S=m.currentLayer,z=S+1===_.length;if(this._renderToTexture[c]&&(this._prevType&&this._renderToTexture[this._prevType]||this._stacks.push([]),this._prevType=c,this._stacks[this._stacks.length-1].push(_[S]),!z))return!0;if(this._renderToTexture[this._prevType]||c==="hillshade"||this._renderToTexture[c]&&z){this._prevType=c;const N=this._stacks.length-1,$=this._stacks[N]||[];for(const W of this._renderableTiles){if(BA(m,m.style.terrain,W,N),this._rerender[W.tileID.key]){m.context.clear({color:o.Color.transparent});for(let ce=0;ce<$.length;ce++){const ge=m.style._layers[$[ce]],Ce=ge.source?this._coordsDescendingInv[ge.source][W.tileID.key]:[W.tileID];m._renderTileClippingMasks(ge,Ce),m.renderLayer(m,m.style.sourceCaches[ge.source],ge,Ce),ge.source&&(W.textureCoords[ge.source]=this._coordsDescendingInvStr[ge.source][W.tileID.key])}}_s(m,m.style.terrain,W)}if(c==="hillshade"){this._stacks.push([_[S]]);for(const W of this._renderableTiles){const ce=this._coordsDescendingInv[r.source][W.tileID.key];BA(m,m.style.terrain,W,this._stacks.length-1),m.context.clear({color:o.Color.transparent}),m._renderTileClippingMasks(r,ce),m.renderLayer(m,m.style.sourceCaches[r.source],r,ce),_s(m,m.style.terrain,W)}return!0}return this._renderToTexture[c]}return!1}}const ho={symbol:function(y,r,c,m,_){if(y.renderPass!=="translucent")return;const S=Yi.disabled,z=y.colorModeForRenderPass();c.layout.get("text-variable-anchor")&&function(N,$,W,ce,ge,Ce,je){const De=$.transform,Ke=ge==="map",lt=Ce==="map";for(const ht of N){const vt=ce.getTile(ht),$e=vt.getBucket(W);if(!$e||!$e.text||!$e.text.segments.get().length)continue;const Ct=o.evaluateSizeForZoom($e.textSizeData,De.zoom),wt=mi(vt,1,$.transform.zoom),Mt=Ma(ht.posMatrix,lt,Ke,$.transform,wt),Ft=W.layout.get("icon-text-fit")!=="none"&&$e.hasIconData();if(Ct){const jt=Math.pow(2,De.zoom-vt.tileID.overscaledZ);ms($e,Ke,lt,je,De,Mt,ht.posMatrix,jt,Ct,Ft,$.style.terrain?(St,mr)=>$.style.terrain.getElevation(ht,St,mr):null)}}}(m,y,c,r,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),_),c.paint.get("icon-opacity").constantOr(1)!==0&&ha(y,r,c,m,!1,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),c.layout.get("icon-rotation-alignment"),c.layout.get("icon-pitch-alignment"),c.layout.get("icon-keep-upright"),S,z),c.paint.get("text-opacity").constantOr(1)!==0&&ha(y,r,c,m,!0,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),c.layout.get("text-keep-upright"),S,z),r.map.showCollisionBoxes&&(Za(y,r,c,m,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),Za(y,r,c,m,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))},circle:function(y,r,c,m){if(y.renderPass!=="translucent")return;const _=c.paint.get("circle-opacity"),S=c.paint.get("circle-stroke-width"),z=c.paint.get("circle-stroke-opacity"),N=!c.layout.get("circle-sort-key").isConstant();if(_.constantOr(1)===0&&(S.constantOr(1)===0||z.constantOr(1)===0))return;const $=y.context,W=$.gl,ce=y.depthModeForSublayer(0,Pi.ReadOnly),ge=Yi.disabled,Ce=y.colorModeForRenderPass(),je=[];for(let De=0;De<m.length;De++){const Ke=m[De],lt=r.getTile(Ke),ht=lt.getBucket(c);if(!ht)continue;const vt=ht.programConfigurations.get(c.id),$e=y.useProgram("circle",vt),Ct=ht.layoutVertexBuffer,wt=ht.indexBuffer,Mt=y.style.terrain&&y.style.terrain.getTerrainData(Ke),Ft={programConfiguration:vt,program:$e,layoutVertexBuffer:Ct,indexBuffer:wt,uniformValues:ea(y,Ke,lt,c),terrainData:Mt};if(N){const jt=ht.segments.get();for(const St of jt)je.push({segments:new o.SegmentVector([St]),sortKey:St.sortKey,state:Ft})}else je.push({segments:ht.segments,sortKey:0,state:Ft})}N&&je.sort((De,Ke)=>De.sortKey-Ke.sortKey);for(const De of je){const{programConfiguration:Ke,program:lt,layoutVertexBuffer:ht,indexBuffer:vt,uniformValues:$e,terrainData:Ct}=De.state;lt.draw($,W.TRIANGLES,ce,ge,Ce,sn.disabled,$e,Ct,c.id,ht,vt,De.segments,c.paint,y.transform.zoom,Ke)}},heatmap:function(y,r,c,m){if(c.paint.get("heatmap-opacity")!==0)if(y.renderPass==="offscreen"){const _=y.context,S=_.gl,z=Yi.disabled,N=new Rn([S.ONE,S.ONE],o.Color.transparent,[!0,!0,!0,!0]);(function($,W,ce){const ge=$.gl;$.activeTexture.set(ge.TEXTURE1),$.viewport.set([0,0,W.width/4,W.height/4]);let Ce=ce.heatmapFbo;if(Ce)ge.bindTexture(ge.TEXTURE_2D,Ce.colorAttachment.get()),$.bindFramebuffer.set(Ce.framebuffer);else{const je=ge.createTexture();ge.bindTexture(ge.TEXTURE_2D,je),ge.texParameteri(ge.TEXTURE_2D,ge.TEXTURE_WRAP_S,ge.CLAMP_TO_EDGE),ge.texParameteri(ge.TEXTURE_2D,ge.TEXTURE_WRAP_T,ge.CLAMP_TO_EDGE),ge.texParameteri(ge.TEXTURE_2D,ge.TEXTURE_MIN_FILTER,ge.LINEAR),ge.texParameteri(ge.TEXTURE_2D,ge.TEXTURE_MAG_FILTER,ge.LINEAR),Ce=ce.heatmapFbo=$.createFramebuffer(W.width/4,W.height/4,!1),function(De,Ke,lt,ht){const vt=De.gl;vt.texImage2D(vt.TEXTURE_2D,0,vt.RGBA,Ke.width/4,Ke.height/4,0,vt.RGBA,De.extRenderToTextureHalfFloat?De.extTextureHalfFloat.HALF_FLOAT_OES:vt.UNSIGNED_BYTE,null),ht.colorAttachment.set(lt)}($,W,je,Ce)}})(_,y,c),_.clear({color:o.Color.transparent});for(let $=0;$<m.length;$++){const W=m[$];if(r.hasRenderableParent(W))continue;const ce=r.getTile(W),ge=ce.getBucket(c);if(!ge)continue;const Ce=ge.programConfigurations.get(c.id),je=y.useProgram("heatmap",Ce),{zoom:De}=y.transform;je.draw(_,S.TRIANGLES,Pi.disabled,z,N,sn.disabled,hn(W.posMatrix,ce,De,c.paint.get("heatmap-intensity")),null,c.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segments,c.paint,y.transform.zoom,Ce)}_.viewport.set([0,0,y.width,y.height])}else y.renderPass==="translucent"&&(y.context.setColorMode(y.colorModeForRenderPass()),function(_,S){const z=_.context,N=z.gl,$=S.heatmapFbo;if(!$)return;z.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,$.colorAttachment.get()),z.activeTexture.set(N.TEXTURE1);let W=S.colorRampTexture;W||(W=S.colorRampTexture=new it(z,S.colorRamp,N.RGBA)),W.bind(N.LINEAR,N.CLAMP_TO_EDGE),_.useProgram("heatmapTexture").draw(z,N.TRIANGLES,Pi.disabled,Yi.disabled,_.colorModeForRenderPass(),sn.disabled,((ce,ge,Ce,je)=>{const De=o.create();o.ortho(De,0,ce.width,ce.height,0,0,1);const Ke=ce.context.gl;return{u_matrix:De,u_world:[Ke.drawingBufferWidth,Ke.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:ge.paint.get("heatmap-opacity")}})(_,S),null,S.id,_.viewportBuffer,_.quadTriangleIndexBuffer,_.viewportSegments,S.paint,_.transform.zoom)}(y,c))},line:function(y,r,c,m){if(y.renderPass!=="translucent")return;const _=c.paint.get("line-opacity"),S=c.paint.get("line-width");if(_.constantOr(1)===0||S.constantOr(1)===0)return;const z=y.depthModeForSublayer(0,Pi.ReadOnly),N=y.colorModeForRenderPass(),$=c.paint.get("line-dasharray"),W=c.paint.get("line-pattern"),ce=W.constantOr(1),ge=c.paint.get("line-gradient"),Ce=c.getCrossfadeParameters(),je=ce?"linePattern":$?"lineSDF":ge?"lineGradient":"line",De=y.context,Ke=De.gl;let lt=!0;for(const ht of m){const vt=r.getTile(ht);if(ce&&!vt.patternsLoaded())continue;const $e=vt.getBucket(c);if(!$e)continue;const Ct=$e.programConfigurations.get(c.id),wt=y.context.program.get(),Mt=y.useProgram(je,Ct),Ft=lt||Mt.program!==wt,jt=y.style.terrain&&y.style.terrain.getTerrainData(ht),St=W.constantOr(null);if(St&&vt.imageAtlas){const l=vt.imageAtlas,u=l.patternPositions[St.to.toString()],A=l.patternPositions[St.from.toString()];u&&A&&Ct.setConstantPatternPositions(u,A)}const mr=jt?ht:null,sr=ce?Qa(y,vt,c,Ce,mr):$?Fs(y,vt,c,$,Ce,mr):ge?Ka(y,vt,c,$e.lineClipsArray.length,mr):Sn(y,vt,c,mr);if(ce)De.activeTexture.set(Ke.TEXTURE0),vt.imageAtlasTexture.bind(Ke.LINEAR,Ke.CLAMP_TO_EDGE),Ct.updatePaintBuffers(Ce);else if($&&(Ft||y.lineAtlas.dirty))De.activeTexture.set(Ke.TEXTURE0),y.lineAtlas.bind(De);else if(ge){const l=$e.gradients[c.id];let u=l.texture;if(c.gradientVersion!==l.version){let A=256;if(c.stepInterpolant){const d=r.getSource().maxzoom,b=ht.canonical.z===d?Math.ceil(1<<y.transform.maxZoom-ht.canonical.z):1;A=o.clamp(o.nextPowerOfTwo($e.maxLineLength/o.EXTENT*1024*b),256,De.maxTextureSize)}l.gradient=o.renderColorRamp({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:A,image:l.gradient||void 0,clips:$e.lineClipsArray}),l.texture?l.texture.update(l.gradient):l.texture=new it(De,l.gradient,Ke.RGBA),l.version=c.gradientVersion,u=l.texture}De.activeTexture.set(Ke.TEXTURE0),u.bind(c.stepInterpolant?Ke.NEAREST:Ke.LINEAR,Ke.CLAMP_TO_EDGE)}Mt.draw(De,Ke.TRIANGLES,z,y.stencilModeForClipping(ht),N,sn.disabled,sr,jt,c.id,$e.layoutVertexBuffer,$e.indexBuffer,$e.segments,c.paint,y.transform.zoom,Ct,$e.layoutVertexBuffer2),lt=!1}},fill:function(y,r,c,m){const _=c.paint.get("fill-color"),S=c.paint.get("fill-opacity");if(S.constantOr(1)===0)return;const z=y.colorModeForRenderPass(),N=c.paint.get("fill-pattern"),$=y.opaquePassEnabledForLayer()&&!N.constantOr(1)&&_.constantOr(o.Color.transparent).a===1&&S.constantOr(0)===1?"opaque":"translucent";if(y.renderPass===$){const W=y.depthModeForSublayer(1,y.renderPass==="opaque"?Pi.ReadWrite:Pi.ReadOnly);zl(y,r,c,m,W,z,!1)}if(y.renderPass==="translucent"&&c.paint.get("fill-antialias")){const W=y.depthModeForSublayer(c.getPaintProperty("fill-outline-color")?2:0,Pi.ReadOnly);zl(y,r,c,m,W,z,!0)}},"fill-extrusion":function(y,r,c,m){const _=c.paint.get("fill-extrusion-opacity");if(_!==0&&y.renderPass==="translucent"){const S=new Pi(y.context.gl.LEQUAL,Pi.ReadWrite,y.depthRangeFor3D);if(_!==1||c.paint.get("fill-extrusion-pattern").constantOr(1))ta(y,r,c,m,S,Yi.disabled,Rn.disabled),ta(y,r,c,m,S,y.stencilModeFor3D(),y.colorModeForRenderPass());else{const z=y.colorModeForRenderPass();ta(y,r,c,m,S,Yi.disabled,z)}}},hillshade:function(y,r,c,m){if(y.renderPass!=="offscreen"&&y.renderPass!=="translucent")return;const _=y.context,S=y.depthModeForSublayer(0,Pi.ReadOnly),z=y.colorModeForRenderPass(),[N,$]=y.renderPass==="translucent"?y.stencilConfigForOverlap(m):[{},m];for(const W of $){const ce=r.getTile(W);ce.needsHillshadePrepare!==void 0&&ce.needsHillshadePrepare&&y.renderPass==="offscreen"?Rl(y,ce,c,S,Yi.disabled,z):y.renderPass==="translucent"&&Ai(y,W,ce,c,S,N[W.overscaledZ],z)}_.viewport.set([0,0,y.width,y.height])},raster:function(y,r,c,m){if(y.renderPass!=="translucent"||c.paint.get("raster-opacity")===0||!m.length)return;const _=y.context,S=_.gl,z=r.getSource(),N=y.useProgram("raster"),$=y.colorModeForRenderPass(),[W,ce]=z instanceof Kr?[{},m]:y.stencilConfigForOverlap(m),ge=ce[ce.length-1].overscaledZ,Ce=!y.options.moving;for(const je of ce){const De=y.depthModeForSublayer(je.overscaledZ-ge,c.paint.get("raster-opacity")===1?Pi.ReadWrite:Pi.ReadOnly,S.LESS),Ke=r.getTile(je);Ke.registerFadeDuration(c.paint.get("raster-fade-duration"));const lt=r.findLoadedParent(je,0),ht=To(Ke,lt,r,c,y.transform,y.style.terrain);let vt,$e;const Ct=c.paint.get("raster-resampling")==="nearest"?S.NEAREST:S.LINEAR;_.activeTexture.set(S.TEXTURE0),Ke.texture.bind(Ct,S.CLAMP_TO_EDGE,S.LINEAR_MIPMAP_NEAREST),_.activeTexture.set(S.TEXTURE1),lt?(lt.texture.bind(Ct,S.CLAMP_TO_EDGE,S.LINEAR_MIPMAP_NEAREST),vt=Math.pow(2,lt.tileID.overscaledZ-Ke.tileID.overscaledZ),$e=[Ke.tileID.canonical.x*vt%1,Ke.tileID.canonical.y*vt%1]):Ke.texture.bind(Ct,S.CLAMP_TO_EDGE,S.LINEAR_MIPMAP_NEAREST);const wt=y.style.terrain&&y.style.terrain.getTerrainData(je),Mt=wt?je:null,Ft=Mt?Mt.posMatrix:y.transform.calculatePosMatrix(je.toUnwrapped(),Ce),jt=kl(Ft,$e||[0,0],vt||1,ht,c);z instanceof Kr?N.draw(_,S.TRIANGLES,De,Yi.disabled,$,sn.disabled,jt,wt,c.id,z.boundsBuffer,y.quadTriangleIndexBuffer,z.boundsSegments):N.draw(_,S.TRIANGLES,De,W[je.overscaledZ],$,sn.disabled,jt,wt,c.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}},background:function(y,r,c,m){const _=c.paint.get("background-color"),S=c.paint.get("background-opacity");if(S===0)return;const z=y.context,N=z.gl,$=y.transform,W=$.tileSize,ce=c.paint.get("background-pattern");if(y.isPatternMissing(ce))return;const ge=!ce&&_.a===1&&S===1&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass!==ge)return;const Ce=Yi.disabled,je=y.depthModeForSublayer(0,ge==="opaque"?Pi.ReadWrite:Pi.ReadOnly),De=y.colorModeForRenderPass(),Ke=y.useProgram(ce?"backgroundPattern":"background"),lt=m||$.coveringTiles({tileSize:W,terrain:y.style.terrain});ce&&(z.activeTexture.set(N.TEXTURE0),y.imageManager.bind(y.context));const ht=c.getCrossfadeParameters();for(const vt of lt){const $e=m?vt.posMatrix:y.transform.calculatePosMatrix(vt.toUnwrapped()),Ct=ce?Pl($e,S,y,ce,{tileID:vt,tileSize:W},ht):vA($e,S,_),wt=y.style.terrain&&y.style.terrain.getTerrainData(vt);Ke.draw(z,N.TRIANGLES,je,Ce,De,sn.disabled,Ct,wt,c.id,y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}},debug:function(y,r,c){for(let m=0;m<c.length;m++)Ys(y,r,c[m])},custom:function(y,r,c){const m=y.context,_=c.implementation;if(y.renderPass==="offscreen"){const S=_.prerender;S&&(y.setCustomLayerDefaults(),m.setColorMode(y.colorModeForRenderPass()),S.call(_,m.gl,y.transform.customLayerMatrix()),m.setDirty(),y.setBaseState())}else if(y.renderPass==="translucent"){y.setCustomLayerDefaults(),m.setColorMode(y.colorModeForRenderPass()),m.setStencilMode(Yi.disabled);const S=_.renderingMode==="3d"?new Pi(y.context.gl.LEQUAL,Pi.ReadWrite,y.depthRangeFor3D):y.depthModeForSublayer(0,Pi.ReadOnly);m.setDepthMode(S),_.render(m.gl,y.transform.customLayerMatrix()),m.setDirty(),y.setBaseState(),m.bindFramebuffer.set(null)}}};class ts{constructor(r,c){this.context=new jA(r),this.transform=c,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.create(),renderTime:0},this.setup(),this.numSublayers=cn.maxUnderzooming+cn.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new zt,this.gpuTimers={}}resize(r,c,m){if(this.width=r*m,this.height=c*m,this.pixelRatio=m,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const _ of this.style._order)this.style._layers[_].resize()}setup(){const r=this.context,c=new o.PosArray;c.emplaceBack(0,0),c.emplaceBack(o.EXTENT,0),c.emplaceBack(0,o.EXTENT),c.emplaceBack(o.EXTENT,o.EXTENT),this.tileExtentBuffer=r.createVertexBuffer(c,Jt.members),this.tileExtentSegments=o.SegmentVector.simpleSegment(0,0,4,2);const m=new o.PosArray;m.emplaceBack(0,0),m.emplaceBack(o.EXTENT,0),m.emplaceBack(0,o.EXTENT),m.emplaceBack(o.EXTENT,o.EXTENT),this.debugBuffer=r.createVertexBuffer(m,Jt.members),this.debugSegments=o.SegmentVector.simpleSegment(0,0,4,5);const _=new o.RasterBoundsArray;_.emplaceBack(0,0,0,0),_.emplaceBack(o.EXTENT,0,o.EXTENT,0),_.emplaceBack(0,o.EXTENT,0,o.EXTENT),_.emplaceBack(o.EXTENT,o.EXTENT,o.EXTENT,o.EXTENT),this.rasterBoundsBuffer=r.createVertexBuffer(_,Or.members),this.rasterBoundsSegments=o.SegmentVector.simpleSegment(0,0,4,2);const S=new o.PosArray;S.emplaceBack(0,0),S.emplaceBack(1,0),S.emplaceBack(0,1),S.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(S,Jt.members),this.viewportSegments=o.SegmentVector.simpleSegment(0,0,4,2);const z=new o.LineStripIndexArray;z.emplaceBack(0),z.emplaceBack(1),z.emplaceBack(3),z.emplaceBack(2),z.emplaceBack(0),this.tileBorderIndexBuffer=r.createIndexBuffer(z);const N=new o.TriangleIndexArray;N.emplaceBack(0,1,2),N.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(N),this.emptyTexture=new it(r,{width:1,height:1,data:new Uint8Array([0,0,0,0])},r.gl.RGBA);const $=this.context.gl;this.stencilClearMode=new Yi({func:$.ALWAYS,mask:0},0,255,$.ZERO,$.ZERO,$.ZERO)}clearStencil(){const r=this.context,c=r.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const m=o.create();o.ortho(m,0,this.width,this.height,0,0,1),o.scale(m,m,[c.drawingBufferWidth,c.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(r,c.TRIANGLES,Pi.disabled,this.stencilClearMode,Rn.disabled,sn.disabled,co(m),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(r,c){if(this.currentStencilSource===r.source||!r.isTileClipped()||!c||!c.length)return;this.currentStencilSource=r.source;const m=this.context,_=m.gl;this.nextStencilID+c.length>256&&this.clearStencil(),m.setColorMode(Rn.disabled),m.setDepthMode(Pi.disabled);const S=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const z of c){const N=this._tileClippingMaskIDs[z.key]=this.nextStencilID++,$=this.style.terrain&&this.style.terrain.getTerrainData(z);S.draw(m,_.TRIANGLES,Pi.disabled,new Yi({func:_.ALWAYS,mask:0},N,255,_.KEEP,_.KEEP,_.REPLACE),Rn.disabled,sn.disabled,co(z.posMatrix),$,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,c=this.context.gl;return new Yi({func:c.NOTEQUAL,mask:255},r,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(r){const c=this.context.gl;return new Yi({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,c.KEEP,c.KEEP,c.REPLACE)}stencilConfigForOverlap(r){const c=this.context.gl,m=r.sort((z,N)=>N.overscaledZ-z.overscaledZ),_=m[m.length-1].overscaledZ,S=m[0].overscaledZ-_+1;if(S>1){this.currentStencilSource=void 0,this.nextStencilID+S>256&&this.clearStencil();const z={};for(let N=0;N<S;N++)z[N+_]=new Yi({func:c.GEQUAL,mask:255},N+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=S,[z,m]}return[{[_]:Yi.disabled},m]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new Rn([r.CONSTANT_COLOR,r.ONE],new o.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Rn.unblended:Rn.alphaBlended}depthModeForSublayer(r,c,m){if(!this.opaquePassEnabledForLayer())return Pi.disabled;const _=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new Pi(m||this.context.gl.LEQUAL,c,[_,_])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(r,c){this.style=r,this.options=c,this.lineAtlas=r.lineAtlas,this.imageManager=r.imageManager,this.glyphManager=r.glyphManager,this.symbolFadeChange=r.placement.symbolFadeChange(o.exported.now()),this.imageManager.beginFrame();const m=this.style._order,_=this.style.sourceCaches,S=this.style.terrain&&new Oo(this);for(const W in _){const ce=_[W];ce.used&&ce.prepare(this.context)}const z={},N={},$={};for(const W in _){const ce=_[W];z[W]=ce.getVisibleCoordinates(),N[W]=z[W].slice().reverse(),$[W]=ce.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let W=0;W<m.length;W++)if(this.style._layers[m[W]].is3D()){this.opaquePassCutoff=W;break}if(S){this.opaquePassCutoff=0;const W=this.style.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!o.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||W.length)&&(o.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(ce,ge){const Ce=ce.context,je=Ce.gl,De=Rn.unblended,Ke=new Pi(je.LEQUAL,Pi.ReadWrite,[0,1]),lt=ge.getTerrainMesh(),ht=ge.sourceCache.getRenderableTiles(),vt=ce.useProgram("terrainDepth");Ce.bindFramebuffer.set(ge.getFramebuffer("depth").framebuffer),Ce.viewport.set([0,0,ce.width/devicePixelRatio,ce.height/devicePixelRatio]),Ce.clear({color:o.Color.transparent,depth:1});for(const $e of ht){const Ct=ge.getTerrainData($e.tileID),wt=ce.transform.calculatePosMatrix($e.tileID.toUnwrapped());vt.draw(Ce,je.TRIANGLES,Ke,Yi.disabled,De,sn.backCCW,{u_matrix:wt},Ct,"terrain",lt.vertexBuffer,lt.indexBuffer,lt.segments)}Ce.bindFramebuffer.set(null),Ce.viewport.set([0,0,ce.width,ce.height])}(this,this.style.terrain),function(ce,ge){const Ce=ce.context,je=Ce.gl,De=Rn.unblended,Ke=new Pi(je.LEQUAL,Pi.ReadWrite,[0,1]),lt=ge.getTerrainMesh(),ht=ge.getCoordsTexture(),vt=ge.sourceCache.getRenderableTiles(),$e=ce.useProgram("terrainCoords");Ce.bindFramebuffer.set(ge.getFramebuffer("coords").framebuffer),Ce.viewport.set([0,0,ce.width/devicePixelRatio,ce.height/devicePixelRatio]),Ce.clear({color:o.Color.transparent,depth:1}),ge.coordsIndex=[];for(const Ct of vt){const wt=ge.getTerrainData(Ct.tileID);Ce.activeTexture.set(je.TEXTURE0),je.bindTexture(je.TEXTURE_2D,ht.texture);const Mt=ce.transform.calculatePosMatrix(Ct.tileID.toUnwrapped());$e.draw(Ce,je.TRIANGLES,Ke,Yi.disabled,De,sn.backCCW,{u_matrix:Mt,u_terrain_coords_id:(255-ge.coordsIndex.length)/255,u_texture:0},wt,"terrain",lt.vertexBuffer,lt.indexBuffer,lt.segments),ge.coordsIndex.push(Ct.tileID.key)}Ce.bindFramebuffer.set(null),Ce.viewport.set([0,0,ce.width,ce.height])}(this,this.style.terrain))}this.renderPass="offscreen";for(const W of m){const ce=this.style._layers[W];if(!ce.hasOffscreenPass()||ce.isHidden(this.transform.zoom))continue;const ge=N[ce.source];(ce.type==="custom"||ge.length)&&this.renderLayer(this,_[ce.source],ce,ge)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:c.showOverdrawInspector?o.Color.black:o.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=c.showOverdrawInspector,this.depthRangeFor3D=[0,1-(r._order.length+2)*this.numSublayers*this.depthEpsilon],!S)for(this.renderPass="opaque",this.currentLayer=m.length-1;this.currentLayer>=0;this.currentLayer--){const W=this.style._layers[m[this.currentLayer]],ce=_[W.source],ge=z[W.source];this._renderTileClippingMasks(W,ge),this.renderLayer(this,ce,W,ge)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<m.length;this.currentLayer++){const W=this.style._layers[m[this.currentLayer]],ce=_[W.source];if(S&&S.renderLayer(W))continue;const ge=(W.type==="symbol"?$:N)[W.source];this._renderTileClippingMasks(W,z[W.source]),this.renderLayer(this,ce,W,ge)}if(this.options.showTileBoundaries){let W,ce;Object.values(this.style._layers).forEach(ge=>{ge.source&&!ge.isHidden(this.transform.zoom)&&(ge.source!==(ce&&ce.id)&&(ce=this.style.sourceCaches[ge.source]),(!W||W.getSource().maxzoom<ce.getSource().maxzoom)&&(W=ce))}),W&&ho.debug(this,W,W.getVisibleCoordinates())}this.options.showPadding&&function(W){const ce=W.transform.padding;Da(W,W.transform.height-(ce.top||0),3,es),Da(W,ce.bottom||0,3,Mo),gs(W,ce.left||0,3,Ol),gs(W,W.transform.width-(ce.right||0),3,Fn);const ge=W.transform.centerPoint;(function(Ce,je,De,Ke){ys(Ce,je-1,De-10,2,20,Ke),ys(Ce,je-10,De-1,20,2,Ke)})(W,ge.x,W.transform.height-ge.y,Hl)}(this),this.context.setDefault()}renderLayer(r,c,m,_){m.isHidden(this.transform.zoom)||(m.type==="background"||m.type==="custom"||(_||[]).length)&&(this.id=m.id,this.gpuTimingStart(m),ho[m.type](r,c,m,_,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(r){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;let m=this.gpuTimers[r.id];m||(m=this.gpuTimers[r.id]={calls:0,cpuTime:0,query:c.createQueryEXT()}),m.calls++,c.beginQueryEXT(c.TIME_ELAPSED_EXT,m.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const r=this.context.extTimerQuery;r.endQueryEXT(r.TIME_ELAPSED_EXT)}collectGpuTimers(){const r=this.gpuTimers;return this.gpuTimers={},r}queryGpuTimers(r){const c={};for(const m in r){const _=r[m],S=this.context.extTimerQuery,z=S.getQueryObjectEXT(_.query,S.QUERY_RESULT_EXT)/1e6;S.deleteQueryEXT(_.query),c[m]=z}return c}translatePosMatrix(r,c,m,_,S){if(!m[0]&&!m[1])return r;const z=S?_==="map"?this.transform.angle:0:_==="viewport"?-this.transform.angle:0;if(z){const W=Math.sin(z),ce=Math.cos(z);m=[m[0]*ce-m[1]*W,m[0]*W+m[1]*ce]}const N=[S?m[0]:mi(c,m[0],this.transform.zoom),S?m[1]:mi(c,m[1],this.transform.zoom),0],$=new Float32Array(16);return o.translate($,r,N),$}saveTileTexture(r){const c=this._tileTextures[r.size[0]];c?c.push(r):this._tileTextures[r.size[0]]=[r]}getTileTexture(r){const c=this._tileTextures[r];return c&&c.length>0?c.pop():null}isPatternMissing(r){if(!r)return!1;if(!r.from||!r.to)return!0;const c=this.imageManager.getPattern(r.from.toString()),m=this.imageManager.getPattern(r.to.toString());return!c||!m}useProgram(r,c){this.cache=this.cache||{};const m=r+(c?c.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.terrain?"/terrain":"");return this.cache[m]||(this.cache[m]=new zn(this.context,r,Bi[r],c,xA[r],this._showOverdrawInspector,this.style.terrain)),this.cache[m]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new it(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class po{constructor(r,c){this.points=r,this.planes=c}static fromInvProjectionMatrix(r,c,m){const _=Math.pow(2,m),S=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(N=>{const $=1/(N=o.transformMat4([],N,r))[3]/c*_;return o.mul$1(N,N,[$,$,1/N[3],$])}),z=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(N=>{const $=o.sub([],S[N[0]],S[N[1]]),W=o.sub([],S[N[2]],S[N[1]]),ce=o.normalize([],o.cross([],$,W)),ge=-o.dot(ce,S[N[1]]);return ce.concat(ge)});return new po(S,z)}}class La{constructor(r,c){this.min=r,this.max=c,this.center=o.scale$1([],o.add([],this.min,this.max),.5)}quadrant(r){const c=[r%2==0,r<2],m=o.clone$2(this.min),_=o.clone$2(this.max);for(let S=0;S<c.length;S++)m[S]=c[S]?this.min[S]:this.center[S],_[S]=c[S]?this.center[S]:this.max[S];return _[2]=this.max[2],new La(m,_)}distanceX(r){return Math.max(Math.min(this.max[0],r[0]),this.min[0])-r[0]}distanceY(r){return Math.max(Math.min(this.max[1],r[1]),this.min[1])-r[1]}intersects(r){const c=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let m=!0;for(let _=0;_<r.planes.length;_++){const S=r.planes[_];let z=0;for(let N=0;N<c.length;N++)o.dot$1(S,c[N])>=0&&z++;if(z===0)return 0;z!==c.length&&(m=!1)}if(m)return 2;for(let _=0;_<3;_++){let S=Number.MAX_VALUE,z=-Number.MAX_VALUE;for(let N=0;N<r.points.length;N++){const $=r.points[N][_]-this.min[_];S=Math.min(S,$),z=Math.max(z,$)}if(z<0||S>this.max[_]-this.min[_])return 0}return 1}}class za{constructor(r=0,c=0,m=0,_=0){if(isNaN(r)||r<0||isNaN(c)||c<0||isNaN(m)||m<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=c,this.left=m,this.right=_}interpolate(r,c,m){return c.top!=null&&r.top!=null&&(this.top=o.number(r.top,c.top,m)),c.bottom!=null&&r.bottom!=null&&(this.bottom=o.number(r.bottom,c.bottom,m)),c.left!=null&&r.left!=null&&(this.left=o.number(r.left,c.left,m)),c.right!=null&&r.right!=null&&(this.right=o.number(r.right,c.right,m)),this}getCenter(r,c){const m=o.clamp((this.left+r-this.right)/2,0,r),_=o.clamp((this.top+c-this.bottom)/2,0,c);return new o.pointGeometry(m,_)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new za(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class vs{constructor(r,c,m,_,S){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=S===void 0||!!S,this._minZoom=r||0,this._maxZoom=c||22,this._minPitch=m==null?0:m,this._maxPitch=_==null?60:_,this.setMaxBounds(),this.width=0,this.height=0,this._center=new o.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new za,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const r=new vs(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return r.tileSize=this.tileSize,r.latRange=this.latRange,r.width=this.width,r.height=this.height,r._center=this._center,r._elevation=this._elevation,r.zoom=this.zoom,r.angle=this.angle,r._fov=this._fov,r._pitch=this._pitch,r._unmodified=this._unmodified,r._edgeInsets=this._edgeInsets.clone(),r._calcMatrices(),r}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(r){const c=-o.wrap(r,-180,180)*Math.PI/180;var m;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=(m=new o.ARRAY_TYPE(4),o.ARRAY_TYPE!=Float32Array&&(m[1]=0,m[2]=0),m[0]=1,m[3]=1,m),function(_,S,z){var N=S[0],$=S[1],W=S[2],ce=S[3],ge=Math.sin(z),Ce=Math.cos(z);_[0]=N*Ce+W*ge,_[1]=$*Ce+ce*ge,_[2]=N*-ge+W*Ce,_[3]=$*-ge+ce*Ce}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const c=o.clamp(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=r/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(r){const c=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==c&&(this._unmodified=!1,this._zoom=c,this.scale=this.zoomScale(c),this.tileZoom=Math.floor(c),this.zoomFraction=c-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(r){r!==this._elevation&&(this._elevation=r,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,c,m){this._unmodified=!1,this._edgeInsets.interpolate(r,c,m),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const c=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,c)}getVisibleUnwrappedCoordinates(r){const c=[new o.UnwrappedTileID(0,r)];if(this._renderWorldCopies){const m=this.pointCoordinate(new o.pointGeometry(0,0)),_=this.pointCoordinate(new o.pointGeometry(this.width,0)),S=this.pointCoordinate(new o.pointGeometry(this.width,this.height)),z=this.pointCoordinate(new o.pointGeometry(0,this.height)),N=Math.floor(Math.min(m.x,_.x,S.x,z.x)),$=Math.floor(Math.max(m.x,_.x,S.x,z.x)),W=1;for(let ce=N-W;ce<=$+W;ce++)ce!==0&&c.push(new o.UnwrappedTileID(ce,r))}return c}coveringTiles(r){var c,m;let _=this.coveringZoomLevel(r);const S=_;if(r.minzoom!==void 0&&_<r.minzoom)return[];r.maxzoom!==void 0&&_>r.maxzoom&&(_=r.maxzoom);const z=this.pointCoordinate(this.getCameraPoint()),N=o.MercatorCoordinate.fromLngLat(this.center),$=Math.pow(2,_),W=[$*z.x,$*z.y,0],ce=[$*N.x,$*N.y,0],ge=po.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,_);let Ce=r.minzoom||0;!r.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(Ce=_);const je=r.terrain?2/Math.min(this.tileSize,r.tileSize)*this.tileSize:3,De=$e=>({aabb:new La([$e*$,0,0],[($e+1)*$,$,0]),zoom:0,x:0,y:0,wrap:$e,fullyVisible:!1}),Ke=[],lt=[],ht=_,vt=r.reparseOverscaled?S:_;if(this._renderWorldCopies)for(let $e=1;$e<=3;$e++)Ke.push(De(-$e)),Ke.push(De($e));for(Ke.push(De(0));Ke.length>0;){const $e=Ke.pop(),Ct=$e.x,wt=$e.y;let Mt=$e.fullyVisible;if(!Mt){const l=$e.aabb.intersects(ge);if(l===0)continue;Mt=l===2}const Ft=r.terrain?W:ce,jt=$e.aabb.distanceX(Ft),St=$e.aabb.distanceY(Ft),mr=Math.max(Math.abs(jt),Math.abs(St)),sr=je+(1<<ht-$e.zoom)-2;if($e.zoom===ht||mr>sr&&$e.zoom>=Ce){const l=ht-$e.zoom,u=W[0]-.5-(Ct<<l),A=W[1]-.5-(wt<<l);lt.push({tileID:new o.OverscaledTileID($e.zoom===ht?vt:$e.zoom,$e.wrap,$e.zoom,Ct,wt),distanceSq:o.sqrLen([ce[0]-.5-Ct,ce[1]-.5-wt]),tileDistanceToCamera:Math.sqrt(u*u+A*A)})}else for(let l=0;l<4;l++){const u=(Ct<<1)+l%2,A=(wt<<1)+(l>>1),d=$e.zoom+1;let b=$e.aabb.quadrant(l);if(r.terrain){const M=new o.OverscaledTileID(d,$e.wrap,d,u,A),Q=r.terrain.getMinMaxElevation(M),R=(c=Q.minElevation)!==null&&c!==void 0?c:this.elevation,J=(m=Q.maxElevation)!==null&&m!==void 0?m:this.elevation;b=new La([b.min[0],b.min[1],R],[b.max[0],b.max[1],J])}Ke.push({aabb:b,zoom:d,x:u,y:A,wrap:$e.wrap,fullyVisible:Mt})}}return lt.sort(($e,Ct)=>$e.distanceSq-Ct.distanceSq).map($e=>$e.tileID)}resize(r,c){this.width=r,this.height=c,this.pixelsToGLUnits=[2/r,-2/c],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const c=o.clamp(r.lat,-this.maxValidLatitude,this.maxValidLatitude);return new o.pointGeometry(o.mercatorXfromLng(r.lng)*this.worldSize,o.mercatorYfromLat(c)*this.worldSize)}unproject(r){return new o.MercatorCoordinate(r.x/this.worldSize,r.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(r){this.freezeElevation||(this.elevation=r?this.getElevation(this._center,r):0)}getElevation(r,c){const m=o.MercatorCoordinate.fromLngLat(r),_=(1<<this.tileZoom)*o.EXTENT,S=m.x*_,z=m.y*_,N=Math.floor(S/o.EXTENT),$=Math.floor(z/o.EXTENT),W=new o.OverscaledTileID(this.tileZoom,0,this.tileZoom,N,$);return c.getElevation(W,S%o.EXTENT,z%o.EXTENT,o.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(r){const c=this.pointLocation(this.centerPoint,r),m=this.getElevation(c,r);if(!(this.elevation-m))return;const _=this.getCameraPosition(),S=o.MercatorCoordinate.fromLngLat(_.lngLat,_.altitude),z=o.MercatorCoordinate.fromLngLat(c,m),N=S.x-z.x,$=S.y-z.y,W=S.z-z.z,ce=Math.sqrt(N*N+$*$+W*W),ge=this.scaleZoom(this.cameraToCenterDistance/ce/this.tileSize);this._elevation=m,this._center=c,this.zoom=ge}setLocationAtPoint(r,c){const m=this.pointCoordinate(c),_=this.pointCoordinate(this.centerPoint),S=this.locationCoordinate(r),z=new o.MercatorCoordinate(S.x-(m.x-_.x),S.y-(m.y-_.y));this.center=this.coordinateLocation(z),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(r,c){return c?this.coordinatePoint(this.locationCoordinate(r),this.getElevation(r,c),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(r))}pointLocation(r,c){return this.coordinateLocation(this.pointCoordinate(r,c))}locationCoordinate(r){return o.MercatorCoordinate.fromLngLat(r)}coordinateLocation(r){return r&&r.toLngLat()}pointCoordinate(r,c){if(c){const Ce=c.pointCoordinate(r);if(Ce!=null)return Ce}const m=[r.x,r.y,0,1],_=[r.x,r.y,1,1];o.transformMat4(m,m,this.pixelMatrixInverse),o.transformMat4(_,_,this.pixelMatrixInverse);const S=m[3],z=_[3],N=m[1]/S,$=_[1]/z,W=m[2]/S,ce=_[2]/z,ge=W===ce?0:(0-W)/(ce-W);return new o.MercatorCoordinate(o.number(m[0]/S,_[0]/z,ge)/this.worldSize,o.number(N,$,ge)/this.worldSize)}coordinatePoint(r,c=0,m=this.pixelMatrix){const _=[r.x*this.worldSize,r.y*this.worldSize,c,1];return o.transformMat4(_,_,m),new o.pointGeometry(_[0]/_[3],_[1]/_[3])}getBounds(){const r=Math.max(0,this.height/2-this.getHorizon());return new o.LngLatBounds().extend(this.pointLocation(new o.pointGeometry(0,r))).extend(this.pointLocation(new o.pointGeometry(this.width,r))).extend(this.pointLocation(new o.pointGeometry(this.width,this.height))).extend(this.pointLocation(new o.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new o.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(r){r?(this.lngRange=[r.getWest(),r.getEast()],this.latRange=[r.getSouth(),r.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(r,c=!1){const m=r.key,_=c?this._alignedPosMatrixCache:this._posMatrixCache;if(_[m])return _[m];const S=r.canonical,z=this.worldSize/this.zoomScale(S.z),N=S.x+Math.pow(2,S.z)*r.wrap,$=o.identity(new Float64Array(16));return o.translate($,$,[N*z,S.y*z,0]),o.scale($,$,[z/o.EXTENT,z/o.EXTENT,1]),o.multiply($,c?this.alignedProjMatrix:this.projMatrix,$),_[m]=new Float32Array($),_[m]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let r,c,m,_,S=-90,z=90,N=-180,$=180;const W=this.size,ce=this._unmodified;if(this.latRange){const je=this.latRange;S=o.mercatorYfromLat(je[1])*this.worldSize,z=o.mercatorYfromLat(je[0])*this.worldSize,r=z-S<W.y?W.y/(z-S):0}if(this.lngRange){const je=this.lngRange;N=o.wrap(o.mercatorXfromLng(je[0])*this.worldSize,0,this.worldSize),$=o.wrap(o.mercatorXfromLng(je[1])*this.worldSize,0,this.worldSize),$<N&&($+=this.worldSize),c=$-N<W.x?W.x/($-N):0}const ge=this.point,Ce=Math.max(c||0,r||0);if(Ce)return this.center=this.unproject(new o.pointGeometry(c?($+N)/2:ge.x,r?(z+S)/2:ge.y)),this.zoom+=this.scaleZoom(Ce),this._unmodified=ce,void(this._constraining=!1);if(this.latRange){const je=ge.y,De=W.y/2;je-De<S&&(_=S+De),je+De>z&&(_=z-De)}if(this.lngRange){const je=(N+$)/2,De=o.wrap(ge.x,je-this.worldSize/2,je+this.worldSize/2),Ke=W.x/2;De-Ke<N&&(m=N+Ke),De+Ke>$&&(m=$-Ke)}m===void 0&&_===void 0||(this.center=this.unproject(new o.pointGeometry(m!==void 0?m:ge.x,_!==void 0?_:ge.y)).wrap()),this._unmodified=ce,this._constraining=!1}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,c=this.point.x,m=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=o.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let _=o.identity(new Float64Array(16));o.scale(_,_,[this.width/2,-this.height/2,1]),o.translate(_,_,[1,-1,0]),this.labelPlaneMatrix=_,_=o.identity(new Float64Array(16)),o.scale(_,_,[1,-1,1]),o.translate(_,_,[-1,-1,0]),o.scale(_,_,[2/this.width,2/this.height,1]),this.glCoordMatrix=_,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const S=Math.PI/2+this._pitch,z=this._fov*(.5+r.y/this.height),N=Math.sin(z)*this.cameraToSeaLevelDistance/Math.sin(o.clamp(Math.PI-S-z,.01,Math.PI-.01)),$=this.getHorizon(),W=2*Math.atan($/this.cameraToCenterDistance)*(.5+r.y/(2*$)),ce=Math.sin(W)*this.cameraToSeaLevelDistance/Math.sin(o.clamp(Math.PI-S-W,.01,Math.PI-.01)),ge=Math.cos(Math.PI/2-this._pitch)*N+this.cameraToSeaLevelDistance,Ce=Math.cos(Math.PI/2-this._pitch)*ce+this.cameraToSeaLevelDistance,je=1.01*Math.min(ge,Ce),De=this.height/50;_=new Float64Array(16),o.perspective(_,this._fov,this.width/this.height,De,je),_[8]=2*-r.x/this.width,_[9]=2*r.y/this.height,o.scale(_,_,[1,-1,1]),o.translate(_,_,[0,0,-this.cameraToCenterDistance]),o.rotateX(_,_,this._pitch),o.rotateZ(_,_,this.angle),o.translate(_,_,[-c,-m,0]),this.mercatorMatrix=o.scale([],_,[this.worldSize,this.worldSize,this.worldSize]),o.scale(_,_,[1,1,this._pixelPerMeter]),this.pixelMatrix=o.multiply(new Float64Array(16),this.labelPlaneMatrix,_),o.translate(_,_,[0,0,-this.elevation]),this.projMatrix=_,this.invProjMatrix=o.invert([],_),this.pixelMatrix3D=o.multiply(new Float64Array(16),this.labelPlaneMatrix,_);const Ke=this.width%2/2,lt=this.height%2/2,ht=Math.cos(this.angle),vt=Math.sin(this.angle),$e=c-Math.round(c)+ht*Ke+vt*lt,Ct=m-Math.round(m)+ht*lt+vt*Ke,wt=new Float64Array(_);if(o.translate(wt,wt,[$e>.5?$e-1:$e,Ct>.5?Ct-1:Ct,0]),this.alignedProjMatrix=wt,_=o.invert(new Float64Array(16),this.pixelMatrix),!_)throw new Error("failed to invert matrix");this.pixelMatrixInverse=_,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const r=this.pointCoordinate(new o.pointGeometry(0,0)),c=[r.x*this.worldSize,r.y*this.worldSize,0,1];return o.transformMat4(c,c,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.pointGeometry(0,r))}getCameraQueryGeometry(r){const c=this.getCameraPoint();if(r.length===1)return[r[0],c];{let m=c.x,_=c.y,S=c.x,z=c.y;for(const N of r)m=Math.min(m,N.x),_=Math.min(_,N.y),S=Math.max(S,N.x),z=Math.max(z,N.y);return[new o.pointGeometry(m,_),new o.pointGeometry(S,_),new o.pointGeometry(S,z),new o.pointGeometry(m,z),new o.pointGeometry(m,_)]}}}class ml{constructor(r){this._hashName=r&&encodeURIComponent(r),o.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(c,m){let _=!1,S=null;const z=()=>{S=null,_&&(c(),S=setTimeout(z,300),_=!1)};return()=>(_=!0,S||z(),S)}(this._updateHashUnthrottled.bind(this))}addTo(r){return this._map=r,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(r){const c=this._map.getCenter(),m=Math.round(100*this._map.getZoom())/100,_=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),S=Math.pow(10,_),z=Math.round(c.lng*S)/S,N=Math.round(c.lat*S)/S,$=this._map.getBearing(),W=this._map.getPitch();let ce="";if(ce+=r?`/${z}/${N}/${m}`:`${m}/${N}/${z}`,($||W)&&(ce+="/"+Math.round(10*$)/10),W&&(ce+=`/${Math.round(W)}`),this._hashName){const ge=this._hashName;let Ce=!1;const je=window.location.hash.slice(1).split("&").map(De=>{const Ke=De.split("=")[0];return Ke===ge?(Ce=!0,`${Ke}=${ce}`):De}).filter(De=>De);return Ce||je.push(`${ge}=${ce}`),`#${je.join("&")}`}return`#${ce}`}_getCurrentHash(){const r=window.location.hash.replace("#","");if(this._hashName){let c;return r.split("&").map(m=>m.split("=")).forEach(m=>{m[0]===this._hashName&&(c=m)}),(c&&c[1]||"").split("/")}return r.split("/")}_onHashChange(){const r=this._getCurrentHash();if(r.length>=3&&!r.some(c=>isNaN(c))){const c=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(r[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+r[2],+r[1]],zoom:+r[0],bearing:c,pitch:+(r[4]||0)}),!0}return!1}_updateHashUnthrottled(){const r=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,r)}catch{}}}const el={linearity:.3,easing:o.bezier(0,0,.3,1)},iA=o.extend({deceleration:2500,maxSpeed:1400},el),Vl=o.extend({deceleration:20,maxSpeed:1400},el),Ra=o.extend({deceleration:1e3,maxSpeed:360},el),tl=o.extend({deceleration:1e3,maxSpeed:90},el);class ZA{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.exported.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,c=o.exported.now();for(;r.length>0&&c-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const c={zoom:0,bearing:0,pitch:0,pan:new o.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:S}of this._inertiaBuffer)c.zoom+=S.zoomDelta||0,c.bearing+=S.bearingDelta||0,c.pitch+=S.pitchDelta||0,S.panDelta&&c.pan._add(S.panDelta),S.around&&(c.around=S.around),S.pinchAround&&(c.pinchAround=S.pinchAround);const m=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(c.pan.mag()){const S=zs(c.pan.mag(),m,o.extend({},iA,r||{}));_.offset=c.pan.mult(S.amount/c.pan.mag()),_.center=this._map.transform.center,Ls(_,S)}if(c.zoom){const S=zs(c.zoom,m,Vl);_.zoom=this._map.transform.zoom+S.amount,Ls(_,S)}if(c.bearing){const S=zs(c.bearing,m,Ra);_.bearing=this._map.transform.bearing+o.clamp(S.amount,-179,179),Ls(_,S)}if(c.pitch){const S=zs(c.pitch,m,tl);_.pitch=this._map.transform.pitch+S.amount,Ls(_,S)}if(_.zoom||_.bearing){const S=c.pinchAround===void 0?c.around:c.pinchAround;_.around=S?this._map.unproject(S):this._map.getCenter()}return this.clear(),o.extend(_,{noMoveStart:!0})}}function Ls(y,r){(!y.duration||y.duration<r.duration)&&(y.duration=r.duration,y.easing=r.easing)}function zs(y,r,c){const{maxSpeed:m,linearity:_,deceleration:S}=c,z=o.clamp(y*_/(r/1e3),-m,m),N=Math.abs(z)/(S*_);return{easing:c.easing,duration:1e3*N,amount:z*(N/2)}}class pa extends o.Event{constructor(r,c,m,_={}){const S=ie.mousePos(c.getCanvasContainer(),m),z=c.unproject(S);super(r,o.extend({point:S,lngLat:z,originalEvent:m},_)),this._defaultPrevented=!1,this.target=c}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class gl extends o.Event{constructor(r,c,m){const _=r==="touchend"?m.changedTouches:m.touches,S=ie.touchPos(c.getCanvasContainer(),_),z=S.map($=>c.unproject($)),N=S.reduce(($,W,ce,ge)=>$.add(W.div(ge.length)),new o.pointGeometry(0,0));super(r,{points:S,point:N,lngLats:z,lngLat:c.unproject(N),originalEvent:m}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Zn extends o.Event{constructor(r,c,m){super(r,{originalEvent:m}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Nl{constructor(r,c){this._map=r,this._clickTolerance=c.clickTolerance}reset(){delete this._mousedownPos}wheel(r){return this._firePreventable(new Zn(r.type,this._map,r))}mousedown(r,c){return this._mousedownPos=c,this._firePreventable(new pa(r.type,this._map,r))}mouseup(r){this._map.fire(new pa(r.type,this._map,r))}click(r,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||this._map.fire(new pa(r.type,this._map,r))}dblclick(r){return this._firePreventable(new pa(r.type,this._map,r))}mouseover(r){this._map.fire(new pa(r.type,this._map,r))}mouseout(r){this._map.fire(new pa(r.type,this._map,r))}touchstart(r){return this._firePreventable(new gl(r.type,this._map,r))}touchmove(r){this._map.fire(new gl(r.type,this._map,r))}touchend(r){this._map.fire(new gl(r.type,this._map,r))}touchcancel(r){this._map.fire(new gl(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Rs{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(r){this._map.fire(new pa(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new pa("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._ignoreContextMenu||this._map.fire(new pa(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class rl{constructor(r,c){this._map=r,this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,c){this.isEnabled()&&r.shiftKey&&r.button===0&&(ie.disableDrag(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(r,c){if(!this._active)return;const m=c;if(this._lastPos.equals(m)||!this._box&&m.dist(this._startPos)<this._clickTolerance)return;const _=this._startPos;this._lastPos=m,this._box||(this._box=ie.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",r));const S=Math.min(_.x,m.x),z=Math.max(_.x,m.x),N=Math.min(_.y,m.y),$=Math.max(_.y,m.y);ie.setTransform(this._box,`translate(${S}px,${N}px)`),this._box.style.width=z-S+"px",this._box.style.height=$-N+"px"}mouseupWindow(r,c){if(!this._active||r.button!==0)return;const m=this._startPos,_=c;if(this.reset(),ie.suppressClick(),m.x!==_.x||m.y!==_.y)return this._map.fire(new o.Event("boxzoomend",{originalEvent:r})),{cameraAnimation:S=>S.fitScreenCoordinates(m,_,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",r)}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(ie.remove(this._box),this._box=null),ie.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(r,c){return this._map.fire(new o.Event(r,{originalEvent:c}))}}function Oi(y,r){if(y.length!==r.length)throw new Error(`The number of touches and points are not equal - touches ${y.length}, points ${r.length}`);const c={};for(let m=0;m<y.length;m++)c[y[m].identifier]=r[m];return c}class il{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(r,c,m){(this.centroid||m.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=r.timeStamp),m.length===this.numTouches&&(this.centroid=function(_){const S=new o.pointGeometry(0,0);for(const z of _)S._add(z);return S.div(_.length)}(c),this.touches=Oi(m,c)))}touchmove(r,c,m){if(this.aborted||!this.centroid)return;const _=Oi(m,c);for(const S in this.touches){const z=this.touches[S],N=_[S];(!N||N.dist(z)>30)&&(this.aborted=!0)}}touchend(r,c,m){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),m.length===0){const _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class xs{constructor(r){this.singleTap=new il(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(r,c,m){this.singleTap.touchstart(r,c,m)}touchmove(r,c,m){this.singleTap.touchmove(r,c,m)}touchend(r,c,m){const _=this.singleTap.touchend(r,c,m);if(_){const S=r.timeStamp-this.lastTime<500,z=!this.lastTap||this.lastTap.dist(_)<30;if(S&&z||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class Os{constructor(){this._zoomIn=new xs({numTouches:1,numTaps:2}),this._zoomOut=new xs({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,c,m){this._zoomIn.touchstart(r,c,m),this._zoomOut.touchstart(r,c,m)}touchmove(r,c,m){this._zoomIn.touchmove(r,c,m),this._zoomOut.touchmove(r,c,m)}touchend(r,c,m){const _=this._zoomIn.touchend(r,c,m),S=this._zoomOut.touchend(r,c,m);return _?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:z=>z.easeTo({duration:300,zoom:z.getZoom()+1,around:z.unproject(_)},{originalEvent:r})}):S?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:z=>z.easeTo({duration:300,zoom:z.getZoom()-1,around:z.unproject(S)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Ei={0:1,2:2};class ln{constructor(r){this.reset(),this._clickTolerance=r.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(r,c){return!1}_move(r,c){return{}}mousedown(r,c){if(this._lastPoint)return;const m=ie.mouseButton(r);this._correctButton(r,m)&&(this._lastPoint=c,this._eventButton=m)}mousemoveWindow(r,c){const m=this._lastPoint;if(m){if(r.preventDefault(),function(_,S){const z=Ei[S];return _.buttons===void 0||(_.buttons&z)!==z}(r,this._eventButton))this.reset();else if(this._moved||!(c.dist(m)<this._clickTolerance))return this._moved=!0,this._lastPoint=c,this._move(m,c)}}mouseupWindow(r){this._lastPoint&&ie.mouseButton(r)===this._eventButton&&(this._moved&&ie.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ho extends ln{mousedown(r,c){super.mousedown(r,c),this._lastPoint&&(this._active=!0)}_correctButton(r,c){return c===0&&!r.ctrlKey}_move(r,c){return{around:c,panDelta:c.sub(r)}}}class va extends ln{_correctButton(r,c){return c===0&&r.ctrlKey||c===2}_move(r,c){const m=.8*(c.x-r.x);if(m)return this._active=!0,{bearingDelta:m}}contextmenu(r){r.preventDefault()}}class xr extends ln{_correctButton(r,c){return c===0&&r.ctrlKey||c===2}_move(r,c){const m=-.5*(c.y-r.y);if(m)return this._active=!0,{pitchDelta:m}}contextmenu(r){r.preventDefault()}}class yl{constructor(r,c){this._minTouches=r.cooperativeGestures?2:1,this._clickTolerance=r.clickTolerance||1,this._map=c,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.pointGeometry(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(r,c,m){return this._calculateTransform(r,c,m)}touchmove(r,c,m){if(this._map._cooperativeGestures&&(this._minTouches===2&&m.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(r,!1,m.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(m.length<this._minTouches))return r.preventDefault(),this._calculateTransform(r,c,m)}touchend(r,c,m){this._calculateTransform(r,c,m),this._active&&m.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,c,m){m.length>0&&(this._active=!0);const _=Oi(m,c),S=new o.pointGeometry(0,0),z=new o.pointGeometry(0,0);let N=0;for(const W in _){const ce=_[W],ge=this._touches[W];ge&&(S._add(ce),z._add(ce.sub(ge)),N++,_[W]=ce)}if(this._touches=_,N<this._minTouches||!z.mag())return;const $=z.div(N);return this._sum._add($),this._sum.mag()<this._clickTolerance?void 0:{around:S.div(N),panDelta:$}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _l{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(r){}_move(r,c,m){return{}}touchstart(r,c,m){this._firstTwoTouches||m.length<2||(this._firstTwoTouches=[m[0].identifier,m[1].identifier],this._start([c[0],c[1]]))}touchmove(r,c,m){if(!this._firstTwoTouches)return;r.preventDefault();const[_,S]=this._firstTwoTouches,z=rs(m,c,_),N=rs(m,c,S);if(!z||!N)return;const $=this._aroundCenter?null:z.add(N).div(2);return this._move([z,N],$,r)}touchend(r,c,m){if(!this._firstTwoTouches)return;const[_,S]=this._firstTwoTouches,z=rs(m,c,_),N=rs(m,c,S);z&&N||(this._active&&ie.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function rs(y,r,c){for(let m=0;m<y.length;m++)if(y[m].identifier===c)return r[m]}function vl(y,r){return Math.log(y/r)/Math.LN2}class pr extends _l{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,c){const m=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(vl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:vl(this._distance,m),pinchAround:c}}}function xa(y,r){return 180*y.angleWith(r)/Math.PI}class yo extends _l{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,c){const m=this._vector;if(this._vector=r[0].sub(r[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:xa(this._vector,m),pinchAround:c}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const c=25/(Math.PI*this._minDiameter)*360,m=xa(r,this._startVector);return Math.abs(m)<c}}function Xa(y){return Math.abs(y.y)>Math.abs(y.x)}class nA extends _l{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(r,c,m){super.touchstart(r,c,m),this._currentTouchCount=m.length}_start(r){this._lastPoints=r,Xa(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,c,m){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const _=r[0].sub(this._lastPoints[0]),S=r[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(_,S,m.timeStamp),this._valid?(this._lastPoints=r,this._active=!0,{pitchDelta:(_.y+S.y)/2*-.5}):void 0}gestureBeginsVertically(r,c,m){if(this._valid!==void 0)return this._valid;const _=r.mag()>=2,S=c.mag()>=2;if(!_&&!S)return;if(!_||!S)return this._firstMove===void 0&&(this._firstMove=m),m-this._firstMove<100&&void 0;const z=r.y>0==c.y>0;return Xa(r)&&Xa(c)&&z}}const io={panStep:100,bearingStep:15,pitchStep:10};class fr{constructor(){const r=io;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let c=0,m=0,_=0,S=0,z=0;switch(r.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:r.shiftKey?m=-1:(r.preventDefault(),S=-1);break;case 39:r.shiftKey?m=1:(r.preventDefault(),S=1);break;case 38:r.shiftKey?_=1:(r.preventDefault(),z=-1);break;case 40:r.shiftKey?_=-1:(r.preventDefault(),z=1);break;default:return}return this._rotationDisabled&&(m=0,_=0),{cameraAnimation:N=>{const $=N.getZoom();N.easeTo({duration:300,easeId:"keyboardHandler",easing:wa,zoom:c?Math.round($)+c*(r.shiftKey?2:1):$,bearing:N.getBearing()+m*this._bearingStep,pitch:N.getPitch()+_*this._pitchStep,offset:[-S*this._panStep,-z*this._panStep],center:N.getCenter()},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function wa(y){return y*(2-y)}const oA=4.000244140625;class nl{constructor(r,c){this._map=r,this._el=r.getCanvasContainer(),this._handler=c,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,o.bindAll(["_onTimeout"],this)}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=r&&r.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!this._map._metaPress)return;r.preventDefault()}let c=r.deltaMode===WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const m=o.exported.now(),_=m-(this._lastWheelEventTime||0);this._lastWheelEventTime=m,c!==0&&c%oA==0?this._type="wheel":c!==0&&Math.abs(c)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=c,this._timeout=setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(_*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),r.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=r,this._delta-=c,this._active||this._start(r)),r.preventDefault()}_onTimeout(r){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const c=ie.mousePos(this._el,r);this._around=o.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(c)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._map.transform;if(this._delta!==0){const N=this._type==="wheel"&&Math.abs(this._delta)>oA?this._wheelZoomRate:this._defaultZoomRate;let $=2/(1+Math.exp(-Math.abs(this._delta*N)));this._delta<0&&$!==0&&($=1/$);const W=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):r.scale;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(W*$))),this._type==="wheel"&&(this._startZoom=r.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const c=typeof this._targetZoom=="number"?this._targetZoom:r.zoom,m=this._startZoom,_=this._easing;let S,z=!1;if(this._type==="wheel"&&m&&_){const N=Math.min((o.exported.now()-this._lastWheelEventTime)/200,1),$=_(N);S=o.number(m,c,$),N<1?this._frameId||(this._frameId=!0):z=!0}else S=c,z=!0;return this._active=!0,z&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!z,zoomDelta:S-r.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let c=o.ease;if(this._prevEase){const m=this._prevEase,_=(o.exported.now()-m.start)/m.duration,S=m.easing(_+.01)-m.easing(_),z=.27/Math.sqrt(S*S+1e-4)*.01,N=Math.sqrt(.0729-z*z);c=o.bezier(z,N,.25,1)}return this._prevEase={start:o.exported.now(),duration:r,easing:c},c}reset(){this._active=!1}}class ra{constructor(r,c){this._clickZoom=r,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ia{constructor(){this.reset()}reset(){this._active=!1}dblclick(r,c){return r.preventDefault(),{cameraAnimation:m=>{m.easeTo({duration:300,zoom:m.getZoom()+(r.shiftKey?-1:1),around:m.unproject(c)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class aA{constructor(){this._tap=new xs({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(r,c,m){this._swipePoint||(this._tapTime&&r.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?m.length>0&&(this._swipePoint=c[0],this._swipeTouch=m[0].identifier):this._tap.touchstart(r,c,m))}touchmove(r,c,m){if(this._tapTime){if(this._swipePoint){if(m[0].identifier!==this._swipeTouch)return;const _=c[0],S=_.y-this._swipePoint.y;return this._swipePoint=_,r.preventDefault(),this._active=!0,{zoomDelta:S/128}}}else this._tap.touchmove(r,c,m)}touchend(r,c,m){this._tapTime?this._swipePoint&&m.length===0&&this.reset():this._tap.touchend(r,c,m)&&(this._tapTime=r.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Gt{constructor(r,c,m){this._el=r,this._mousePan=c,this._touchPan=m}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class ws{constructor(r,c,m){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=c,this._mousePitch=m}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class sA{constructor(r,c,m,_){this._el=r,this._touchZoom=c,this._touchRotate=m,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const ol=y=>y.zoom||y.drag||y.pitch||y.rotate;class ba extends o.Event{}function _o(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta}class lA{constructor(r,c){this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ZA(r),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(c),o.bindAll(["handleEvent","handleWindowEvent"],this);const m=this._el;this._listeners=[[m,"touchstart",{passive:!0}],[m,"touchmove",{passive:!1}],[m,"touchend",void 0],[m,"touchcancel",void 0],[m,"mousedown",void 0],[m,"mousemove",void 0],[m,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[m,"mouseover",void 0],[m,"mouseout",void 0],[m,"dblclick",void 0],[m,"click",void 0],[m,"keydown",{capture:!1}],[m,"keyup",void 0],[m,"wheel",{passive:!1}],[m,"contextmenu",void 0],[window,"blur",void 0]];for(const[_,S,z]of this._listeners)ie.addEventListener(_,S,_===document?this.handleWindowEvent:this.handleEvent,z)}destroy(){for(const[r,c,m]of this._listeners)ie.removeEventListener(r,c,r===document?this.handleWindowEvent:this.handleEvent,m)}_addDefaultHandlers(r){const c=this._map,m=c.getCanvasContainer();this._add("mapEvent",new Nl(c,r));const _=c.boxZoom=new rl(c,r);this._add("boxZoom",_);const S=new Os,z=new ia;c.doubleClickZoom=new ra(z,S),this._add("tapZoom",S),this._add("clickZoom",z);const N=new aA;this._add("tapDragZoom",N);const $=c.touchPitch=new nA(c);this._add("touchPitch",$);const W=new va(r),ce=new xr(r);c.dragRotate=new ws(r,W,ce),this._add("mouseRotate",W,["mousePitch"]),this._add("mousePitch",ce,["mouseRotate"]);const ge=new Ho(r),Ce=new yl(r,c);c.dragPan=new Gt(m,ge,Ce),this._add("mousePan",ge),this._add("touchPan",Ce,["touchZoom","touchRotate"]);const je=new yo,De=new pr;c.touchZoomRotate=new sA(m,De,je,N),this._add("touchRotate",je,["touchPan","touchZoom"]),this._add("touchZoom",De,["touchPan","touchRotate"]);const Ke=c.scrollZoom=new nl(c,this);this._add("scrollZoom",Ke,["mousePan"]);const lt=c.keyboard=new fr;this._add("keyboard",lt),this._add("blockableMapEvent",new Rs(c));for(const ht of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])r.interactive&&r[ht]&&c[ht].enable(r[ht])}_add(r,c,m){this._handlers.push({handlerName:r,handler:c,allowed:m}),this._handlersById[r]=c}stop(r){if(!this._updatingCamera){for(const{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[]}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(ol(this._eventsInProgress))||this.isZooming()}_blockedByActive(r,c,m){for(const _ in r)if(_!==m&&(!c||c.indexOf(_)<0))return!0;return!1}handleWindowEvent(r){this.handleEvent(r,`${r.type}Window`)}_getMapTouches(r){const c=[];for(const m of r)this._el.contains(m.target)&&c.push(m);return c}handleEvent(r,c){if(r.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const m=r.type==="renderFrame"?void 0:r,_={needsRenderFrame:!1},S={},z={},N=r.touches,$=N?this._getMapTouches(N):void 0,W=$?ie.touchPos(this._el,$):ie.mousePos(this._el,r);for(const{handlerName:Ce,handler:je,allowed:De}of this._handlers){if(!je.isEnabled())continue;let Ke;this._blockedByActive(z,De,Ce)?je.reset():je[c||r.type]&&(Ke=je[c||r.type](r,W,$),this.mergeHandlerResult(_,S,Ke,Ce,m),Ke&&Ke.needsRenderFrame&&this._triggerRenderFrame()),(Ke||je.isActive())&&(z[Ce]=je)}const ce={};for(const Ce in this._previousActiveHandlers)z[Ce]||(ce[Ce]=m);this._previousActiveHandlers=z,(Object.keys(ce).length||_o(_))&&(this._changes.push([_,S,ce]),this._triggerRenderFrame()),(Object.keys(z).length||_o(_))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ge}=_;ge&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ge(this._map))}mergeHandlerResult(r,c,m,_,S){if(!m)return;o.extend(r,m);const z={handlerName:_,originalEvent:m.originalEvent||S};m.zoomDelta!==void 0&&(c.zoom=z),m.panDelta!==void 0&&(c.drag=z),m.pitchDelta!==void 0&&(c.pitch=z),m.bearingDelta!==void 0&&(c.rotate=z)}_applyChanges(){const r={},c={},m={};for(const[_,S,z]of this._changes)_.panDelta&&(r.panDelta=(r.panDelta||new o.pointGeometry(0,0))._add(_.panDelta)),_.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+_.pitchDelta),_.around!==void 0&&(r.around=_.around),_.pinchAround!==void 0&&(r.pinchAround=_.pinchAround),_.noInertia&&(r.noInertia=_.noInertia),o.extend(c,S),o.extend(m,z);this._updateMapTransform(r,c,m),this._changes=[]}_updateMapTransform(r,c,m){const _=this._map,S=_.transform,z=_.style&&_.style.terrain;if(!(_o(r)||z&&this._drag))return this._fireEvents(c,m,!0);let{panDelta:N,zoomDelta:$,bearingDelta:W,pitchDelta:ce,around:ge,pinchAround:Ce}=r;Ce!==void 0&&(ge=Ce),_._stop(!0),ge=ge||_.transform.centerPoint;const je=S.pointLocation(N?ge.sub(N):ge);W&&(S.bearing+=W),ce&&(S.pitch+=ce),$&&(S.zoom+=$),z?c.drag&&!this._drag?(this._drag={center:S.centerPoint,lngLat:S.pointLocation(ge),point:ge,handlerName:c.drag.handlerName},_.fire(new o.Event("freezeElevation",{freeze:!0}))):this._drag&&m[this._drag.handlerName]?(_.fire(new o.Event("freezeElevation",{freeze:!1})),this._drag=null):c.drag&&this._drag&&(S.center=S.pointLocation(S.centerPoint.sub(N))):S.setLocationAtPoint(je,ge),this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(c,m,!0)}_fireEvents(r,c,m){const _=ol(this._eventsInProgress),S=ol(r),z={};for(const ce in r){const{originalEvent:ge}=r[ce];this._eventsInProgress[ce]||(z[`${ce}start`]=ge),this._eventsInProgress[ce]=r[ce]}!_&&S&&this._fireEvent("movestart",S.originalEvent);for(const ce in z)this._fireEvent(ce,z[ce]);S&&this._fireEvent("move",S.originalEvent);for(const ce in r){const{originalEvent:ge}=r[ce];this._fireEvent(ce,ge)}const N={};let $;for(const ce in this._eventsInProgress){const{handlerName:ge,originalEvent:Ce}=this._eventsInProgress[ce];this._handlersById[ge].isActive()||(delete this._eventsInProgress[ce],$=c[ge]||Ce,N[`${ce}end`]=$)}for(const ce in N)this._fireEvent(ce,N[ce]);const W=ol(this._eventsInProgress);if(m&&(_||S)&&!W){this._updatingCamera=!0;const ce=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ge=Ce=>Ce!==0&&-this._bearingSnap<Ce&&Ce<this._bearingSnap;ce?(ge(ce.bearing||this._map.getBearing())&&(ce.bearing=0),this._map.easeTo(ce,{originalEvent:$})):(this._map.fire(new o.Event("moveend",{originalEvent:$})),ge(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(r,c){this._map.fire(new o.Event(r,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{delete this._frameId,this.handleEvent(new ba("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const da={extend:(y,...r)=>o.extend(y,...r),run(y){y()},logToElement(y,r=!1,c="log"){const m=window.document.getElementById(c);m&&(r&&(m.innerHTML=""),m.innerHTML+=`<br>${y}`)}};class Hi extends o.Evented{constructor(r,c){super(),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=c.bearingSnap,o.bindAll(["_renderFrameCallback"],this)}getCenter(){return new o.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(r,c){return this.jumpTo({center:r},c)}panBy(r,c,m){return r=o.pointGeometry.convert(r).mult(-1),this.panTo(this.transform.center,o.extend({offset:r},c),m)}panTo(r,c,m){return this.easeTo(o.extend({center:r},c),m)}getZoom(){return this.transform.zoom}setZoom(r,c){return this.jumpTo({zoom:r},c),this}zoomTo(r,c,m){return this.easeTo(o.extend({zoom:r},c),m)}zoomIn(r,c){return this.zoomTo(this.getZoom()+1,r,c),this}zoomOut(r,c){return this.zoomTo(this.getZoom()-1,r,c),this}getBearing(){return this.transform.bearing}setBearing(r,c){return this.jumpTo({bearing:r},c),this}getPadding(){return this.transform.padding}setPadding(r,c){return this.jumpTo({padding:r},c),this}rotateTo(r,c,m){return this.easeTo(o.extend({bearing:r},c),m)}resetNorth(r,c){return this.rotateTo(0,o.extend({duration:1e3},r),c),this}resetNorthPitch(r,c){return this.easeTo(o.extend({bearing:0,pitch:0,duration:1e3},r),c),this}snapToNorth(r,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,c):this}getPitch(){return this.transform.pitch}setPitch(r,c){return this.jumpTo({pitch:r},c),this}cameraForBounds(r,c){r=o.LngLatBounds.convert(r);const m=c&&c.bearing||0;return this._cameraForBoxAndBearing(r.getNorthWest(),r.getSouthEast(),m,c)}_cameraForBoxAndBearing(r,c,m,_){const S={top:0,bottom:0,right:0,left:0};if(typeof(_=o.extend({padding:S,offset:[0,0],maxZoom:this.transform.maxZoom},_)).padding=="number"){const wt=_.padding;_.padding={top:wt,bottom:wt,right:wt,left:wt}}_.padding=o.extend(S,_.padding);const z=this.transform,N=z.padding,$=z.project(o.LngLat.convert(r)),W=z.project(o.LngLat.convert(c)),ce=$.rotate(-m*Math.PI/180),ge=W.rotate(-m*Math.PI/180),Ce=new o.pointGeometry(Math.max(ce.x,ge.x),Math.max(ce.y,ge.y)),je=new o.pointGeometry(Math.min(ce.x,ge.x),Math.min(ce.y,ge.y)),De=Ce.sub(je),Ke=(z.width-(N.left+N.right+_.padding.left+_.padding.right))/De.x,lt=(z.height-(N.top+N.bottom+_.padding.top+_.padding.bottom))/De.y;if(lt<0||Ke<0)return void o.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const ht=Math.min(z.scaleZoom(z.scale*Math.min(Ke,lt)),_.maxZoom),vt=o.pointGeometry.convert(_.offset),$e=new o.pointGeometry((_.padding.left-_.padding.right)/2,(_.padding.top-_.padding.bottom)/2).rotate(m*Math.PI/180),Ct=vt.add($e).mult(z.scale/z.zoomScale(ht));return{center:z.unproject($.add(W).div(2).sub(Ct)),zoom:ht,bearing:m}}fitBounds(r,c,m){return this._fitInternal(this.cameraForBounds(r,c),c,m)}fitScreenCoordinates(r,c,m,_,S){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(o.pointGeometry.convert(r)),this.transform.pointLocation(o.pointGeometry.convert(c)),m,_),_,S)}_fitInternal(r,c,m){return r?(delete(c=o.extend(r,c)).padding,c.linear?this.easeTo(c,m):this.flyTo(c,m)):this}jumpTo(r,c){this.stop();const m=this.transform;let _=!1,S=!1,z=!1;return"zoom"in r&&m.zoom!==+r.zoom&&(_=!0,m.zoom=+r.zoom),r.center!==void 0&&(m.center=o.LngLat.convert(r.center)),"bearing"in r&&m.bearing!==+r.bearing&&(S=!0,m.bearing=+r.bearing),"pitch"in r&&m.pitch!==+r.pitch&&(z=!0,m.pitch=+r.pitch),r.padding==null||m.isPaddingEqual(r.padding)||(m.padding=r.padding),this.fire(new o.Event("movestart",c)).fire(new o.Event("move",c)),_&&this.fire(new o.Event("zoomstart",c)).fire(new o.Event("zoom",c)).fire(new o.Event("zoomend",c)),S&&this.fire(new o.Event("rotatestart",c)).fire(new o.Event("rotate",c)).fire(new o.Event("rotateend",c)),z&&this.fire(new o.Event("pitchstart",c)).fire(new o.Event("pitch",c)).fire(new o.Event("pitchend",c)),this.fire(new o.Event("moveend",c))}calculateCameraOptionsFromTo(r,c,m,_=0){const S=o.MercatorCoordinate.fromLngLat(r,c),z=o.MercatorCoordinate.fromLngLat(m,_),N=z.x-S.x,$=z.y-S.y,W=z.z-S.z,ce=Math.hypot(N,$,W);if(ce===0)throw new Error("Can't calculate camera options with same From and To");const ge=Math.hypot(N,$),Ce=this.transform.scaleZoom(this.transform.cameraToCenterDistance/ce/this.transform.tileSize),je=180*Math.atan2(N,-$)/Math.PI;let De=180*Math.acos(ge/ce)/Math.PI;return De=W<0?90-De:90+De,{center:z.toLngLat(),zoom:Ce,pitch:De,bearing:je}}easeTo(r,c){this._stop(!1,r.easeId),((r=o.extend({offset:[0,0],duration:500,easing:o.ease},r)).animate===!1||!r.essential&&o.exported.prefersReducedMotion)&&(r.duration=0);const m=this.transform,_=this.getZoom(),S=this.getBearing(),z=this.getPitch(),N=this.getPadding(),$="zoom"in r?+r.zoom:_,W="bearing"in r?this._normalizeBearing(r.bearing,S):S,ce="pitch"in r?+r.pitch:z,ge="padding"in r?r.padding:m.padding,Ce=o.pointGeometry.convert(r.offset);let je=m.centerPoint.add(Ce);const De=m.pointLocation(je),Ke=o.LngLat.convert(r.center||De);this._normalizeCenter(Ke);const lt=m.project(De),ht=m.project(Ke).sub(lt),vt=m.zoomScale($-_);let $e,Ct;r.around&&($e=o.LngLat.convert(r.around),Ct=m.locationPoint($e));const wt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||$!==_,this._rotating=this._rotating||S!==W,this._pitching=this._pitching||ce!==z,this._padding=!m.isPaddingEqual(ge),this._easeId=r.easeId,this._prepareEase(c,r.noMoveStart,wt),this._ease(Mt=>{if(this._zooming&&(m.zoom=o.number(_,$,Mt)),this._rotating&&(m.bearing=o.number(S,W,Mt)),this._pitching&&(m.pitch=o.number(z,ce,Mt)),this._padding&&(m.interpolatePadding(N,ge,Mt),je=m.centerPoint.add(Ce)),$e)m.setLocationAtPoint($e,Ct);else{const Ft=m.zoomScale(m.zoom-_),jt=$>_?Math.min(2,vt):Math.max(.5,vt),St=Math.pow(jt,1-Mt),mr=m.unproject(lt.add(ht.mult(Mt*St)).mult(Ft));m.setLocationAtPoint(m.renderWorldCopies?mr.wrap():mr,je)}this._fireMoveEvents(c)},Mt=>{this._afterEase(c,Mt)},r),this}_prepareEase(r,c,m={}){this._moving=!0,this.fire(new o.Event("freezeElevation",{freeze:!0})),c||m.moving||this.fire(new o.Event("movestart",r)),this._zooming&&!m.zooming&&this.fire(new o.Event("zoomstart",r)),this._rotating&&!m.rotating&&this.fire(new o.Event("rotatestart",r)),this._pitching&&!m.pitching&&this.fire(new o.Event("pitchstart",r))}_fireMoveEvents(r){this.fire(new o.Event("move",r)),this._zooming&&this.fire(new o.Event("zoom",r)),this._rotating&&this.fire(new o.Event("rotate",r)),this._pitching&&this.fire(new o.Event("pitch",r))}_afterEase(r,c){if(this._easeId&&c&&this._easeId===c)return;delete this._easeId,this.fire(new o.Event("freezeElevation",{freeze:!1}));const m=this._zooming,_=this._rotating,S=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,m&&this.fire(new o.Event("zoomend",r)),_&&this.fire(new o.Event("rotateend",r)),S&&this.fire(new o.Event("pitchend",r)),this.fire(new o.Event("moveend",r))}flyTo(r,c){if(!r.essential&&o.exported.prefersReducedMotion){const d=o.pick(r,["center","zoom","bearing","pitch","around"]);return this.jumpTo(d,c)}this.stop(),r=o.extend({offset:[0,0],speed:1.2,curve:1.42,easing:o.ease},r);const m=this.transform,_=this.getZoom(),S=this.getBearing(),z=this.getPitch(),N=this.getPadding(),$="zoom"in r?o.clamp(+r.zoom,m.minZoom,m.maxZoom):_,W="bearing"in r?this._normalizeBearing(r.bearing,S):S,ce="pitch"in r?+r.pitch:z,ge="padding"in r?r.padding:m.padding,Ce=m.zoomScale($-_),je=o.pointGeometry.convert(r.offset);let De=m.centerPoint.add(je);const Ke=m.pointLocation(De),lt=o.LngLat.convert(r.center||Ke);this._normalizeCenter(lt);const ht=m.project(Ke),vt=m.project(lt).sub(ht);let $e=r.curve;const Ct=Math.max(m.width,m.height),wt=Ct/Ce,Mt=vt.mag();if("minZoom"in r){const d=o.clamp(Math.min(r.minZoom,_,$),m.minZoom,m.maxZoom),b=Ct/m.zoomScale(d-_);$e=Math.sqrt(b/Mt*2)}const Ft=$e*$e;function jt(d){const b=(wt*wt-Ct*Ct+(d?-1:1)*Ft*Ft*Mt*Mt)/(2*(d?wt:Ct)*Ft*Mt);return Math.log(Math.sqrt(b*b+1)-b)}function St(d){return(Math.exp(d)-Math.exp(-d))/2}function mr(d){return(Math.exp(d)+Math.exp(-d))/2}const sr=jt(0);let l=function(d){return mr(sr)/mr(sr+$e*d)},u=function(d){return Ct*((mr(sr)*(St(b=sr+$e*d)/mr(b))-St(sr))/Ft)/Mt;var b},A=(jt(1)-sr)/$e;if(Math.abs(Mt)<1e-6||!isFinite(A)){if(Math.abs(Ct-wt)<1e-6)return this.easeTo(r,c);const d=wt<Ct?-1:1;A=Math.abs(Math.log(wt/Ct))/$e,u=function(){return 0},l=function(b){return Math.exp(d*$e*b)}}return r.duration="duration"in r?+r.duration:1e3*A/("screenSpeed"in r?+r.screenSpeed/$e:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0),this._zooming=!0,this._rotating=S!==W,this._pitching=ce!==z,this._padding=!m.isPaddingEqual(ge),this._prepareEase(c,!1),this._ease(d=>{const b=d*A,M=1/l(b);m.zoom=d===1?$:_+m.scaleZoom(M),this._rotating&&(m.bearing=o.number(S,W,d)),this._pitching&&(m.pitch=o.number(z,ce,d)),this._padding&&(m.interpolatePadding(N,ge,d),De=m.centerPoint.add(je));const Q=d===1?lt:m.unproject(ht.add(vt.mult(u(b))).mult(M));m.setLocationAtPoint(m.renderWorldCopies?Q.wrap():Q,De),this._fireMoveEvents(c)},()=>this._afterEase(c),r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(r,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const m=this._onEaseEnd;delete this._onEaseEnd,m.call(this,c)}if(!r){const m=this.handlers;m&&m.stop(!1)}return this}_ease(r,c,m){m.animate===!1||m.duration===0?(r(1),c()):(this._easeStart=o.exported.now(),this._easeOptions=m,this._onEaseFrame=r,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const r=Math.min((o.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(r)),r<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(r,c){r=o.wrap(r,-180,180);const m=Math.abs(r-c);return Math.abs(r-360-c)<m&&(r-=360),Math.abs(r+360-c)<m&&(r+=360),r}_normalizeCenter(r){const c=this.transform;if(!c.renderWorldCopies||c.lngRange)return;const m=r.lng-c.center.lng;r.lng+=m>180?-360:m<-180?360:0}}class Oa{constructor(r={}){this.options=r,o.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(r){return this._map=r,this._compact=this.options&&this.options.compact,this._container=ie.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=ie.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ie.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){ie.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(r,c){const m=this._map._getUIString(`AttributionControl.${c}`);r.title=m,r.setAttribute("aria-label",m)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(r){!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"&&r.type!=="terrain"||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let r=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=r.concat(this.options.customAttribution.map(_=>typeof _!="string"?"":_)):typeof this.options.customAttribution=="string"&&r.push(this.options.customAttribution)),this._map.style.stylesheet){const _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}const c=this._map.style.sourceCaches;for(const _ in c){const S=c[_];if(S.used||S.usedForTerrain){const z=S.getSource();z.attribution&&r.indexOf(z.attribution)<0&&r.push(z.attribution)}}r=r.filter(_=>String(_).trim()),r.sort((_,S)=>_.length-S.length),r=r.filter((_,S)=>{for(let z=S+1;z<r.length;z++)if(r[z].indexOf(_)>=0)return!1;return!0});const m=r.join(" | ");m!==this._attribHTML&&(this._attribHTML=m,r.length?(this._innerContainer.innerHTML=m,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class al{constructor(r={}){this.options=r,o.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(r){this._map=r,this._compact=this.options&&this.options.compact,this._container=ie.create("div","maplibregl-ctrl mapboxgl-ctrl");const c=ie.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://maplibre.org/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){ie.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const r=this._container.children;if(r.length){const c=r[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&c.classList.add("maplibregl-compact","mapboxgl-compact"):c.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class Kl{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const c=++this._id;return this._queue.push({callback:r,id:c,cancelled:!1}),c}remove(r){const c=this._currentlyRunning,m=c?this._queue.concat(c):this._queue;for(const _ of m)if(_.id===r)return void(_.cancelled=!0)}run(r=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const c=this._currentlyRunning=this._queue;this._queue=[];for(const m of c)if(!m.cancelled&&(m.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const CA={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"},EA={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},is={showCompass:!0,showZoom:!0,visualizePitch:!1};class Xn{constructor(r,c,m=!1){this._clickTolerance=10,this.element=c,this.mouseRotate=new va({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,m&&(this.mousePitch=new xr({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),o.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),ie.addEventListener(c,"mousedown",this.mousedown),ie.addEventListener(c,"touchstart",this.touchstart,{passive:!1}),ie.addEventListener(c,"touchmove",this.touchmove),ie.addEventListener(c,"touchend",this.touchend),ie.addEventListener(c,"touchcancel",this.reset)}down(r,c){this.mouseRotate.mousedown(r,c),this.mousePitch&&this.mousePitch.mousedown(r,c),ie.disableDrag()}move(r,c){const m=this.map,_=this.mouseRotate.mousemoveWindow(r,c);if(_&&_.bearingDelta&&m.setBearing(m.getBearing()+_.bearingDelta),this.mousePitch){const S=this.mousePitch.mousemoveWindow(r,c);S&&S.pitchDelta&&m.setPitch(m.getPitch()+S.pitchDelta)}}off(){const r=this.element;ie.removeEventListener(r,"mousedown",this.mousedown),ie.removeEventListener(r,"touchstart",this.touchstart,{passive:!1}),ie.removeEventListener(r,"touchmove",this.touchmove),ie.removeEventListener(r,"touchend",this.touchend),ie.removeEventListener(r,"touchcancel",this.reset),this.offTemp()}offTemp(){ie.enableDrag(),ie.removeEventListener(window,"mousemove",this.mousemove),ie.removeEventListener(window,"mouseup",this.mouseup)}mousedown(r){this.down(o.extend({},r,{ctrlKey:!0,preventDefault:()=>r.preventDefault()}),ie.mousePos(this.element,r)),ie.addEventListener(window,"mousemove",this.mousemove),ie.addEventListener(window,"mouseup",this.mouseup)}mousemove(r){this.move(r,ie.mousePos(this.element,r))}mouseup(r){this.mouseRotate.mouseupWindow(r),this.mousePitch&&this.mousePitch.mouseupWindow(r),this.offTemp()}touchstart(r){r.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ie.touchPos(this.element,r.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>r.preventDefault()},this._startPos))}touchmove(r){r.targetTouches.length!==1?this.reset():(this._lastPos=ie.touchPos(this.element,r.targetTouches)[0],this.move({preventDefault:()=>r.preventDefault()},this._lastPos))}touchend(r){r.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function pi(y,r,c){if(y=new o.LngLat(y.lng,y.lat),r){const m=new o.LngLat(y.lng-360,y.lat),_=new o.LngLat(y.lng+360,y.lat),S=c.locationPoint(y).distSqr(r);c.locationPoint(m).distSqr(r)<S?y=m:c.locationPoint(_).distSqr(r)<S&&(y=_)}for(;Math.abs(y.lng-c.center.lng)>180;){const m=c.locationPoint(y);if(m.x>=0&&m.y>=0&&m.x<=c.width&&m.y<=c.height)break;y.lng>c.center.lng?y.lng-=360:y.lng+=360}return y}const Cr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Pr(y,r,c){const m=y.classList;for(const _ in Cr)m.remove(`maplibregl-${c}-anchor-${_}`,`mapboxgl-${c}-anchor-${_}`);m.add(`maplibregl-${c}-anchor-${r}`,`mapboxgl-${c}-anchor-${r}`)}class no extends o.Evented{constructor(r,c){if(super(),(r instanceof HTMLElement||c)&&(r=o.extend({element:r},c)),o.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment!=="auto"?r.pitchAlignment:this._rotationAlignment,r&&r.element)this._element=r.element,this._offset=o.pointGeometry.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=ie.create("div"),this._element.setAttribute("aria-label","Map marker");const m=ie.createNS("http://www.w3.org/2000/svg","svg"),_=41,S=27;m.setAttributeNS(null,"display","block"),m.setAttributeNS(null,"height",`${_}px`),m.setAttributeNS(null,"width",`${S}px`),m.setAttributeNS(null,"viewBox",`0 0 ${S} ${_}`);const z=ie.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"stroke","none"),z.setAttributeNS(null,"stroke-width","1"),z.setAttributeNS(null,"fill","none"),z.setAttributeNS(null,"fill-rule","evenodd");const N=ie.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"fill-rule","nonzero");const $=ie.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"transform","translate(3.0, 29.0)"),$.setAttributeNS(null,"fill","#000000");const W=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const vt of W){const $e=ie.createNS("http://www.w3.org/2000/svg","ellipse");$e.setAttributeNS(null,"opacity","0.04"),$e.setAttributeNS(null,"cx","10.5"),$e.setAttributeNS(null,"cy","5.80029008"),$e.setAttributeNS(null,"rx",vt.rx),$e.setAttributeNS(null,"ry",vt.ry),$.appendChild($e)}const ce=ie.createNS("http://www.w3.org/2000/svg","g");ce.setAttributeNS(null,"fill",this._color);const ge=ie.createNS("http://www.w3.org/2000/svg","path");ge.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),ce.appendChild(ge);const Ce=ie.createNS("http://www.w3.org/2000/svg","g");Ce.setAttributeNS(null,"opacity","0.25"),Ce.setAttributeNS(null,"fill","#000000");const je=ie.createNS("http://www.w3.org/2000/svg","path");je.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Ce.appendChild(je);const De=ie.createNS("http://www.w3.org/2000/svg","g");De.setAttributeNS(null,"transform","translate(6.0, 7.0)"),De.setAttributeNS(null,"fill","#FFFFFF");const Ke=ie.createNS("http://www.w3.org/2000/svg","g");Ke.setAttributeNS(null,"transform","translate(8.0, 8.0)");const lt=ie.createNS("http://www.w3.org/2000/svg","circle");lt.setAttributeNS(null,"fill","#000000"),lt.setAttributeNS(null,"opacity","0.25"),lt.setAttributeNS(null,"cx","5.5"),lt.setAttributeNS(null,"cy","5.5"),lt.setAttributeNS(null,"r","5.4999962");const ht=ie.createNS("http://www.w3.org/2000/svg","circle");ht.setAttributeNS(null,"fill","#FFFFFF"),ht.setAttributeNS(null,"cx","5.5"),ht.setAttributeNS(null,"cy","5.5"),ht.setAttributeNS(null,"r","5.4999962"),Ke.appendChild(lt),Ke.appendChild(ht),N.appendChild($),N.appendChild(ce),N.appendChild(Ce),N.appendChild(De),N.appendChild(Ke),m.appendChild(N),m.setAttributeNS(null,"height",_*this._scale+"px"),m.setAttributeNS(null,"width",S*this._scale+"px"),this._element.appendChild(m),this._offset=o.pointGeometry.convert(r&&r.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",m=>{m.preventDefault()}),this._element.addEventListener("mousedown",m=>{m.preventDefault()}),Pr(this._element,this._anchor,"marker"),this._popup=null}addTo(r){return this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._update),r.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),ie.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=o.LngLat.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const _=Math.sqrt(Math.pow(13.5,2)/2);r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(38.1-13.5+_)],"bottom-right":[-_,-1*(38.1-13.5+_)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(r){const c=r.code,m=r.charCode||r.keyCode;c!=="Space"&&c!=="Enter"&&m!==32&&m!==13||this.togglePopup()}_onMapClick(r){const c=r.originalEvent.target,m=this._element;this._popup&&(c===m||m.contains(c))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?r.remove():r.addTo(this._map),this):this}_update(r){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=pi(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let c="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?c=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(c=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let m="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?m="rotateX(0deg)":this._pitchAlignment==="map"&&(m=`rotateX(${this._map.getPitch()}deg)`),r&&r.type!=="moveend"||(this._pos=this._pos.round()),ie.setTransform(this._element,`${Cr[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${m} ${c}`),this._map.style&&this._map.style.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const _=this._map.unproject(this._pos),S=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=_.distanceTo(this._lngLat)>20*S?"0.2":"1.0",this._opacityTimeout=null},100))}getOffset(){return this._offset}setOffset(r){return this._offset=o.pointGeometry.convert(r),this._update(),this}_onMove(r){if(!this._isDragging){const c=this._clickTolerance||this._map._clickTolerance;this._isDragging=r.point.dist(this._pointerdownPos)>=c}this._isDragging&&(this._pos=r.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.Event("dragstart"))),this.fire(new o.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.Event("dragend")),this._state="inactive"}_addDragHandler(r){this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(this._pos).add(this._offset),this._pointerdownPos=r.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(r){return this._draggable=!!r,this._map&&(r?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r&&r!=="auto"?r:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const Hs={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let fa,On=0,oo=!1;const Ba={maxWidth:100,unit:"metric"};function kr(y,r,c){const m=c&&c.maxWidth||100,_=y._container.clientHeight/2,S=y.unproject([0,_]),z=y.unproject([m,_]),N=S.distanceTo(z);if(c&&c.unit==="imperial"){const $=3.2808*N;$>5280?cr(r,m,$/5280,y._getUIString("ScaleControl.Miles")):cr(r,m,$,y._getUIString("ScaleControl.Feet"))}else c&&c.unit==="nautical"?cr(r,m,N/1852,y._getUIString("ScaleControl.NauticalMiles")):N>=1e3?cr(r,m,N/1e3,y._getUIString("ScaleControl.Kilometers")):cr(r,m,N,y._getUIString("ScaleControl.Meters"))}function cr(y,r,c,m){const _=function(S){const z=Math.pow(10,`${Math.floor(S)}`.length-1);let N=S/z;return N=N>=10?10:N>=5?5:N>=3?3:N>=2?2:N>=1?1:function($){const W=Math.pow(10,Math.ceil(-Math.log($)/Math.LN10));return Math.round($*W)/W}(N),z*N}(c);y.style.width=r*(_/c)+"px",y.innerHTML=`${_}&nbsp;${m}`}const Wn={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},qi=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ca(y){if(y){if(typeof y=="number"){const r=Math.round(Math.sqrt(.5*Math.pow(y,2)));return{center:new o.pointGeometry(0,0),top:new o.pointGeometry(0,y),"top-left":new o.pointGeometry(r,r),"top-right":new o.pointGeometry(-r,r),bottom:new o.pointGeometry(0,-y),"bottom-left":new o.pointGeometry(r,-r),"bottom-right":new o.pointGeometry(-r,-r),left:new o.pointGeometry(y,0),right:new o.pointGeometry(-y,0)}}if(y instanceof o.pointGeometry||Array.isArray(y)){const r=o.pointGeometry.convert(y);return{center:r,top:r,"top-left":r,"top-right":r,bottom:r,"bottom-left":r,"bottom-right":r,left:r,right:r}}return{center:o.pointGeometry.convert(y.center||[0,0]),top:o.pointGeometry.convert(y.top||[0,0]),"top-left":o.pointGeometry.convert(y["top-left"]||[0,0]),"top-right":o.pointGeometry.convert(y["top-right"]||[0,0]),bottom:o.pointGeometry.convert(y.bottom||[0,0]),"bottom-left":o.pointGeometry.convert(y["bottom-left"]||[0,0]),"bottom-right":o.pointGeometry.convert(y["bottom-right"]||[0,0]),left:o.pointGeometry.convert(y.left||[0,0]),right:o.pointGeometry.convert(y.right||[0,0])}}return Ca(new o.pointGeometry(0,0))}const eo={supported:q,setRTLTextPlugin:o.setRTLTextPlugin,getRTLTextPluginStatus:o.getRTLTextPluginStatus,Map:class extends Hi{constructor(y){var r;if(o.PerformanceUtils.mark(o.PerformanceMarkers.create),(y=o.extend({},EA,y)).minZoom!=null&&y.maxZoom!=null&&y.minZoom>y.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(y.minPitch!=null&&y.maxPitch!=null&&y.minPitch>y.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(y.minPitch!=null&&y.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(y.maxPitch!=null&&y.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new vs(y.minZoom,y.maxZoom,y.minPitch,y.maxPitch,y.renderWorldCopies),{bearingSnap:y.bearingSnap}),this._interactive=y.interactive,this._cooperativeGestures=y.cooperativeGestures,this._maxTileCacheSize=y.maxTileCacheSize,this._failIfMajorPerformanceCaveat=y.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=y.preserveDrawingBuffer,this._antialias=y.antialias,this._trackResize=y.trackResize,this._bearingSnap=y.bearingSnap,this._refreshExpiredTiles=y.refreshExpiredTiles,this._fadeDuration=y.fadeDuration,this._crossSourceCollisions=y.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=y.collectResourceTiming,this._renderTaskQueue=new Kl,this._controls=[],this._mapId=o.uniqueId(),this._locale=o.extend({},CA,y.locale),this._clickTolerance=y.clickTolerance,this._pixelRatio=(r=y.pixelRatio)!==null&&r!==void 0?r:devicePixelRatio,this._requestManager=new be(y.transformRequest),typeof y.container=="string"){if(this._container=document.getElementById(y.container),!this._container)throw new Error(`Container '${y.container}' not found.`)}else{if(!(y.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=y.container}if(y.maxBounds&&this.setMaxBounds(y.maxBounds),o.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),typeof window<"u"&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new lA(this,y),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=y.hash&&new ml(typeof y.hash=="string"&&y.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:y.center,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch}),y.bounds&&(this.resize(),this.fitBounds(y.bounds,o.extend({},y.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=y.localIdeographFontFamily,y.style&&this.setStyle(y.style,{localIdeographFontFamily:y.localIdeographFontFamily}),y.attributionControl&&this.addControl(new Oa({customAttribution:y.customAttribution})),y.maplibreLogo&&this.addControl(new al,y.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",c=>{this._update(c.dataType==="style"),this.fire(new o.Event(`${c.dataType}data`,c))}),this.on("dataloading",c=>{this.fire(new o.Event(`${c.dataType}dataloading`,c))}),this.on("dataabort",c=>{this.fire(new o.Event("sourcedataabort",c))})}_getMapId(){return this._mapId}addControl(y,r){if(r===void 0&&(r=y.getDefaultPosition?y.getDefaultPosition():"top-right"),!y||!y.onAdd)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const c=y.onAdd(this);this._controls.push(y);const m=this._controlPositions[r];return r.indexOf("bottom")!==-1?m.insertBefore(c,m.firstChild):m.appendChild(c),this}removeControl(y){if(!y||!y.onRemove)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(y);return r>-1&&this._controls.splice(r,1),y.onRemove(this),this}hasControl(y){return this._controls.indexOf(y)>-1}calculateCameraOptionsFromTo(y,r,c,m){return m==null&&this.style.terrain&&(m=this.transform.getElevation(c,this.style.terrain)),super.calculateCameraOptionsFromTo(y,r,c,m)}resize(y){const r=this._containerDimensions(),c=r[0],m=r[1];this._resizeCanvas(c,m,this.getPixelRatio()),this.transform.resize(c,m),this.painter.resize(c,m,this.getPixelRatio());const _=!this._moving;return _&&(this.stop(),this.fire(new o.Event("movestart",y)).fire(new o.Event("move",y))),this.fire(new o.Event("resize",y)),_&&this.fire(new o.Event("moveend",y)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(y){const[r,c]=this._containerDimensions();this._pixelRatio=y,this._resizeCanvas(r,c,y),this.painter.resize(r,c,y)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(y){return this.transform.setMaxBounds(o.LngLatBounds.convert(y)),this._update()}setMinZoom(y){if((y=y==null?-2:y)>=-2&&y<=this.transform.maxZoom)return this.transform.minZoom=y,this._update(),this.getZoom()<y&&this.setZoom(y),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(y){if((y=y==null?22:y)>=this.transform.minZoom)return this.transform.maxZoom=y,this._update(),this.getZoom()>y&&this.setZoom(y),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(y){if((y=y==null?0:y)<0)throw new Error("minPitch must be greater than or equal to 0");if(y>=0&&y<=this.transform.maxPitch)return this.transform.minPitch=y,this._update(),this.getPitch()<y&&this.setPitch(y),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(y){if((y=y==null?60:y)>85)throw new Error("maxPitch must be less than or equal to 85");if(y>=this.transform.minPitch)return this.transform.maxPitch=y,this._update(),this.getPitch()>y&&this.setPitch(y),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(y){return this.transform.renderWorldCopies=y,this._update()}project(y){return this.transform.locationPoint(o.LngLat.convert(y),this.style&&this.style.terrain)}unproject(y){return this.transform.pointLocation(o.pointGeometry.convert(y),this.style&&this.style.terrain)}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(y,r,c){if(y==="mouseenter"||y==="mouseover"){let m=!1;return{layer:r,listener:c,delegates:{mousemove:S=>{const z=this.getLayer(r)?this.queryRenderedFeatures(S.point,{layers:[r]}):[];z.length?m||(m=!0,c.call(this,new pa(y,this,S.originalEvent,{features:z}))):m=!1},mouseout:()=>{m=!1}}}}if(y==="mouseleave"||y==="mouseout"){let m=!1;return{layer:r,listener:c,delegates:{mousemove:z=>{(this.getLayer(r)?this.queryRenderedFeatures(z.point,{layers:[r]}):[]).length?m=!0:m&&(m=!1,c.call(this,new pa(y,this,z.originalEvent)))},mouseout:z=>{m&&(m=!1,c.call(this,new pa(y,this,z.originalEvent)))}}}}{const m=_=>{const S=this.getLayer(r)?this.queryRenderedFeatures(_.point,{layers:[r]}):[];S.length&&(_.features=S,c.call(this,_),delete _.features)};return{layer:r,listener:c,delegates:{[y]:m}}}}on(y,r,c){if(c===void 0)return super.on(y,r);const m=this._createDelegatedListener(y,r,c);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[y]=this._delegatedListeners[y]||[],this._delegatedListeners[y].push(m);for(const _ in m.delegates)this.on(_,m.delegates[_]);return this}once(y,r,c){if(c===void 0)return super.once(y,r);const m=this._createDelegatedListener(y,r,c);for(const _ in m.delegates)this.once(_,m.delegates[_]);return this}off(y,r,c){return c===void 0?super.off(y,r):(this._delegatedListeners&&this._delegatedListeners[y]&&(m=>{const _=this._delegatedListeners[y];for(let S=0;S<_.length;S++){const z=_[S];if(z.layer===r&&z.listener===c){for(const N in z.delegates)this.off(N,z.delegates[N]);return _.splice(S,1),this}}})(),this)}queryRenderedFeatures(y,r){if(!this.style)return[];let c;if(r!==void 0||y===void 0||y instanceof o.pointGeometry||Array.isArray(y)||(r=y,y=void 0),r=r||{},(y=y||[[0,0],[this.transform.width,this.transform.height]])instanceof o.pointGeometry||typeof y[0]=="number")c=[o.pointGeometry.convert(y)];else{const m=o.pointGeometry.convert(y[0]),_=o.pointGeometry.convert(y[1]);c=[m,new o.pointGeometry(_.x,m.y),_,new o.pointGeometry(m.x,_.y),m]}return this.style.queryRenderedFeatures(c,r,this.transform)}querySourceFeatures(y,r){return this.style.querySourceFeatures(y,r)}setStyle(y,r){return(r=o.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},r)).diff!==!1&&r.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&y?(this._diffStyle(y,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._updateStyle(y,r))}setTransformRequest(y){return this._requestManager.setTransformRequest(y),this}_getUIString(y){const r=this._locale[y];if(r==null)throw new Error(`Missing UI string '${y}'`);return r}_updateStyle(y,r){return this.style&&(this.style.setEventedParent(null),this.style._remove()),y?(this.style=new li(this,r||{}),this.style.setEventedParent(this,{style:this.style}),typeof y=="string"?this.style.loadURL(y):this.style.loadJSON(y),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new li(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(y,r){if(typeof y=="string"){const c=this._requestManager.transformRequest(y,o.ResourceType.Style);o.getJSON(c,(m,_)=>{m?this.fire(new o.ErrorEvent(m)):_&&this._updateDiff(_,r)})}else typeof y=="object"&&this._updateDiff(y,r)}_updateDiff(y,r){try{this.style.setState(y)&&this._update(!0)}catch(c){o.warnOnce(`Unable to perform style diff: ${c.message||c.error||c}.  Rebuilding the style from scratch.`),this._updateStyle(y,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():o.warnOnce("There is no style added to the map.")}addSource(y,r){return this._lazyInitEmptyStyle(),this.style.addSource(y,r),this._update(!0)}isSourceLoaded(y){const r=this.style&&this.style.sourceCaches[y];if(r!==void 0)return r.loaded();this.fire(new o.ErrorEvent(new Error(`There is no source with ID '${y}'`)))}setTerrain(y){return this.style.setTerrain(y),this}getTerrain(){return this.style.terrain&&this.style.terrain.options}areTilesLoaded(){const y=this.style&&this.style.sourceCaches;for(const r in y){const c=y[r]._tiles;for(const m in c){const _=c[m];if(_.state!=="loaded"&&_.state!=="errored")return!1}}return!0}addSourceType(y,r,c){return this._lazyInitEmptyStyle(),this.style.addSourceType(y,r,c)}removeSource(y){return this.style.removeSource(y),this._update(!0)}getSource(y){return this.style.getSource(y)}addImage(y,r,{pixelRatio:c=1,sdf:m=!1,stretchX:_,stretchY:S,content:z}={}){if(this._lazyInitEmptyStyle(),r instanceof HTMLImageElement||o.isImageBitmap(r)){const{width:N,height:$,data:W}=o.exported.getImageData(r);this.style.addImage(y,{data:new o.RGBAImage({width:N,height:$},W),pixelRatio:c,stretchX:_,stretchY:S,content:z,sdf:m,version:0})}else{if(r.width===void 0||r.height===void 0)return this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:N,height:$,data:W}=r,ce=r;this.style.addImage(y,{data:new o.RGBAImage({width:N,height:$},new Uint8Array(W)),pixelRatio:c,stretchX:_,stretchY:S,content:z,sdf:m,version:0,userImage:ce}),ce.onAdd&&ce.onAdd(this,y)}}}updateImage(y,r){const c=this.style.getImage(y);if(!c)return this.fire(new o.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const m=r instanceof HTMLImageElement||o.isImageBitmap(r)?o.exported.getImageData(r):r,{width:_,height:S,data:z}=m;if(_===void 0||S===void 0)return this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(_!==c.data.width||S!==c.data.height)return this.fire(new o.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const N=!(r instanceof HTMLImageElement||o.isImageBitmap(r));c.data.replace(z,N),this.style.updateImage(y,c)}hasImage(y){return y?!!this.style.getImage(y):(this.fire(new o.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(y){this.style.removeImage(y)}loadImage(y,r){o.getImage(this._requestManager.transformRequest(y,o.ResourceType.Image),r)}listImages(){return this.style.listImages()}addLayer(y,r){return this._lazyInitEmptyStyle(),this.style.addLayer(y,r),this._update(!0)}moveLayer(y,r){return this.style.moveLayer(y,r),this._update(!0)}removeLayer(y){return this.style.removeLayer(y),this._update(!0)}getLayer(y){return this.style.getLayer(y)}setLayerZoomRange(y,r,c){return this.style.setLayerZoomRange(y,r,c),this._update(!0)}setFilter(y,r,c={}){return this.style.setFilter(y,r,c),this._update(!0)}getFilter(y){return this.style.getFilter(y)}setPaintProperty(y,r,c,m={}){return this.style.setPaintProperty(y,r,c,m),this._update(!0)}getPaintProperty(y,r){return this.style.getPaintProperty(y,r)}setLayoutProperty(y,r,c,m={}){return this.style.setLayoutProperty(y,r,c,m),this._update(!0)}getLayoutProperty(y,r){return this.style.getLayoutProperty(y,r)}setLight(y,r={}){return this._lazyInitEmptyStyle(),this.style.setLight(y,r),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(y,r){return this.style.setFeatureState(y,r),this._update()}removeFeatureState(y,r){return this.style.removeFeatureState(y,r),this._update()}getFeatureState(y){return this.style.getFeatureState(y)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let y=0,r=0;return this._container&&(y=this._container.clientWidth||400,r=this._container.clientHeight||300),[y,r]}_setupContainer(){const y=this._container;y.classList.add("maplibregl-map","mapboxgl-map");const r=this._canvasContainer=ie.create("div","maplibregl-canvas-container mapboxgl-canvas-container",y);this._interactive&&r.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=ie.create("canvas","maplibregl-canvas mapboxgl-canvas",r),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const c=this._containerDimensions();this._resizeCanvas(c[0],c[1],this.getPixelRatio());const m=this._controlContainer=ie.create("div","maplibregl-control-container mapboxgl-control-container",y),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(S=>{_[S]=ie.create("div",`maplibregl-ctrl-${S} mapboxgl-ctrl-${S}`,m)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){const y=this._container;this._metaPress=!1,this._cooperativeGesturesScreen=ie.create("div","maplibregl-cooperative-gesture-screen",y);let r="Control",c=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(c=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use \u2318 + scroll to zoom the map",r="Meta"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${c}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,document.addEventListener("keydown",m=>{m.key===r&&(this._metaPress=!0)}),document.addEventListener("keyup",m=>{m.key===r&&(this._metaPress=!1)}),this._canvasContainer.addEventListener("wheel",m=>{this._onCooperativeGesture(m,this._metaPress,1)},!1),this._canvasContainer.classList.remove("mapboxgl-touch-drag-pan","maplibregl-touch-drag-pan")}_resizeCanvas(y,r,c){this._canvas.width=c*y,this._canvas.height=c*r,this._canvas.style.width=`${y}px`,this._canvas.style.height=`${r}px`}_setupPainter(){const y=o.extend({},q.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),r=this._canvas.getContext("webgl",y)||this._canvas.getContext("experimental-webgl",y);r?(this.painter=new ts(r,this.transform),o.exported$1.testSupport(r)):this.fire(new o.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(y){y.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.Event("webglcontextlost",{originalEvent:y}))}_contextRestored(y){this._setupPainter(),this.resize(),this._update(),this.fire(new o.Event("webglcontextrestored",{originalEvent:y}))}_onMapScroll(y){if(y.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(y,r,c){return!r&&c<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(y){return this.style?(this._styleDirty=this._styleDirty||y,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(y){return this._update(),this._renderTaskQueue.add(y)}_cancelRenderFrame(y){this._renderTaskQueue.remove(y)}_render(y){let r,c=0;const m=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(r=m.createQueryEXT(),m.beginQueryEXT(m.TIME_ELAPSED_EXT,r),c=o.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(y),this._removed)return;let _=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const z=this.transform.zoom,N=o.exported.now();this.style.zoomHistory.update(z,N);const $=new o.EvaluationParameters(z,{now:N,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),W=$.crossFadingFactor();W===1&&W===this._crossFadingFactor||(_=!0,this._crossFadingFactor=W),this.style.update($)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.style.terrain&&this.style.terrain.sourceCache.update(this.transform,this.style.terrain),this.transform.updateElevation(this.style.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new o.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.PerformanceUtils.mark(o.PerformanceMarkers.load),this.fire(new o.Event("load"))),this.style&&(this.style.hasTransitions()||_)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const z=o.exported.now()-c;m.endQueryEXT(m.TIME_ELAPSED_EXT,r),setTimeout(()=>{const N=m.getQueryObjectEXT(r,m.QUERY_RESULT_EXT)/1e6;m.deleteQueryEXT(r),this.fire(new o.Event("gpu-timing-frame",{cpuTime:z,gpuTime:N}))},50)}if(this.listens("gpu-timing-layer")){const z=this.painter.collectGpuTimers();setTimeout(()=>{const N=this.painter.queryGpuTimers(z);this.fire(new o.Event("gpu-timing-layer",{layerTimes:N}))},50)}const S=this._sourcesDirty||this._styleDirty||this._placementDirty;return S||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.Event("idle")),!this._loaded||this._fullyLoaded||S||(this._fullyLoaded=!0,o.PerformanceUtils.mark(o.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));const y=this.painter.context.gl.getExtension("WEBGL_lose_context");y&&y.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),ie.remove(this._canvasContainer),ie.remove(this._controlContainer),this._cooperativeGestures&&ie.remove(this._cooperativeGesturesScreen),this._container.classList.remove("maplibregl-map","mapboxgl-map"),o.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new o.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=o.exported.frame(y=>{o.PerformanceUtils.frame(y),this._frame=null,this._render(y)}))}_onWindowOnline(){this._update()}_onWindowResize(y){this._trackResize&&this.resize({originalEvent:y})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(y){this._showTileBoundaries!==y&&(this._showTileBoundaries=y,this._update())}get showPadding(){return!!this._showPadding}set showPadding(y){this._showPadding!==y&&(this._showPadding=y,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(y){this._showCollisionBoxes!==y&&(this._showCollisionBoxes=y,y?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(y){this._showOverdrawInspector!==y&&(this._showOverdrawInspector=y,this._update())}get repaint(){return!!this._repaint}set repaint(y){this._repaint!==y&&(this._repaint=y,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(y){this._vertices=y,this._update()}_setCacheLimits(y,r){o.setCacheLimits(y,r)}get version(){return"2.4.0"}},NavigationControl:class{constructor(y){this.options=o.extend({},is,y),this._container=ie.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(o.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",r=>this._map.zoomIn({},{originalEvent:r})),ie.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",r=>this._map.zoomOut({},{originalEvent:r})),ie.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(o.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",r=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:r}):this._map.resetNorth({},{originalEvent:r})}),this._compassIcon=ie.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const y=this._map.getZoom(),r=y===this._map.getMaxZoom(),c=y===this._map.getMinZoom();this._zoomInButton.disabled=r,this._zoomOutButton.disabled=c,this._zoomInButton.setAttribute("aria-disabled",r.toString()),this._zoomOutButton.setAttribute("aria-disabled",c.toString())}_rotateCompassArrow(){const y=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=y}onAdd(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Xn(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){ie.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(y,r){const c=ie.create("button",y,this._container);return c.type="button",c.addEventListener("click",r),c}_setButtonTitle(y,r){const c=this._map._getUIString(`NavigationControl.${r}`);y.title=c,y.setAttribute("aria-label",c)}},GeolocateControl:class extends o.Evented{constructor(y){super(),this.options=o.extend({},Hs,y),o.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(y){var r;return this._map=y,this._container=ie.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),r=this._setupUI,fa!==void 0?r(fa):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(c=>{fa=c.state!=="denied",r(fa)}):(fa=!!window.navigator.geolocation,r(fa)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),ie.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,On=0,oo=!1}_isOutOfMapMaxBounds(y){const r=this._map.getMaxBounds(),c=y.coords;return r&&(c.longitude<r.getWest()||c.longitude>r.getEast()||c.latitude<r.getSouth()||c.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(y){if(this._map){if(this._isOutOfMapMaxBounds(y))return this._setErrorState(),this.fire(new o.Event("outofmaxbounds",y)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=y,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(y),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(y),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new o.Event("geolocate",y)),this._finish()}}_updateCamera(y){const r=new o.LngLat(y.coords.longitude,y.coords.latitude),c=y.coords.accuracy,m=this._map.getBearing(),_=o.extend({bearing:m},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(c),_,{geolocateSource:!0})}_updateMarker(y){if(y){const r=new o.LngLat(y.coords.longitude,y.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=y.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const y=this._map._container.clientHeight/2,r=this._map.unproject([0,y]),c=this._map.unproject([1,y]),m=r.distanceTo(c),_=Math.ceil(2*this._accuracy/m);this._circleElement.style.width=`${_}px`,this._circleElement.style.height=`${_}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(y){if(this._map){if(this.options.trackUserLocation)if(y.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(y.code===3&&oo)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new o.Event("error",y)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(y){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=ie.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),ie.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",y===!1){o.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ie.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new no(this._dotElement),this._circleElement=ie.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new no({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new o.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return o.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":On--,oo=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let y;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),On++,On>1?(y={maximumAge:6e5,timeout:0},oo=!0):(y=this.options.positionOptions,oo=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,y)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Oa,LogoControl:al,ScaleControl:class{constructor(y){this.options=o.extend({},Ba,y),o.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){kr(this._map,this._container,this.options)}onAdd(y){return this._map=y,this._container=ie.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",y.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){ie.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(y){this.options.unit=y,kr(this._map,this._container,this.options)}},FullscreenControl:class{constructor(y){this._fullscreen=!1,y&&y.container&&(y.container instanceof HTMLElement?this._container=y.container:o.warnOnce("Full screen control 'container' must be a DOM element.")),o.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=ie.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){ie.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){const y=this._fullscreenButton=ie.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);ie.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",y).setAttribute("aria-hidden","true"),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.title=y}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},TerrainControl:class{constructor(y){this.options=y,o.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(y){return this._map=y,this._container=ie.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._terrainButton=ie.create("button","maplibregl-ctrl-terrain mapboxgl-ctrl-terrain",this._container),ie.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){ie.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._map.style.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends o.Evented{constructor(y){super(),this.options=o.extend(Object.create(Wn),y),o.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(y){return this._map&&this.remove(),this._map=y,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new o.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&ie.remove(this._content),this._container&&(ie.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new o.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(y){return this._lngLat=o.LngLat.convert(y),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(y){return this.setDOMContent(document.createTextNode(y))}setHTML(y){const r=document.createDocumentFragment(),c=document.createElement("body");let m;for(c.innerHTML=y;m=c.firstChild,m;)r.appendChild(m);return this.setDOMContent(r)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(y){return this.options.maxWidth=y,this._update(),this}setDOMContent(y){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=ie.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(y),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(y){this._container&&this._container.classList.add(y)}removeClassName(y){this._container&&this._container.classList.remove(y)}setOffset(y){return this.options.offset=y,this._update(),this}toggleClassName(y){if(this._container)return this._container.classList.toggle(y)}_createCloseButton(){this.options.closeButton&&(this._closeButton=ie.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(y){this._update(y.point)}_onMouseMove(y){this._update(y.point)}_onDrag(y){this._update(y.point)}_update(y){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=ie.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=ie.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(S=>this._container.classList.add(S)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=pi(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!y))return;const r=this._pos=this._trackPointer&&y?y:this._map.project(this._lngLat);let c=this.options.anchor;const m=Ca(this.options.offset);if(!c){const S=this._container.offsetWidth,z=this._container.offsetHeight;let N;N=r.y+m.bottom.y<z?["top"]:r.y>this._map.transform.height-z?["bottom"]:[],r.x<S/2?N.push("left"):r.x>this._map.transform.width-S/2&&N.push("right"),c=N.length===0?"bottom":N.join("-")}const _=r.add(m[c]).round();ie.setTransform(this._container,`${Cr[c]} translate(${_.x}px,${_.y}px)`),Pr(this._container,c,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const y=this._container.querySelector(qi);y&&y.focus()}_onClose(){this.remove()}},Marker:no,Style:li,LngLat:o.LngLat,LngLatBounds:o.LngLatBounds,Point:o.pointGeometry,MercatorCoordinate:o.MercatorCoordinate,Evented:o.Evented,AJAXError:o.AJAXError,config:o.config,CanvasSource:ri,GeoJSONSource:br,ImageSource:Kr,RasterDEMTileSource:Rt,RasterTileSource:rr,VectorTileSource:ei,VideoSource:di,prewarm:function(){an().acquire(Ln)},clearPrewarmedResources:function(){const y=Pn;y&&(y.isPreloaded()&&y.numActive()===1?(y.release(Ln),Pn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return"2.4.0"},get workerCount(){return Wi.workerCount},set workerCount(y){Wi.workerCount=y},get maxParallelImageRequests(){return o.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(y){o.config.MAX_PARALLEL_IMAGE_REQUESTS=y},clearStorage(y){o.clearTileCache(y)},workerUrl:"",addProtocol(y,r){o.config.REGISTERED_PROTOCOLS[y]=r},removeProtocol(y){delete o.config.REGISTERED_PROTOCOLS[y]}};return da.extend(eo,{isSafari:o.isSafari,getPerformanceMetrics:o.PerformanceUtils.getPerformanceMetrics}),eo}),P}(),E_=qg({__proto__:null,default:ny},[iy.exports]);const ip=[];function mp(C,E=zo){let P;const V=new Set;function o(q){if(Ua(C,q)&&(C=q,P)){const K=!ip.length;for(const ae of V)ae[1](),ip.push(ae,C);if(K){for(let ae=0;ae<ip.length;ae+=2)ip[ae][0](ip[ae+1]);ip.length=0}}}return{set:o,update:function(q){o(q(C))},subscribe:function(q,K=zo){const ae=[q,K];return V.add(ae),V.size===1&&(P=E(o)||zo),q(C),()=>{V.delete(ae),V.size===0&&(P(),P=null)}}}}const ju=mp([]),mf=mp([]),gp=mp([]),gf=mp(!0),pu=mp(!0),cu=mp([]),I_=C=>{if(!Array.isArray(C))return!1;const E=["id","name","type"];return!(C.filter(P=>{const V=Object.keys(P);return E.filter(o=>!V.includes(o)).length>0}).length>0)},Fl=(C,E)=>Math.round(C*10**E)/10**E;var S_=/^\s+|\s+$/g,T_=/^[-+]0x[0-9a-f]+$/i,F_=/^0b[01]+$/i,U_=/^0o[0-7]+$/i,M_=parseInt,k_=typeof OA=="object"&&OA&&OA.Object===Object&&OA,P_=typeof self=="object"&&self&&self.Object===Object&&self,Q_=k_||P_||Function("return this")(),D_=Object.prototype.toString,L_=Math.max,z_=Math.min,Kd=function(){return Q_.Date.now()};function R_(C,E,P){var V,o,q,K,ae,Y,ie=0,be=!1,ze=!1,it=!0;if(typeof C!="function")throw new TypeError("Expected a function");function tt(gt){var Zt=V,dr=o;return V=o=void 0,ie=gt,K=C.apply(dr,Zt)}function _t(gt){return ie=gt,ae=setTimeout(Bt,E),be?tt(gt):K}function yt(gt){var Zt=gt-Y;return Y===void 0||Zt>=E||Zt<0||ze&&gt-ie>=q}function Bt(){var gt=Kd();if(yt(gt))return rt(gt);ae=setTimeout(Bt,function(Zt){var dr=E-(Zt-Y);return ze?z_(dr,q-(Zt-ie)):dr}(gt))}function rt(gt){return ae=void 0,it&&V?tt(gt):(V=o=void 0,K)}function It(){var gt=Kd(),Zt=yt(gt);if(V=arguments,o=this,Y=gt,Zt){if(ae===void 0)return _t(Y);if(ze)return ae=setTimeout(Bt,E),tt(Y)}return ae===void 0&&(ae=setTimeout(Bt,E)),K}return E=_m(E)||0,xd(P)&&(be=!!P.leading,q=(ze="maxWait"in P)?L_(_m(P.maxWait)||0,E):q,it="trailing"in P?!!P.trailing:it),It.cancel=function(){ae!==void 0&&clearTimeout(ae),ie=0,V=Y=o=ae=void 0},It.flush=function(){return ae===void 0?K:rt(Kd())},It}function xd(C){var E=typeof C;return!!C&&(E=="object"||E=="function")}function _m(C){if(typeof C=="number")return C;if(function(V){return typeof V=="symbol"||function(o){return!!o&&typeof o=="object"}(V)&&D_.call(V)=="[object Symbol]"}(C))return NaN;if(xd(C)){var E=typeof C.valueOf=="function"?C.valueOf():C;C=xd(E)?E+"":E}if(typeof C!="string")return C===0?C:+C;C=C.replace(S_,"");var P=F_.test(C);return P||U_.test(C)?M_(C.slice(2),P?2:8):T_.test(C)?NaN:+C}var ay,Df=function(C,E,P){var V=!0,o=!0;if(typeof C!="function")throw new TypeError("Expected a function");return xd(P)&&(V="leading"in P?!!P.leading:V,o="trailing"in P?!!P.trailing:o),R_(C,E,{leading:V,maxWait:E,trailing:o})},vm=Object.prototype.toString,sy=function(C){var E=vm.call(C),P=E==="[object Arguments]";return P||(P=E!=="[object Array]"&&C!==null&&typeof C=="object"&&typeof C.length=="number"&&C.length>=0&&vm.call(C.callee)==="[object Function]"),P};if(!Object.keys){var td=Object.prototype.hasOwnProperty,xm=Object.prototype.toString,O_=sy,wm=Object.prototype.propertyIsEnumerable,H_=!wm.call({toString:null},"toString"),V_=wm.call(function(){},"prototype"),rd=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],Gd=function(C){var E=C.constructor;return E&&E.prototype===C},N_={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},K_=function(){if(typeof window>"u")return!1;for(var C in window)try{if(!N_["$"+C]&&td.call(window,C)&&window[C]!==null&&typeof window[C]=="object")try{Gd(window[C])}catch{return!0}}catch{return!0}return!1}();ay=function(C){var E=C!==null&&typeof C=="object",P=xm.call(C)==="[object Function]",V=O_(C),o=E&&xm.call(C)==="[object String]",q=[];if(!E&&!P&&!V)throw new TypeError("Object.keys called on a non-object");var K=V_&&P;if(o&&C.length>0&&!td.call(C,0))for(var ae=0;ae<C.length;++ae)q.push(String(ae));if(V&&C.length>0)for(var Y=0;Y<C.length;++Y)q.push(String(Y));else for(var ie in C)K&&ie==="prototype"||!td.call(C,ie)||q.push(String(ie));if(H_)for(var be=function(it){if(typeof window>"u"||!K_)return Gd(it);try{return Gd(it)}catch{return!1}}(C),ze=0;ze<rd.length;++ze)be&&rd[ze]==="constructor"||!td.call(C,rd[ze])||q.push(rd[ze]);return q}}var G_=ay,j_=Array.prototype.slice,$_=sy,bm=Object.keys,fd=bm?function(C){return bm(C)}:G_,Bm=Object.keys;fd.shim=function(){if(Object.keys){var C=function(){var E=Object.keys(arguments);return E&&E.length===arguments.length}(1,2);C||(Object.keys=function(E){return $_(E)?Bm(j_.call(E)):Bm(E)})}else Object.keys=fd;return Object.keys||fd};var Lf=fd,zf=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var C={},E=Symbol("test"),P=Object(E);if(typeof E=="string"||Object.prototype.toString.call(E)!=="[object Symbol]"||Object.prototype.toString.call(P)!=="[object Symbol]")return!1;for(E in C[E]=42,C)return!1;if(typeof Object.keys=="function"&&Object.keys(C).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(C).length!==0)return!1;var V=Object.getOwnPropertySymbols(C);if(V.length!==1||V[0]!==E||!Object.prototype.propertyIsEnumerable.call(C,E))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(C,E);if(o.value!==42||o.enumerable!==!0)return!1}return!0},q_=zf,Zu=function(){return q_()&&!!Symbol.toStringTag},Cm=typeof Symbol<"u"&&Symbol,Z_=zf,ly=function(){return typeof Cm=="function"&&typeof Symbol=="function"&&typeof Cm("foo")=="symbol"&&typeof Symbol("bar")=="symbol"&&Z_()},X_="Function.prototype.bind called on incompatible ",jd=Array.prototype.slice,W_=Object.prototype.toString,J_=function(C){var E=this;if(typeof E!="function"||W_.call(E)!=="[object Function]")throw new TypeError(X_+E);for(var P,V=jd.call(arguments,1),o=function(){if(this instanceof P){var ie=E.apply(this,V.concat(jd.call(arguments)));return Object(ie)===ie?ie:this}return E.apply(C,V.concat(jd.call(arguments)))},q=Math.max(0,E.length-V.length),K=[],ae=0;ae<q;ae++)K.push("$"+ae);if(P=Function("binder","return function ("+K.join(",")+"){ return binder.apply(this,arguments); }")(o),E.prototype){var Y=function(){};Y.prototype=E.prototype,P.prototype=new Y,Y.prototype=null}return P},Rf=Function.prototype.bind||J_,Y_=Rf.call(Function.call,Object.prototype.hasOwnProperty),Vp=SyntaxError,Ay=Function,up=TypeError,$d=function(C){try{return Ay('"use strict"; return ('+C+").constructor;")()}catch{}},Bh=Object.getOwnPropertyDescriptor;if(Bh)try{Bh({},"")}catch{Bh=null}var qd=function(){throw new up},ev=Bh?function(){try{return qd}catch{try{return Bh(arguments,"callee").get}catch{return qd}}}():qd,np=ly(),Vu=Object.getPrototypeOf||function(C){return C.__proto__},op={},tv=typeof Uint8Array>"u"?void 0:Vu(Uint8Array),hp={"%AggregateError%":typeof AggregateError>"u"?void 0:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?void 0:ArrayBuffer,"%ArrayIteratorPrototype%":np?Vu([][Symbol.iterator]()):void 0,"%AsyncFromSyncIteratorPrototype%":void 0,"%AsyncFunction%":op,"%AsyncGenerator%":op,"%AsyncGeneratorFunction%":op,"%AsyncIteratorPrototype%":op,"%Atomics%":typeof Atomics>"u"?void 0:Atomics,"%BigInt%":typeof BigInt>"u"?void 0:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?void 0:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?void 0:Float32Array,"%Float64Array%":typeof Float64Array>"u"?void 0:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?void 0:FinalizationRegistry,"%Function%":Ay,"%GeneratorFunction%":op,"%Int8Array%":typeof Int8Array>"u"?void 0:Int8Array,"%Int16Array%":typeof Int16Array>"u"?void 0:Int16Array,"%Int32Array%":typeof Int32Array>"u"?void 0:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":np?Vu(Vu([][Symbol.iterator]())):void 0,"%JSON%":typeof JSON=="object"?JSON:void 0,"%Map%":typeof Map>"u"?void 0:Map,"%MapIteratorPrototype%":typeof Map<"u"&&np?Vu(new Map()[Symbol.iterator]()):void 0,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?void 0:Promise,"%Proxy%":typeof Proxy>"u"?void 0:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?void 0:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?void 0:Set,"%SetIteratorPrototype%":typeof Set<"u"&&np?Vu(new Set()[Symbol.iterator]()):void 0,"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?void 0:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":np?Vu(""[Symbol.iterator]()):void 0,"%Symbol%":np?Symbol:void 0,"%SyntaxError%":Vp,"%ThrowTypeError%":ev,"%TypedArray%":tv,"%TypeError%":up,"%Uint8Array%":typeof Uint8Array>"u"?void 0:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?void 0:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?void 0:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?void 0:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?void 0:WeakMap,"%WeakRef%":typeof WeakRef>"u"?void 0:WeakRef,"%WeakSet%":typeof WeakSet>"u"?void 0:WeakSet},rv=function C(E){var P;if(E==="%AsyncFunction%")P=$d("async function () {}");else if(E==="%GeneratorFunction%")P=$d("function* () {}");else if(E==="%AsyncGeneratorFunction%")P=$d("async function* () {}");else if(E==="%AsyncGenerator%"){var V=C("%AsyncGeneratorFunction%");V&&(P=V.prototype)}else if(E==="%AsyncIteratorPrototype%"){var o=C("%AsyncGenerator%");o&&(P=Vu(o.prototype))}return hp[E]=P,P},Em={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Ud=Rf,wd=Y_,iv=Ud.call(Function.call,Array.prototype.concat),nv=Ud.call(Function.apply,Array.prototype.splice),Im=Ud.call(Function.call,String.prototype.replace),bd=Ud.call(Function.call,String.prototype.slice),ov=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,av=/\\(\\)?/g,sv=function(C){var E=bd(C,0,1),P=bd(C,-1);if(E==="%"&&P!=="%")throw new Vp("invalid intrinsic syntax, expected closing `%`");if(P==="%"&&E!=="%")throw new Vp("invalid intrinsic syntax, expected opening `%`");var V=[];return Im(C,ov,function(o,q,K,ae){V[V.length]=K?Im(ae,av,"$1"):q||o}),V},lv=function(C,E){var P,V=C;if(wd(Em,V)&&(V="%"+(P=Em[V])[0]+"%"),wd(hp,V)){var o=hp[V];if(o===op&&(o=rv(V)),o===void 0&&!E)throw new up("intrinsic "+C+" exists, but is not available. Please file an issue!");return{alias:P,name:V,value:o}}throw new Vp("intrinsic "+C+" does not exist!")},yp=function(C,E){if(typeof C!="string"||C.length===0)throw new up("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof E!="boolean")throw new up('"allowMissing" argument must be a boolean');var P=sv(C),V=P.length>0?P[0]:"",o=lv("%"+V+"%",E),q=o.name,K=o.value,ae=!1,Y=o.alias;Y&&(V=Y[0],nv(P,iv([0,1],Y)));for(var ie=1,be=!0;ie<P.length;ie+=1){var ze=P[ie],it=bd(ze,0,1),tt=bd(ze,-1);if((it==='"'||it==="'"||it==="`"||tt==='"'||tt==="'"||tt==="`")&&it!==tt)throw new Vp("property names with quotes must have matching quotes");if(ze!=="constructor"&&be||(ae=!0),wd(hp,q="%"+(V+="."+ze)+"%"))K=hp[q];else if(K!=null){if(!(ze in K)){if(!E)throw new up("base intrinsic for "+C+" exists, but the property is not available.");return}if(Bh&&ie+1>=P.length){var _t=Bh(K,ze);K=(be=!!_t)&&"get"in _t&&!("originalValue"in _t.get)?_t.get:K[ze]}else be=wd(K,ze),K=K[ze];be&&!ae&&(hp[q]=K)}}return K},Kp={exports:{}};(function(C){var E=Rf,P=yp,V=P("%Function.prototype.apply%"),o=P("%Function.prototype.call%"),q=P("%Reflect.apply%",!0)||E.call(o,V),K=P("%Object.getOwnPropertyDescriptor%",!0),ae=P("%Object.defineProperty%",!0),Y=P("%Math.max%");if(ae)try{ae({},"a",{value:1})}catch{ae=null}C.exports=function(be){var ze=q(E,o,arguments);if(K&&ae){var it=K(ze,"length");it.configurable&&ae(ze,"length",{value:1+Y(0,be.length-(arguments.length-1))})}return ze};var ie=function(){return q(E,V,arguments)};ae?ae(C.exports,"apply",{value:ie}):C.exports.apply=ie})(Kp);var cy=yp,uy=Kp.exports,Av=uy(cy("String.prototype.indexOf")),fu=function(C,E){var P=cy(C,!!E);return typeof P=="function"&&Av(C,".prototype.")>-1?uy(P):P},cv=Zu(),yf=fu("Object.prototype.toString"),Md=function(C){return!(cv&&C&&typeof C=="object"&&Symbol.toStringTag in C)&&yf(C)==="[object Arguments]"},hy=function(C){return!!Md(C)||C!==null&&typeof C=="object"&&typeof C.length=="number"&&C.length>=0&&yf(C)!=="[object Array]"&&yf(C.callee)==="[object Function]"},uv=function(){return Md(arguments)}();Md.isLegacyArguments=hy;var hv=uv?Md:hy,pv=Lf,dv=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",fv=Object.prototype.toString,mv=Array.prototype.concat,_f=Object.defineProperty,py=_f&&function(){var C={};try{for(var E in _f(C,"x",{enumerable:!1,value:C}),C)return!1;return C.x===C}catch{return!1}}(),gv=function(C,E,P,V){var o;(!(E in C)||typeof(o=V)=="function"&&fv.call(o)==="[object Function]"&&V())&&(py?_f(C,E,{configurable:!0,enumerable:!1,value:P,writable:!0}):C[E]=P)},dy=function(C,E){var P=arguments.length>2?arguments[2]:{},V=pv(E);dv&&(V=mv.call(V,Object.getOwnPropertySymbols(E)));for(var o=0;o<V.length;o+=1)gv(C,V[o],E[V[o]],P[V[o]])};dy.supportsDescriptors=!!py;var Ch=dy,Sm=function(C){return C!=C},fy=function(C,E){return C===0&&E===0?1/C==1/E:C===E||!(!Sm(C)||!Sm(E))},yv=fy,my=function(){return typeof Object.is=="function"?Object.is:yv},_v=my,vv=Ch,xv=Ch,wv=fy,gy=my,bv=function(){var C=_v();return vv(Object,{is:C},{is:function(){return Object.is!==C}}),C},yy=(0,Kp.exports)(gy(),Object);xv(yy,{getPolyfill:gy,implementation:wv,shim:bv});var _y,vy,vf,xf,Bv=yy,wf=fu,xy=Zu();if(xy){_y=wf("Object.prototype.hasOwnProperty"),vy=wf("RegExp.prototype.exec"),vf={};var Zd=function(){throw vf};xf={toString:Zd,valueOf:Zd},typeof Symbol.toPrimitive=="symbol"&&(xf[Symbol.toPrimitive]=Zd)}var Cv=wf("Object.prototype.toString"),Ev=Object.getOwnPropertyDescriptor,Iv=xy?function(C){if(!C||typeof C!="object")return!1;var E=Ev(C,"lastIndex");if(!(E&&_y(E,"value")))return!1;try{vy(C,xf)}catch(P){return P===vf}}:function(C){return!(!C||typeof C!="object"&&typeof C!="function")&&Cv(C)==="[object RegExp]"},Sv=Object,Tv=TypeError,wy=function(){if(this!=null&&this!==Sv(this))throw new Tv("RegExp.prototype.flags getter called on non-object");var C="";return this.hasIndices&&(C+="d"),this.global&&(C+="g"),this.ignoreCase&&(C+="i"),this.multiline&&(C+="m"),this.dotAll&&(C+="s"),this.unicode&&(C+="u"),this.sticky&&(C+="y"),C},Fv=wy,Uv=Ch.supportsDescriptors,Mv=Object.getOwnPropertyDescriptor,by=function(){if(Uv&&/a/gim.flags==="gim"){var C=Mv(RegExp.prototype,"flags");if(C&&typeof C.get=="function"&&typeof/a/.dotAll=="boolean")return C.get}return Fv},kv=Ch.supportsDescriptors,Pv=by,Qv=Object.getOwnPropertyDescriptor,Dv=Object.defineProperty,Lv=TypeError,Tm=Object.getPrototypeOf,zv=/a/,Rv=Ch,Ov=wy,By=by,Hv=function(){if(!kv||!Tm)throw new Lv("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var C=Pv(),E=Tm(zv),P=Qv(E,"flags");return P&&P.get===C||Dv(E,"flags",{configurable:!0,enumerable:!1,get:C}),C},Cy=(0,Kp.exports)(By());Rv(Cy,{getPolyfill:By,implementation:Ov,shim:Hv});var Vv=Cy,Nv={}.toString,Kv=Array.isArray||function(C){return Nv.call(C)=="[object Array]"},Gv=Date.prototype.getDay,jv=Object.prototype.toString,$v=Zu(),qv=String.prototype.valueOf,Zv=Object.prototype.toString,Xv=Zu(),Wv=Number.prototype.toString,Jv=Object.prototype.toString,Yv=Zu(),Ey=fu,e0=Ey("Boolean.prototype.toString"),t0=Ey("Object.prototype.toString"),r0=Zu(),bf={exports:{}},i0=Object.prototype.toString;if(ly()){var n0=Symbol.prototype.toString,o0=/^Symbol\(.*\)$/;bf.exports=function(C){if(typeof C=="symbol")return!0;if(i0.call(C)!=="[object Symbol]")return!1;try{return function(E){return typeof E.valueOf()=="symbol"&&o0.test(n0.call(E))}(C)}catch{return!1}}}else bf.exports=function(C){return!1};var Bf={exports:{}},Fm=OA.BigInt;if(typeof Fm=="function"&&typeof BigInt=="function"&&typeof Fm(42)=="bigint"&&typeof BigInt(42)=="bigint"){var a0=BigInt.prototype.valueOf;Bf.exports=function(C){return C!=null&&typeof C!="boolean"&&typeof C!="string"&&typeof C!="number"&&typeof C!="symbol"&&typeof C!="function"&&(typeof C=="bigint"||function(E){try{return a0.call(E),!0}catch{}return!1}(C))}}else Bf.exports=function(C){return!1};var Bd,s0=function(C){return typeof C=="string"||typeof C=="object"&&(Xv?function(E){try{return qv.call(E),!0}catch{return!1}}(C):Zv.call(C)==="[object String]")},l0=function(C){return typeof C=="number"||typeof C=="object"&&(Yv?function(E){try{return Wv.call(E),!0}catch{return!1}}(C):Jv.call(C)==="[object Number]")},A0=function(C){return typeof C=="boolean"||C!==null&&typeof C=="object"&&(r0&&Symbol.toStringTag in C?function(E){try{return e0(E),!0}catch{return!1}}(C):t0(C)==="[object Boolean]")},c0=bf.exports,u0=Bf.exports,Of=typeof Map=="function"&&Map.prototype?Map:null,h0=typeof Set=="function"&&Set.prototype?Set:null;Of||(Bd=function(C){return!1});var Iy=Of?Map.prototype.has:null,Um=h0?Set.prototype.has:null;Bd||Iy||(Bd=function(C){return!1});var Cd,p0=Bd||function(C){if(!C||typeof C!="object")return!1;try{if(Iy.call(C),Um)try{Um.call(C)}catch{return!0}return C instanceof Of}catch{}return!1},d0=typeof Map=="function"&&Map.prototype?Map:null,Hf=typeof Set=="function"&&Set.prototype?Set:null;Hf||(Cd=function(C){return!1});var Mm=d0?Map.prototype.has:null,Sy=Hf?Set.prototype.has:null;Cd||Sy||(Cd=function(C){return!1});var Ed,f0=Cd||function(C){if(!C||typeof C!="object")return!1;try{if(Sy.call(C),Mm)try{Mm.call(C)}catch{return!0}return C instanceof Hf}catch{}return!1},Id=typeof WeakMap=="function"&&WeakMap.prototype?WeakMap:null,km=typeof WeakSet=="function"&&WeakSet.prototype?WeakSet:null;Id||(Ed=function(C){return!1});var Cf=Id?Id.prototype.has:null,Xd=km?km.prototype.has:null;Ed||Cf||(Ed=function(C){return!1});var m0=Ed||function(C){if(!C||typeof C!="object")return!1;try{if(Cf.call(C,Cf),Xd)try{Xd.call(C,Xd)}catch{return!0}return C instanceof Id}catch{}return!1},Ef={exports:{}},Ty=fu,g0=yp("%WeakSet%",!0),Wd=Ty("WeakSet.prototype.has",!0);if(Wd){var Jd=Ty("WeakMap.prototype.has",!0);Ef.exports=function(C){if(!C||typeof C!="object")return!1;try{if(Wd(C,Wd),Jd)try{Jd(C,Jd)}catch{return!0}return C instanceof g0}catch{}return!1}}else Ef.exports=function(C){return!1};var y0=p0,_0=f0,v0=m0,x0=Ef.exports,Pm=Symbol.iterator,w0=B_(Object.freeze({__proto__:null,default:{}})),Vf=typeof Map=="function"&&Map.prototype,Yd=Object.getOwnPropertyDescriptor&&Vf?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,id=Vf&&Yd&&typeof Yd.get=="function"?Yd.get:null,b0=Vf&&Map.prototype.forEach,Nf=typeof Set=="function"&&Set.prototype,ef=Object.getOwnPropertyDescriptor&&Nf?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,nd=Nf&&ef&&typeof ef.get=="function"?ef.get:null,B0=Nf&&Set.prototype.forEach,Qp=typeof WeakMap=="function"&&WeakMap.prototype?WeakMap.prototype.has:null,Dp=typeof WeakSet=="function"&&WeakSet.prototype?WeakSet.prototype.has:null,Qm=typeof WeakRef=="function"&&WeakRef.prototype?WeakRef.prototype.deref:null,C0=Boolean.prototype.valueOf,E0=Object.prototype.toString,I0=Function.prototype.toString,S0=String.prototype.match,Kf=String.prototype.slice,Gu=String.prototype.replace,T0=String.prototype.toUpperCase,Dm=String.prototype.toLowerCase,Fy=RegExp.prototype.test,Lm=Array.prototype.concat,Oc=Array.prototype.join,F0=Array.prototype.slice,zm=Math.floor,tf=typeof BigInt=="function"?BigInt.prototype.valueOf:null,rf=Object.getOwnPropertySymbols,If=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,dp=typeof Symbol=="function"&&typeof Symbol.iterator=="object",pl=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===dp||"symbol")?Symbol.toStringTag:null,Uy=Object.prototype.propertyIsEnumerable,Rm=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(C){return C.__proto__}:null);function Om(C,E){if(C===1/0||C===-1/0||C!=C||C&&C>-1e3&&C<1e3||Fy.call(/e/,E))return E;var P=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof C=="number"){var V=C<0?-zm(-C):zm(C);if(V!==C){var o=String(V),q=Kf.call(E,o.length+1);return Gu.call(o,P,"$&_")+"."+Gu.call(Gu.call(q,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Gu.call(E,P,"$&_")}var nf=w0.custom,of=nf&&ky(nf)?nf:null;function My(C,E,P){var V=(P.quoteStyle||E)==="double"?'"':"'";return V+C+V}function U0(C){return Gu.call(String(C),/"/g,"&quot;")}function Sf(C){return!(Hu(C)!=="[object Array]"||pl&&typeof C=="object"&&pl in C)}function ky(C){if(dp)return C&&typeof C=="object"&&C instanceof Symbol;if(typeof C=="symbol")return!0;if(!C||typeof C!="object"||!If)return!1;try{return If.call(C),!0}catch{}return!1}var M0=Object.prototype.hasOwnProperty||function(C){return C in this};function Nu(C,E){return M0.call(C,E)}function Hu(C){return E0.call(C)}function Hm(C,E){if(C.indexOf)return C.indexOf(E);for(var P=0,V=C.length;P<V;P++)if(C[P]===E)return P;return-1}function Py(C,E){if(C.length>E.maxStringLength){var P=C.length-E.maxStringLength,V="... "+P+" more character"+(P>1?"s":"");return Py(Kf.call(C,0,E.maxStringLength),E)+V}return My(Gu.call(Gu.call(C,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,k0),"single",E)}function k0(C){var E=C.charCodeAt(0),P={8:"b",9:"t",10:"n",12:"f",13:"r"}[E];return P?"\\"+P:"\\x"+(E<16?"0":"")+T0.call(E.toString(16))}function Lp(C){return"Object("+C+")"}function af(C){return C+" { ? }"}function Vm(C,E,P,V){return C+" ("+E+") {"+(V?Tf(P,V):Oc.call(P,", "))+"}"}function Tf(C,E){if(C.length===0)return"";var P=`
`+E.prev+E.base;return P+Oc.call(C,","+P)+`
`+E.prev}function od(C,E){var P=Sf(C),V=[];if(P){V.length=C.length;for(var o=0;o<C.length;o++)V[o]=Nu(C,o)?E(C[o],C):""}var q,K=typeof rf=="function"?rf(C):[];if(dp){q={};for(var ae=0;ae<K.length;ae++)q["$"+K[ae]]=K[ae]}for(var Y in C)Nu(C,Y)&&(P&&String(Number(Y))===Y&&Y<C.length||dp&&q["$"+Y]instanceof Symbol||(Fy.call(/[^\w$]/,Y)?V.push(E(Y,C)+": "+E(C[Y],C)):V.push(Y+": "+E(C[Y],C))));if(typeof rf=="function")for(var ie=0;ie<K.length;ie++)Uy.call(C,K[ie])&&V.push("["+E(K[ie])+"]: "+E(C[K[ie]],C));return V}var Gf=yp,_p=fu,P0=function C(E,P,V,o){var q=P||{};if(Nu(q,"quoteStyle")&&q.quoteStyle!=="single"&&q.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Nu(q,"maxStringLength")&&(typeof q.maxStringLength=="number"?q.maxStringLength<0&&q.maxStringLength!==1/0:q.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var K=!Nu(q,"customInspect")||q.customInspect;if(typeof K!="boolean"&&K!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Nu(q,"indent")&&q.indent!==null&&q.indent!=="	"&&!(parseInt(q.indent,10)===q.indent&&q.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Nu(q,"numericSeparator")&&typeof q.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var ae=q.numericSeparator;if(E===void 0)return"undefined";if(E===null)return"null";if(typeof E=="boolean")return E?"true":"false";if(typeof E=="string")return Py(E,q);if(typeof E=="number"){if(E===0)return 1/0/E>0?"0":"-0";var Y=String(E);return ae?Om(E,Y):Y}if(typeof E=="bigint"){var ie=String(E)+"n";return ae?Om(E,ie):ie}var be=q.depth===void 0?5:q.depth;if(V===void 0&&(V=0),V>=be&&be>0&&typeof E=="object")return Sf(E)?"[Array]":"[Object]";var ze=function(kt,Rt){var br;if(kt.indent==="	")br="	";else{if(!(typeof kt.indent=="number"&&kt.indent>0))return null;br=Oc.call(Array(kt.indent+1)," ")}return{base:br,prev:Oc.call(Array(Rt+1),br)}}(q,V);if(o===void 0)o=[];else if(Hm(o,E)>=0)return"[Circular]";function it(kt,Rt,br){if(Rt&&(o=F0.call(o)).push(Rt),br){var Or={depth:q.depth};return Nu(q,"quoteStyle")&&(Or.quoteStyle=q.quoteStyle),C(kt,Or,V+1,o)}return C(kt,q,V+1,o)}if(typeof E=="function"){var tt=function(kt){if(kt.name)return kt.name;var Rt=S0.call(I0.call(kt),/^function\s*([\w$]+)/);return Rt?Rt[1]:null}(E),_t=od(E,it);return"[Function"+(tt?": "+tt:" (anonymous)")+"]"+(_t.length>0?" { "+Oc.call(_t,", ")+" }":"")}if(ky(E)){var yt=dp?Gu.call(String(E),/^(Symbol\(.*\))_[^)]*$/,"$1"):If.call(E);return typeof E!="object"||dp?yt:Lp(yt)}if(function(kt){return!kt||typeof kt!="object"?!1:typeof HTMLElement<"u"&&kt instanceof HTMLElement?!0:typeof kt.nodeName=="string"&&typeof kt.getAttribute=="function"}(E)){for(var Bt="<"+Dm.call(String(E.nodeName)),rt=E.attributes||[],It=0;It<rt.length;It++)Bt+=" "+rt[It].name+"="+My(U0(rt[It].value),"double",q);return Bt+=">",E.childNodes&&E.childNodes.length&&(Bt+="..."),Bt+="</"+Dm.call(String(E.nodeName))+">"}if(Sf(E)){if(E.length===0)return"[]";var gt=od(E,it);return ze&&!function(kt){for(var Rt=0;Rt<kt.length;Rt++)if(Hm(kt[Rt],`
`)>=0)return!1;return!0}(gt)?"["+Tf(gt,ze)+"]":"[ "+Oc.call(gt,", ")+" ]"}if(function(kt){return!(Hu(kt)!=="[object Error]"||pl&&typeof kt=="object"&&pl in kt)}(E)){var Zt=od(E,it);return"cause"in E&&!Uy.call(E,"cause")?"{ ["+String(E)+"] "+Oc.call(Lm.call("[cause]: "+it(E.cause),Zt),", ")+" }":Zt.length===0?"["+String(E)+"]":"{ ["+String(E)+"] "+Oc.call(Zt,", ")+" }"}if(typeof E=="object"&&K){if(of&&typeof E[of]=="function")return E[of]();if(K!=="symbol"&&typeof E.inspect=="function")return E.inspect()}if(function(kt){if(!id||!kt||typeof kt!="object")return!1;try{id.call(kt);try{nd.call(kt)}catch{return!0}return kt instanceof Map}catch{}return!1}(E)){var dr=[];return b0.call(E,function(kt,Rt){dr.push(it(Rt,E,!0)+" => "+it(kt,E))}),Vm("Map",id.call(E),dr,ze)}if(function(kt){if(!nd||!kt||typeof kt!="object")return!1;try{nd.call(kt);try{id.call(kt)}catch{return!0}return kt instanceof Set}catch{}return!1}(E)){var Xr=[];return B0.call(E,function(kt){Xr.push(it(kt,E))}),Vm("Set",nd.call(E),Xr,ze)}if(function(kt){if(!Qp||!kt||typeof kt!="object")return!1;try{Qp.call(kt,Qp);try{Dp.call(kt,Dp)}catch{return!0}return kt instanceof WeakMap}catch{}return!1}(E))return af("WeakMap");if(function(kt){if(!Dp||!kt||typeof kt!="object")return!1;try{Dp.call(kt,Dp);try{Qp.call(kt,Qp)}catch{return!0}return kt instanceof WeakSet}catch{}return!1}(E))return af("WeakSet");if(function(kt){if(!Qm||!kt||typeof kt!="object")return!1;try{return Qm.call(kt),!0}catch{}return!1}(E))return af("WeakRef");if(function(kt){return!(Hu(kt)!=="[object Number]"||pl&&typeof kt=="object"&&pl in kt)}(E))return Lp(it(Number(E)));if(function(kt){if(!kt||typeof kt!="object"||!tf)return!1;try{return tf.call(kt),!0}catch{}return!1}(E))return Lp(it(tf.call(E)));if(function(kt){return!(Hu(kt)!=="[object Boolean]"||pl&&typeof kt=="object"&&pl in kt)}(E))return Lp(C0.call(E));if(function(kt){return!(Hu(kt)!=="[object String]"||pl&&typeof kt=="object"&&pl in kt)}(E))return Lp(it(String(E)));if(!function(kt){return!(Hu(kt)!=="[object Date]"||pl&&typeof kt=="object"&&pl in kt)}(E)&&!function(kt){return!(Hu(kt)!=="[object RegExp]"||pl&&typeof kt=="object"&&pl in kt)}(E)){var ur=od(E,it),_r=Rm?Rm(E)===Object.prototype:E instanceof Object||E.constructor===Object,Rr=E instanceof Object?"":"null prototype",ei=!_r&&pl&&Object(E)===E&&pl in E?Kf.call(Hu(E),8,-1):Rr?"Object":"",rr=(_r||typeof E.constructor!="function"?"":E.constructor.name?E.constructor.name+" ":"")+(ei||Rr?"["+Oc.call(Lm.call([],ei||[],Rr||[]),": ")+"] ":"");return ur.length===0?rr+"{}":ze?rr+"{"+Tf(ur,ze)+"}":rr+"{ "+Oc.call(ur,", ")+" }"}return String(E)},Q0=Gf("%TypeError%"),ad=Gf("%WeakMap%",!0),sd=Gf("%Map%",!0),D0=_p("WeakMap.prototype.get",!0),L0=_p("WeakMap.prototype.set",!0),z0=_p("WeakMap.prototype.has",!0),R0=_p("Map.prototype.get",!0),O0=_p("Map.prototype.set",!0),H0=_p("Map.prototype.has",!0),sf=function(C,E){for(var P,V=C;(P=V.next)!==null;V=P)if(P.key===E)return V.next=P.next,P.next=C.next,C.next=P,P},V0=Object.prototype.hasOwnProperty,N0=Object.prototype.toString,Qy=function(C,E,P){if(N0.call(E)!=="[object Function]")throw new TypeError("iterator must be a function");var V=C.length;if(V===+V)for(var o=0;o<V;o++)E.call(P,C[o],o,C);else for(var q in C)V0.call(C,q)&&E.call(P,C[q],q,C)},lf=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],K0=typeof globalThis>"u"?OA:globalThis,Dy=function(){for(var C=[],E=0;E<lf.length;E++)typeof K0[lf[E]]=="function"&&(C[C.length]=lf[E]);return C},md=yp("%Object.getOwnPropertyDescriptor%",!0);if(md)try{md([],"length")}catch{md=null}var Ly=md,zy=Qy,G0=Dy,jf=fu,j0=jf("Object.prototype.toString"),Ry=Zu(),$0=typeof globalThis>"u"?OA:globalThis,Oy=G0(),q0=jf("Array.prototype.indexOf",!0)||function(C,E){for(var P=0;P<C.length;P+=1)if(C[P]===E)return P;return-1},Z0=jf("String.prototype.slice"),Hy={},gd=Ly,Af=Object.getPrototypeOf;Ry&&gd&&Af&&zy(Oy,function(C){var E=new $0[C];if(Symbol.toStringTag in E){var P=Af(E),V=gd(P,Symbol.toStringTag);if(!V){var o=Af(P);V=gd(o,Symbol.toStringTag)}Hy[C]=V.get}});var Vy=Qy,X0=Dy,Ny=fu,W0=Ny("Object.prototype.toString"),Ky=Zu(),Nm=typeof globalThis>"u"?OA:globalThis,J0=X0(),Y0=Ny("String.prototype.slice"),Gy={},cf=Ly,uf=Object.getPrototypeOf;Ky&&cf&&uf&&Vy(J0,function(C){if(typeof Nm[C]=="function"){var E=new Nm[C];if(Symbol.toStringTag in E){var P=uf(E),V=cf(P,Symbol.toStringTag);if(!V){var o=uf(P);V=cf(o,Symbol.toStringTag)}Gy[C]=V.get}}});var ex=function(C){if(!C||typeof C!="object")return!1;if(!Ry||!(Symbol.toStringTag in C)){var E=Z0(j0(C),8,-1);return q0(Oy,E)>-1}return!!gd&&function(P){var V=!1;return zy(Hy,function(o,q){if(!V)try{V=o.call(P)===q}catch{}}),V}(C)},tx=Lf,rx=function(C){return C!=null},jy=zf(),$y=fu,Km=Object,ix=$y("Array.prototype.push"),Gm=$y("Object.prototype.propertyIsEnumerable"),nx=jy?Object.getOwnPropertySymbols:null,qy=function(C,E){if(!rx(C))throw new TypeError("target must be an object");var P,V,o,q,K,ae,Y,ie=Km(C);for(P=1;P<arguments.length;++P){V=Km(arguments[P]),q=tx(V);var be=jy&&(Object.getOwnPropertySymbols||nx);if(be)for(K=be(V),o=0;o<K.length;++o)Y=K[o],Gm(V,Y)&&ix(q,Y);for(o=0;o<q.length;++o)ae=V[Y=q[o]],Gm(V,Y)&&(ie[Y]=ae)}return ie},jm=qy,Zy=function(){return Object.assign?function(){if(!Object.assign)return!1;for(var C="abcdefghijklmnopqrst",E=C.split(""),P={},V=0;V<E.length;++V)P[E[V]]=E[V];var o=Object.assign({},P),q="";for(var K in o)q+=K;return C!==q}()||function(){if(!Object.assign||!Object.preventExtensions)return!1;var C=Object.preventExtensions({1:2});try{Object.assign(C,"xy")}catch{return C[1]==="y"}return!1}()?jm:Object.assign:jm},ox=Ch,ax=Zy,sx=Ch,lx=qy,Xy=Zy,Ax=function(){var C=ax();return ox(Object,{assign:C},{assign:function(){return Object.assign!==C}}),C},cx=Kp.exports.apply(Xy()),Wy=function(C,E){return cx(Object,arguments)};sx(Wy,{getPolyfill:Xy,implementation:lx,shim:Ax});var $m=Lf,qm=hv,Zm=Bv,Xm=Iv,Wm=Vv,Jm=Kv,Ym=function(C){return typeof C=="object"&&C!==null&&($v?function(E){try{return Gv.call(E),!0}catch{return!1}}(C):jv.call(C)==="[object Date]")},eg=function(C){return C==null||typeof C!="object"&&typeof C!="function"?null:s0(C)?"String":l0(C)?"Number":A0(C)?"Boolean":c0(C)?"Symbol":u0(C)?"BigInt":void 0},ux=yp,mu=fu,tg=function(C){if(C&&typeof C=="object"){if(y0(C))return"Map";if(_0(C))return"Set";if(v0(C))return"WeakMap";if(x0(C))return"WeakSet"}return!1},ap=function(C){if(C!=null&&C[Pm]!==void 0)return C[Pm]()},hx=function(){var C,E,P,V={assert:function(o){if(!V.has(o))throw new Q0("Side channel does not contain "+P0(o))},get:function(o){if(ad&&o&&(typeof o=="object"||typeof o=="function")){if(C)return D0(C,o)}else if(sd){if(E)return R0(E,o)}else if(P)return function(q,K){var ae=sf(q,K);return ae&&ae.value}(P,o)},has:function(o){if(ad&&o&&(typeof o=="object"||typeof o=="function")){if(C)return z0(C,o)}else if(sd){if(E)return H0(E,o)}else if(P)return function(q,K){return!!sf(q,K)}(P,o);return!1},set:function(o,q){ad&&o&&(typeof o=="object"||typeof o=="function")?(C||(C=new ad),L0(C,o,q)):sd?(E||(E=new sd),O0(E,o,q)):(P||(P={key:{},next:null}),function(K,ae,Y){var ie=sf(K,ae);ie?ie.value=Y:K.next={key:ae,next:K.next,value:Y}}(P,o,q))}};return V},rg=function(C){return!!ex(C)&&(Ky&&Symbol.toStringTag in C?function(E){var P=!1;return Vy(Gy,function(V,o){if(!P)try{var q=V.call(E);q===o&&(P=q)}catch{}}),P}(C):Y0(W0(C),8,-1))},Jy=Wy,ig=mu("Date.prototype.getTime"),hf=Object.getPrototypeOf,ng=mu("Object.prototype.toString"),ld=ux("%Set%",!0),Ff=mu("Map.prototype.has",!0),Sd=mu("Map.prototype.get",!0),og=mu("Map.prototype.size",!0),Ad=mu("Set.prototype.add",!0),Yy=mu("Set.prototype.delete",!0),Td=mu("Set.prototype.has",!0),cd=mu("Set.prototype.size",!0);function ag(C,E,P,V){for(var o,q=ap(C);(o=q.next())&&!o.done;)if(uu(E,o.value,P,V))return Yy(C,o.value),!0;return!1}function e_(C){return C===void 0?null:typeof C!="object"?typeof C!="symbol"&&(typeof C!="string"&&typeof C!="number"||+C==+C):void 0}function px(C,E,P,V,o,q){var K=e_(P);if(K!=null)return K;var ae=Sd(E,K),Y=Jy({},o,{strict:!1});return!(ae===void 0&&!Ff(E,K)||!uu(V,ae,Y,q))&&!Ff(C,K)&&uu(V,ae,Y,q)}function dx(C,E,P){var V=e_(P);return V!=null?V:Td(E,V)&&!Td(C,V)}function sg(C,E,P,V,o,q){for(var K,ae,Y=ap(C);(K=Y.next())&&!K.done;)if(uu(P,ae=K.value,o,q)&&uu(V,Sd(E,ae),o,q))return Yy(C,ae),!0;return!1}function uu(C,E,P,V){var o=P||{};if(o.strict?Zm(C,E):C===E)return!0;if(eg(C)!==eg(E))return!1;if(!C||!E||typeof C!="object"&&typeof E!="object")return o.strict?Zm(C,E):C==E;var q,K=V.has(C),ae=V.has(E);if(K&&ae){if(V.get(C)===V.get(E))return!0}else q={};return K||V.set(C,q),ae||V.set(E,q),function(Y,ie,be,ze){var it,tt;if(typeof Y!=typeof ie||Y==null||ie==null||ng(Y)!==ng(ie)||qm(Y)!==qm(ie))return!1;var _t=Jm(Y),yt=Jm(ie);if(_t!==yt)return!1;var Bt=Y instanceof Error,rt=ie instanceof Error;if(Bt!==rt||(Bt||rt)&&(Y.name!==ie.name||Y.message!==ie.message))return!1;var It=Xm(Y),gt=Xm(ie);if(It!==gt||(It||gt)&&(Y.source!==ie.source||Wm(Y)!==Wm(ie)))return!1;var Zt=Ym(Y),dr=Ym(ie);if(Zt!==dr||(Zt||dr)&&ig(Y)!==ig(ie)||be.strict&&hf&&hf(Y)!==hf(ie)||rg(Y)!==rg(ie))return!1;var Xr=lg(Y),ur=lg(ie);if(Xr!==ur)return!1;if(Xr||ur){if(Y.length!==ie.length)return!1;for(it=0;it<Y.length;it++)if(Y[it]!==ie[it])return!1;return!0}if(typeof Y!=typeof ie)return!1;var _r=$m(Y),Rr=$m(ie);if(_r.length!==Rr.length)return!1;for(_r.sort(),Rr.sort(),it=_r.length-1;it>=0;it--)if(_r[it]!=Rr[it])return!1;for(it=_r.length-1;it>=0;it--)if(!uu(Y[tt=_r[it]],ie[tt],be,ze))return!1;var ei=tg(Y),rr=tg(ie);return ei!==rr?!1:ei==="Set"||rr==="Set"?function(kt,Rt,br,Or){if(cd(kt)!==cd(Rt))return!1;for(var Kr,di,ri,ii=ap(kt),ki=ap(Rt);(Kr=ii.next())&&!Kr.done;)if(Kr.value&&typeof Kr.value=="object")ri||(ri=new ld),Ad(ri,Kr.value);else if(!Td(Rt,Kr.value)){if(br.strict||!dx(kt,Rt,Kr.value))return!1;ri||(ri=new ld),Ad(ri,Kr.value)}if(ri){for(;(di=ki.next())&&!di.done;)if(di.value&&typeof di.value=="object"){if(!ag(ri,di.value,br.strict,Or))return!1}else if(!br.strict&&!Td(kt,di.value)&&!ag(ri,di.value,br.strict,Or))return!1;return cd(ri)===0}return!0}(Y,ie,be,ze):ei==="Map"?function(kt,Rt,br,Or){if(og(kt)!==og(Rt))return!1;for(var Kr,di,ri,ii,ki,kn,Zi=ap(kt),Bn=ap(Rt);(Kr=Zi.next())&&!Kr.done;)if(ii=Kr.value[0],ki=Kr.value[1],ii&&typeof ii=="object")ri||(ri=new ld),Ad(ri,ii);else if((kn=Sd(Rt,ii))===void 0&&!Ff(Rt,ii)||!uu(ki,kn,br,Or)){if(br.strict||!px(kt,Rt,ii,ki,br,Or))return!1;ri||(ri=new ld),Ad(ri,ii)}if(ri){for(;(di=Bn.next())&&!di.done;)if(ii=di.value[0],kn=di.value[1],ii&&typeof ii=="object"){if(!sg(ri,kt,ii,kn,br,Or))return!1}else if(!(br.strict||kt.has(ii)&&uu(Sd(kt,ii),kn,br,Or)||sg(ri,kt,ii,kn,Jy({},br,{strict:!1}),Or)))return!1;return cd(ri)===0}return!0}(Y,ie,be,ze):!0}(C,E,o,V)}function lg(C){return!(!C||typeof C!="object"||typeof C.length!="number")&&typeof C.copy=="function"&&typeof C.slice=="function"&&!(C.length>0&&typeof C[0]!="number")&&!!(C.constructor&&C.constructor.isBuffer&&C.constructor.isBuffer(C))}var t_=function(C,E,P){return uu(C,E,P,hx())},fx=function C(E,P){if(E===P)return!0;if(E&&P&&typeof E=="object"&&typeof P=="object"){if(E.constructor!==P.constructor)return!1;var V,o,q;if(Array.isArray(E)){if((V=E.length)!=P.length)return!1;for(o=V;o--!=0;)if(!C(E[o],P[o]))return!1;return!0}if(E.constructor===RegExp)return E.source===P.source&&E.flags===P.flags;if(E.valueOf!==Object.prototype.valueOf)return E.valueOf()===P.valueOf();if(E.toString!==Object.prototype.toString)return E.toString()===P.toString();if((V=(q=Object.keys(E)).length)!==Object.keys(P).length)return!1;for(o=V;o--!=0;)if(!Object.prototype.hasOwnProperty.call(P,q[o]))return!1;for(o=V;o--!=0;){var K=q[o];if(!C(E[K],P[K]))return!1}return!0}return E!=E&&P!=P},sp;(function(C){C[C.INITIALIZED=0]="INITIALIZED",C[C.LOADING=1]="LOADING",C[C.SUCCESS=2]="SUCCESS",C[C.FAILURE=3]="FAILURE"})(sp||(sp={}));class wh{constructor({apiKey:E,channel:P,client:V,id:o="__googleMapsScriptId",libraries:q=[],language:K,region:ae,version:Y,mapIds:ie,nonce:be,retries:ze=3,url:it="https://maps.googleapis.com/maps/api/js"}){if(this.CALLBACK="__googleMapsCallback",this.callbacks=[],this.done=!1,this.loading=!1,this.errors=[],this.version=Y,this.apiKey=E,this.channel=P,this.client=V,this.id=o||"__googleMapsScriptId",this.libraries=q,this.language=K,this.region=ae,this.mapIds=ie,this.nonce=be,this.retries=ze,this.url=it,wh.instance){if(!fx(this.options,wh.instance.options))throw new Error(`Loader must not be called again with different options. ${JSON.stringify(this.options)} !== ${JSON.stringify(wh.instance.options)}`);return wh.instance}wh.instance=this}get options(){return{version:this.version,apiKey:this.apiKey,channel:this.channel,client:this.client,id:this.id,libraries:this.libraries,language:this.language,region:this.region,mapIds:this.mapIds,nonce:this.nonce,url:this.url}}get status(){return this.errors.length?sp.FAILURE:this.done?sp.SUCCESS:this.loading?sp.LOADING:sp.INITIALIZED}get failed(){return this.done&&!this.loading&&this.errors.length>=this.retries+1}createUrl(){let E=this.url;return E+=`?callback=${this.CALLBACK}`,this.apiKey&&(E+=`&key=${this.apiKey}`),this.channel&&(E+=`&channel=${this.channel}`),this.client&&(E+=`&client=${this.client}`),this.libraries.length>0&&(E+=`&libraries=${this.libraries.join(",")}`),this.language&&(E+=`&language=${this.language}`),this.region&&(E+=`&region=${this.region}`),this.version&&(E+=`&v=${this.version}`),this.mapIds&&(E+=`&map_ids=${this.mapIds.join(",")}`),E}deleteScript(){const E=document.getElementById(this.id);E&&E.remove()}load(){return this.loadPromise()}loadPromise(){return new Promise((E,P)=>{this.loadCallback(V=>{V?P(V.error):E(window.google)})})}loadCallback(E){this.callbacks.push(E),this.execute()}setScript(){if(document.getElementById(this.id))return void this.callback();const E=this.createUrl(),P=document.createElement("script");P.id=this.id,P.type="text/javascript",P.src=E,P.onerror=this.loadErrorCallback.bind(this),P.defer=!0,P.async=!0,this.nonce&&(P.nonce=this.nonce),document.head.appendChild(P)}reset(){this.deleteScript(),this.done=!1,this.loading=!1,this.errors=[],this.onerrorEvent=null}resetIfRetryingFailed(){this.failed&&this.reset()}loadErrorCallback(E){if(this.errors.push(E),this.errors.length<=this.retries){const P=this.errors.length*Math.pow(2,this.errors.length);console.log(`Failed to load Google Maps script, retrying in ${P} ms.`),setTimeout(()=>{this.deleteScript(),this.setScript()},P)}else this.onerrorEvent=E,this.callback()}setCallback(){window.__googleMapsCallback=this.callback.bind(this)}callback(){this.done=!0,this.loading=!1,this.callbacks.forEach(E=>{E(this.onerrorEvent)}),this.callbacks=[]}execute(){if(this.resetIfRetryingFailed(),this.done)this.callback();else{if(window.google&&window.google.maps&&window.google.maps.version)return console.warn("Google Maps already loaded outside @googlemaps/js-api-loader.This may result in undesirable behavior as options and script parameters may not match."),void this.callback();this.loading||(this.loading=!0,this.setCallback(),this.setScript())}}}function mx(C){let E;return{c(){E=wr("div"),Dt(E,"id",C[0]),Dt(E,"class","map svelte-16c2pp7")},m(P,V){Di(P,E,V)},p(P,[V]){1&V&&Dt(E,"id",P[0])},i:zo,o:zo,d(P){P&&Ci(E)}}}function gx(C,E,P){let V,o,{id:q}=E,{bearing:K}=E,{center:ae}=E,{pitch:Y}=E,{zoom:ie}=E,{mapStyle:be}=E,{numberOfMaps:ze}=E;gp.subscribe(gt=>({googleMapsAPIKey:o}=gt));const it=fc();let tt,_t={};const yt=new wh({apiKey:o,version:"beta"}),Bt=()=>({bearing:tt.getHeading(),center:{lng:tt.getCenter().lng(),lat:tt.getCenter().lat()},pitch:tt.getTilt(),zoom:tt.getZoom()-1}),rt=()=>{const gt=It(Bt()),Zt=It(_t);return!t_(gt,Zt)},It=gt=>({bearing:Fl(gt.bearing,1),pitch:Fl(gt.pitch,1),center:{lat:Fl(gt.center.lat,6),lng:Fl(gt.center.lng,6)},zoom:Fl(gt.zoom,2)});return Fd(()=>{yt.load().then(()=>{var Zt;HTMLCanvasElement.prototype.getContext=(Zt=HTMLCanvasElement.prototype.getContext,function(Xr,ur){return(ur=ur||{}).preserveDrawingBuffer=!0,Zt.call(this,Xr,ur)}),P(7,tt=new google.maps.Map(document.getElementById(q),{center:_t.center,zoom:_t.zoom,mapId:V,disableDefaultUI:!0,isFractionalZoomEnabled:!0,fullscreenControl:!1,zoomControl:!1}));const dr=Df(()=>{document.getElementById(q).querySelector('div[tabindex="0"]').focus()},250);document.getElementById(q).addEventListener("wheel",dr,{passive:!0}),tt.addListener("center_changed",gt),tt.addListener("heading_changed",gt),tt.addListener("tilt_changed",gt),tt.addListener("zoom_changed",gt)});const gt=()=>{document.getElementById(q).contains(document.activeElement)&&rt()&&it("mapMove",{options:Bt()})}}),C.$$set=gt=>{"id"in gt&&P(0,q=gt.id),"bearing"in gt&&P(1,K=gt.bearing),"center"in gt&&P(2,ae=gt.center),"pitch"in gt&&P(3,Y=gt.pitch),"zoom"in gt&&P(4,ie=gt.zoom),"mapStyle"in gt&&P(5,be=gt.mapStyle),"numberOfMaps"in gt&&P(6,ze=gt.numberOfMaps)},C.$$.update=()=>{if(32&C.$$.dirty&&(V=be==null?void 0:be.mapId),30&C.$$.dirty&&P(8,_t={bearing:K,center:ae,pitch:Y,zoom:ie}),384&C.$$.dirty&&((gt,Zt)=>{gt&&rt()&&gt.moveCamera({center:{lat:ae.lat,lng:ae.lng},zoom:ie+1,heading:K,tilt:Y})})(tt),193&C.$$.dirty&&tt&&ze){const gt=document.getElementById(q);gt&&new ResizeObserver(()=>{google.maps.event.trigger(tt,"resize")}).observe(gt)}},[q,K,ae,Y,ie,be,ze,tt,_t]}class yx extends us{constructor(E){super(),cs(this,E,gx,mx,Ua,{id:0,bearing:1,center:2,pitch:3,zoom:4,mapStyle:5,numberOfMaps:6})}}function _x(C){let E;return{c(){E=wr("div"),Dt(E,"id",C[0]),Dt(E,"class","map svelte-18031t1")},m(P,V){Di(P,E,V)},p(P,[V]){1&V&&Dt(E,"id",P[0])},i:zo,o:zo,d(P){P&&Ci(E)}}}function vx(C,E,P){let V;hu(C,gp,_r=>P(17,V=_r));let o,{id:q}=E,{bearing:K}=E,{center:ae}=E,{pitch:Y}=E,{showCollisions:ie}=E,{showBoundaries:be}=E,{zoom:ze}=E,{mapStyle:it}=E,{numberOfMaps:tt}=E,{mapType:_t}=E;const yt=fc();let Bt,rt,It={},gt=null,Zt=!1,dr={};const Xr=()=>({bearing:rt.getBearing(),center:rt.getCenter(),pitch:rt.getPitch(),zoom:rt.getZoom()}),ur=(_r,Rr)=>{_r&&!t_(Xr(),dr)&&_r.jumpTo(Rr)};return Fd(async()=>{await(async()=>{_t==="maplibre-gl"?(await Promise.resolve().then(function(){return L1}),o=await Promise.resolve().then(function(){return E_})):(await Promise.resolve().then(function(){return z1}),o=await Promise.resolve().then(function(){return C_}),o.accessToken=V.mapboxGlAccessToken)})();const _r=o;P(12,rt=new _r.Map({container:q,style:Bt,preserveDrawingBuffer:!0,...dr}));const Rr=Df(()=>{document.getElementById(q).querySelector('canvas[tabindex="0"]').focus()},250);document.getElementById(q).addEventListener("wheel",Rr,{passive:!0}),rt.on("move",ei=>{ei!=null&&ei.resize||(({origin:rr})=>{var kt;(kt=document.getElementById(q))!=null&&kt.contains(document.activeElement)&&yt("mapMove",{options:Xr()})})(ei)}),rt.on("click",ei=>{let rr=rt.queryRenderedFeatures(ei.point);rr.length&&(Zt?(gt.remove(),gt=null):(gt=new _r.Popup().setLngLat(ei.lngLat).setHTML((kt=>{const Rt=kt.reduce((Or,Kr)=>{const{source:di,sourceLayer:ri,properties:ii}=Kr;return Or.some(ki=>{const kn=ki.source===di&&ki.sourceLayer===ri,Zi=Object.keys(ii).every(Bn=>ii[Bn]===ki.properties[Bn]);return kn&&Zi})||Or.push(Kr),Or},[]);let br='<div class="popup">';for(const Or of Rt){const{properties:Kr}=Or;br+=`<h2 class="popup-source-layer">${Or.source}: ${Or.sourceLayer}</h2>`,Kr&&Object.keys(Kr).length?Object.keys(Kr).sort().forEach(di=>{const ri=Kr[di];br+=`<p class="popup-property"><span class="popup-property-id">${di}:</span> <span class="popup-property-value">${ri}</span></p>`}):br+='<p class="popup-no-properties">No properties</p>'}return br+="</div>",br})(rr)).setMaxWidth(360).addTo(rt),Zt=!0,gt.on("close",()=>{Zt=!1})))})}),Wg(()=>{rt&&rt.remove()}),C.$$set=_r=>{"id"in _r&&P(0,q=_r.id),"bearing"in _r&&P(1,K=_r.bearing),"center"in _r&&P(2,ae=_r.center),"pitch"in _r&&P(3,Y=_r.pitch),"showCollisions"in _r&&P(4,ie=_r.showCollisions),"showBoundaries"in _r&&P(5,be=_r.showBoundaries),"zoom"in _r&&P(6,ze=_r.zoom),"mapStyle"in _r&&P(7,it=_r.mapStyle),"numberOfMaps"in _r&&P(8,tt=_r.numberOfMaps),"mapType"in _r&&P(9,_t=_r.mapType)},C.$$.update=()=>{128&C.$$.dirty&&P(10,{style:It,url:Bt}=it,It,(P(11,Bt),P(7,it))),78&C.$$.dirty&&P(13,dr={bearing:K,center:ae,pitch:Y,zoom:ze}),4112&C.$$.dirty&&rt&&P(12,rt.showCollisionBoxes=ie,rt),4128&C.$$.dirty&&rt&&P(12,rt.showTileBoundaries=be,rt),12288&C.$$.dirty&&ur(rt,dr),7168&C.$$.dirty&&((_r,Rr,ei)=>{_r&&_r.setStyle(Rr||ei)})(rt,Bt,It),4353&C.$$.dirty&&rt&&tt&&rt.once("render",()=>{const _r=document.getElementById(q);_r&&new ResizeObserver(()=>{rt.resize({resize:!0})}).observe(_r)})},[q,K,ae,Y,ie,be,ze,it,tt,_t,It,Bt,rt,dr]}class xx extends us{constructor(E){super(),cs(this,E,vx,_x,Ua,{id:0,bearing:1,center:2,pitch:3,showCollisions:4,showBoundaries:5,zoom:6,mapStyle:7,numberOfMaps:8,mapType:9})}}/*!
 * Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2022 Fonticons, Inc.
 */var wx={prefix:"fas",iconName:"camera",icon:[512,512,[62258,"camera-alt"],"f030","M194.6 32H317.4C338.1 32 356.4 45.22 362.9 64.82L373.3 96H448C483.3 96 512 124.7 512 160V416C512 451.3 483.3 480 448 480H64C28.65 480 0 451.3 0 416V160C0 124.7 28.65 96 64 96H138.7L149.1 64.82C155.6 45.22 173.9 32 194.6 32H194.6zM256 384C309 384 352 341 352 288C352 234.1 309 192 256 192C202.1 192 160 234.1 160 288C160 341 202.1 384 256 384z"]},bx={prefix:"fas",iconName:"compress",icon:[448,512,[],"f066","M128 320H32c-17.69 0-32 14.31-32 32s14.31 32 32 32h64v64c0 17.69 14.31 32 32 32s32-14.31 32-32v-96C160 334.3 145.7 320 128 320zM416 320h-96c-17.69 0-32 14.31-32 32v96c0 17.69 14.31 32 32 32s32-14.31 32-32v-64h64c17.69 0 32-14.31 32-32S433.7 320 416 320zM320 192h96c17.69 0 32-14.31 32-32s-14.31-32-32-32h-64V64c0-17.69-14.31-32-32-32s-32 14.31-32 32v96C288 177.7 302.3 192 320 192zM128 32C110.3 32 96 46.31 96 64v64H32C14.31 128 0 142.3 0 160s14.31 32 32 32h96c17.69 0 32-14.31 32-32V64C160 46.31 145.7 32 128 32z"]},Bx={prefix:"fas",iconName:"expand",icon:[448,512,[],"f065","M128 32H32C14.31 32 0 46.31 0 64v96c0 17.69 14.31 32 32 32s32-14.31 32-32V96h64c17.69 0 32-14.31 32-32S145.7 32 128 32zM416 32h-96c-17.69 0-32 14.31-32 32s14.31 32 32 32h64v64c0 17.69 14.31 32 32 32s32-14.31 32-32V64C448 46.31 433.7 32 416 32zM128 416H64v-64c0-17.69-14.31-32-32-32s-32 14.31-32 32v96c0 17.69 14.31 32 32 32h96c17.69 0 32-14.31 32-32S145.7 416 128 416zM416 320c-17.69 0-32 14.31-32 32v64h-64c-17.69 0-32 14.31-32 32s14.31 32 32 32h96c17.69 0 32-14.31 32-32v-96C448 334.3 433.7 320 416 320z"]},Ag={prefix:"fas",iconName:"link",icon:[640,512,[128279,"chain"],"f0c1","M172.5 131.1C228.1 75.51 320.5 75.51 376.1 131.1C426.1 181.1 433.5 260.8 392.4 318.3L391.3 319.9C381 334.2 361 337.6 346.7 327.3C332.3 317 328.9 297 339.2 282.7L340.3 281.1C363.2 249 359.6 205.1 331.7 177.2C300.3 145.8 249.2 145.8 217.7 177.2L105.5 289.5C73.99 320.1 73.99 372 105.5 403.5C133.3 431.4 177.3 435 209.3 412.1L210.9 410.1C225.3 400.7 245.3 404 255.5 418.4C265.8 432.8 262.5 452.8 248.1 463.1L246.5 464.2C188.1 505.3 110.2 498.7 60.21 448.8C3.741 392.3 3.741 300.7 60.21 244.3L172.5 131.1zM467.5 380C411 436.5 319.5 436.5 263 380C213 330 206.5 251.2 247.6 193.7L248.7 192.1C258.1 177.8 278.1 174.4 293.3 184.7C307.7 194.1 311.1 214.1 300.8 229.3L299.7 230.9C276.8 262.1 280.4 306.9 308.3 334.8C339.7 366.2 390.8 366.2 422.3 334.8L534.5 222.5C566 191 566 139.1 534.5 108.5C506.7 80.63 462.7 76.99 430.7 99.9L429.1 101C414.7 111.3 394.7 107.1 384.5 93.58C374.2 79.2 377.5 59.21 391.9 48.94L393.5 47.82C451 6.731 529.8 13.25 579.8 63.24C636.3 119.7 636.3 211.3 579.8 267.7L467.5 380z"]},cg={prefix:"fas",iconName:"link-slash",icon:[640,512,["chain-broken","chain-slash","unlink"],"f127","M185.7 120.3C242.5 75.82 324.7 79.73 376.1 131.1C420.1 175.1 430.9 239.6 406.7 293.5L438.6 318.4L534.5 222.5C566 191 566 139.1 534.5 108.5C506.7 80.63 462.7 76.1 430.7 99.9L429.1 101C414.7 111.3 394.7 107.1 384.5 93.58C374.2 79.2 377.5 59.21 391.9 48.94L393.5 47.82C451 6.732 529.8 13.25 579.8 63.24C636.3 119.7 636.3 211.3 579.8 267.7L489.3 358.2L630.8 469.1C641.2 477.3 643.1 492.4 634.9 502.8C626.7 513.2 611.6 515.1 601.2 506.9L9.196 42.89C-1.236 34.71-3.065 19.63 5.112 9.196C13.29-1.236 28.37-3.065 38.81 5.112L185.7 120.3zM238.1 161.1L353.4 251.7C359.3 225.5 351.7 197.2 331.7 177.2C306.6 152.1 269.1 147 238.1 161.1V161.1zM263 380C233.1 350.1 218.7 309.8 220.9 270L406.6 416.4C357.4 431 301.9 418.9 263 380V380zM116.6 187.9L167.2 227.8L105.5 289.5C73.99 320.1 73.99 372 105.5 403.5C133.3 431.4 177.3 435 209.3 412.1L210.9 410.1C225.3 400.7 245.3 404 255.5 418.4C265.8 432.8 262.5 452.8 248.1 463.1L246.5 464.2C188.1 505.3 110.2 498.7 60.21 448.8C3.741 392.3 3.741 300.7 60.21 244.3L116.6 187.9z"]},Cx={prefix:"fas",iconName:"plus",icon:[448,512,[10133,61543,"add"],"2b","M432 256c0 17.69-14.33 32.01-32 32.01H256v144c0 17.69-14.33 31.99-32 31.99s-32-14.3-32-31.99v-144H48c-17.67 0-32-14.32-32-32.01s14.33-31.99 32-31.99H192v-144c0-17.69 14.33-32.01 32-32.01s32 14.32 32 32.01v144h144C417.7 224 432 238.3 432 256z"]},Ex={prefix:"fas",iconName:"xmark",icon:[320,512,[128473,10005,10006,10060,215,"close","multiply","remove","times"],"f00d","M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"]};const ud=parseFloat;function hd(C,E=";"){let P;if(Array.isArray(C))P=C.filter(V=>V);else{P=[];for(const V in C)C[V]&&P.push(`${V}:${C[V]}`)}return P.join(E)}function ug(C){let E,P,V,o,q,K,ae;function Y(ze,it){return typeof ze[7][4]=="string"?Sx:Ix}let ie=Y(C),be=ie(C);return{c(){E=Ap("svg"),P=Ap("g"),V=Ap("g"),be.c(),Dt(V,"transform",C[10]),Dt(P,"transform",o=`translate(${C[7][0]/2} ${C[7][1]/2})`),Dt(P,"transform-origin",q=C[7][0]/4+" 0"),Dt(E,"id",C[0]),Dt(E,"class",K=$u(C[8])+" svelte-1cj2gr0"),Dt(E,"style",C[9]),Dt(E,"viewBox",ae=`0 0 ${C[7][0]} ${C[7][1]}`),Dt(E,"aria-hidden","true"),Dt(E,"role","img"),Dt(E,"xmlns","http://www.w3.org/2000/svg")},m(ze,it){Di(ze,E,it),ar(E,P),ar(P,V),be.m(V,null)},p(ze,it){ie===(ie=Y(ze))&&be?be.p(ze,it):(be.d(1),be=ie(ze),be&&(be.c(),be.m(V,null))),1024&it&&Dt(V,"transform",ze[10]),128&it&&o!==(o=`translate(${ze[7][0]/2} ${ze[7][1]/2})`)&&Dt(P,"transform",o),128&it&&q!==(q=ze[7][0]/4+" 0")&&Dt(P,"transform-origin",q),1&it&&Dt(E,"id",ze[0]),256&it&&K!==(K=$u(ze[8])+" svelte-1cj2gr0")&&Dt(E,"class",K),512&it&&Dt(E,"style",ze[9]),128&it&&ae!==(ae=`0 0 ${ze[7][0]} ${ze[7][1]}`)&&Dt(E,"viewBox",ae)},d(ze){ze&&Ci(E),be.d()}}}function Ix(C){let E,P,V,o,q,K,ae,Y,ie,be;return{c(){E=Ap("path"),K=Ap("path"),Dt(E,"d",P=C[7][4][0]),Dt(E,"fill",V=C[3]||C[1]||"currentColor"),Dt(E,"fill-opacity",o=C[6]!=0?C[4]:C[5]),Dt(E,"transform",q=`translate(${C[7][0]/-2} ${C[7][1]/-2})`),Dt(K,"d",ae=C[7][4][1]),Dt(K,"fill",Y=C[2]||C[1]||"currentColor"),Dt(K,"fill-opacity",ie=C[6]!=0?C[5]:C[4]),Dt(K,"transform",be=`translate(${C[7][0]/-2} ${C[7][1]/-2})`)},m(ze,it){Di(ze,E,it),Di(ze,K,it)},p(ze,it){128&it&&P!==(P=ze[7][4][0])&&Dt(E,"d",P),10&it&&V!==(V=ze[3]||ze[1]||"currentColor")&&Dt(E,"fill",V),112&it&&o!==(o=ze[6]!=0?ze[4]:ze[5])&&Dt(E,"fill-opacity",o),128&it&&q!==(q=`translate(${ze[7][0]/-2} ${ze[7][1]/-2})`)&&Dt(E,"transform",q),128&it&&ae!==(ae=ze[7][4][1])&&Dt(K,"d",ae),6&it&&Y!==(Y=ze[2]||ze[1]||"currentColor")&&Dt(K,"fill",Y),112&it&&ie!==(ie=ze[6]!=0?ze[5]:ze[4])&&Dt(K,"fill-opacity",ie),128&it&&be!==(be=`translate(${ze[7][0]/-2} ${ze[7][1]/-2})`)&&Dt(K,"transform",be)},d(ze){ze&&Ci(E),ze&&Ci(K)}}}function Sx(C){let E,P,V,o;return{c(){E=Ap("path"),Dt(E,"d",P=C[7][4]),Dt(E,"fill",V=C[1]||C[2]||"currentColor"),Dt(E,"transform",o=`translate(${C[7][0]/-2} ${C[7][1]/-2})`)},m(q,K){Di(q,E,K)},p(q,K){128&K&&P!==(P=q[7][4])&&Dt(E,"d",P),6&K&&V!==(V=q[1]||q[2]||"currentColor")&&Dt(E,"fill",V),128&K&&o!==(o=`translate(${q[7][0]/-2} ${q[7][1]/-2})`)&&Dt(E,"transform",o)},d(q){q&&Ci(E)}}}function Tx(C){let E,P=C[7][4]&&ug(C);return{c(){P&&P.c(),E=fp()},m(V,o){P&&P.m(V,o),Di(V,E,o)},p(V,[o]){V[7][4]?P?P.p(V,o):(P=ug(V),P.c(),P.m(E.parentNode,E)):P&&(P.d(1),P=null)},i:zo,o:zo,d(V){P&&P.d(V),V&&Ci(E)}}}function Fx(C,E,P){let V,o,q,K,{class:ae=""}=E,{id:Y=""}=E,{style:ie=""}=E,{icon:be}=E,{size:ze=""}=E,{color:it=""}=E,{fw:tt=!1}=E,{pull:_t=""}=E,{scale:yt=1}=E,{translateX:Bt=0}=E,{translateY:rt=0}=E,{rotate:It=""}=E,{flip:gt=!1}=E,{spin:Zt=!1}=E,{pulse:dr=!1}=E,{primaryColor:Xr=""}=E,{secondaryColor:ur=""}=E,{primaryOpacity:_r=1}=E,{secondaryOpacity:Rr=.4}=E,{swapOpacity:ei=!1}=E;return C.$$set=rr=>{"class"in rr&&P(11,ae=rr.class),"id"in rr&&P(0,Y=rr.id),"style"in rr&&P(12,ie=rr.style),"icon"in rr&&P(13,be=rr.icon),"size"in rr&&P(14,ze=rr.size),"color"in rr&&P(1,it=rr.color),"fw"in rr&&P(15,tt=rr.fw),"pull"in rr&&P(16,_t=rr.pull),"scale"in rr&&P(17,yt=rr.scale),"translateX"in rr&&P(18,Bt=rr.translateX),"translateY"in rr&&P(19,rt=rr.translateY),"rotate"in rr&&P(20,It=rr.rotate),"flip"in rr&&P(21,gt=rr.flip),"spin"in rr&&P(22,Zt=rr.spin),"pulse"in rr&&P(23,dr=rr.pulse),"primaryColor"in rr&&P(2,Xr=rr.primaryColor),"secondaryColor"in rr&&P(3,ur=rr.secondaryColor),"primaryOpacity"in rr&&P(4,_r=rr.primaryOpacity),"secondaryOpacity"in rr&&P(5,Rr=rr.secondaryOpacity),"swapOpacity"in rr&&P(6,ei=rr.swapOpacity)},C.$$.update=()=>{8192&C.$$.dirty&&P(7,V=be&&be.icon||[0,0,"",[],""]),12584960&C.$$.dirty&&P(8,o=hd([ae,"svelte-fa",Zt&&"spin",dr&&"pulse"]," ")),118784&C.$$.dirty&&P(9,q=function(rr,kt,Rt,br){let Or,Kr,di,ri,ii,ki="-.125em";return br&&(ii="center",Kr="1.25em"),Rt&&(Or=Rt),kt&&(kt=="lg"?(ri="1.33333em",di=".75em",ki="-.225em"):ri=kt=="xs"?".75em":kt=="sm"?".875em":kt.replace("x","em")),hd([hd({float:Or,width:Kr,height:"1em","line-height":di,"font-size":ri,"text-align":ii,"vertical-align":ki,"transform-origin":"center",overflow:"visible"}),rr])}(ie,ze,_t,tt)),4063232&C.$$.dirty&&P(10,K=function(rr,kt,Rt,br,Or,Kr=1,di="",ri=""){let ii=1,ki=1;return Or&&(Or=="horizontal"?ii=-1:Or=="vertical"?ki=-1:ii=ki=-1),hd([`translate(${ud(kt)*Kr}${di},${ud(Rt)*Kr}${di})`,`scale(${ii*ud(rr)},${ki*ud(rr)})`,br&&`rotate(${br}${ri})`]," ")}(yt,Bt,rt,It,gt,512))},[Y,it,Xr,ur,_r,Rr,ei,V,o,q,K,ae,ie,be,ze,tt,_t,yt,Bt,rt,It,gt,Zt,dr]}var lp=class extends us{constructor(C){super(),cs(this,C,Fx,Tx,Ua,{class:11,id:0,style:12,icon:13,size:14,color:1,fw:15,pull:16,scale:17,translateX:18,translateY:19,rotate:20,flip:21,spin:22,pulse:23,primaryColor:2,secondaryColor:3,primaryOpacity:4,secondaryOpacity:5,swapOpacity:6})}},r_={exports:{}},Uf=r_.exports=function(C,E){if(E||(E=16),C===void 0&&(C=128),C<=0)return"0";for(var P=Math.log(Math.pow(2,C))/Math.log(E),V=2;P===1/0;V*=2)P=Math.log(Math.pow(2,C/V))/Math.log(E)*V;var o=P-Math.floor(P),q="";for(V=0;V<Math.floor(P);V++)q=Math.floor(Math.random()*E).toString(E)+q;if(o){var K=Math.pow(E,o);q=Math.floor(Math.random()*K).toString(E)+q}var ae=parseInt(q,E);return ae!==1/0&&ae>=Math.pow(2,C)?Uf(C,E):q};Uf.rack=function(C,E,P){var V=function(q){var K=0;do{if(K++>10){if(!P)throw new Error("too many ID collisions, use more bits");C+=P}var ae=Uf(C,E)}while(Object.hasOwnProperty.call(o,ae));return o[ae]=q,ae},o=V.hats={};return V.get=function(q){return V.hats[q]},V.set=function(q,K){return V.hats[q]=K,V},V.bits=C||128,V.base=E||16,V};var pf=r_.exports;const i_=(C,E,P)=>C.replace("{branch}",E).replace("{style}",P),kd=(C,E)=>{let P;const V=()=>window.removeEventListener("keydown",P),o=()=>{V(),E&&(P=q=>{!!E.alt==q.altKey&&!!E.shift==q.shiftKey&&!!E.control==(q.ctrlKey||q.metaKey)&&E.code==q.code&&(q.preventDefault(),E.callback?E.callback():C.click())},window.addEventListener("keydown",P))};return o(),{update:o,destroy:V}};let n_;gp.subscribe(C=>({mapboxGlAccessToken:n_}=C));function hg(C,E,P){const V=C.slice();return V[21]=E[P],V}function pg(C,E,P){const V=C.slice();return V[24]=E[P],V}function dg(C){let E,P,V,o,q=C[24].text+"";return{c(){E=wr("option"),P=dl(q),E.__value=V=C[24].dropdownId,E.value=E.__value,E.selected=o=C[1].dropdownId===C[24].dropdownId},m(K,ae){Di(K,E,ae),ar(E,P)},p(K,ae){1&ae&&q!==(q=K[24].text+"")&&qu(P,q),1&ae&&V!==(V=K[24].dropdownId)&&(E.__value=V,E.value=E.__value),3&ae&&o!==(o=K[1].dropdownId===K[24].dropdownId)&&(E.selected=o)},d(K){K&&Ci(E)}}}function fg(C){let E,P,V,o=C[0][C[21]],q=[];for(let K=0;K<o.length;K+=1)q[K]=dg(pg(C,o,K));return{c(){E=wr("optgroup");for(let K=0;K<q.length;K+=1)q[K].c();Dt(E,"value",P=C[21]),Dt(E,"label",V=C[21])},m(K,ae){Di(K,E,ae);for(let Y=0;Y<q.length;Y+=1)q[Y].m(E,null)},p(K,ae){if(3&ae){let Y;for(o=K[0][K[21]],Y=0;Y<o.length;Y+=1){const ie=pg(K,o,Y);q[Y]?q[Y].p(ie,ae):(q[Y]=dg(ie),q[Y].c(),q[Y].m(E,null))}for(;Y<q.length;Y+=1)q[Y].d(1);q.length=o.length}1&ae&&P!==(P=K[21])&&Dt(E,"value",P),1&ae&&V!==(V=K[21])&&Dt(E,"label",V)},d(K){K&&Ci(E),Vc(q,K)}}}function mg(C){let E,P,V,o,q,K,ae,Y,ie;return{c(){var be;E=wr("div"),P=wr("input"),o=to(),q=wr("button"),K=dl("Submit"),Dt(P,"placeholder",V=C[3].dropdownType==="branch"?"enter a branch name":"enter a url to a style"),Dt(P,"class","svelte-1qgw420"),vd(P,"input-error",C[4]),q.disabled=ae=((be=C[3])==null?void 0:be.url)===C[2],Dt(E,"class","custom-input svelte-1qgw420")},m(be,ze){Di(be,E,ze),ar(E,P),Ku(P,C[2]),ar(E,o),ar(E,q),ar(q,K),Y||(ie=[gn(P,"input",C[12]),gn(P,"focus",C[8]),gn(P,"blur",C[9]),Np(kd.call(null,q,{code:"Enter",callback:C[7]})),gn(q,"click",C[6])],Y=!0)},p(be,ze){var it;8&ze&&V!==(V=be[3].dropdownType==="branch"?"enter a branch name":"enter a url to a style")&&Dt(P,"placeholder",V),4&ze&&P.value!==be[2]&&Ku(P,be[2]),16&ze&&vd(P,"input-error",be[4]),12&ze&&ae!==(ae=((it=be[3])==null?void 0:it.url)===be[2])&&(q.disabled=ae)},d(be){be&&Ci(E),Y=!1,VA(ie)}}}function gg(C){let E,P;return{c(){E=wr("div"),P=dl(C[4]),Dt(E,"class","error-message svelte-1qgw420")},m(V,o){Di(V,E,o),ar(E,P)},p(V,o){16&o&&qu(P,V[4])},d(V){V&&Ci(E)}}}function Ux(C){var ze,it;let E,P,V,o,q,K,ae=Object.keys(C[0]),Y=[];for(let tt=0;tt<ae.length;tt+=1)Y[tt]=fg(hg(C,ae,tt));let ie=(((ze=C[3])==null?void 0:ze.dropdownType)==="custom"||((it=C[3])==null?void 0:it.dropdownType)==="branch")&&mg(C),be=!!C[4]&&gg(C);return{c(){E=wr("div"),P=wr("select");for(let tt=0;tt<Y.length;tt+=1)Y[tt].c();V=to(),ie&&ie.c(),o=to(),be&&be.c(),Dt(P,"id","styles"),Dt(E,"class","map-style-input svelte-1qgw420")},m(tt,_t){Di(tt,E,_t),ar(E,P);for(let yt=0;yt<Y.length;yt+=1)Y[yt].m(P,null);ar(E,V),ie&&ie.m(E,null),ar(E,o),be&&be.m(E,null),q||(K=gn(P,"change",C[11]),q=!0)},p(tt,[_t]){var yt,Bt;if(3&_t){let rt;for(ae=Object.keys(tt[0]),rt=0;rt<ae.length;rt+=1){const It=hg(tt,ae,rt);Y[rt]?Y[rt].p(It,_t):(Y[rt]=fg(It),Y[rt].c(),Y[rt].m(P,null))}for(;rt<Y.length;rt+=1)Y[rt].d(1);Y.length=ae.length}((yt=tt[3])==null?void 0:yt.dropdownType)==="custom"||((Bt=tt[3])==null?void 0:Bt.dropdownType)==="branch"?ie?ie.p(tt,_t):(ie=mg(tt),ie.c(),ie.m(E,o)):ie&&(ie.d(1),ie=null),tt[4]?be?be.p(tt,_t):(be=gg(tt),be.c(),be.m(E,null)):be&&(be.d(1),be=null)},i:zo,o:zo,d(tt){tt&&Ci(E),Vc(Y,tt),ie&&ie.d(),be&&be.d(),q=!1,K()}}}function Mx(C,E,P){const V=fc();let o,q,{dropdownDisplayOptions:K}=E,{dropdownValue:ae}=E,{activeUrl:Y}=E,ie=!1,be=null,ze=!0;Wg(()=>{ze=!1}),Fd(()=>{P(3,o=ae),P(2,q=o.defaultText),it(o.url)});const it=rt=>{const It=gt=>{if(!ze||!gt||Y!==gt)return!1;const Zt=new RegExp("^(?:[a-z+]+:)?//","i");return gt.includes("localhost")||!Zt.test(gt)};It(rt)&&setTimeout(()=>It(rt)&&_t(rt),3e3)},tt=rt=>{const It=["dropdownType","selected"];let gt={...Object.fromEntries(Object.entries(rt).filter(([Zt,dr])=>!It.includes(Zt)))};o.dropdownType==="branch"&&(gt.branch=q),rt.style&&(gt.id=rt.style.id,gt.name=rt.style.name),V("updateMapStore",{value:gt})},_t=async rt=>{let It;try{const gt=await(async Zt=>{const dr=(Rr=>typeof Rr=="string"&&Rr.startsWith("mapbox://styles/")&&Rr.split("/").length===5)(Zt);let Xr,ur=Zt;if(dr){const[,,,Rr,ei]=ur.split("/");ur=`https://api.mapbox.com/styles/v1/${Rr}/${ei}?title=true&access_token=${n_}`}try{Xr=await fetch(ur)}catch(Rr){throw{message:Rr.message}}if(!Xr.ok)throw{status:Xr.status,message:Xr.statusText};const _r=await Xr.json();if(dr&&_r.message)throw{message:_r.message};return _r})(rt);if(gt&&typeof gt=="object")return It=gt,it(rt),tt({...o,style:It,url:rt}),{status:"200"}}catch(gt){const{status:Zt,message:dr}=gt;return P(4,be=new Error(dr)),{status:Zt}}},yt=async rt=>{const{status:It}=await _t(rt);It==="200"&&(P(3,o.url=rt,o),it(rt))},Bt=async()=>{const{dropdownType:rt,pattern:It}=o;let gt=rt==="branch"?i_(It,q,o.id):q;if((o==null?void 0:o.url)!==gt){if(gt.includes("localhost")){const[Zt,dr]=gt.split("localhost");Zt||(gt=`http://localhost${dr}`)}yt(gt)}};return C.$$set=rt=>{"dropdownDisplayOptions"in rt&&P(0,K=rt.dropdownDisplayOptions),"dropdownValue"in rt&&P(1,ae=rt.dropdownValue),"activeUrl"in rt&&P(10,Y=rt.activeUrl)},C.$$.update=()=>{4&C.$$.dirty&&(rt=>{be&&rt!==void 0&&P(4,be=null)})(q),2&C.$$.dirty&&(()=>{if(Object.entries(ae).every(gt=>{const[Zt,dr]=gt;return Zt==="url"||!(!o||o[Zt]!==dr)||void 0}))return;const rt=o==null?void 0:o.dropdownType;P(3,o=ae),P(4,be=null);const{dropdownType:It}=o;switch(It){case"preset":{const{type:gt,url:Zt}=o;if(gt==="google"){tt(o);break}yt(Zt);break}case"branch":q&&rt==="branch"&&Bt()}P(2,q=o.defaultText)})()},[K,ae,q,o,be,V,Bt,()=>{ie&&Bt()},()=>{ie=!0},()=>{ie=!1,be&&P(2,q=o.defaultText)},Y,rt=>V("selectOption",{dropdownId:rt.target.value}),function(){q=this.value,P(2,q)}]}class kx extends us{constructor(E){super(),cs(this,E,Mx,Ux,Ua,{dropdownDisplayOptions:0,dropdownValue:1,activeUrl:10})}}function yg(C){let E,P;return E=new kx({props:{dropdownValue:C[3],dropdownDisplayOptions:C[1],activeUrl:C[0]}}),E.$on("selectOption",C[4]),E.$on("updateMapStore",C[5]),{c(){qo(E.$$.fragment)},m(V,o){Do(E,V,o),P=!0},p(V,o){const q={};8&o&&(q.dropdownValue=V[3]),2&o&&(q.dropdownDisplayOptions=V[1]),1&o&&(q.activeUrl=V[0]),E.$set(q)},i(V){P||(ti(E.$$.fragment,V),P=!0)},o(V){xi(E.$$.fragment,V),P=!1},d(V){Lo(E,V)}}}function Px(C){let E,P,V=C[2]&&yg(C);return{c(){E=wr("div"),V&&V.c(),Dt(E,"class","map-style-input svelte-bemu0l")},m(o,q){Di(o,E,q),V&&V.m(E,null),P=!0},p(o,[q]){o[2]?V?(V.p(o,q),4&q&&ti(V,1)):(V=yg(o),V.c(),ti(V,1),V.m(E,null)):V&&(Ul(),xi(V,1,1,()=>{V=null}),Ml())},i(o){P||(ti(V),P=!0)},o(o){xi(V),P=!1},d(o){o&&Ci(E),V&&V.d()}}}function Qx(C,E,P){let V,o,q,K,{index:ae}=E;gp.subscribe(tt=>({branchPatterns:V}=tt)),ju.subscribe(tt=>{o=tt.find(_t=>_t.index===ae),o&&(K=o.branch,P(0,q=o.url))});let Y,ie={},be=[];const ze=()=>{let tt=be.find(_t=>!!_t.selected);switch(tt=JSON.parse(JSON.stringify(tt)),tt.dropdownType){case"preset":tt={...tt,defaultText:""};break;case"branch":tt={...tt,defaultText:K!=null?K:""};break;case"custom":tt={...tt,defaultText:q,url:q}}P(3,Y=tt)},it=tt=>{(_t=>{var Bt;if(P(1,ie={}),P(2,be=[]),_t.length){const rt=_t.map(It=>({...It,dropdownType:"preset",selected:q===(It==null?void 0:It.url)&&o.type===(It==null?void 0:It.type),dropdownId:pf()}));P(2,be=be.concat(rt)),P(1,ie.Presets=rt.map(It=>({text:It.name,dropdownId:It.dropdownId})),ie)}if(V){for(const rt of V)if((Bt=rt==null?void 0:rt.styles)!=null&&Bt.length){const It=rt==null?void 0:rt.styles.map(gt=>({name:`${gt.charAt(0).toUpperCase()+gt.slice(1)} on...`,id:gt,type:rt.type,dropdownType:"branch",selected:!(!K||i_(rt.pattern,K,gt)!==q||rt.type!==o.type),pattern:rt.pattern,dropdownId:pf()}));P(2,be=be.concat(It)),P(1,ie["Styles on a branch"+(rt.name?`: ${rt.name}`:"")]=It.map(gt=>({text:gt.name,dropdownId:gt.dropdownId})),ie)}}const yt=[{name:"Fetch URL at...",dropdownType:"custom",selected:!be.some(rt=>!!rt.selected),type:"mapbox-gl",dropdownId:pf()}];P(2,be=be.concat(yt)),P(1,ie.Custom=yt.map(rt=>({text:rt.name,dropdownId:rt.dropdownId})),ie)})(tt),ze()};return mf.subscribe(tt=>{it(tt)}),C.$$set=tt=>{"index"in tt&&P(6,ae=tt.index)},[q,ie,be,Y,tt=>{const{dropdownId:_t}=tt.detail;P(2,be=be.map(yt=>({...yt,selected:yt.dropdownId===_t}))),ze()},tt=>{const{value:_t}=tt.detail,yt={..._t,index:ae};delete yt.dropdownId,ju.update(Bt=>Bt.map((rt,It)=>It===ae?yt:rt))},ae]}class Dx extends us{constructor(E){super(),cs(this,E,Qx,Px,Ua,{index:6})}}function Lx(C){let E,P,V,o;const q=C[1].default,K=function(ae,Y,ie,be){if(ae){const ze=mm(ae,Y,ie,be);return ae[0](ze)}}(q,C,C[0],null);return{c(){E=wr("button"),K&&K.c(),Dt(E,"class","svelte-d9bm20")},m(ae,Y){Di(ae,E,Y),K&&K.m(E,null),P=!0,V||(o=gn(E,"click",C[2]),V=!0)},p(ae,[Y]){K&&K.p&&(!P||1&Y)&&function(ie,be,ze,it,tt,_t){if(tt){const yt=mm(be,ze,it,_t);ie.p(yt,tt)}}(K,q,ae,ae[0],P?function(ie,be,ze,it){if(ie[2]&&it){const tt=ie[2](it(ze));if(be.dirty===void 0)return tt;if(typeof tt=="object"){const _t=[],yt=Math.max(be.dirty.length,tt.length);for(let Bt=0;Bt<yt;Bt+=1)_t[Bt]=be.dirty[Bt]|tt[Bt];return _t}return be.dirty|tt}return be.dirty}(q,ae[0],Y,null):function(ie){if(ie.ctx.length>32){const be=[],ze=ie.ctx.length/32;for(let it=0;it<ze;it++)be[it]=-1;return be}return-1}(ae[0]),null)},i(ae){P||(ti(K,ae),P=!0)},o(ae){xi(K,ae),P=!1},d(ae){ae&&Ci(E),K&&K.d(ae),V=!1,o()}}}function zx(C,E,P){let{$$slots:V={},$$scope:o}=E;return C.$$set=q=>{"$$scope"in q&&P(0,o=q.$$scope)},[o,V,function(q){Tl.call(this,C,q)}]}class _g extends us{constructor(E){super(),cs(this,E,zx,Lx,Ua,{})}}function Rx(C){let E,P,V,o,q,K,ae,Y,ie,be,ze,it,tt;return ae=new _g({props:{$$slots:{default:[Hx]},$$scope:{ctx:C}}}),ae.$on("click",C[6]),be=new _g({props:{$$slots:{default:[Vx]},$$scope:{ctx:C}}}),be.$on("click",C[5]),{c(){E=wr("div"),P=wr("div"),V=dl(C[2]),o=to(),q=wr("div"),K=wr("div"),qo(ae.$$.fragment),Y=to(),ie=wr("div"),qo(be.$$.fragment),Dt(P,"class","map-state svelte-1nshzal"),Dt(K,"class","svelte-1nshzal"),Dt(ie,"class","svelte-1nshzal"),Dt(q,"class","location-actions svelte-1nshzal"),Dt(E,"class","map-state-container svelte-1nshzal")},m(_t,yt){Di(_t,E,yt),ar(E,P),ar(P,V),ar(E,o),ar(E,q),ar(q,K),Do(ae,K,null),ar(q,Y),ar(q,ie),Do(be,ie,null),ze=!0,it||(tt=gn(P,"click",C[5]),it=!0)},p(_t,yt){(!ze||4&yt)&&qu(V,_t[2]);const Bt={};1048576&yt&&(Bt.$$scope={dirty:yt,ctx:_t}),ae.$set(Bt);const rt={};1048577&yt&&(rt.$$scope={dirty:yt,ctx:_t}),be.$set(rt)},i(_t){ze||(ti(ae.$$.fragment,_t),ti(be.$$.fragment,_t),ze=!0)},o(_t){xi(ae.$$.fragment,_t),xi(be.$$.fragment,_t),ze=!1},d(_t){_t&&Ci(E),Lo(ae),Lo(be),it=!1,tt()}}}function Ox(C){let E,P,V,o,q;return{c(){E=wr("div"),P=wr("input"),V=wr("label"),V.textContent="enter zoom/lat/lng[/pitch/bearing]",cp(P,"height","18px"),Dt(P,"type","text"),Dt(V,"class","input-label svelte-1nshzal"),Dt(E,"class","state-record svelte-1nshzal")},m(K,ae){Di(K,E,ae),ar(E,P),Ku(P,C[3]),C[17](P),ar(E,V),o||(q=[gn(P,"input",C[15]),gn(P,"keydown",C[16]),gn(P,"focus",Kx)],o=!0)},p(K,ae){8&ae&&P.value!==K[3]&&Ku(P,K[3])},i:zo,o:zo,d(K){K&&Ci(E),C[17](null),o=!1,VA(q)}}}function Hx(C){let E;return{c(){E=dl("change")},m(P,V){Di(P,E,V)},d(P){P&&Ci(E)}}}function Vx(C){let E,P=C[0]?"copied":"copy";return{c(){E=dl(P)},m(V,o){Di(V,E,o)},p(V,o){1&o&&P!==(P=V[0]?"copied":"copy")&&qu(E,P)},d(V){V&&Ci(E)}}}function Nx(C){let E,P,V,o;const q=[Ox,Rx],K=[];function ae(Y,ie){return Y[1]?0:1}return P=ae(C),V=K[P]=q[P](C),{c(){E=wr("div"),V.c()},m(Y,ie){Di(Y,E,ie),K[P].m(E,null),o=!0},p(Y,[ie]){let be=P;P=ae(Y),P===be?K[P].p(Y,ie):(Ul(),xi(K[be],1,1,()=>{K[be]=null}),Ml(),V=K[P],V?V.p(Y,ie):(V=K[P]=q[P](Y),V.c()),ti(V,1),V.m(E,null))},i(Y){o||(ti(V),o=!0)},o(Y){xi(V),o=!1},d(Y){Y&&Ci(E),K[P].d()}}}const Kx=C=>C.target.select();function Gx(C,E,P){let V,o,{bearing:q}=E,{center:K}=E,{pitch:ae}=E,{zoom:Y}=E;const ie=fc();let be,ze=!1,it=!1,tt="",_t="";const yt=()=>{P(1,it=!1)},Bt=()=>{P(1,it=!1),P(0,ze=!1);const[rt,It,gt,Zt,dr]=_t.split("/"),Xr={mapStateUpdateOrigin:"controls"};rt!==void 0&&(Xr.zoom=+rt),It!==void 0&&gt!==void 0&&(Xr.center={lng:+gt,lat:+It}),Zt!==void 0&&(Xr.pitch=+Zt),dr!==void 0&&(Xr.bearing=+dr),ie("mapState",{options:Xr})};return C.$$set=rt=>{"bearing"in rt&&P(9,q=rt.bearing),"center"in rt&&P(10,K=rt.center),"pitch"in rt&&P(11,ae=rt.pitch),"zoom"in rt&&P(12,Y=rt.zoom)},C.$$.update=()=>{1024&C.$$.dirty&&P(14,V=K.lat),1024&C.$$.dirty&&P(13,o=K.lng),31232&C.$$.dirty&&((rt,It,gt,Zt,dr)=>{let Xr=[Fl(gt,2),Fl(rt,3),Fl(It,3)];(Zt||dr)&&(Xr.push(Fl(Zt,1)),Xr.push(Fl(dr,1))),P(2,tt=Xr.join("/")),P(0,ze=!1)})(V,o,Y,ae,q)},[ze,it,tt,_t,be,()=>{P(0,ze=!0),navigator.clipboard.writeText(tt)},async()=>{P(1,it=!0),P(3,_t=tt),await(Yg(),Jg),be.focus()},yt,Bt,q,K,ae,Y,o,V,function(){_t=this.value,P(3,_t)},rt=>{rt.key==="Enter"&&Bt(),rt.key==="Escape"&&yt()},function(rt){df[rt?"unshift":"push"](()=>{be=rt,P(4,be)})}]}class o_ extends us{constructor(E){super(),cs(this,E,Gx,Nx,Ua,{bearing:9,center:10,pitch:11,zoom:12})}}function vg(C){let E,P,V,o,q,K,ae,Y,ie,be,ze,it,tt,_t=!C[6]&&Object.keys(C[4]).length;V=new lp({props:{icon:Ex}}),ie=new Dx({props:{index:C[0]}});let yt=_t&&xg(C);return{c(){E=wr("div"),P=wr("button"),qo(V.$$.fragment),o=to(),q=wr("div"),K=dl(C[1]),ae=to(),Y=wr("div"),qo(ie.$$.fragment),be=to(),yt&&yt.c(),Dt(P,"class","close-button svelte-3ml0qt"),P.disabled=C[3],Dt(q,"class","map-name svelte-3ml0qt"),Dt(Y,"class","options-container svelte-3ml0qt"),Dt(E,"class","map-label svelte-3ml0qt")},m(Bt,rt){Di(Bt,E,rt),ar(E,P),Do(V,P,null),ar(E,o),ar(E,q),ar(q,K),ar(E,ae),ar(E,Y),Do(ie,Y,null),ar(Y,be),yt&&yt.m(Y,null),ze=!0,it||(tt=gn(P,"click",function(){Pf(C[2])&&C[2].apply(this,arguments)}),it=!0)},p(Bt,rt){C=Bt,(!ze||8&rt)&&(P.disabled=C[3]),(!ze||2&rt)&&qu(K,C[1]);const It={};1&rt&&(It.index=C[0]),ie.$set(It),80&rt&&(_t=!C[6]&&Object.keys(C[4]).length),_t?yt?(yt.p(C,rt),80&rt&&ti(yt,1)):(yt=xg(C),yt.c(),ti(yt,1),yt.m(Y,null)):yt&&(Ul(),xi(yt,1,1,()=>{yt=null}),Ml())},i(Bt){ze||(ti(V.$$.fragment,Bt),ti(ie.$$.fragment,Bt),ti(yt),ze=!0)},o(Bt){xi(V.$$.fragment,Bt),xi(ie.$$.fragment,Bt),xi(yt),ze=!1},d(Bt){Bt&&Ci(E),Lo(V),Lo(ie),yt&&yt.d(),it=!1,tt()}}}function xg(C){let E,P,V;const o=[C[4]];let q={};for(let K=0;K<o.length;K+=1)q=HA(q,o[K]);return P=new o_({props:q}),P.$on("mapState",C[8]),{c(){E=wr("div"),qo(P.$$.fragment),Dt(E,"class","location-control svelte-3ml0qt")},m(K,ae){Di(K,E,ae),Do(P,E,null),V=!0},p(K,ae){const Y=16&ae?du(o,[Hc(K[4])]):{};P.$set(Y)},i(K){V||(ti(P.$$.fragment,K),V=!0)},o(K){xi(P.$$.fragment,K),V=!1},d(K){K&&Ci(E),Lo(P)}}}function jx(C){let E,P,V=C[5]&&vg(C);return{c(){V&&V.c(),E=fp()},m(o,q){V&&V.m(o,q),Di(o,E,q),P=!0},p(o,[q]){o[5]?V?(V.p(o,q),32&q&&ti(V,1)):(V=vg(o),V.c(),ti(V,1),V.m(E.parentNode,E)):V&&(Ul(),xi(V,1,1,()=>{V=null}),Ml())},i(o){P||(ti(V),P=!0)},o(o){xi(V),P=!1},d(o){V&&V.d(o),o&&Ci(E)}}}function $x(C,E,P){let V,o,q,K;hu(C,gf,tt=>P(5,q=tt)),hu(C,pu,tt=>P(6,K=tt));let ae,{index:Y}=E,{name:ie}=E,{onClose:be}=E,{disableClose:ze}=E,{mapState:it}=E;return C.$$set=tt=>{"index"in tt&&P(0,Y=tt.index),"name"in tt&&P(1,ie=tt.name),"onClose"in tt&&P(2,be=tt.onClose),"disableClose"in tt&&P(3,ze=tt.disableClose),"mapState"in tt&&P(7,it=tt.mapState)},C.$$.update=()=>{128&C.$$.dirty&&P(4,{showBoundaries:V,showCollisions:o,...ae}=it,ae)},[Y,ie,be,ze,ae,q,K,it,function(tt){Tl.call(this,C,tt)}]}class qx extends us{constructor(E){super(),cs(this,E,$x,jx,Ua,{index:0,name:1,onClose:2,disableClose:3,mapState:7})}}const zp=["swipe","mirror","phone","responsive"],a_=(C,E)=>E.some(({type:P})=>P==="google")?C.zoom<12?35:45:60,Mf=(C,E)=>{const P={...C};if((V=>V.some(({type:o})=>o==="google"))(E)){const V=a_(C,E);P.pitch>V&&(P.pitch=V)}return P};var kf={exports:{}};(function(C,E){var P="__lodash_hash_undefined__",V=9007199254740991,o="[object Arguments]",q="[object Array]",K="[object Boolean]",ae="[object Date]",Y="[object Error]",ie="[object Function]",be="[object Map]",ze="[object Number]",it="[object Object]",tt="[object Promise]",_t="[object RegExp]",yt="[object Set]",Bt="[object String]",rt="[object Symbol]",It="[object WeakMap]",gt="[object ArrayBuffer]",Zt="[object DataView]",dr=/^\[object .+?Constructor\]$/,Xr=/^(?:0|[1-9]\d*)$/,ur={};ur["[object Float32Array]"]=ur["[object Float64Array]"]=ur["[object Int8Array]"]=ur["[object Int16Array]"]=ur["[object Int32Array]"]=ur["[object Uint8Array]"]=ur["[object Uint8ClampedArray]"]=ur["[object Uint16Array]"]=ur["[object Uint32Array]"]=!0,ur[o]=ur[q]=ur[gt]=ur[K]=ur[Zt]=ur[ae]=ur[Y]=ur[ie]=ur[be]=ur[ze]=ur[it]=ur[_t]=ur[yt]=ur[Bt]=ur[It]=!1;var _r=typeof OA=="object"&&OA&&OA.Object===Object&&OA,Rr=typeof self=="object"&&self&&self.Object===Object&&self,ei=_r||Rr||Function("return this")(),rr=E&&!E.nodeType&&E,kt=rr&&C&&!C.nodeType&&C,Rt=kt&&kt.exports===rr,br=Rt&&_r.process,Or=function(){try{return br&&br.binding&&br.binding("util")}catch{}}(),Kr=Or&&Or.isTypedArray;function di(we,Pe){for(var dt=-1,xt=we==null?0:we.length;++dt<xt;)if(Pe(we[dt],dt,we))return!0;return!1}function ri(we){var Pe=-1,dt=Array(we.size);return we.forEach(function(xt,Lt){dt[++Pe]=[Lt,xt]}),dt}function ii(we){var Pe=-1,dt=Array(we.size);return we.forEach(function(xt){dt[++Pe]=xt}),dt}var ki,kn,Zi,Bn=Array.prototype,la=Function.prototype,Xi=Object.prototype,cn=ei["__core-js_shared__"],wi=la.toString,Vi=Xi.hasOwnProperty,Ln=(ki=/[^.]+$/.exec(cn&&cn.keys&&cn.keys.IE_PROTO||""))?"Symbol(src)_1."+ki:"",Wi=Xi.toString,ni=RegExp("^"+wi.call(Vi).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Pn=Rt?ei.Buffer:void 0,an=ei.Symbol,qn=ei.Uint8Array,un=Xi.propertyIsEnumerable,Wr=Bn.splice,Nn=an?an.toStringTag:void 0,Ri=Object.getOwnPropertySymbols,Hr=Pn?Pn.isBuffer:void 0,Ji=(kn=Object.keys,Zi=Object,function(we){return kn(Zi(we))}),Cn=We(ei,"DataView"),$i=We(ei,"Map"),yn=We(ei,"Promise"),En=We(ei,"Set"),Ut=We(ei,"WeakMap"),ir=We(Object,"create"),Ma=H(Cn),lo=H($i),bi=H(yn),bo=H(En),ro=H(Ut),Ao=an?an.prototype:void 0,Bo=Ao?Ao.valueOf:void 0;function er(we){var Pe=-1,dt=we==null?0:we.length;for(this.clear();++Pe<dt;){var xt=we[Pe];this.set(xt[0],xt[1])}}function Vr(we){var Pe=-1,dt=we==null?0:we.length;for(this.clear();++Pe<dt;){var xt=we[Pe];this.set(xt[0],xt[1])}}function Nr(we){var Pe=-1,dt=we==null?0:we.length;for(this.clear();++Pe<dt;){var xt=we[Pe];this.set(xt[0],xt[1])}}function _n(we){var Pe=-1,dt=we==null?0:we.length;for(this.__data__=new Nr;++Pe<dt;)this.add(we[Pe])}function Qn(we){var Pe=this.__data__=new Vr(we);this.size=Pe.size}function Gr(we,Pe){var dt=se(we),xt=!dt&&pe(we),Lt=!dt&&!xt&&Se(we),zt=!dt&&!xt&&!Lt&&Je(we),Jt=dt||xt||Lt||zt,or=Jt?function(vr,Sr){for(var Tr=-1,li=Array(vr);++Tr<vr;)li[Tr]=Sr(Tr);return li}(we.length,String):[],Ar=or.length;for(var Br in we)!Pe&&!Vi.call(we,Br)||Jt&&(Br=="length"||Lt&&(Br=="offset"||Br=="parent")||zt&&(Br=="buffer"||Br=="byteLength"||Br=="byteOffset")||X(Br,Ar))||or.push(Br);return or}function mo(we,Pe){for(var dt=we.length;dt--;)if(te(we[dt][0],Pe))return dt;return-1}function In(we){return we==null?we===void 0?"[object Undefined]":"[object Null]":Nn&&Nn in Object(we)?function(Pe){var dt=Vi.call(Pe,Nn),xt=Pe[Nn];try{Pe[Nn]=void 0;var Lt=!0}catch{}var zt=Wi.call(Pe);return Lt&&(dt?Pe[Nn]=xt:delete Pe[Nn]),zt}(we):function(Pe){return Wi.call(Pe)}(we)}function ka(we){return Oe(we)&&In(we)==o}function mi(we,Pe,dt,xt,Lt){return we===Pe||(we==null||Pe==null||!Oe(we)&&!Oe(Pe)?we!=we&&Pe!=Pe:function(zt,Jt,or,Ar,Br,vr){var Sr=se(zt),Tr=se(Jt),li=Sr?q:Ee(zt),Co=Tr?q:Ee(Jt),Bi=(li=li==o?it:li)==it,hi=(Co=Co==o?it:Co)==it,Na=li==Co;if(Na&&Se(zt)){if(!Se(Jt))return!1;Sr=!0,Bi=!1}if(Na&&!Bi)return vr||(vr=new Qn),Sr||Je(zt)?xe(zt,Jt,or,Ar,Br,vr):function(fi,vi,Ni,go,Uo,ea,Dn){switch(Ni){case Zt:if(fi.byteLength!=vi.byteLength||fi.byteOffset!=vi.byteOffset)return!1;fi=fi.buffer,vi=vi.buffer;case gt:return!(fi.byteLength!=vi.byteLength||!ea(new qn(fi),new qn(vi)));case K:case ae:case ze:return te(+fi,+vi);case Y:return fi.name==vi.name&&fi.message==vi.message;case _t:case Bt:return fi==vi+"";case be:var Aa=ri;case yt:var co=1&go;if(Aa||(Aa=ii),fi.size!=vi.size&&!co)return!1;var hn=Dn.get(fi);if(hn)return hn==vi;go|=2,Dn.set(fi,vi);var Io=xe(Aa(fi),Aa(vi),go,Uo,ea,Dn);return Dn.delete(fi),Io;case rt:if(Bo)return Bo.call(fi)==Bo.call(vi)}return!1}(zt,Jt,li,or,Ar,Br,vr);if(!(1&or)){var Pa=Bi&&Vi.call(zt,"__wrapped__"),zn=hi&&Vi.call(Jt,"__wrapped__");if(Pa||zn){var js=Pa?zt.value():zt,Eo=zn?Jt.value():Jt;return vr||(vr=new Qn),Br(js,Eo,or,Ar,vr)}}return Na?(vr||(vr=new Qn),function(fi,vi,Ni,go,Uo,ea){var Dn=1&Ni,Aa=Fe(fi),co=Aa.length,hn=Fe(vi).length;if(co!=hn&&!Dn)return!1;for(var Io=co;Io--;){var Sn=Aa[Io];if(!(Dn?Sn in vi:Vi.call(vi,Sn)))return!1}var Ka=ea.get(fi);if(Ka&&ea.get(vi))return Ka==vi;var Qa=!0;ea.set(fi,vi),ea.set(vi,fi);for(var Fs=Dn;++Io<co;){var pn=fi[Sn=Aa[Io]],hs=vi[Sn];if(go)var kl=Dn?go(hs,pn,Sn,vi,fi,ea):go(pn,hs,Sn,fi,vi,ea);if(!(kl===void 0?pn===hs||Uo(pn,hs,Ni,go,ea):kl)){Qa=!1;break}Fs||(Fs=Sn=="constructor")}if(Qa&&!Fs){var fl=fi.constructor,Us=vi.constructor;fl==Us||!("constructor"in fi)||!("constructor"in vi)||typeof fl=="function"&&fl instanceof fl&&typeof Us=="function"&&Us instanceof Us||(Qa=!1)}return ea.delete(fi),ea.delete(vi),Qa}(zt,Jt,or,Ar,Br,vr)):!1}(we,Pe,dt,xt,mi,Lt))}function ne(we){return!(!ve(we)||function(Pe){return!!Ln&&Ln in Pe}(we))&&(Ne(we)?ni:dr).test(H(we))}function fe(we){if(dt=(Pe=we)&&Pe.constructor,xt=typeof dt=="function"&&dt.prototype||Xi,Pe!==xt)return Ji(we);var Pe,dt,xt,Lt=[];for(var zt in Object(we))Vi.call(we,zt)&&zt!="constructor"&&Lt.push(zt);return Lt}function xe(we,Pe,dt,xt,Lt,zt){var Jt=1&dt,or=we.length,Ar=Pe.length;if(or!=Ar&&!(Jt&&Ar>or))return!1;var Br=zt.get(we);if(Br&&zt.get(Pe))return Br==Pe;var vr=-1,Sr=!0,Tr=2&dt?new _n:void 0;for(zt.set(we,Pe),zt.set(Pe,we);++vr<or;){var li=we[vr],Co=Pe[vr];if(xt)var Bi=Jt?xt(Co,li,vr,Pe,we,zt):xt(li,Co,vr,we,Pe,zt);if(Bi!==void 0){if(Bi)continue;Sr=!1;break}if(Tr){if(!di(Pe,function(hi,Na){if(Pa=Na,!Tr.has(Pa)&&(li===hi||Lt(li,hi,dt,xt,zt)))return Tr.push(Na);var Pa})){Sr=!1;break}}else if(li!==Co&&!Lt(li,Co,dt,xt,zt)){Sr=!1;break}}return zt.delete(we),zt.delete(Pe),Sr}function Fe(we){return function(Pe,dt,xt){var Lt=dt(Pe);return se(Pe)?Lt:function(zt,Jt){for(var or=-1,Ar=Jt.length,Br=zt.length;++or<Ar;)zt[Br+or]=Jt[or];return zt}(Lt,xt(Pe))}(we,ct,st)}function Re(we,Pe){var dt,xt,Lt=we.__data__;return((xt=typeof(dt=Pe))=="string"||xt=="number"||xt=="symbol"||xt=="boolean"?dt!=="__proto__":dt===null)?Lt[typeof Pe=="string"?"string":"hash"]:Lt.map}function We(we,Pe){var dt=function(xt,Lt){return xt==null?void 0:xt[Lt]}(we,Pe);return ne(dt)?dt:void 0}er.prototype.clear=function(){this.__data__=ir?ir(null):{},this.size=0},er.prototype.delete=function(we){var Pe=this.has(we)&&delete this.__data__[we];return this.size-=Pe?1:0,Pe},er.prototype.get=function(we){var Pe=this.__data__;if(ir){var dt=Pe[we];return dt===P?void 0:dt}return Vi.call(Pe,we)?Pe[we]:void 0},er.prototype.has=function(we){var Pe=this.__data__;return ir?Pe[we]!==void 0:Vi.call(Pe,we)},er.prototype.set=function(we,Pe){var dt=this.__data__;return this.size+=this.has(we)?0:1,dt[we]=ir&&Pe===void 0?P:Pe,this},Vr.prototype.clear=function(){this.__data__=[],this.size=0},Vr.prototype.delete=function(we){var Pe=this.__data__,dt=mo(Pe,we);return!(dt<0)&&(dt==Pe.length-1?Pe.pop():Wr.call(Pe,dt,1),--this.size,!0)},Vr.prototype.get=function(we){var Pe=this.__data__,dt=mo(Pe,we);return dt<0?void 0:Pe[dt][1]},Vr.prototype.has=function(we){return mo(this.__data__,we)>-1},Vr.prototype.set=function(we,Pe){var dt=this.__data__,xt=mo(dt,we);return xt<0?(++this.size,dt.push([we,Pe])):dt[xt][1]=Pe,this},Nr.prototype.clear=function(){this.size=0,this.__data__={hash:new er,map:new($i||Vr),string:new er}},Nr.prototype.delete=function(we){var Pe=Re(this,we).delete(we);return this.size-=Pe?1:0,Pe},Nr.prototype.get=function(we){return Re(this,we).get(we)},Nr.prototype.has=function(we){return Re(this,we).has(we)},Nr.prototype.set=function(we,Pe){var dt=Re(this,we),xt=dt.size;return dt.set(we,Pe),this.size+=dt.size==xt?0:1,this},_n.prototype.add=_n.prototype.push=function(we){return this.__data__.set(we,P),this},_n.prototype.has=function(we){return this.__data__.has(we)},Qn.prototype.clear=function(){this.__data__=new Vr,this.size=0},Qn.prototype.delete=function(we){var Pe=this.__data__,dt=Pe.delete(we);return this.size=Pe.size,dt},Qn.prototype.get=function(we){return this.__data__.get(we)},Qn.prototype.has=function(we){return this.__data__.has(we)},Qn.prototype.set=function(we,Pe){var dt=this.__data__;if(dt instanceof Vr){var xt=dt.__data__;if(!$i||xt.length<199)return xt.push([we,Pe]),this.size=++dt.size,this;dt=this.__data__=new Nr(xt)}return dt.set(we,Pe),this.size=dt.size,this};var st=Ri?function(we){return we==null?[]:(we=Object(we),function(Pe,dt){for(var xt=-1,Lt=Pe==null?0:Pe.length,zt=0,Jt=[];++xt<Lt;){var or=Pe[xt];dt(or,xt,Pe)&&(Jt[zt++]=or)}return Jt}(Ri(we),function(Pe){return un.call(we,Pe)}))}:function(){return[]},Ee=In;function X(we,Pe){return!!(Pe=Pe==null?V:Pe)&&(typeof we=="number"||Xr.test(we))&&we>-1&&we%1==0&&we<Pe}function H(we){if(we!=null){try{return wi.call(we)}catch{}try{return we+""}catch{}}return""}function te(we,Pe){return we===Pe||we!=we&&Pe!=Pe}(Cn&&Ee(new Cn(new ArrayBuffer(1)))!=Zt||$i&&Ee(new $i)!=be||yn&&Ee(yn.resolve())!=tt||En&&Ee(new En)!=yt||Ut&&Ee(new Ut)!=It)&&(Ee=function(we){var Pe=In(we),dt=Pe==it?we.constructor:void 0,xt=dt?H(dt):"";if(xt)switch(xt){case Ma:return Zt;case lo:return be;case bi:return tt;case bo:return yt;case ro:return It}return Pe});var pe=ka(function(){return arguments}())?ka:function(we){return Oe(we)&&Vi.call(we,"callee")&&!un.call(we,"callee")},se=Array.isArray,Se=Hr||function(){return!1};function Ne(we){if(!ve(we))return!1;var Pe=In(we);return Pe==ie||Pe=="[object GeneratorFunction]"||Pe=="[object AsyncFunction]"||Pe=="[object Proxy]"}function Me(we){return typeof we=="number"&&we>-1&&we%1==0&&we<=V}function ve(we){var Pe=typeof we;return we!=null&&(Pe=="object"||Pe=="function")}function Oe(we){return we!=null&&typeof we=="object"}var Je=Kr?function(we){return function(Pe){return we(Pe)}}(Kr):function(we){return Oe(we)&&Me(we.length)&&!!ur[In(we)]};function ct(we){return(Pe=we)!=null&&Me(Pe.length)&&!Ne(Pe)?Gr(we):fe(we);var Pe}C.exports=function(we,Pe){return mi(we,Pe)}})(kf,kf.exports);var s_=kf.exports;function wg(C){let E,P,V;const o=[C[5],C[6]];var q=C[4];function K(ae){let Y={};for(let ie=0;ie<o.length;ie+=1)Y=HA(Y,o[ie]);return{props:Y}}return q&&(E=new q(K()),E.$on("mapMove",C[8])),{c(){E&&qo(E.$$.fragment),P=fp()},m(ae,Y){E&&Do(E,ae,Y),Di(ae,P,Y),V=!0},p(ae,Y){const ie=96&Y?du(o,[32&Y&&Hc(ae[5]),64&Y&&Hc(ae[6])]):{};if(q!==(q=ae[4])){if(E){Ul();const be=E;xi(be.$$.fragment,1,0,()=>{Lo(be,1)}),Ml()}q?(E=new q(K()),E.$on("mapMove",ae[8]),qo(E.$$.fragment),ti(E.$$.fragment,1),Do(E,P.parentNode,P)):E=null}else q&&E.$set(ie)},i(ae){V||(E&&ti(E.$$.fragment,ae),V=!0)},o(ae){E&&xi(E.$$.fragment,ae),V=!1},d(ae){ae&&Ci(P),E&&Lo(E,ae)}}}function bg(C){let E,P,V,o,q;return P=new qx({props:{index:C[0].index,name:C[0].name,onClose:C[7],disableClose:C[1]<=1,mapState:C[6]}}),P.$on("mapState",C[8]),{c(){E=wr("div"),qo(P.$$.fragment),Dt(E,"id",V=C[0].id),Dt(E,"class",o=$u(`map-label-container ${C[1]===2?`map-label-container-${C[0].index}`:""} ${C[2]}`)+" svelte-qvie9m")},m(K,ae){Di(K,E,ae),Do(P,E,null),q=!0},p(K,ae){const Y={};1&ae&&(Y.index=K[0].index),1&ae&&(Y.name=K[0].name),2&ae&&(Y.disableClose=K[1]<=1),64&ae&&(Y.mapState=K[6]),P.$set(Y),(!q||1&ae&&V!==(V=K[0].id))&&Dt(E,"id",V),(!q||7&ae&&o!==(o=$u(`map-label-container ${K[1]===2?`map-label-container-${K[0].index}`:""} ${K[2]}`)+" svelte-qvie9m"))&&Dt(E,"class",o)},i(K){q||(ti(P.$$.fragment,K),q=!0)},o(K){xi(P.$$.fragment,K),q=!1},d(K){K&&Ci(E),Lo(P)}}}function Zx(C){let E,P,V,o=C[3],q=`${C[1]}-${C[0].index}`,K=wg(C),ae=bg(C);return{c(){E=wr("div"),K.c(),P=to(),ae.c(),Dt(E,"class","map svelte-qvie9m")},m(Y,ie){Di(Y,E,ie),K.m(E,null),ar(E,P),ae.m(E,null),V=!0},p(Y,[ie]){8&ie&&Ua(o,o=Y[3])?(Ul(),xi(K,1,1,zo),Ml(),K=wg(Y),K.c(),ti(K),K.m(E,P)):K.p(Y,ie),3&ie&&Ua(q,q=`${Y[1]}-${Y[0].index}`)?(Ul(),xi(ae,1,1,zo),Ml(),ae=bg(Y),ae.c(),ti(ae),ae.m(E,null)):ae.p(Y,ie)},i(Y){V||(ti(K),ti(ae),V=!0)},o(Y){xi(K),xi(ae),V=!1},d(Y){Y&&Ci(E),K.d(Y),ae.d(Y)}}}function Xx(C,E,P){let V,o,q,K;const ae=["map","numberOfMaps","themeLabel"];let Y,ie,be=gm(E,ae);hu(C,pu,It=>P(13,Y=It)),hu(C,cu,It=>P(11,ie=It));let{map:ze}=E,{numberOfMaps:it}=E,{themeLabel:tt=""}=E;const _t=fc();let yt,Bt={},rt={};return C.$$set=It=>{E=HA(HA({},E),function(gt){const Zt={};for(const dr in gt)dr[0]!=="$"&&(Zt[dr]=gt[dr]);return Zt}(It)),P(18,be=gm(E,ae)),"map"in It&&P(0,ze=It.map),"numberOfMaps"in It&&P(1,it=It.numberOfMaps),"themeLabel"in It&&P(2,tt=It.themeLabel)},C.$$.update=()=>{var It;2049&C.$$.dirty&&(V=(It=ie==null?void 0:ie[ze.index])!=null?It:{}),1&C.$$.dirty&&P(10,o=`${ze.id}-${ze.index}`),513&C.$$.dirty&&(s_(rt,ze==null?void 0:ze.style)||P(9,rt=ze==null?void 0:ze.style)),1&C.$$.dirty&&P(3,q=ze.type),1538&C.$$.dirty&&P(5,Bt={id:o,mapStyle:ze,numberOfMaps:it}),8&C.$$.dirty&&(gt=>{gt==="google"?P(4,yt=yx):(P(4,yt=xx),P(5,Bt.mapType=gt,Bt))})(q),P(6,K=(gt=>{if(Y)return gt;const{bearing:Zt,center:dr,pitch:Xr,zoom:ur,..._r}=gt;let Rr={..._r,bearing:Zt,center:dr,pitch:Xr,zoom:ur,...V};return Rr=Mf(Rr,[ze]),Rr})(be))},[ze,it,tt,q,yt,Bt,K,()=>{ju.update(It=>It.filter((gt,Zt)=>Zt!==ze.index).map((gt,Zt)=>({...gt,index:Zt}))),Y||cu.update(It=>It.filter((gt,Zt)=>Zt!==ze.index))},It=>{if(Y)_t("mapMove",It.detail);else{const{options:gt}=It.detail;cu.update(Zt=>Zt.map((dr,Xr)=>Xr===ze.index?gt:dr))}},rt,o,ie]}class Pd extends us{constructor(E){super(),cs(this,E,Xx,Zx,Ua,{map:0,numberOfMaps:1,themeLabel:2})}}function Bg(C,E,P){const V=C.slice();return V[1]=E[P],V}function Cg(C,E,P){const V=C.slice();return V[10]=E[P],V}function Eg(C){let E,P,V;const o=[{map:C[10]},C[0],{numberOfMaps:C[2]}];let q={};for(let K=0;K<o.length;K+=1)q=HA(q,o[K]);return P=new Pd({props:q}),P.$on("mapMove",C[5]),{c(){E=wr("div"),qo(P.$$.fragment),Dt(E,"class","map-container svelte-43hrvj")},m(K,ae){Di(K,E,ae),Do(P,E,null),V=!0},p(K,ae){const Y=13&ae?du(o,[8&ae&&{map:K[10]},1&ae&&Hc(K[0]),4&ae&&{numberOfMaps:K[2]}]):{};P.$set(Y)},i(K){V||(ti(P.$$.fragment,K),V=!0)},o(K){xi(P.$$.fragment,K),V=!1},d(K){K&&Ci(E),Lo(P)}}}function Ig(C){let E,P,V,o=C[1],q=[];for(let ae=0;ae<o.length;ae+=1)q[ae]=Eg(Cg(C,o,ae));const K=ae=>xi(q[ae],1,1,()=>{q[ae]=null});return{c(){E=wr("div");for(let ae=0;ae<q.length;ae+=1)q[ae].c();P=to(),Dt(E,"class","section svelte-43hrvj")},m(ae,Y){Di(ae,E,Y);for(let ie=0;ie<q.length;ie+=1)q[ie].m(E,null);ar(E,P),V=!0},p(ae,Y){if(13&Y){let ie;for(o=ae[1],ie=0;ie<o.length;ie+=1){const be=Cg(ae,o,ie);q[ie]?(q[ie].p(be,Y),ti(q[ie],1)):(q[ie]=Eg(be),q[ie].c(),ti(q[ie],1),q[ie].m(E,P))}for(Ul(),ie=o.length;ie<q.length;ie+=1)K(ie);Ml()}},i(ae){if(!V){for(let Y=0;Y<o.length;Y+=1)ti(q[Y]);V=!0}},o(ae){q=q.filter(Boolean);for(let Y=0;Y<q.length;Y+=1)xi(q[Y]);V=!1},d(ae){ae&&Ci(E),Vc(q,ae)}}}function Wx(C){let E,P,V,o,q=C[3],K=[];for(let Y=0;Y<q.length;Y+=1)K[Y]=Ig(Bg(C,q,Y));const ae=Y=>xi(K[Y],1,1,()=>{K[Y]=null});return{c(){E=wr("div"),P=wr("div");for(let Y=0;Y<K.length;Y+=1)K[Y].c();Dt(P,"class","maps svelte-43hrvj"),Dt(E,"class",V=$u(`mirror mirror-${C[4]}-orientation`)+" svelte-43hrvj")},m(Y,ie){Di(Y,E,ie),ar(E,P);for(let be=0;be<K.length;be+=1)K[be].m(P,null);o=!0},p(Y,[ie]){if(13&ie){let be;for(q=Y[3],be=0;be<q.length;be+=1){const ze=Bg(Y,q,be);K[be]?(K[be].p(ze,ie),ti(K[be],1)):(K[be]=Ig(ze),K[be].c(),ti(K[be],1),K[be].m(P,null))}for(Ul(),be=q.length;be<K.length;be+=1)ae(be);Ml()}(!o||16&ie&&V!==(V=$u(`mirror mirror-${Y[4]}-orientation`)+" svelte-43hrvj"))&&Dt(E,"class",V)},i(Y){if(!o){for(let ie=0;ie<q.length;ie+=1)ti(K[ie]);o=!0}},o(Y){K=K.filter(Boolean);for(let ie=0;ie<K.length;ie+=1)xi(K[ie]);o=!1},d(Y){Y&&Ci(E),Vc(K,Y)}}}function Jx(C,E,P){let{maps:V=[]}=E,{mapState:o}=E,q=[],K=0;const ae=[2,6];let Y;return C.$$set=ie=>{"maps"in ie&&P(1,V=ie.maps),"mapState"in ie&&P(0,o=ie.mapState)},C.$$.update=()=>{2&C.$$.dirty&&P(2,K=V.length),4&C.$$.dirty&&P(4,Y=ae.includes(K)?"row":"column"),2&C.$$.dirty&&(ie=>{const be=Math.round(Math.sqrt(K)),ze=Math.floor(K/be);let it=JSON.parse(JSON.stringify(ie)),tt=[];for(;it.length;)tt.push(it.slice(0,ze)),it=it.slice(ze);P(3,q=tt)})(V)},[o,V,K,q,Y,function(ie){Tl.call(this,C,ie)}]}class Yx extends us{constructor(E){super(),cs(this,E,Jx,Wx,Ua,{maps:1,mapState:0})}}function Sg(C,E,P){const V=C.slice();return V[3]=E[P],V}function Tg(C){let E,P,V,o;const q=[{map:C[3]},C[1],{themeLabel:"map-label-offset"},{numberOfMaps:C[0].length}];let K={};for(let ae=0;ae<q.length;ae+=1)K=HA(K,q[ae]);return P=new Pd({props:K}),P.$on("mapMove",C[2]),{c(){E=wr("div"),qo(P.$$.fragment),V=to(),Dt(E,"class","map-container svelte-1hvjgnk")},m(ae,Y){Di(ae,E,Y),Do(P,E,null),ar(E,V),o=!0},p(ae,Y){const ie=3&Y?du(q,[1&Y&&{map:ae[3]},2&Y&&Hc(ae[1]),q[2],1&Y&&{numberOfMaps:ae[0].length}]):{};P.$set(ie)},i(ae){o||(ti(P.$$.fragment,ae),o=!0)},o(ae){xi(P.$$.fragment,ae),o=!1},d(ae){ae&&Ci(E),Lo(P)}}}function e1(C){let E,P,V,o=C[0],q=[];for(let ae=0;ae<o.length;ae+=1)q[ae]=Tg(Sg(C,o,ae));const K=ae=>xi(q[ae],1,1,()=>{q[ae]=null});return{c(){E=wr("div"),P=wr("div");for(let ae=0;ae<q.length;ae+=1)q[ae].c();Dt(P,"class","maps phone svelte-1hvjgnk"),Dt(E,"class","viewer-container svelte-1hvjgnk")},m(ae,Y){Di(ae,E,Y),ar(E,P);for(let ie=0;ie<q.length;ie+=1)q[ie].m(P,null);V=!0},p(ae,[Y]){if(3&Y){let ie;for(o=ae[0],ie=0;ie<o.length;ie+=1){const be=Sg(ae,o,ie);q[ie]?(q[ie].p(be,Y),ti(q[ie],1)):(q[ie]=Tg(be),q[ie].c(),ti(q[ie],1),q[ie].m(P,null))}for(Ul(),ie=o.length;ie<q.length;ie+=1)K(ie);Ml()}},i(ae){if(!V){for(let Y=0;Y<o.length;Y+=1)ti(q[Y]);V=!0}},o(ae){q=q.filter(Boolean);for(let Y=0;Y<q.length;Y+=1)xi(q[Y]);V=!1},d(ae){ae&&Ci(E),Vc(q,ae)}}}function t1(C,E,P){let{maps:V}=E,{mapState:o}=E;return C.$$set=q=>{"maps"in q&&P(0,V=q.maps),"mapState"in q&&P(1,o=q.mapState)},[V,o,function(q){Tl.call(this,C,q)}]}class r1 extends us{constructor(E){super(),cs(this,E,t1,e1,Ua,{maps:0,mapState:1})}}function Fg(C,E,P){const V=C.slice();return V[11]=E[P],V}function Ug(C){let E,P,V,o;const q=[{map:C[11]},C[1],{numberOfMaps:C[0].length}];let K={};for(let ae=0;ae<q.length;ae+=1)K=HA(K,q[ae]);return P=new Pd({props:K}),P.$on("mapMove",C[9]),{c(){E=wr("div"),qo(P.$$.fragment),Dt(E,"class","map-container svelte-yry985"),Dt(E,"style",V=C[11].index===1&&C[4]?`clip: rect(0px, ${C[2]}px, ${C[5]}px, ${C[4]}px)`:null)},m(ae,Y){Di(ae,E,Y),Do(P,E,null),o=!0},p(ae,Y){const ie=3&Y?du(q,[1&Y&&{map:ae[11]},2&Y&&Hc(ae[1]),1&Y&&{numberOfMaps:ae[0].length}]):{};P.$set(ie),(!o||53&Y&&V!==(V=ae[11].index===1&&ae[4]?`clip: rect(0px, ${ae[2]}px, ${ae[5]}px, ${ae[4]}px)`:null))&&Dt(E,"style",V)},i(ae){o||(ti(P.$$.fragment,ae),o=!0)},o(ae){xi(P.$$.fragment,ae),o=!1},d(ae){ae&&Ci(E),Lo(P)}}}function i1(C){let E,P,V,o,q,K,ae,Y=C[0],ie=[];for(let ze=0;ze<Y.length;ze+=1)ie[ze]=Ug(Fg(C,Y,ze));const be=ze=>xi(ie[ze],1,1,()=>{ie[ze]=null});return{c(){E=wr("div");for(let ze=0;ze<ie.length;ze+=1)ie[ze].c();P=to(),V=wr("div"),Dt(V,"class","slider svelte-yry985"),cp(V,"left",C[4]+"px"),cp(V,"width",l_+"px"),Dt(E,"class","maps svelte-yry985"),pp(()=>C[10].call(E)),vd(E,"dragging",C[3])},m(ze,it){Di(ze,E,it);for(let tt=0;tt<ie.length;tt+=1)ie[tt].m(E,null);ar(E,P),ar(E,V),o=function(tt,_t){getComputedStyle(tt).position==="static"&&(tt.style.position="relative");const yt=wr("iframe");yt.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),yt.setAttribute("aria-hidden","true"),yt.tabIndex=-1;const Bt=w_();let rt;return Bt?(yt.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",rt=gn(window,"message",It=>{It.source===yt.contentWindow&&_t()})):(yt.src="about:blank",yt.onload=()=>{rt=gn(yt.contentWindow,"resize",_t)}),ar(tt,yt),()=>{(Bt||rt&&yt.contentWindow)&&rt(),Ci(yt)}}(E,C[10].bind(E)),q=!0,K||(ae=[gn(V,"mousedown",C[6]),gn(E,"mousemove",C[8]),gn(E,"mouseup",C[7])],K=!0)},p(ze,[it]){if(55&it){let tt;for(Y=ze[0],tt=0;tt<Y.length;tt+=1){const _t=Fg(ze,Y,tt);ie[tt]?(ie[tt].p(_t,it),ti(ie[tt],1)):(ie[tt]=Ug(_t),ie[tt].c(),ti(ie[tt],1),ie[tt].m(E,P))}for(Ul(),tt=Y.length;tt<ie.length;tt+=1)be(tt);Ml()}(!q||16&it)&&cp(V,"left",ze[4]+"px"),8&it&&vd(E,"dragging",ze[3])},i(ze){if(!q){for(let it=0;it<Y.length;it+=1)ti(ie[it]);q=!0}},o(ze){ie=ie.filter(Boolean);for(let it=0;it<ie.length;it+=1)xi(ie[it]);q=!1},d(ze){ze&&Ci(E),Vc(ie,ze),o(),K=!1,VA(ae)}}}const l_=5;function n1(C,E,P){let V,o,{maps:q}=E,{mapState:K}=E,ae=!1,Y=0;return C.$$set=ie=>{"maps"in ie&&P(0,q=ie.maps),"mapState"in ie&&P(1,K=ie.mapState)},C.$$.update=()=>{4&C.$$.dirty&&P(4,Y=V/2)},[q,K,V,ae,Y,o,()=>P(3,ae=!0),()=>P(3,ae=!1),ie=>{ae&&ie.clientX!==0&&P(4,Y=ie.clientX-l_/2)},function(ie){Tl.call(this,C,ie)},function(){o=this.clientHeight,V=this.clientWidth,P(5,o),P(2,V)}]}class o1 extends us{constructor(E){super(),cs(this,E,n1,i1,Ua,{maps:0,mapState:1})}}function Mg(C){let E,P;const V=[{map:C[8]},C[6],{numberOfMaps:C[7]},{themeLabel:"map-label-responsive"}];let o={};for(let q=0;q<V.length;q+=1)o=HA(o,V[q]);return E=new Pd({props:o}),E.$on("mapMove",C[14]),{c(){qo(E.$$.fragment)},m(q,K){Do(E,q,K),P=!0},p(q,K){const ae=448&K?du(V,[256&K&&{map:q[8]},64&K&&Hc(q[6]),128&K&&{numberOfMaps:q[7]},V[3]]):{};E.$set(ae)},i(q){P||(ti(E.$$.fragment,q),P=!0)},o(q){xi(E.$$.fragment,q),P=!1},d(q){Lo(E,q)}}}function a1(C){let E,P,V,o,q,K,ae,Y,ie,be,ze,it,tt,_t,yt,Bt,rt,It,gt,Zt,dr,Xr,ur,_r,Rr,ei,rr,kt,Rt=C[8]&&Mg(C);return{c(){E=wr("div"),P=wr("div"),Rt&&Rt.c(),o=to(),q=wr("div"),K=wr("div"),ae=wr("span"),ae.textContent="Height:",Y=to(),ie=wr("div"),be=wr("input"),ze=to(),it=wr("div"),tt=wr("span"),tt.textContent="Width:",_t=to(),yt=wr("div"),Bt=wr("input"),rt=to(),It=wr("div"),gt=wr("button"),Zt=dl("Set Dimensions"),Xr=to(),ur=wr("button"),_r=dl("Reset"),Dt(P,"class","map-container svelte-1pk77jp"),Dt(P,"style",V=`height:${C[0]}px; width:${C[1]}px`),Dt(be,"type","number"),Dt(be,"class","input svelte-1pk77jp"),Dt(ie,"class","input-container svelte-1pk77jp"),Dt(K,"class","dimension-input svelte-1pk77jp"),Dt(Bt,"type","number"),Dt(Bt,"class","input svelte-1pk77jp"),Dt(yt,"class","input-container svelte-1pk77jp"),Dt(it,"class","dimension-input svelte-1pk77jp"),gt.disabled=dr=!C[3]||!C[2],ur.disabled=Rr=C[0]==="100%"&&C[1]==="100%",Dt(It,"class","buttons svelte-1pk77jp"),Dt(q,"class","responsive-input svelte-1pk77jp"),Dt(E,"class","maps responsive svelte-1pk77jp")},m(br,Or){Di(br,E,Or),ar(E,P),Rt&&Rt.m(P,null),ar(E,o),ar(E,q),ar(q,K),ar(K,ae),ar(K,Y),ar(K,ie),ar(ie,be),Ku(be,C[2]),ar(q,ze),ar(q,it),ar(it,tt),ar(it,_t),ar(it,yt),ar(yt,Bt),Ku(Bt,C[3]),ar(q,rt),ar(q,It),ar(It,gt),ar(gt,Zt),ar(It,Xr),ar(It,ur),ar(ur,_r),ei=!0,rr||(kt=[gn(be,"input",C[15]),gn(be,"focus",C[16]),gn(be,"blur",C[17]),gn(Bt,"input",C[18]),gn(Bt,"focus",C[19]),gn(Bt,"blur",C[20]),gn(gt,"click",C[10]),Np(kd.call(null,gt,{code:"Enter",callback:C[9]})),gn(ur,"click",C[11])],rr=!0)},p(br,[Or]){br[8]?Rt?(Rt.p(br,Or),256&Or&&ti(Rt,1)):(Rt=Mg(br),Rt.c(),ti(Rt,1),Rt.m(P,null)):Rt&&(Ul(),xi(Rt,1,1,()=>{Rt=null}),Ml()),(!ei||3&Or&&V!==(V=`height:${br[0]}px; width:${br[1]}px`))&&Dt(P,"style",V),4&Or&&yd(be.value)!==br[2]&&Ku(be,br[2]),8&Or&&yd(Bt.value)!==br[3]&&Ku(Bt,br[3]),(!ei||12&Or&&dr!==(dr=!br[3]||!br[2]))&&(gt.disabled=dr),(!ei||3&Or&&Rr!==(Rr=br[0]==="100%"&&br[1]==="100%"))&&(ur.disabled=Rr)},i(br){ei||(ti(Rt),ei=!0)},o(br){xi(Rt),ei=!1},d(br){br&&Ci(E),Rt&&Rt.d(),rr=!1,VA(kt)}}}function s1(C,E,P){let V,o,{maps:q}=E,{mapState:K}=E;const ae=fc();let Y=K.height||"100%",ie=K.width||"100%",be=K.height||"",ze=K.width||"",it=!1,tt=!1,_t=K;delete _t.width,delete _t.height;const yt=()=>{P(0,Y=be),P(1,ie=ze),ae("mapSetDimensions",{options:{height:Y,width:ie}})};return C.$$set=Bt=>{"maps"in Bt&&P(12,q=Bt.maps),"mapState"in Bt&&P(13,K=Bt.mapState)},C.$$.update=()=>{var Bt;if(4096&C.$$.dirty&&P(8,V=q[0]),4096&C.$$.dirty&&P(7,o=(Bt=q==null?void 0:q.length)!=null?Bt:0),8192&C.$$.dirty){let{width:rt,height:It,...gt}=K;P(6,_t=gt)}},[Y,ie,be,ze,it,tt,_t,o,V,()=>{(it||tt)&&!(!ze||!be)&&yt()},yt,()=>{P(0,Y="100%"),P(1,ie="100%"),P(2,be=""),P(3,ze=""),ae("mapSetDimensions",{options:{height:null,width:null}})},q,K,function(Bt){Tl.call(this,C,Bt)},function(){be=yd(this.value),P(2,be)},()=>P(4,it=!0),()=>P(4,it=!1),function(){ze=yd(this.value),P(3,ze)},()=>P(5,tt=!0),()=>P(5,tt=!1)]}class l1 extends us{constructor(E){super(),cs(this,E,s1,a1,Ua,{maps:12,mapState:13})}}function A1(C){let E,P,V;var o=C[2];function q(K){return{props:{maps:K[0],mapState:K[1]}}}return o&&(E=new o(q(C)),E.$on("mapMove",C[3]),E.$on("mapSetDimensions",C[4])),{c(){E&&qo(E.$$.fragment),P=fp()},m(K,ae){E&&Do(E,K,ae),Di(K,P,ae),V=!0},p(K,[ae]){const Y={};if(1&ae&&(Y.maps=K[0]),2&ae&&(Y.mapState=K[1]),o!==(o=K[2])){if(E){Ul();const ie=E;xi(ie.$$.fragment,1,0,()=>{Lo(ie,1)}),Ml()}o?(E=new o(q(K)),E.$on("mapMove",K[3]),E.$on("mapSetDimensions",K[4]),qo(E.$$.fragment),ti(E.$$.fragment,1),Do(E,P.parentNode,P)):E=null}else o&&E.$set(Y)},i(K){V||(E&&ti(E.$$.fragment,K),V=!0)},o(K){E&&xi(E.$$.fragment,K),V=!1},d(K){K&&Ci(P),E&&Lo(E,K)}}}function c1(C,E,P){let V,o,{maps:q}=E,{mapState:K}=E,{viewMode:ae}=E;const Y=fc();let ie;const be=ze=>{Y("setDimensions",{...ze.detail.options})};return C.$$set=ze=>{"maps"in ze&&P(0,q=ze.maps),"mapState"in ze&&P(1,K=ze.mapState),"viewMode"in ze&&P(5,ae=ze.viewMode)},C.$$.update=()=>{2&C.$$.dirty&&P(7,V=K.height),2&C.$$.dirty&&P(6,o=K.width),32&C.$$.dirty&&(ze=>{switch(ze){case"phone":P(2,ie=r1);break;case"mirror":P(2,ie=Yx);break;case"responsive":P(2,ie=l1);break;default:P(2,ie=o1)}})(ae),224&C.$$.dirty&&ae!=="responsive"&&(V||o)&&be({detail:{options:{height:null,width:null}}})},[q,K,ie,ze=>{Y("mapState",{options:ze.detail.options})},be,ae,o,V]}class u1 extends us{constructor(E){super(),cs(this,E,c1,A1,Ua,{maps:0,mapState:1,viewMode:5})}}var h1=function(){/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var C=function(I,B){return C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(U,F){U.__proto__=F}||function(U,F){for(var G in F)Object.prototype.hasOwnProperty.call(F,G)&&(U[G]=F[G])},C(I,B)};function E(I,B){if(typeof B!="function"&&B!==null)throw new TypeError("Class extends value "+String(B)+" is not a constructor or null");function U(){this.constructor=I}C(I,B),I.prototype=B===null?Object.create(B):(U.prototype=B.prototype,new U)}var P=function(){return P=Object.assign||function(I){for(var B,U=1,F=arguments.length;U<F;U++)for(var G in B=arguments[U])Object.prototype.hasOwnProperty.call(B,G)&&(I[G]=B[G]);return I},P.apply(this,arguments)};function V(I,B,U,F){function G(ue){return ue instanceof U?ue:new U(function(_e){_e(ue)})}return new(U||(U=Promise))(function(ue,_e){function Ge(pt){try{ut(F.next(pt))}catch(Pt){_e(Pt)}}function Ve(pt){try{ut(F.throw(pt))}catch(Pt){_e(Pt)}}function ut(pt){pt.done?ue(pt.value):G(pt.value).then(Ge,Ve)}ut((F=F.apply(I,B||[])).next())})}function o(I,B){var U,F,G,ue,_e={label:0,sent:function(){if(1&G[0])throw G[1];return G[1]},trys:[],ops:[]};return ue={next:Ge(0),throw:Ge(1),return:Ge(2)},typeof Symbol=="function"&&(ue[Symbol.iterator]=function(){return this}),ue;function Ge(ut){return function(pt){return Ve([ut,pt])}}function Ve(ut){if(U)throw new TypeError("Generator is already executing.");for(;_e;)try{if(U=1,F&&(G=2&ut[0]?F.return:ut[0]?F.throw||((G=F.return)&&G.call(F),0):F.next)&&!(G=G.call(F,ut[1])).done)return G;switch(F=0,G&&(ut=[2&ut[0],G.value]),ut[0]){case 0:case 1:G=ut;break;case 4:return _e.label++,{value:ut[1],done:!1};case 5:_e.label++,F=ut[1],ut=[0];continue;case 7:ut=_e.ops.pop(),_e.trys.pop();continue;default:if(!((G=(G=_e.trys).length>0&&G[G.length-1])||ut[0]!==6&&ut[0]!==2)){_e=0;continue}if(ut[0]===3&&(!G||ut[1]>G[0]&&ut[1]<G[3])){_e.label=ut[1];break}if(ut[0]===6&&_e.label<G[1]){_e.label=G[1],G=ut;break}if(G&&_e.label<G[2]){_e.label=G[2],_e.ops.push(ut);break}G[2]&&_e.ops.pop(),_e.trys.pop();continue}ut=B.call(I,_e)}catch(pt){ut=[6,pt],F=0}finally{U=G=0}if(5&ut[0])throw ut[1];return{value:ut[0]?ut[1]:void 0,done:!0}}}function q(I,B,U){if(U||arguments.length===2)for(var F,G=0,ue=B.length;G<ue;G++)!F&&G in B||(F||(F=Array.prototype.slice.call(B,0,G)),F[G]=B[G]);return I.concat(F||B)}for(var K=function(){function I(B,U,F,G){this.left=B,this.top=U,this.width=F,this.height=G}return I.prototype.add=function(B,U,F,G){return new I(this.left+B,this.top+U,this.width+F,this.height+G)},I.fromClientRect=function(B,U){return new I(U.left+B.windowBounds.left,U.top+B.windowBounds.top,U.width,U.height)},I.fromDOMRectList=function(B,U){var F=Array.from(U).find(function(G){return G.width!==0});return F?new I(F.left+B.windowBounds.left,F.top+B.windowBounds.top,F.width,F.height):I.EMPTY},I.EMPTY=new I(0,0,0,0),I}(),ae=function(I,B){return K.fromClientRect(I,B.getBoundingClientRect())},Y=function(I){var B=I.body,U=I.documentElement;if(!B||!U)throw new Error("Unable to get document size");var F=Math.max(Math.max(B.scrollWidth,U.scrollWidth),Math.max(B.offsetWidth,U.offsetWidth),Math.max(B.clientWidth,U.clientWidth)),G=Math.max(Math.max(B.scrollHeight,U.scrollHeight),Math.max(B.offsetHeight,U.offsetHeight),Math.max(B.clientHeight,U.clientHeight));return new K(0,0,F,G)},ie=function(I){for(var B=[],U=0,F=I.length;U<F;){var G=I.charCodeAt(U++);if(G>=55296&&G<=56319&&U<F){var ue=I.charCodeAt(U++);(64512&ue)==56320?B.push(((1023&G)<<10)+(1023&ue)+65536):(B.push(G),U--)}else B.push(G)}return B},be=function(){for(var I=[],B=0;B<arguments.length;B++)I[B]=arguments[B];if(String.fromCodePoint)return String.fromCodePoint.apply(String,I);var U=I.length;if(!U)return"";for(var F=[],G=-1,ue="";++G<U;){var _e=I[G];_e<=65535?F.push(_e):(_e-=65536,F.push(55296+(_e>>10),_e%1024+56320)),(G+1===U||F.length>16384)&&(ue+=String.fromCharCode.apply(String,F),F.length=0)}return ue},ze="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",it=typeof Uint8Array>"u"?[]:new Uint8Array(256),tt=0;tt<ze.length;tt++)it[ze.charCodeAt(tt)]=tt;for(var _t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",yt=typeof Uint8Array>"u"?[]:new Uint8Array(256),Bt=0;Bt<_t.length;Bt++)yt[_t.charCodeAt(Bt)]=Bt;for(var rt=function(I){var B,U,F,G,ue,_e=.75*I.length,Ge=I.length,Ve=0;I[I.length-1]==="="&&(_e--,I[I.length-2]==="="&&_e--);var ut=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&Uint8Array.prototype.slice!==void 0?new ArrayBuffer(_e):new Array(_e),pt=Array.isArray(ut)?ut:new Uint8Array(ut);for(B=0;B<Ge;B+=4)U=yt[I.charCodeAt(B)],F=yt[I.charCodeAt(B+1)],G=yt[I.charCodeAt(B+2)],ue=yt[I.charCodeAt(B+3)],pt[Ve++]=U<<2|F>>4,pt[Ve++]=(15&F)<<4|G>>2,pt[Ve++]=(3&G)<<6|63&ue;return ut},It=function(I){for(var B=I.length,U=[],F=0;F<B;F+=2)U.push(I[F+1]<<8|I[F]);return U},gt=function(I){for(var B=I.length,U=[],F=0;F<B;F+=4)U.push(I[F+3]<<24|I[F+2]<<16|I[F+1]<<8|I[F]);return U},Zt=5,dr=11,Xr=2,ur=65536>>Zt,_r=(1<<Zt)-1,Rr=ur+(1024>>Zt)+32,ei=65536>>dr,rr=(1<<dr-Zt)-1,kt=function(I,B,U){return I.slice?I.slice(B,U):new Uint16Array(Array.prototype.slice.call(I,B,U))},Rt=function(I,B,U){return I.slice?I.slice(B,U):new Uint32Array(Array.prototype.slice.call(I,B,U))},br=function(I,B){var U=rt(I),F=Array.isArray(U)?gt(U):new Uint32Array(U),G=Array.isArray(U)?It(U):new Uint16Array(U),ue=24,_e=kt(G,ue/2,F[4]/2),Ge=F[5]===2?kt(G,(ue+F[4])/2):Rt(F,Math.ceil((ue+F[4])/4));return new Or(F[0],F[1],F[2],F[3],_e,Ge)},Or=function(){function I(B,U,F,G,ue,_e){this.initialValue=B,this.errorValue=U,this.highStart=F,this.highValueIndex=G,this.index=ue,this.data=_e}return I.prototype.get=function(B){var U;if(B>=0){if(B<55296||B>56319&&B<=65535)return U=((U=this.index[B>>Zt])<<Xr)+(B&_r),this.data[U];if(B<=65535)return U=((U=this.index[ur+(B-55296>>Zt)])<<Xr)+(B&_r),this.data[U];if(B<this.highStart)return U=Rr-ei+(B>>dr),U=this.index[U],U+=B>>Zt&rr,U=((U=this.index[U])<<Xr)+(B&_r),this.data[U];if(B<=1114111)return this.data[this.highValueIndex]}return this.errorValue},I}(),Kr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",di=typeof Uint8Array>"u"?[]:new Uint8Array(256),ri=0;ri<Kr.length;ri++)di[Kr.charCodeAt(ri)]=ri;var ii=50,ki=1,kn=2,Zi=3,Bn=4,la=5,Xi=7,cn=8,wi=9,Vi=10,Ln=11,Wi=12,ni=13,Pn=14,an=15,qn=16,un=17,Wr=18,Nn=19,Ri=20,Hr=21,Ji=22,Cn=23,$i=24,yn=25,En=26,Ut=27,ir=28,Ma=29,lo=30,bi=31,bo=32,ro=33,Ao=34,Bo=35,er=36,Vr=37,Nr=38,_n=39,Qn=40,Gr=41,mo=42,In=43,ka=[9001,65288],mi="!",ne="\xD7",fe="\xF7",xe=br("KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA=="),Fe=[lo,er],Re=[ki,kn,Zi,la],We=[Vi,cn],st=[Ut,En],Ee=Re.concat(We),X=[Nr,_n,Qn,Ao,Bo],H=[an,ni],te=function(I,B){B===void 0&&(B="strict");var U=[],F=[],G=[];return I.forEach(function(ue,_e){var Ge=xe.get(ue);if(Ge>ii?(G.push(!0),Ge-=ii):G.push(!1),["normal","auto","loose"].indexOf(B)!==-1&&[8208,8211,12316,12448].indexOf(ue)!==-1)return F.push(_e),U.push(qn);if(Ge===Bn||Ge===Ln){if(_e===0)return F.push(_e),U.push(lo);var Ve=U[_e-1];return Ee.indexOf(Ve)===-1?(F.push(F[_e-1]),U.push(Ve)):(F.push(_e),U.push(lo))}return F.push(_e),Ge===bi?U.push(B==="strict"?Hr:Vr):Ge===mo||Ge===Ma?U.push(lo):Ge===In?ue>=131072&&ue<=196605||ue>=196608&&ue<=262141?U.push(Vr):U.push(lo):void U.push(Ge)}),[F,U,G]},pe=function(I,B,U,F){var G=F[U];if(Array.isArray(I)?I.indexOf(G)!==-1:I===G)for(var ue=U;ue<=F.length;){if((Ve=F[++ue])===B)return!0;if(Ve!==Vi)break}if(G===Vi)for(ue=U;ue>0;){var _e=F[--ue];if(Array.isArray(I)?I.indexOf(_e)!==-1:I===_e)for(var Ge=U;Ge<=F.length;){var Ve;if((Ve=F[++Ge])===B)return!0;if(Ve!==Vi)break}if(_e!==Vi)break}return!1},se=function(I,B){for(var U=I;U>=0;){var F=B[U];if(F!==Vi)return F;U--}return 0},Se=function(I,B,U,F,G){if(U[F]===0)return ne;var ue=F-1;if(Array.isArray(G)&&G[ue]===!0)return ne;var _e=ue-1,Ge=ue+1,Ve=B[ue],ut=_e>=0?B[_e]:0,pt=B[Ge];if(Ve===kn&&pt===Zi)return ne;if(Re.indexOf(Ve)!==-1)return mi;if(Re.indexOf(pt)!==-1||We.indexOf(pt)!==-1)return ne;if(se(ue,B)===cn)return fe;if(xe.get(I[ue])===Ln||(Ve===bo||Ve===ro)&&xe.get(I[Ge])===Ln||Ve===Xi||pt===Xi||Ve===wi||[Vi,ni,an].indexOf(Ve)===-1&&pt===wi||[un,Wr,Nn,$i,ir].indexOf(pt)!==-1||se(ue,B)===Ji||pe(Cn,Ji,ue,B)||pe([un,Wr],Hr,ue,B)||pe(Wi,Wi,ue,B))return ne;if(Ve===Vi)return fe;if(Ve===Cn||pt===Cn)return ne;if(pt===qn||Ve===qn)return fe;if([ni,an,Hr].indexOf(pt)!==-1||Ve===Pn||ut===er&&H.indexOf(Ve)!==-1||Ve===ir&&pt===er||pt===Ri||Fe.indexOf(pt)!==-1&&Ve===yn||Fe.indexOf(Ve)!==-1&&pt===yn||Ve===Ut&&[Vr,bo,ro].indexOf(pt)!==-1||[Vr,bo,ro].indexOf(Ve)!==-1&&pt===En||Fe.indexOf(Ve)!==-1&&st.indexOf(pt)!==-1||st.indexOf(Ve)!==-1&&Fe.indexOf(pt)!==-1||[Ut,En].indexOf(Ve)!==-1&&(pt===yn||[Ji,an].indexOf(pt)!==-1&&B[Ge+1]===yn)||[Ji,an].indexOf(Ve)!==-1&&pt===yn||Ve===yn&&[yn,ir,$i].indexOf(pt)!==-1)return ne;if([yn,ir,$i,un,Wr].indexOf(pt)!==-1)for(var Pt=ue;Pt>=0;){if((Qt=B[Pt])===yn)return ne;if([ir,$i].indexOf(Qt)===-1)break;Pt--}if([Ut,En].indexOf(pt)!==-1)for(Pt=[un,Wr].indexOf(Ve)!==-1?_e:ue;Pt>=0;){var Qt;if((Qt=B[Pt])===yn)return ne;if([ir,$i].indexOf(Qt)===-1)break;Pt--}if(Nr===Ve&&[Nr,_n,Ao,Bo].indexOf(pt)!==-1||[_n,Ao].indexOf(Ve)!==-1&&[_n,Qn].indexOf(pt)!==-1||[Qn,Bo].indexOf(Ve)!==-1&&pt===Qn||X.indexOf(Ve)!==-1&&[Ri,En].indexOf(pt)!==-1||X.indexOf(pt)!==-1&&Ve===Ut||Fe.indexOf(Ve)!==-1&&Fe.indexOf(pt)!==-1||Ve===$i&&Fe.indexOf(pt)!==-1||Fe.concat(yn).indexOf(Ve)!==-1&&pt===Ji&&ka.indexOf(I[Ge])===-1||Fe.concat(yn).indexOf(pt)!==-1&&Ve===Wr)return ne;if(Ve===Gr&&pt===Gr){for(var Fr=U[ue],Nt=1;Fr>0&&B[--Fr]===Gr;)Nt++;if(Nt%2!=0)return ne}return Ve===bo&&pt===ro?ne:fe},Ne=function(I,B){B||(B={lineBreak:"normal",wordBreak:"normal"});var U=te(I,B.lineBreak),F=U[0],G=U[1],ue=U[2];B.wordBreak!=="break-all"&&B.wordBreak!=="break-word"||(G=G.map(function(Ge){return[yn,lo,mo].indexOf(Ge)!==-1?Vr:Ge}));var _e=B.wordBreak==="keep-all"?ue.map(function(Ge,Ve){return Ge&&I[Ve]>=19968&&I[Ve]<=40959}):void 0;return[F,G,_e]},Me=function(){function I(B,U,F,G){this.codePoints=B,this.required=U===mi,this.start=F,this.end=G}return I.prototype.slice=function(){return be.apply(void 0,this.codePoints.slice(this.start,this.end))},I}(),ve=function(I,B){var U=ie(I),F=Ne(U,B),G=F[0],ue=F[1],_e=F[2],Ge=U.length,Ve=0,ut=0;return{next:function(){if(ut>=Ge)return{done:!0,value:null};for(var pt=ne;ut<Ge&&(pt=Se(U,ue,G,++ut,_e))===ne;);if(pt!==ne||ut===Ge){var Pt=new Me(U,pt,Ve,ut);return Ve=ut,{value:Pt,done:!1}}return{done:!0,value:null}}}},Oe=1,Je=2,ct=4,we=8,Pe=10,dt=47,xt=92,Lt=9,zt=32,Jt=34,or=61,Ar=35,Br=36,vr=37,Sr=39,Tr=40,li=41,Co=95,Bi=45,hi=33,Na=60,Pa=62,zn=64,js=91,Eo=93,fi=61,vi=123,Ni=63,go=125,Uo=124,ea=126,Dn=128,Aa=65533,co=42,hn=43,Io=44,Sn=58,Ka=59,Qa=46,Fs=0,pn=8,hs=11,kl=14,fl=31,Us=127,ya=-1,$s=48,vA=97,Pl=101,xA=102,Ql=117,_a=122,Ya=65,Ti=69,Ms=70,qs=85,Ga=90,uo=function(I){return I>=$s&&I<=57},ca=function(I){return I>=55296&&I<=57343},Li=function(I){return uo(I)||I>=Ya&&I<=Ms||I>=vA&&I<=xA},Zs=function(I){return I>=vA&&I<=_a},Yl=function(I){return I>=Ya&&I<=Ga},wA=function(I){return Zs(I)||Yl(I)},NA=function(I){return I>=Dn},Xs=function(I){return I===Pe||I===Lt||I===zt},ks=function(I){return wA(I)||NA(I)||I===Co},Dl=function(I){return ks(I)||uo(I)||I===Bi},eA=function(I){return I>=Fs&&I<=pn||I===hs||I>=kl&&I<=fl||I===Us},ja=function(I,B){return I===xt&&B!==Pe},Ll=function(I,B,U){return I===Bi?ks(B)||ja(B,U):!!ks(I)||!(I!==xt||!ja(I,B))},bA=function(I,B,U){return I===hn||I===Bi?!!uo(B)||B===Qa&&uo(U):uo(I===Qa?B:I)},ps=function(I){var B=0,U=1;I[B]!==hn&&I[B]!==Bi||(I[B]===Bi&&(U=-1),B++);for(var F=[];uo(I[B]);)F.push(I[B++]);var G=F.length?parseInt(be.apply(void 0,F),10):0;I[B]===Qa&&B++;for(var ue=[];uo(I[B]);)ue.push(I[B++]);var _e=ue.length,Ge=_e?parseInt(be.apply(void 0,ue),10):0;I[B]!==Ti&&I[B]!==Pl||B++;var Ve=1;I[B]!==hn&&I[B]!==Bi||(I[B]===Bi&&(Ve=-1),B++);for(var ut=[];uo(I[B]);)ut.push(I[B++]);var pt=ut.length?parseInt(be.apply(void 0,ut),10):0;return U*(G+Ge*Math.pow(10,-_e))*Math.pow(10,Ve*pt)},tA={type:2},mc={type:3},Ro={type:4},KA={type:13},Ws={type:8},Js={type:21},Ps={type:9},ds={type:10},fs={type:11},Qs={type:12},$a={type:14},qa={type:23},GA={type:1},rA={type:25},Ki={type:24},gc={type:26},Ds={type:27},Rn={type:28},jA={type:29},Pi={type:31},Gi={type:32},Yi=function(){function I(){this._value=[]}return I.prototype.write=function(B){this._value=this._value.concat(ie(B))},I.prototype.read=function(){for(var B=[],U=this.consumeToken();U!==Gi;)B.push(U),U=this.consumeToken();return B},I.prototype.consumeToken=function(){var B=this.consumeCodePoint();switch(B){case Jt:return this.consumeStringToken(Jt);case Ar:var U=this.peekCodePoint(0),F=this.peekCodePoint(1),G=this.peekCodePoint(2);if(Dl(U)||ja(F,G)){var ue=Ll(U,F,G)?Je:Oe;return{type:5,value:this.consumeName(),flags:ue}}break;case Br:if(this.peekCodePoint(0)===or)return this.consumeCodePoint(),KA;break;case Sr:return this.consumeStringToken(Sr);case Tr:return tA;case li:return mc;case co:if(this.peekCodePoint(0)===or)return this.consumeCodePoint(),$a;break;case hn:if(bA(B,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(B),this.consumeNumericToken();break;case Io:return Ro;case Bi:var _e=B,Ge=this.peekCodePoint(0),Ve=this.peekCodePoint(1);if(bA(_e,Ge,Ve))return this.reconsumeCodePoint(B),this.consumeNumericToken();if(Ll(_e,Ge,Ve))return this.reconsumeCodePoint(B),this.consumeIdentLikeToken();if(Ge===Bi&&Ve===Pa)return this.consumeCodePoint(),this.consumeCodePoint(),Ki;break;case Qa:if(bA(B,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(B),this.consumeNumericToken();break;case dt:if(this.peekCodePoint(0)===co)for(this.consumeCodePoint();;){var ut=this.consumeCodePoint();if(ut===co&&(ut=this.consumeCodePoint())===dt)return this.consumeToken();if(ut===ya)return this.consumeToken()}break;case Sn:return gc;case Ka:return Ds;case Na:if(this.peekCodePoint(0)===hi&&this.peekCodePoint(1)===Bi&&this.peekCodePoint(2)===Bi)return this.consumeCodePoint(),this.consumeCodePoint(),rA;break;case zn:var pt=this.peekCodePoint(0),Pt=this.peekCodePoint(1),Qt=this.peekCodePoint(2);if(Ll(pt,Pt,Qt))return{type:7,value:this.consumeName()};break;case js:return Rn;case xt:if(ja(B,this.peekCodePoint(0)))return this.reconsumeCodePoint(B),this.consumeIdentLikeToken();break;case Eo:return jA;case fi:if(this.peekCodePoint(0)===or)return this.consumeCodePoint(),Ws;break;case vi:return fs;case go:return Qs;case Ql:case qs:var Fr=this.peekCodePoint(0),Nt=this.peekCodePoint(1);return Fr!==hn||!Li(Nt)&&Nt!==Ni||(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(B),this.consumeIdentLikeToken();case Uo:if(this.peekCodePoint(0)===or)return this.consumeCodePoint(),Ps;if(this.peekCodePoint(0)===Uo)return this.consumeCodePoint(),Js;break;case ea:if(this.peekCodePoint(0)===or)return this.consumeCodePoint(),ds;break;case ya:return Gi}return Xs(B)?(this.consumeWhiteSpace(),Pi):uo(B)?(this.reconsumeCodePoint(B),this.consumeNumericToken()):ks(B)?(this.reconsumeCodePoint(B),this.consumeIdentLikeToken()):{type:6,value:be(B)}},I.prototype.consumeCodePoint=function(){var B=this._value.shift();return B===void 0?-1:B},I.prototype.reconsumeCodePoint=function(B){this._value.unshift(B)},I.prototype.peekCodePoint=function(B){return B>=this._value.length?-1:this._value[B]},I.prototype.consumeUnicodeRangeToken=function(){for(var B=[],U=this.consumeCodePoint();Li(U)&&B.length<6;)B.push(U),U=this.consumeCodePoint();for(var F=!1;U===Ni&&B.length<6;)B.push(U),U=this.consumeCodePoint(),F=!0;if(F)return{type:30,start:parseInt(be.apply(void 0,B.map(function(_e){return _e===Ni?$s:_e})),16),end:parseInt(be.apply(void 0,B.map(function(_e){return _e===Ni?Ms:_e})),16)};var G=parseInt(be.apply(void 0,B),16);if(this.peekCodePoint(0)===Bi&&Li(this.peekCodePoint(1))){this.consumeCodePoint(),U=this.consumeCodePoint();for(var ue=[];Li(U)&&ue.length<6;)ue.push(U),U=this.consumeCodePoint();return{type:30,start:G,end:parseInt(be.apply(void 0,ue),16)}}return{type:30,start:G,end:G}},I.prototype.consumeIdentLikeToken=function(){var B=this.consumeName();return B.toLowerCase()==="url"&&this.peekCodePoint(0)===Tr?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===Tr?(this.consumeCodePoint(),{type:19,value:B}):{type:20,value:B}},I.prototype.consumeUrlToken=function(){var B=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===ya)return{type:22,value:""};var U=this.peekCodePoint(0);if(U===Sr||U===Jt){var F=this.consumeStringToken(this.consumeCodePoint());return F.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===ya||this.peekCodePoint(0)===li)?(this.consumeCodePoint(),{type:22,value:F.value}):(this.consumeBadUrlRemnants(),qa)}for(;;){var G=this.consumeCodePoint();if(G===ya||G===li)return{type:22,value:be.apply(void 0,B)};if(Xs(G))return this.consumeWhiteSpace(),this.peekCodePoint(0)===ya||this.peekCodePoint(0)===li?(this.consumeCodePoint(),{type:22,value:be.apply(void 0,B)}):(this.consumeBadUrlRemnants(),qa);if(G===Jt||G===Sr||G===Tr||eA(G))return this.consumeBadUrlRemnants(),qa;if(G===xt){if(!ja(G,this.peekCodePoint(0)))return this.consumeBadUrlRemnants(),qa;B.push(this.consumeEscapedCodePoint())}else B.push(G)}},I.prototype.consumeWhiteSpace=function(){for(;Xs(this.peekCodePoint(0));)this.consumeCodePoint()},I.prototype.consumeBadUrlRemnants=function(){for(;;){var B=this.consumeCodePoint();if(B===li||B===ya)return;ja(B,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},I.prototype.consumeStringSlice=function(B){for(var U=5e4,F="";B>0;){var G=Math.min(U,B);F+=be.apply(void 0,this._value.splice(0,G)),B-=G}return this._value.shift(),F},I.prototype.consumeStringToken=function(B){for(var U="",F=0;;){var G=this._value[F];if(G===ya||G===void 0||G===B)return{type:0,value:U+=this.consumeStringSlice(F)};if(G===Pe)return this._value.splice(0,F),GA;if(G===xt){var ue=this._value[F+1];ue!==ya&&ue!==void 0&&(ue===Pe?(U+=this.consumeStringSlice(F),F=-1,this._value.shift()):ja(G,ue)&&(U+=this.consumeStringSlice(F),U+=be(this.consumeEscapedCodePoint()),F=-1))}F++}},I.prototype.consumeNumber=function(){var B=[],U=ct,F=this.peekCodePoint(0);for(F!==hn&&F!==Bi||B.push(this.consumeCodePoint());uo(this.peekCodePoint(0));)B.push(this.consumeCodePoint());F=this.peekCodePoint(0);var G=this.peekCodePoint(1);if(F===Qa&&uo(G))for(B.push(this.consumeCodePoint(),this.consumeCodePoint()),U=we;uo(this.peekCodePoint(0));)B.push(this.consumeCodePoint());F=this.peekCodePoint(0),G=this.peekCodePoint(1);var ue=this.peekCodePoint(2);if((F===Ti||F===Pl)&&((G===hn||G===Bi)&&uo(ue)||uo(G)))for(B.push(this.consumeCodePoint(),this.consumeCodePoint()),U=we;uo(this.peekCodePoint(0));)B.push(this.consumeCodePoint());return[ps(B),U]},I.prototype.consumeNumericToken=function(){var B=this.consumeNumber(),U=B[0],F=B[1],G=this.peekCodePoint(0),ue=this.peekCodePoint(1),_e=this.peekCodePoint(2);return Ll(G,ue,_e)?{type:15,number:U,flags:F,unit:this.consumeName()}:G===vr?(this.consumeCodePoint(),{type:16,number:U,flags:F}):{type:17,number:U,flags:F}},I.prototype.consumeEscapedCodePoint=function(){var B=this.consumeCodePoint();if(Li(B)){for(var U=be(B);Li(this.peekCodePoint(0))&&U.length<6;)U+=be(this.consumeCodePoint());Xs(this.peekCodePoint(0))&&this.consumeCodePoint();var F=parseInt(U,16);return F===0||ca(F)||F>1114111?Aa:F}return B===ya?Aa:B},I.prototype.consumeName=function(){for(var B="";;){var U=this.consumeCodePoint();if(Dl(U))B+=be(U);else{if(!ja(U,this.peekCodePoint(0)))return this.reconsumeCodePoint(U),B;B+=be(this.consumeEscapedCodePoint())}}},I}(),sn=function(){function I(B){this._tokens=B}return I.create=function(B){var U=new Yi;return U.write(B),new I(U.read())},I.parseValue=function(B){return I.create(B).parseComponentValue()},I.parseValues=function(B){return I.create(B).parseComponentValues()},I.prototype.parseComponentValue=function(){for(var B=this.consumeToken();B.type===31;)B=this.consumeToken();if(B.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(B);var U=this.consumeComponentValue();do B=this.consumeToken();while(B.type===31);if(B.type===32)return U;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},I.prototype.parseComponentValues=function(){for(var B=[];;){var U=this.consumeComponentValue();if(U.type===32)return B;B.push(U),B.push()}},I.prototype.consumeComponentValue=function(){var B=this.consumeToken();switch(B.type){case 11:case 28:case 2:return this.consumeSimpleBlock(B.type);case 19:return this.consumeFunction(B)}return B},I.prototype.consumeSimpleBlock=function(B){for(var U={type:B,values:[]},F=this.consumeToken();;){if(F.type===32||zl(F,B))return U;this.reconsumeToken(F),U.values.push(this.consumeComponentValue()),F=this.consumeToken()}},I.prototype.consumeFunction=function(B){for(var U={name:B.value,values:[],type:18};;){var F=this.consumeToken();if(F.type===32||F.type===3)return U;this.reconsumeToken(F),U.values.push(this.consumeComponentValue())}},I.prototype.consumeToken=function(){var B=this._tokens.shift();return B===void 0?Gi:B},I.prototype.reconsumeToken=function(B){this._tokens.unshift(B)},I}(),ua=function(I){return I.type===15},Za=function(I){return I.type===17},Tn=function(I){return I.type===20},$A=function(I){return I.type===0},ms=function(I,B){return Tn(I)&&I.value===B},qA=function(I){return I.type!==31},ha=function(I){return I.type!==31&&I.type!==4},So=function(I){var B=[],U=[];return I.forEach(function(F){if(F.type===4){if(U.length===0)throw new Error("Error parsing function args, zero tokens for arg");return B.push(U),void(U=[])}F.type!==31&&U.push(F)}),U.length&&B.push(U),B},zl=function(I,B){return B===11&&I.type===12||B===28&&I.type===29||B===2&&I.type===3},ta=function(I){return I.type===17||I.type===15},Ai=function(I){return I.type===16||ta(I)},Rl=function(I){return I.length>1?[I[0],I[1]]:[I[0]]},To={type:17,number:0,flags:ct},es={type:16,number:50,flags:ct},Mo={type:16,number:100,flags:ct},Ol=function(I,B,U){var F=I[0],G=I[1];return[Fn(F,B),Fn(G!==void 0?G:F,U)]},Fn=function(I,B){if(I.type===16)return I.number/100*B;if(ua(I))switch(I.unit){case"rem":case"em":return 16*I.number;default:return I.number}return I.number},Hl="deg",Da="grad",gs="rad",ys="turn",Ys={name:"angle",parse:function(I,B){if(B.type===15)switch(B.unit){case Hl:return Math.PI*B.number/180;case Da:return Math.PI/200*B.number;case gs:return B.number;case ys:return 2*Math.PI*B.number}throw new Error("Unsupported angle type")}},_s=function(I){return I.type===15&&(I.unit===Hl||I.unit===Da||I.unit===gs||I.unit===ys)},BA=function(I){switch(I.filter(Tn).map(function(B){return B.value}).join(" ")){case"to bottom right":case"to right bottom":case"left top":case"top left":return[To,To];case"to top":case"bottom":return Oo(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[To,Mo];case"to right":case"left":return Oo(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[Mo,Mo];case"to bottom":case"top":return Oo(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[Mo,To];case"to left":case"right":return Oo(270)}return 0},Oo=function(I){return Math.PI*I/180},ho={name:"color",parse:function(I,B){if(B.type===18){var U=iA[B.name];if(U===void 0)throw new Error('Attempting to parse an unsupported color function "'+B.name+'"');return U(I,B.values)}if(B.type===5){if(B.value.length===3){var F=B.value.substring(0,1),G=B.value.substring(1,2),ue=B.value.substring(2,3);return La(parseInt(F+F,16),parseInt(G+G,16),parseInt(ue+ue,16),1)}if(B.value.length===4){F=B.value.substring(0,1),G=B.value.substring(1,2),ue=B.value.substring(2,3);var _e=B.value.substring(3,4);return La(parseInt(F+F,16),parseInt(G+G,16),parseInt(ue+ue,16),parseInt(_e+_e,16)/255)}if(B.value.length===6)return F=B.value.substring(0,2),G=B.value.substring(2,4),ue=B.value.substring(4,6),La(parseInt(F,16),parseInt(G,16),parseInt(ue,16),1);if(B.value.length===8)return F=B.value.substring(0,2),G=B.value.substring(2,4),ue=B.value.substring(4,6),_e=B.value.substring(6,8),La(parseInt(F,16),parseInt(G,16),parseInt(ue,16),parseInt(_e,16)/255)}if(B.type===20){var Ge=Ra[B.value.toUpperCase()];if(Ge!==void 0)return Ge}return Ra.TRANSPARENT}},ts=function(I){return(255&I)==0},po=function(I){var B=255&I,U=255&I>>8,F=255&I>>16,G=255&I>>24;return B<255?"rgba("+G+","+F+","+U+","+B/255+")":"rgb("+G+","+F+","+U+")"},La=function(I,B,U,F){return(I<<24|B<<16|U<<8|Math.round(255*F)<<0)>>>0},za=function(I,B){if(I.type===17)return I.number;if(I.type===16){var U=B===3?1:255;return B===3?I.number/100*U:Math.round(I.number/100*U)}return 0},vs=function(I,B){var U=B.filter(ha);if(U.length===3){var F=U.map(za),G=F[0],ue=F[1],_e=F[2];return La(G,ue,_e,1)}if(U.length===4){var Ge=U.map(za),Ve=(G=Ge[0],ue=Ge[1],_e=Ge[2],Ge[3]);return La(G,ue,_e,Ve)}return 0};function ml(I,B,U){return U<0&&(U+=1),U>=1&&(U-=1),U<1/6?(B-I)*U*6+I:U<.5?B:U<2/3?6*(B-I)*(2/3-U)+I:I}var el=function(I,B){var U=B.filter(ha),F=U[0],G=U[1],ue=U[2],_e=U[3],Ge=(F.type===17?Oo(F.number):Ys.parse(I,F))/(2*Math.PI),Ve=Ai(G)?G.number/100:0,ut=Ai(ue)?ue.number/100:0,pt=_e!==void 0&&Ai(_e)?Fn(_e,1):1;if(Ve===0)return La(255*ut,255*ut,255*ut,1);var Pt=ut<=.5?ut*(Ve+1):ut+Ve-ut*Ve,Qt=2*ut-Pt,Fr=ml(Qt,Pt,Ge+1/3),Nt=ml(Qt,Pt,Ge),tr=ml(Qt,Pt,Ge-1/3);return La(255*Fr,255*Nt,255*tr,pt)},iA={hsl:el,hsla:el,rgb:vs,rgba:vs},Vl=function(I,B){return ho.parse(I,sn.create(B).parseComponentValue())},Ra={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},tl={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(I,B){return B.map(function(U){if(Tn(U))switch(U.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},ZA={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Ls=function(I,B){var U=ho.parse(I,B[0]),F=B[1];return F&&Ai(F)?{color:U,stop:F}:{color:U,stop:null}},zs=function(I,B){var U=I[0],F=I[I.length-1];U.stop===null&&(U.stop=To),F.stop===null&&(F.stop=Mo);for(var G=[],ue=0,_e=0;_e<I.length;_e++){var Ge=I[_e].stop;if(Ge!==null){var Ve=Fn(Ge,B);Ve>ue?G.push(Ve):G.push(ue),ue=Ve}else G.push(null)}var ut=null;for(_e=0;_e<G.length;_e++){var pt=G[_e];if(pt===null)ut===null&&(ut=_e);else if(ut!==null){for(var Pt=_e-ut,Qt=(pt-G[ut-1])/(Pt+1),Fr=1;Fr<=Pt;Fr++)G[ut+Fr-1]=Qt*Fr;ut=null}}return I.map(function(Nt,tr){return{color:Nt.color,stop:Math.max(Math.min(1,G[tr]/B),0)}})},pa=function(I,B,U){var F=B/2,G=U/2,ue=Fn(I[0],B)-F,_e=G-Fn(I[1],U);return(Math.atan2(_e,ue)+2*Math.PI)%(2*Math.PI)},gl=function(I,B,U){var F=typeof I=="number"?I:pa(I,B,U),G=Math.abs(B*Math.sin(F))+Math.abs(U*Math.cos(F)),ue=B/2,_e=U/2,Ge=G/2,Ve=Math.sin(F-Math.PI/2)*Ge,ut=Math.cos(F-Math.PI/2)*Ge;return[G,ue-ut,ue+ut,_e-Ve,_e+Ve]},Zn=function(I,B){return Math.sqrt(I*I+B*B)},Nl=function(I,B,U,F,G){return[[0,0],[0,B],[I,0],[I,B]].reduce(function(ue,_e){var Ge=_e[0],Ve=_e[1],ut=Zn(U-Ge,F-Ve);return(G?ut<ue.optimumDistance:ut>ue.optimumDistance)?{optimumCorner:_e,optimumDistance:ut}:ue},{optimumDistance:G?1/0:-1/0,optimumCorner:null}).optimumCorner},Rs=function(I,B,U,F,G){var ue=0,_e=0;switch(I.size){case 0:I.shape===0?ue=_e=Math.min(Math.abs(B),Math.abs(B-F),Math.abs(U),Math.abs(U-G)):I.shape===1&&(ue=Math.min(Math.abs(B),Math.abs(B-F)),_e=Math.min(Math.abs(U),Math.abs(U-G)));break;case 2:if(I.shape===0)ue=_e=Math.min(Zn(B,U),Zn(B,U-G),Zn(B-F,U),Zn(B-F,U-G));else if(I.shape===1){var Ge=Math.min(Math.abs(U),Math.abs(U-G))/Math.min(Math.abs(B),Math.abs(B-F)),Ve=Nl(F,G,B,U,!0),ut=Ve[0],pt=Ve[1];_e=Ge*(ue=Zn(ut-B,(pt-U)/Ge))}break;case 1:I.shape===0?ue=_e=Math.max(Math.abs(B),Math.abs(B-F),Math.abs(U),Math.abs(U-G)):I.shape===1&&(ue=Math.max(Math.abs(B),Math.abs(B-F)),_e=Math.max(Math.abs(U),Math.abs(U-G)));break;case 3:if(I.shape===0)ue=_e=Math.max(Zn(B,U),Zn(B,U-G),Zn(B-F,U),Zn(B-F,U-G));else if(I.shape===1){Ge=Math.max(Math.abs(U),Math.abs(U-G))/Math.max(Math.abs(B),Math.abs(B-F));var Pt=Nl(F,G,B,U,!1);ut=Pt[0],pt=Pt[1],_e=Ge*(ue=Zn(ut-B,(pt-U)/Ge))}}return Array.isArray(I.size)&&(ue=Fn(I.size[0],F),_e=I.size.length===2?Fn(I.size[1],G):ue),[ue,_e]},rl=function(I,B){var U=Oo(180),F=[];return So(B).forEach(function(G,ue){if(ue===0){var _e=G[0];if(_e.type===20&&_e.value==="to")return void(U=BA(G));if(_s(_e))return void(U=Ys.parse(I,_e))}var Ge=Ls(I,G);F.push(Ge)}),{angle:U,stops:F,type:1}},Oi=function(I,B){var U=Oo(180),F=[];return So(B).forEach(function(G,ue){if(ue===0){var _e=G[0];if(_e.type===20&&["top","left","right","bottom"].indexOf(_e.value)!==-1)return void(U=BA(G));if(_s(_e))return void(U=(Ys.parse(I,_e)+Oo(270))%Oo(360))}var Ge=Ls(I,G);F.push(Ge)}),{angle:U,stops:F,type:1}},il=function(I,B){var U=Oo(180),F=[],G=1,ue=0,_e=3,Ge=[];return So(B).forEach(function(Ve,ut){var pt=Ve[0];if(ut===0){if(Tn(pt)&&pt.value==="linear")return void(G=1);if(Tn(pt)&&pt.value==="radial")return void(G=2)}if(pt.type===18){if(pt.name==="from"){var Pt=ho.parse(I,pt.values[0]);F.push({stop:To,color:Pt})}else if(pt.name==="to")Pt=ho.parse(I,pt.values[0]),F.push({stop:Mo,color:Pt});else if(pt.name==="color-stop"){var Qt=pt.values.filter(ha);if(Qt.length===2){Pt=ho.parse(I,Qt[1]);var Fr=Qt[0];Za(Fr)&&F.push({stop:{type:16,number:100*Fr.number,flags:Fr.flags},color:Pt})}}}}),G===1?{angle:(U+Oo(180))%Oo(360),stops:F,type:G}:{size:_e,shape:ue,stops:F,position:Ge,type:G}},xs="closest-side",Os="farthest-side",Ei="closest-corner",ln="farthest-corner",Ho="circle",va="ellipse",xr="cover",yl="contain",_l=function(I,B){var U=0,F=3,G=[],ue=[];return So(B).forEach(function(_e,Ge){var Ve=!0;if(Ge===0){var ut=!1;Ve=_e.reduce(function(Pt,Qt){if(ut)if(Tn(Qt))switch(Qt.value){case"center":return ue.push(es),Pt;case"top":case"left":return ue.push(To),Pt;case"right":case"bottom":return ue.push(Mo),Pt}else(Ai(Qt)||ta(Qt))&&ue.push(Qt);else if(Tn(Qt))switch(Qt.value){case Ho:return U=0,!1;case va:return U=1,!1;case"at":return ut=!0,!1;case xs:return F=0,!1;case xr:case Os:return F=1,!1;case yl:case Ei:return F=2,!1;case ln:return F=3,!1}else if(ta(Qt)||Ai(Qt))return Array.isArray(F)||(F=[]),F.push(Qt),!1;return Pt},Ve)}if(Ve){var pt=Ls(I,_e);G.push(pt)}}),{size:F,shape:U,stops:G,position:ue,type:2}},rs=function(I,B){var U=0,F=3,G=[],ue=[];return So(B).forEach(function(_e,Ge){var Ve=!0;if(Ge===0?Ve=_e.reduce(function(pt,Pt){if(Tn(Pt))switch(Pt.value){case"center":return ue.push(es),!1;case"top":case"left":return ue.push(To),!1;case"right":case"bottom":return ue.push(Mo),!1}else if(Ai(Pt)||ta(Pt))return ue.push(Pt),!1;return pt},Ve):Ge===1&&(Ve=_e.reduce(function(pt,Pt){if(Tn(Pt))switch(Pt.value){case Ho:return U=0,!1;case va:return U=1,!1;case yl:case xs:return F=0,!1;case Os:return F=1,!1;case Ei:return F=2,!1;case xr:case ln:return F=3,!1}else if(ta(Pt)||Ai(Pt))return Array.isArray(F)||(F=[]),F.push(Pt),!1;return pt},Ve)),Ve){var ut=Ls(I,_e);G.push(ut)}}),{size:F,shape:U,stops:G,position:ue,type:2}},vl=function(I){return I.type===1},pr=function(I){return I.type===2},xa={name:"image",parse:function(I,B){if(B.type===22){var U={url:B.value,type:0};return I.cache.addImage(B.value),U}if(B.type===18){var F=nA[B.name];if(F===void 0)throw new Error('Attempting to parse an unsupported image function "'+B.name+'"');return F(I,B.values)}throw new Error("Unsupported image type "+B.type)}};function yo(I){return!(I.type===20&&I.value==="none"||I.type===18&&!nA[I.name])}var Xa,nA={"linear-gradient":rl,"-moz-linear-gradient":Oi,"-ms-linear-gradient":Oi,"-o-linear-gradient":Oi,"-webkit-linear-gradient":Oi,"radial-gradient":_l,"-moz-radial-gradient":rs,"-ms-radial-gradient":rs,"-o-radial-gradient":rs,"-webkit-radial-gradient":rs,"-webkit-gradient":il},io={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(I,B){if(B.length===0)return[];var U=B[0];return U.type===20&&U.value==="none"?[]:B.filter(function(F){return ha(F)&&yo(F)}).map(function(F){return xa.parse(I,F)})}},fr={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(I,B){return B.map(function(U){if(Tn(U))switch(U.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},wa={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(I,B){return So(B).map(function(U){return U.filter(Ai)}).map(Rl)}},oA={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(I,B){return So(B).map(function(U){return U.filter(Tn).map(function(F){return F.value}).join(" ")}).map(nl)}},nl=function(I){switch(I){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;default:return 0}};(function(I){I.AUTO="auto",I.CONTAIN="contain",I.COVER="cover"})(Xa||(Xa={}));var ra,ia={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(I,B){return So(B).map(function(U){return U.filter(aA)})}},aA=function(I){return Tn(I)||Ai(I)},Gt=function(I){return{name:"border-"+I+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},ws=Gt("top"),sA=Gt("right"),ol=Gt("bottom"),ba=Gt("left"),_o=function(I){return{name:"border-radius-"+I,initialValue:"0 0",prefix:!1,type:1,parse:function(B,U){return Rl(U.filter(Ai))}}},lA=_o("top-left"),da=_o("top-right"),Hi=_o("bottom-right"),Oa=_o("bottom-left"),al=function(I){return{name:"border-"+I+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(B,U){switch(U){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},Kl=al("top"),CA=al("right"),EA=al("bottom"),is=al("left"),Xn=function(I){return{name:"border-"+I+"-width",initialValue:"0",type:0,prefix:!1,parse:function(B,U){return ua(U)?U.number:0}}},pi=Xn("top"),Cr=Xn("right"),Pr=Xn("bottom"),no=Xn("left"),Hs={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},fa={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(I,B){return B==="rtl"?1:0}},On={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(I,B){return B.filter(Tn).reduce(function(U,F){return U|oo(F.value)},0)}},oo=function(I){switch(I){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},Ba={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(I,B){switch(B){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},kr={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(I,B){return B.type===20&&B.value==="normal"?0:B.type===17||B.type===15?B.number:0}};(function(I){I.NORMAL="normal",I.STRICT="strict"})(ra||(ra={}));var cr,Wn={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(I,B){return B==="strict"?ra.STRICT:ra.NORMAL}},qi={name:"line-height",initialValue:"normal",prefix:!1,type:4},Ca=function(I,B){return Tn(I)&&I.value==="normal"?1.2*B:I.type===17?B*I.number:Ai(I)?Fn(I,B):B},eo={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(I,B){return B.type===20&&B.value==="none"?null:xa.parse(I,B)}},y={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(I,B){return B==="inside"?0:1}},r={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(I,B){switch(B){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;default:return-1}}},c=function(I){return{name:"margin-"+I,initialValue:"0",prefix:!1,type:4}},m=c("top"),_=c("right"),S=c("bottom"),z=c("left"),N={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(I,B){return B.filter(Tn).map(function(U){switch(U.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;default:return 0}})}},$={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(I,B){return B==="break-word"?"break-word":"normal"}},W=function(I){return{name:"padding-"+I,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},ce=W("top"),ge=W("right"),Ce=W("bottom"),je=W("left"),De={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(I,B){switch(B){case"right":return 2;case"center":case"justify":return 1;default:return 0}}},Ke={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(I,B){switch(B){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},lt={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(I,B){return B.length===1&&ms(B[0],"none")?[]:So(B).map(function(U){for(var F={color:Ra.TRANSPARENT,offsetX:To,offsetY:To,blur:To},G=0,ue=0;ue<U.length;ue++){var _e=U[ue];ta(_e)?(G===0?F.offsetX=_e:G===1?F.offsetY=_e:F.blur=_e,G++):F.color=ho.parse(I,_e)}return F})}},ht={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(I,B){switch(B){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},vt={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(I,B){if(B.type===20&&B.value==="none")return null;if(B.type===18){var U=$e[B.name];if(U===void 0)throw new Error('Attempting to parse an unsupported transform function "'+B.name+'"');return U(B.values)}return null}},$e={matrix:function(I){var B=I.filter(function(U){return U.type===17}).map(function(U){return U.number});return B.length===6?B:null},matrix3d:function(I){var B=I.filter(function(Ve){return Ve.type===17}).map(function(Ve){return Ve.number}),U=B[0],F=B[1];B[2],B[3];var G=B[4],ue=B[5];B[6],B[7],B[8],B[9],B[10],B[11];var _e=B[12],Ge=B[13];return B[14],B[15],B.length===16?[U,F,G,ue,_e,Ge]:null}},Ct={type:16,number:50,flags:ct},wt=[Ct,Ct],Mt={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(I,B){var U=B.filter(Ai);return U.length!==2?wt:[U[0],U[1]]}},Ft={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(I,B){switch(B){case"hidden":return 1;case"collapse":return 2;default:return 0}}};(function(I){I.NORMAL="normal",I.BREAK_ALL="break-all",I.KEEP_ALL="keep-all"})(cr||(cr={}));for(var jt={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(I,B){switch(B){case"break-all":return cr.BREAK_ALL;case"keep-all":return cr.KEEP_ALL;default:return cr.NORMAL}}},St={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(I,B){if(B.type===20)return{auto:!0,order:0};if(Za(B))return{auto:!1,order:B.number};throw new Error("Invalid z-index number parsed")}},mr={name:"time",parse:function(I,B){if(B.type===15)switch(B.unit.toLowerCase()){case"s":return 1e3*B.number;case"ms":return B.number}throw new Error("Unsupported time type")}},sr={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(I,B){return Za(B)?B.number:1}},l={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},u={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(I,B){return B.filter(Tn).map(function(U){switch(U.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(U){return U!==0})}},A={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(I,B){var U=[],F=[];return B.forEach(function(G){switch(G.type){case 20:case 0:U.push(G.value);break;case 17:U.push(G.number.toString());break;case 4:F.push(U.join(" ")),U.length=0}}),U.length&&F.push(U.join(" ")),F.map(function(G){return G.indexOf(" ")===-1?G:"'"+G+"'"})}},d={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},b={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(I,B){return Za(B)?B.number:Tn(B)&&B.value==="bold"?700:400}},M={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(I,B){return B.filter(Tn).map(function(U){return U.value})}},Q={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(I,B){switch(B){case"oblique":return"oblique";case"italic":return"italic";default:return"normal"}}},R=function(I,B){return(I&B)!=0},J={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(I,B){if(B.length===0)return[];var U=B[0];return U.type===20&&U.value==="none"?[]:B}},Ae={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(I,B){if(B.length===0)return null;var U=B[0];if(U.type===20&&U.value==="none")return null;for(var F=[],G=B.filter(qA),ue=0;ue<G.length;ue++){var _e=G[ue],Ge=G[ue+1];if(_e.type===20){var Ve=Ge&&Za(Ge)?Ge.number:1;F.push({counter:_e.value,increment:Ve})}}return F}},Be={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(I,B){if(B.length===0)return[];for(var U=[],F=B.filter(qA),G=0;G<F.length;G++){var ue=F[G],_e=F[G+1];if(Tn(ue)&&ue.value!=="none"){var Ge=_e&&Za(_e)?_e.number:0;U.push({counter:ue.value,reset:Ge})}}return U}},Ie={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(I,B){return B.filter(ua).map(function(U){return mr.parse(I,U)})}},Te={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(I,B){if(B.length===0)return null;var U=B[0];if(U.type===20&&U.value==="none")return null;var F=[],G=B.filter($A);if(G.length%2!=0)return null;for(var ue=0;ue<G.length;ue+=2){var _e=G[ue].value,Ge=G[ue+1].value;F.push({open:_e,close:Ge})}return F}},He=function(I,B,U){if(!I)return"";var F=I[Math.min(B,I.length-1)];return F?U?F.open:F.close:""},Le={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(I,B){return B.length===1&&ms(B[0],"none")?[]:So(B).map(function(U){for(var F={color:255,offsetX:To,offsetY:To,blur:To,spread:To,inset:!1},G=0,ue=0;ue<U.length;ue++){var _e=U[ue];ms(_e,"inset")?F.inset=!0:ta(_e)?(G===0?F.offsetX=_e:G===1?F.offsetY=_e:G===2?F.blur=_e:F.spread=_e,G++):F.color=ho.parse(I,_e)}return F})}},qe={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(I,B){var U=[0,1,2],F=[];return B.filter(Tn).forEach(function(G){switch(G.value){case"stroke":F.push(1);break;case"fill":F.push(0);break;case"markers":F.push(2)}}),U.forEach(function(G){F.indexOf(G)===-1&&F.push(G)}),F}},ke={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},Xe={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(I,B){return ua(B)?B.number:0}},et=function(){function I(B,U){var F,G;this.animationDuration=Ze(B,Ie,U.animationDuration),this.backgroundClip=Ze(B,tl,U.backgroundClip),this.backgroundColor=Ze(B,ZA,U.backgroundColor),this.backgroundImage=Ze(B,io,U.backgroundImage),this.backgroundOrigin=Ze(B,fr,U.backgroundOrigin),this.backgroundPosition=Ze(B,wa,U.backgroundPosition),this.backgroundRepeat=Ze(B,oA,U.backgroundRepeat),this.backgroundSize=Ze(B,ia,U.backgroundSize),this.borderTopColor=Ze(B,ws,U.borderTopColor),this.borderRightColor=Ze(B,sA,U.borderRightColor),this.borderBottomColor=Ze(B,ol,U.borderBottomColor),this.borderLeftColor=Ze(B,ba,U.borderLeftColor),this.borderTopLeftRadius=Ze(B,lA,U.borderTopLeftRadius),this.borderTopRightRadius=Ze(B,da,U.borderTopRightRadius),this.borderBottomRightRadius=Ze(B,Hi,U.borderBottomRightRadius),this.borderBottomLeftRadius=Ze(B,Oa,U.borderBottomLeftRadius),this.borderTopStyle=Ze(B,Kl,U.borderTopStyle),this.borderRightStyle=Ze(B,CA,U.borderRightStyle),this.borderBottomStyle=Ze(B,EA,U.borderBottomStyle),this.borderLeftStyle=Ze(B,is,U.borderLeftStyle),this.borderTopWidth=Ze(B,pi,U.borderTopWidth),this.borderRightWidth=Ze(B,Cr,U.borderRightWidth),this.borderBottomWidth=Ze(B,Pr,U.borderBottomWidth),this.borderLeftWidth=Ze(B,no,U.borderLeftWidth),this.boxShadow=Ze(B,Le,U.boxShadow),this.color=Ze(B,Hs,U.color),this.direction=Ze(B,fa,U.direction),this.display=Ze(B,On,U.display),this.float=Ze(B,Ba,U.cssFloat),this.fontFamily=Ze(B,A,U.fontFamily),this.fontSize=Ze(B,d,U.fontSize),this.fontStyle=Ze(B,Q,U.fontStyle),this.fontVariant=Ze(B,M,U.fontVariant),this.fontWeight=Ze(B,b,U.fontWeight),this.letterSpacing=Ze(B,kr,U.letterSpacing),this.lineBreak=Ze(B,Wn,U.lineBreak),this.lineHeight=Ze(B,qi,U.lineHeight),this.listStyleImage=Ze(B,eo,U.listStyleImage),this.listStylePosition=Ze(B,y,U.listStylePosition),this.listStyleType=Ze(B,r,U.listStyleType),this.marginTop=Ze(B,m,U.marginTop),this.marginRight=Ze(B,_,U.marginRight),this.marginBottom=Ze(B,S,U.marginBottom),this.marginLeft=Ze(B,z,U.marginLeft),this.opacity=Ze(B,sr,U.opacity);var ue=Ze(B,N,U.overflow);this.overflowX=ue[0],this.overflowY=ue[ue.length>1?1:0],this.overflowWrap=Ze(B,$,U.overflowWrap),this.paddingTop=Ze(B,ce,U.paddingTop),this.paddingRight=Ze(B,ge,U.paddingRight),this.paddingBottom=Ze(B,Ce,U.paddingBottom),this.paddingLeft=Ze(B,je,U.paddingLeft),this.paintOrder=Ze(B,qe,U.paintOrder),this.position=Ze(B,Ke,U.position),this.textAlign=Ze(B,De,U.textAlign),this.textDecorationColor=Ze(B,l,(F=U.textDecorationColor)!==null&&F!==void 0?F:U.color),this.textDecorationLine=Ze(B,u,(G=U.textDecorationLine)!==null&&G!==void 0?G:U.textDecoration),this.textShadow=Ze(B,lt,U.textShadow),this.textTransform=Ze(B,ht,U.textTransform),this.transform=Ze(B,vt,U.transform),this.transformOrigin=Ze(B,Mt,U.transformOrigin),this.visibility=Ze(B,Ft,U.visibility),this.webkitTextStrokeColor=Ze(B,ke,U.webkitTextStrokeColor),this.webkitTextStrokeWidth=Ze(B,Xe,U.webkitTextStrokeWidth),this.wordBreak=Ze(B,jt,U.wordBreak),this.zIndex=Ze(B,St,U.zIndex)}return I.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},I.prototype.isTransparent=function(){return ts(this.backgroundColor)},I.prototype.isTransformed=function(){return this.transform!==null},I.prototype.isPositioned=function(){return this.position!==0},I.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},I.prototype.isFloating=function(){return this.float!==0},I.prototype.isInlineLevel=function(){return R(this.display,4)||R(this.display,33554432)||R(this.display,268435456)||R(this.display,536870912)||R(this.display,67108864)||R(this.display,134217728)},I}(),at=function(){function I(B,U){this.content=Ze(B,J,U.content),this.quotes=Ze(B,Te,U.quotes)}return I}(),mt=function(){function I(B,U){this.counterIncrement=Ze(B,Ae,U.counterIncrement),this.counterReset=Ze(B,Be,U.counterReset)}return I}(),Ze=function(I,B,U){var F=new Yi,G=U!=null?U.toString():B.initialValue;F.write(G);var ue=new sn(F.read());switch(B.type){case 2:var _e=ue.parseComponentValue();return B.parse(I,Tn(_e)?_e.value:B.initialValue);case 0:return B.parse(I,ue.parseComponentValue());case 1:return B.parse(I,ue.parseComponentValues());case 4:return ue.parseComponentValue();case 3:switch(B.format){case"angle":return Ys.parse(I,ue.parseComponentValue());case"color":return ho.parse(I,ue.parseComponentValue());case"image":return xa.parse(I,ue.parseComponentValue());case"length":var Ge=ue.parseComponentValue();return ta(Ge)?Ge:To;case"length-percentage":var Ve=ue.parseComponentValue();return Ai(Ve)?Ve:To;case"time":return mr.parse(I,ue.parseComponentValue())}}},bt="data-html2canvas-debug",Tt=function(I){switch(I.getAttribute(bt)){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},Vt=function(I,B){var U=Tt(I);return U===1||B===U},Ht=function(){function I(B,U){this.context=B,this.textNodes=[],this.elements=[],this.flags=0,Vt(U,3),this.styles=new et(B,window.getComputedStyle(U,null)),wu(U)&&(this.styles.animationDuration.some(function(F){return F>0})&&(U.style.animationDuration="0s"),this.styles.transform!==null&&(U.style.transform="none")),this.bounds=ae(this.context,U),Vt(U,4)&&(this.flags|=16)}return I}(),hr="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",Er="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Mr=typeof Uint8Array>"u"?[]:new Uint8Array(256),Ur=0;Ur<Er.length;Ur++)Mr[Er.charCodeAt(Ur)]=Ur;for(var gi=function(I){var B,U,F,G,ue,_e=.75*I.length,Ge=I.length,Ve=0;I[I.length-1]==="="&&(_e--,I[I.length-2]==="="&&_e--);var ut=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&Uint8Array.prototype.slice!==void 0?new ArrayBuffer(_e):new Array(_e),pt=Array.isArray(ut)?ut:new Uint8Array(ut);for(B=0;B<Ge;B+=4)U=Mr[I.charCodeAt(B)],F=Mr[I.charCodeAt(B+1)],G=Mr[I.charCodeAt(B+2)],ue=Mr[I.charCodeAt(B+3)],pt[Ve++]=U<<2|F>>4,pt[Ve++]=(15&F)<<4|G>>2,pt[Ve++]=(3&G)<<6|63&ue;return ut},lr=function(I){for(var B=I.length,U=[],F=0;F<B;F+=2)U.push(I[F+1]<<8|I[F]);return U},zr=function(I){for(var B=I.length,U=[],F=0;F<B;F+=4)U.push(I[F+3]<<24|I[F+2]<<16|I[F+1]<<8|I[F]);return U},$r=5,qr=11,Zr=2,si=65536>>$r,Lr=(1<<$r)-1,Dr=si+(1024>>$r)+32,Kn=65536>>qr,dn=(1<<qr-$r)-1,ao=function(I,B,U){return I.slice?I.slice(B,U):new Uint16Array(Array.prototype.slice.call(I,B,U))},Vo=function(I,B,U){return I.slice?I.slice(B,U):new Uint32Array(Array.prototype.slice.call(I,B,U))},Un=function(I,B){var U=gi(I),F=Array.isArray(U)?zr(U):new Uint32Array(U),G=Array.isArray(U)?lr(U):new Uint16Array(U),ue=24,_e=ao(G,ue/2,F[4]/2),Ge=F[5]===2?ao(G,(ue+F[4])/2):Vo(F,Math.ceil((ue+F[4])/4));return new vo(F[0],F[1],F[2],F[3],_e,Ge)},vo=function(){function I(B,U,F,G,ue,_e){this.initialValue=B,this.errorValue=U,this.highStart=F,this.highValueIndex=G,this.index=ue,this.data=_e}return I.prototype.get=function(B){var U;if(B>=0){if(B<55296||B>56319&&B<=65535)return U=((U=this.index[B>>$r])<<Zr)+(B&Lr),this.data[U];if(B<=65535)return U=((U=this.index[si+(B-55296>>$r)])<<Zr)+(B&Lr),this.data[U];if(B<this.highStart)return U=Dr-Kn+(B>>qr),U=this.index[U],U+=B>>$r&dn,U=((U=this.index[U])<<Zr)+(B&Lr),this.data[U];if(B<=1114111)return this.data[this.highValueIndex]}return this.errorValue},I}(),Ea="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",en=typeof Uint8Array>"u"?[]:new Uint8Array(256),ns=0;ns<Ea.length;ns++)en[Ea.charCodeAt(ns)]=ns;var No,ma=1,Ko=2,sl=3,xl=4,ll=5,IA=7,AA=8,bs=9,wl=10,Vs=11,xo=12,Ns=13,Al=14,Wa=15,tn=function(I){for(var B=[],U=0,F=I.length;U<F;){var G=I.charCodeAt(U++);if(G>=55296&&G<=56319&&U<F){var ue=I.charCodeAt(U++);(64512&ue)==56320?B.push(((1023&G)<<10)+(1023&ue)+65536):(B.push(G),U--)}else B.push(G)}return B},ga=function(){for(var I=[],B=0;B<arguments.length;B++)I[B]=arguments[B];if(String.fromCodePoint)return String.fromCodePoint.apply(String,I);var U=I.length;if(!U)return"";for(var F=[],G=-1,ue="";++G<U;){var _e=I[G];_e<=65535?F.push(_e):(_e-=65536,F.push(55296+(_e>>10),_e%1024+56320)),(G+1===U||F.length>16384)&&(ue+=String.fromCharCode.apply(String,F),F.length=0)}return ue},na=Un(hr),ko="\xD7",Nc="\xF7",yc=function(I){return na.get(I)},Ia=function(I,B,U){var F=U-2,G=B[F],ue=B[U-1],_e=B[U];if(ue===Ko&&_e===sl)return ko;if(ue===Ko||ue===sl||ue===xl||_e===Ko||_e===sl||_e===xl)return Nc;if(ue===AA&&[AA,bs,Vs,xo].indexOf(_e)!==-1||!(ue!==Vs&&ue!==bs||_e!==bs&&_e!==wl)||(ue===xo||ue===wl)&&_e===wl||_e===Ns||_e===ll||_e===IA||ue===ma)return ko;if(ue===Ns&&_e===Al){for(;G===ll;)G=B[--F];if(G===Al)return ko}if(ue===Wa&&_e===Wa){for(var Ge=0;G===Wa;)Ge++,G=B[--F];if(Ge%2==0)return ko}return Nc},Go=function(I){var B=tn(I),U=B.length,F=0,G=0,ue=B.map(yc);return{next:function(){if(F>=U)return{done:!0,value:null};for(var _e=ko;F<U&&(_e=Ia(B,ue,++F))===ko;);if(_e!==ko||F===U){var Ge=ga.apply(null,B.slice(G,F));return G=F,{value:Ge,done:!1}}return{done:!0,value:null}}}},Kc=function(I){for(var B,U=Go(I),F=[];!(B=U.next()).done;)B.value&&F.push(B.value.slice());return F},Gl=function(I){var B=123;if(I.createRange){var U=I.createRange();if(U.getBoundingClientRect){var F=I.createElement("boundtest");F.style.height=B+"px",F.style.display="block",I.body.appendChild(F),U.selectNode(F);var G=U.getBoundingClientRect(),ue=Math.round(G.height);if(I.body.removeChild(F),ue===B)return!0}}return!1},XA=function(I){var B=I.createElement("boundtest");B.style.width="50px",B.style.display="block",B.style.fontSize="12px",B.style.letterSpacing="0px",B.style.wordSpacing="0px",I.body.appendChild(B);var U=I.createRange();B.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var F=B.firstChild,G=ie(F.data).map(function(Ve){return be(Ve)}),ue=0,_e={},Ge=G.every(function(Ve,ut){U.setStart(F,ue),U.setEnd(F,ue+Ve.length);var pt=U.getBoundingClientRect();ue+=Ve.length;var Pt=pt.x>_e.x||pt.y>_e.y;return _e=pt,ut===0||Pt});return I.body.removeChild(B),Ge},WA=function(){return new Image().crossOrigin!==void 0},JA=function(){return typeof new XMLHttpRequest().responseType=="string"},Ha=function(I){var B=new Image,U=I.createElement("canvas"),F=U.getContext("2d");if(!F)return!1;B.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{F.drawImage(B,0,0),U.toDataURL()}catch{return!1}return!0},Xu=function(I){return I[0]===0&&I[1]===255&&I[2]===0&&I[3]===255},Gc=function(I){var B=I.createElement("canvas"),U=100;B.width=U,B.height=U;var F=B.getContext("2d");if(!F)return Promise.reject(!1);F.fillStyle="rgb(0, 255, 0)",F.fillRect(0,0,U,U);var G=new Image,ue=B.toDataURL();G.src=ue;var _e=gu(U,U,0,0,G);return F.fillStyle="red",F.fillRect(0,0,U,U),Wu(_e).then(function(Ge){F.drawImage(Ge,0,0);var Ve=F.getImageData(0,0,U,U).data;F.fillStyle="red",F.fillRect(0,0,U,U);var ut=I.createElement("div");return ut.style.backgroundImage="url("+ue+")",ut.style.height=U+"px",Xu(Ve)?Wu(gu(U,U,0,0,ut)):Promise.reject(!1)}).then(function(Ge){return F.drawImage(Ge,0,0),Xu(F.getImageData(0,0,U,U).data)}).catch(function(){return!1})},gu=function(I,B,U,F,G){var ue="http://www.w3.org/2000/svg",_e=document.createElementNS(ue,"svg"),Ge=document.createElementNS(ue,"foreignObject");return _e.setAttributeNS(null,"width",I.toString()),_e.setAttributeNS(null,"height",B.toString()),Ge.setAttributeNS(null,"width","100%"),Ge.setAttributeNS(null,"height","100%"),Ge.setAttributeNS(null,"x",U.toString()),Ge.setAttributeNS(null,"y",F.toString()),Ge.setAttributeNS(null,"externalResourcesRequired","true"),_e.appendChild(Ge),Ge.appendChild(G),_e},Wu=function(I){return new Promise(function(B,U){var F=new Image;F.onload=function(){return B(F)},F.onerror=U,F.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(I))})},Sa={get SUPPORT_RANGE_BOUNDS(){var I=Gl(document);return Object.defineProperty(Sa,"SUPPORT_RANGE_BOUNDS",{value:I}),I},get SUPPORT_WORD_BREAKING(){var I=Sa.SUPPORT_RANGE_BOUNDS&&XA(document);return Object.defineProperty(Sa,"SUPPORT_WORD_BREAKING",{value:I}),I},get SUPPORT_SVG_DRAWING(){var I=Ha(document);return Object.defineProperty(Sa,"SUPPORT_SVG_DRAWING",{value:I}),I},get SUPPORT_FOREIGNOBJECT_DRAWING(){var I=typeof Array.from=="function"&&typeof window.fetch=="function"?Gc(document):Promise.resolve(!1);return Object.defineProperty(Sa,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:I}),I},get SUPPORT_CORS_IMAGES(){var I=WA();return Object.defineProperty(Sa,"SUPPORT_CORS_IMAGES",{value:I}),I},get SUPPORT_RESPONSE_TYPE(){var I=JA();return Object.defineProperty(Sa,"SUPPORT_RESPONSE_TYPE",{value:I}),I},get SUPPORT_CORS_XHR(){var I="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Sa,"SUPPORT_CORS_XHR",{value:I}),I},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var I=!(typeof Intl>"u"||!Intl.Segmenter);return Object.defineProperty(Sa,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:I}),I}},jc=function(){function I(B,U){this.text=B,this.bounds=U}return I}(),$c=function(I,B,U,F){var G=_c(B,U),ue=[],_e=0;return G.forEach(function(Ge){if(U.textDecorationLine.length||Ge.trim().length>0)if(Sa.SUPPORT_RANGE_BOUNDS){var Ve=YA(F,_e,Ge.length).getClientRects();if(Ve.length>1){var ut=SA(Ge),pt=0;ut.forEach(function(Qt){ue.push(new jc(Qt,K.fromDOMRectList(I,YA(F,pt+_e,Qt.length).getClientRects()))),pt+=Qt.length})}else ue.push(new jc(Ge,K.fromDOMRectList(I,Ve)))}else{var Pt=F.splitText(Ge.length);ue.push(new jc(Ge,Eh(I,F))),F=Pt}else Sa.SUPPORT_RANGE_BOUNDS||(F=F.splitText(Ge.length));_e+=Ge.length}),ue},Eh=function(I,B){var U=B.ownerDocument;if(U){var F=U.createElement("html2canvaswrapper");F.appendChild(B.cloneNode(!0));var G=B.parentNode;if(G){G.replaceChild(F,B);var ue=ae(I,F);return F.firstChild&&G.replaceChild(F.firstChild,F),ue}}return K.EMPTY},YA=function(I,B,U){var F=I.ownerDocument;if(!F)throw new Error("Node has no owner document");var G=F.createRange();return G.setStart(I,B),G.setEnd(I,B+U),G},SA=function(I){if(Sa.SUPPORT_NATIVE_TEXT_SEGMENTATION){var B=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(B.segment(I)).map(function(U){return U.segment})}return Kc(I)},oa=function(I,B){if(Sa.SUPPORT_NATIVE_TEXT_SEGMENTATION){var U=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(U.segment(I)).map(function(F){return F.segment})}return xp(I,B)},_c=function(I,B){return B.letterSpacing!==0?SA(I):oa(I,B)},vp=[32,160,4961,65792,65793,4153,4241],xp=function(I,B){for(var U,F=ve(I,{lineBreak:B.lineBreak,wordBreak:B.overflowWrap==="break-word"?"break-word":B.wordBreak}),G=[],ue=function(){if(U.value){var _e=U.value.slice(),Ge=ie(_e),Ve="";Ge.forEach(function(ut){vp.indexOf(ut)===-1?Ve+=be(ut):(Ve.length&&G.push(Ve),G.push(be(ut)),Ve="")}),Ve.length&&G.push(Ve)}};!(U=F.next()).done;)ue();return G},wp=function(){function I(B,U,F){this.text=yu(U.data,F.textTransform),this.textBounds=$c(B,this.text,F,U)}return I}(),yu=function(I,B){switch(B){case 1:return I.toLowerCase();case 3:return I.replace(_u,Ih);case 2:return I.toUpperCase();default:return I}},_u=/(^|\s|:|-|\(|\))([a-z])/g,Ih=function(I,B,U){return I.length>0?B+U.toUpperCase():I},TA=function(I){function B(U,F){var G=I.call(this,U,F)||this;return G.src=F.currentSrc||F.src,G.intrinsicWidth=F.naturalWidth,G.intrinsicHeight=F.naturalHeight,G.context.cache.addImage(G.src),G}return E(B,I),B}(Ht),FA=function(I){function B(U,F){var G=I.call(this,U,F)||this;return G.canvas=F,G.intrinsicWidth=F.width,G.intrinsicHeight=F.height,G}return E(B,I),B}(Ht),Sh=function(I){function B(U,F){var G=I.call(this,U,F)||this,ue=new XMLSerializer,_e=ae(U,F);return F.setAttribute("width",_e.width+"px"),F.setAttribute("height",_e.height+"px"),G.svg="data:image/svg+xml,"+encodeURIComponent(ue.serializeToString(F)),G.intrinsicWidth=F.width.baseVal.value,G.intrinsicHeight=F.height.baseVal.value,G.context.cache.addImage(G.svg),G}return E(B,I),B}(Ht),ec=function(I){function B(U,F){var G=I.call(this,U,F)||this;return G.value=F.value,G}return E(B,I),B}(Ht),Ju=function(I){function B(U,F){var G=I.call(this,U,F)||this;return G.start=F.start,G.reversed=typeof F.reversed=="boolean"&&F.reversed===!0,G}return E(B,I),B}(Ht),Po=[{type:15,flags:0,unit:"px",number:3}],vu=[{type:16,flags:0,number:50}],Th=function(I){return I.width>I.height?new K(I.left+(I.width-I.height)/2,I.top,I.height,I.height):I.width<I.height?new K(I.left,I.top+(I.height-I.width)/2,I.width,I.width):I},xu=function(I){var B=I.type===tc?new Array(I.value.length+1).join("\u2022"):I.value;return B.length===0?I.placeholder||"":B},cA="checkbox",UA="radio",tc="password",Yu=707406591,Jn=function(I){function B(U,F){var G=I.call(this,U,F)||this;switch(G.type=F.type.toLowerCase(),G.checked=F.checked,G.value=xu(F),G.type!==cA&&G.type!==UA||(G.styles.backgroundColor=3739148031,G.styles.borderTopColor=G.styles.borderRightColor=G.styles.borderBottomColor=G.styles.borderLeftColor=2779096575,G.styles.borderTopWidth=G.styles.borderRightWidth=G.styles.borderBottomWidth=G.styles.borderLeftWidth=1,G.styles.borderTopStyle=G.styles.borderRightStyle=G.styles.borderBottomStyle=G.styles.borderLeftStyle=1,G.styles.backgroundClip=[0],G.styles.backgroundOrigin=[0],G.bounds=Th(G.bounds)),G.type){case cA:G.styles.borderTopRightRadius=G.styles.borderTopLeftRadius=G.styles.borderBottomRightRadius=G.styles.borderBottomLeftRadius=Po;break;case UA:G.styles.borderTopRightRadius=G.styles.borderTopLeftRadius=G.styles.borderBottomRightRadius=G.styles.borderBottomLeftRadius=vu}return G}return E(B,I),B}(Ht),rc=function(I){function B(U,F){var G=I.call(this,U,F)||this,ue=F.options[F.selectedIndex||0];return G.value=ue&&ue.text||"",G}return E(B,I),B}(Ht),qc=function(I){function B(U,F){var G=I.call(this,U,F)||this;return G.value=F.value,G}return E(B,I),B}(Ht),Zc=function(I){function B(U,F){var G=I.call(this,U,F)||this;G.src=F.src,G.width=parseInt(F.width,10)||0,G.height=parseInt(F.height,10)||0,G.backgroundColor=G.styles.backgroundColor;try{if(F.contentWindow&&F.contentWindow.document&&F.contentWindow.document.documentElement){G.tree=eh(U,F.contentWindow.document.documentElement);var ue=F.contentWindow.document.documentElement?Vl(U,getComputedStyle(F.contentWindow.document.documentElement).backgroundColor):Ra.TRANSPARENT,_e=F.contentWindow.document.body?Vl(U,getComputedStyle(F.contentWindow.document.body).backgroundColor):Ra.TRANSPARENT;G.backgroundColor=ts(ue)?ts(_e)?G.styles.backgroundColor:_e:ue}}catch{}return G}return E(B,I),B}(Ht),MA=["OL","UL","MENU"],kA=function(I,B,U,F){for(var G=B.firstChild,ue=void 0;G;G=ue)if(ue=G.nextSibling,Bs(G)&&G.data.trim().length>0)U.textNodes.push(new wp(I,G,U.styles));else if(vc(G))if(oc(G)&&G.assignedNodes)G.assignedNodes().forEach(function(Ge){return kA(I,Ge,U,F)});else{var _e=Xc(I,G);_e.styles.isVisible()&&(ic(G,_e,F)?_e.flags|=4:Wc(_e.styles)&&(_e.flags|=2),MA.indexOf(G.tagName)!==-1&&(_e.flags|=8),U.elements.push(_e),G.slot,G.shadowRoot?kA(I,G.shadowRoot,_e,F):QA(G)||Bu(G)||os(G)||kA(I,G,_e,F))}},Xc=function(I,B){return ih(B)?new TA(I,B):rh(B)?new FA(I,B):Bu(B)?new Sh(I,B):bp(B)?new ec(I,B):bu(B)?new Ju(I,B):xc(B)?new Jn(I,B):os(B)?new rc(I,B):QA(B)?new qc(I,B):nc(B)?new Zc(I,B):new Ht(I,B)},eh=function(I,B){var U=Xc(I,B);return U.flags|=4,kA(I,B,U,U),U},ic=function(I,B,U){return B.styles.isPositionedWithZIndex()||B.styles.opacity<1||B.styles.isTransformed()||wc(I)&&U.styles.isTransparent()},Wc=function(I){return I.isPositioned()||I.isFloating()},Bs=function(I){return I.nodeType===Node.TEXT_NODE},vc=function(I){return I.nodeType===Node.ELEMENT_NODE},wu=function(I){return vc(I)&&I.style!==void 0&&!PA(I)},PA=function(I){return typeof I.className=="object"},bp=function(I){return I.tagName==="LI"},bu=function(I){return I.tagName==="OL"},xc=function(I){return I.tagName==="INPUT"},th=function(I){return I.tagName==="HTML"},Bu=function(I){return I.tagName==="svg"},wc=function(I){return I.tagName==="BODY"},rh=function(I){return I.tagName==="CANVAS"},Fh=function(I){return I.tagName==="VIDEO"},ih=function(I){return I.tagName==="IMG"},nc=function(I){return I.tagName==="IFRAME"},Uh=function(I){return I.tagName==="STYLE"},jl=function(I){return I.tagName==="SCRIPT"},QA=function(I){return I.tagName==="TEXTAREA"},os=function(I){return I.tagName==="SELECT"},oc=function(I){return I.tagName==="SLOT"},Mh=function(I){return I.tagName.indexOf("-")>0},Bp=function(){function I(){this.counters={}}return I.prototype.getCounterValue=function(B){var U=this.counters[B];return U&&U.length?U[U.length-1]:1},I.prototype.getCounterValues=function(B){var U=this.counters[B];return U||[]},I.prototype.pop=function(B){var U=this;B.forEach(function(F){return U.counters[F].pop()})},I.prototype.parse=function(B){var U=this,F=B.counterIncrement,G=B.counterReset,ue=!0;F!==null&&F.forEach(function(Ge){var Ve=U.counters[Ge.counter];Ve&&Ge.increment!==0&&(ue=!1,Ve.length||Ve.push(1),Ve[Math.max(0,Ve.length-1)]+=Ge.increment)});var _e=[];return ue&&G.forEach(function(Ge){var Ve=U.counters[Ge.counter];_e.push(Ge.counter),Ve||(Ve=U.counters[Ge.counter]=[]),Ve.push(Ge.reset)}),_e},I}(),bc={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},Cu={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["\u0554","\u0553","\u0552","\u0551","\u0550","\u054F","\u054E","\u054D","\u054C","\u054B","\u054A","\u0549","\u0548","\u0547","\u0546","\u0545","\u0544","\u0543","\u0542","\u0541","\u0540","\u053F","\u053E","\u053D","\u053C","\u053B","\u053A","\u0539","\u0538","\u0537","\u0536","\u0535","\u0534","\u0533","\u0532","\u0531"]},kh={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["\u05D9\u05F3","\u05D8\u05F3","\u05D7\u05F3","\u05D6\u05F3","\u05D5\u05F3","\u05D4\u05F3","\u05D3\u05F3","\u05D2\u05F3","\u05D1\u05F3","\u05D0\u05F3","\u05EA","\u05E9","\u05E8","\u05E7","\u05E6","\u05E4","\u05E2","\u05E1","\u05E0","\u05DE","\u05DC","\u05DB","\u05D9\u05D8","\u05D9\u05D7","\u05D9\u05D6","\u05D8\u05D6","\u05D8\u05D5","\u05D9","\u05D8","\u05D7","\u05D6","\u05D5","\u05D4","\u05D3","\u05D2","\u05D1","\u05D0"]},Cp={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["\u10F5","\u10F0","\u10EF","\u10F4","\u10EE","\u10ED","\u10EC","\u10EB","\u10EA","\u10E9","\u10E8","\u10E7","\u10E6","\u10E5","\u10E4","\u10F3","\u10E2","\u10E1","\u10E0","\u10DF","\u10DE","\u10DD","\u10F2","\u10DC","\u10DB","\u10DA","\u10D9","\u10D8","\u10D7","\u10F1","\u10D6","\u10D5","\u10D4","\u10D3","\u10D2","\u10D1","\u10D0"]},Bc=function(I,B,U,F,G,ue){return I<B||I>U?Yc(I,G,ue.length>0):F.integers.reduce(function(_e,Ge,Ve){for(;I>=Ge;)I-=Ge,_e+=F.values[Ve];return _e},"")+ue},Ph=function(I,B,U,F){var G="";do U||I--,G=F(I)+G,I/=B;while(I*B>=B);return G},jo=function(I,B,U,F,G){var ue=U-B+1;return(I<0?"-":"")+(Ph(Math.abs(I),ue,F,function(_e){return be(Math.floor(_e%ue)+B)})+G)},wo=function(I,B,U){U===void 0&&(U=". ");var F=B.length;return Ph(Math.abs(I),F,!1,function(G){return B[Math.floor(G%F)]})+U},$l=1,bl=2,uA=4,Jc=8,ql=function(I,B,U,F,G,ue){if(I<-9999||I>9999)return Yc(I,4,G.length>0);var _e=Math.abs(I),Ge=G;if(_e===0)return B[0]+Ge;for(var Ve=0;_e>0&&Ve<=4;Ve++){var ut=_e%10;ut===0&&R(ue,$l)&&Ge!==""?Ge=B[ut]+Ge:ut>1||ut===1&&Ve===0||ut===1&&Ve===1&&R(ue,bl)||ut===1&&Ve===1&&R(ue,uA)&&I>100||ut===1&&Ve>1&&R(ue,Jc)?Ge=B[ut]+(Ve>0?U[Ve-1]:"")+Ge:ut===1&&Ve>0&&(Ge=U[Ve-1]+Ge),_e=Math.floor(_e/10)}return(I<0?F:"")+Ge},Cc="\u5341\u767E\u5343\u842C",nh="\u62FE\u4F70\u4EDF\u842C",Qh="\u30DE\u30A4\u30CA\u30B9",Eu="\uB9C8\uC774\uB108\uC2A4",Yc=function(I,B,U){var F=U?". ":"",G=U?"\u3001":"",ue=U?", ":"",_e=U?" ":"";switch(B){case 0:return"\u2022"+_e;case 1:return"\u25E6"+_e;case 2:return"\u25FE"+_e;case 5:var Ge=jo(I,48,57,!0,F);return Ge.length<4?"0"+Ge:Ge;case 4:return wo(I,"\u3007\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D",G);case 6:return Bc(I,1,3999,bc,3,F).toLowerCase();case 7:return Bc(I,1,3999,bc,3,F);case 8:return jo(I,945,969,!1,F);case 9:return jo(I,97,122,!1,F);case 10:return jo(I,65,90,!1,F);case 11:return jo(I,1632,1641,!0,F);case 12:case 49:return Bc(I,1,9999,Cu,3,F);case 35:return Bc(I,1,9999,Cu,3,F).toLowerCase();case 13:return jo(I,2534,2543,!0,F);case 14:case 30:return jo(I,6112,6121,!0,F);case 15:return wo(I,"\u5B50\u4E11\u5BC5\u536F\u8FB0\u5DF3\u5348\u672A\u7533\u9149\u620C\u4EA5",G);case 16:return wo(I,"\u7532\u4E59\u4E19\u4E01\u620A\u5DF1\u5E9A\u8F9B\u58EC\u7678",G);case 17:case 48:return ql(I,"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D",Cc,"\u8CA0",G,bl|uA|Jc);case 47:return ql(I,"\u96F6\u58F9\u8CB3\u53C3\u8086\u4F0D\u9678\u67D2\u634C\u7396",nh,"\u8CA0",G,$l|bl|uA|Jc);case 42:return ql(I,"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D",Cc,"\u8D1F",G,bl|uA|Jc);case 41:return ql(I,"\u96F6\u58F9\u8D30\u53C1\u8086\u4F0D\u9646\u67D2\u634C\u7396",nh,"\u8D1F",G,$l|bl|uA|Jc);case 26:return ql(I,"\u3007\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D","\u5341\u767E\u5343\u4E07",Qh,G,0);case 25:return ql(I,"\u96F6\u58F1\u5F10\u53C2\u56DB\u4F0D\u516D\u4E03\u516B\u4E5D","\u62FE\u767E\u5343\u4E07",Qh,G,$l|bl|uA);case 31:return ql(I,"\uC601\uC77C\uC774\uC0BC\uC0AC\uC624\uC721\uCE60\uD314\uAD6C","\uC2ED\uBC31\uCC9C\uB9CC",Eu,ue,$l|bl|uA);case 33:return ql(I,"\u96F6\u4E00\u4E8C\u4E09\u56DB\u4E94\u516D\u4E03\u516B\u4E5D","\u5341\u767E\u5343\u842C",Eu,ue,0);case 32:return ql(I,"\u96F6\u58F9\u8CB3\u53C3\u56DB\u4E94\u516D\u4E03\u516B\u4E5D","\u62FE\u767E\u5343",Eu,ue,$l|bl|uA);case 18:return jo(I,2406,2415,!0,F);case 20:return Bc(I,1,19999,Cp,3,F);case 21:return jo(I,2790,2799,!0,F);case 22:return jo(I,2662,2671,!0,F);case 22:return Bc(I,1,10999,kh,3,F);case 23:return wo(I,"\u3042\u3044\u3046\u3048\u304A\u304B\u304D\u304F\u3051\u3053\u3055\u3057\u3059\u305B\u305D\u305F\u3061\u3064\u3066\u3068\u306A\u306B\u306C\u306D\u306E\u306F\u3072\u3075\u3078\u307B\u307E\u307F\u3080\u3081\u3082\u3084\u3086\u3088\u3089\u308A\u308B\u308C\u308D\u308F\u3090\u3091\u3092\u3093");case 24:return wo(I,"\u3044\u308D\u306F\u306B\u307B\u3078\u3068\u3061\u308A\u306C\u308B\u3092\u308F\u304B\u3088\u305F\u308C\u305D\u3064\u306D\u306A\u3089\u3080\u3046\u3090\u306E\u304A\u304F\u3084\u307E\u3051\u3075\u3053\u3048\u3066\u3042\u3055\u304D\u3086\u3081\u307F\u3057\u3091\u3072\u3082\u305B\u3059");case 27:return jo(I,3302,3311,!0,F);case 28:return wo(I,"\u30A2\u30A4\u30A6\u30A8\u30AA\u30AB\u30AD\u30AF\u30B1\u30B3\u30B5\u30B7\u30B9\u30BB\u30BD\u30BF\u30C1\u30C4\u30C6\u30C8\u30CA\u30CB\u30CC\u30CD\u30CE\u30CF\u30D2\u30D5\u30D8\u30DB\u30DE\u30DF\u30E0\u30E1\u30E2\u30E4\u30E6\u30E8\u30E9\u30EA\u30EB\u30EC\u30ED\u30EF\u30F0\u30F1\u30F2\u30F3",G);case 29:return wo(I,"\u30A4\u30ED\u30CF\u30CB\u30DB\u30D8\u30C8\u30C1\u30EA\u30CC\u30EB\u30F2\u30EF\u30AB\u30E8\u30BF\u30EC\u30BD\u30C4\u30CD\u30CA\u30E9\u30E0\u30A6\u30F0\u30CE\u30AA\u30AF\u30E4\u30DE\u30B1\u30D5\u30B3\u30A8\u30C6\u30A2\u30B5\u30AD\u30E6\u30E1\u30DF\u30B7\u30F1\u30D2\u30E2\u30BB\u30B9",G);case 34:return jo(I,3792,3801,!0,F);case 37:return jo(I,6160,6169,!0,F);case 38:return jo(I,4160,4169,!0,F);case 39:return jo(I,2918,2927,!0,F);case 40:return jo(I,1776,1785,!0,F);case 43:return jo(I,3046,3055,!0,F);case 44:return jo(I,3174,3183,!0,F);case 45:return jo(I,3664,3673,!0,F);case 46:return jo(I,3872,3881,!0,F);default:return jo(I,48,57,!0,F)}},Dh="data-html2canvas-ignore",Ec=function(){function I(B,U,F){if(this.context=B,this.options=F,this.scrolledElements=[],this.referenceElement=U,this.counters=new Bp,this.quoteDepth=0,!U.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(U.ownerDocument.documentElement,!1)}return I.prototype.toIFrame=function(B,U){var F=this,G=oh(B,U);if(!G.contentWindow)return Promise.reject("Unable to find iframe window");var ue=B.defaultView.pageXOffset,_e=B.defaultView.pageYOffset,Ge=G.contentWindow,Ve=Ge.document,ut=ah(G).then(function(){return V(F,void 0,void 0,function(){var pt,Pt;return o(this,function(Qt){switch(Qt.label){case 0:return this.scrolledElements.forEach(Ip),Ge&&(Ge.scrollTo(U.left,U.top),!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)||Ge.scrollY===U.top&&Ge.scrollX===U.left||(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(Ge.scrollX-U.left,Ge.scrollY-U.top,0,0))),pt=this.options.onclone,(Pt=this.clonedReferenceElement)===void 0?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:Ve.fonts&&Ve.fonts.ready?[4,Ve.fonts.ready]:[3,2];case 1:Qt.sent(),Qt.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,Vn(Ve)]:[3,4];case 3:Qt.sent(),Qt.label=4;case 4:return typeof pt=="function"?[2,Promise.resolve().then(function(){return pt(Ve,Pt)}).then(function(){return G})]:[2,G]}})})});return Ve.open(),Ve.write(Lh(document.doctype)+"<html></html>"),Ep(this.referenceElement.ownerDocument,ue,_e),Ve.replaceChild(Ve.adoptNode(this.documentElement),Ve.documentElement),Ve.close(),ut},I.prototype.createElementClone=function(B){if(Vt(B,2),rh(B))return this.createCanvasClone(B);if(Fh(B))return this.createVideoClone(B);if(Uh(B))return this.createStyleClone(B);var U=B.cloneNode(!1);return ih(U)&&(ih(B)&&B.currentSrc&&B.currentSrc!==B.src&&(U.src=B.currentSrc,U.srcset=""),U.loading==="lazy"&&(U.loading="eager")),Mh(U)?this.createCustomElementClone(U):U},I.prototype.createCustomElementClone=function(B){var U=document.createElement("html2canvascustomelement");return hA(B.style,U),U},I.prototype.createStyleClone=function(B){try{var U=B.sheet;if(U&&U.cssRules){var F=[].slice.call(U.cssRules,0).reduce(function(ue,_e){return _e&&typeof _e.cssText=="string"?ue+_e.cssText:ue},""),G=B.cloneNode(!1);return G.textContent=F,G}}catch(ue){if(this.context.logger.error("Unable to access cssRules property",ue),ue.name!=="SecurityError")throw ue}return B.cloneNode(!1)},I.prototype.createCanvasClone=function(B){var U;if(this.options.inlineImages&&B.ownerDocument){var F=B.ownerDocument.createElement("img");try{return F.src=B.toDataURL(),F}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",B)}}var G=B.cloneNode(!1);try{G.width=B.width,G.height=B.height;var ue=B.getContext("2d"),_e=G.getContext("2d");if(_e)if(!this.options.allowTaint&&ue)_e.putImageData(ue.getImageData(0,0,B.width,B.height),0,0);else{var Ge=(U=B.getContext("webgl2"))!==null&&U!==void 0?U:B.getContext("webgl");if(Ge){var Ve=Ge.getContextAttributes();(Ve==null?void 0:Ve.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",B)}_e.drawImage(B,0,0)}return G}catch{this.context.logger.info("Unable to clone canvas as it is tainted",B)}return G},I.prototype.createVideoClone=function(B){var U=B.ownerDocument.createElement("canvas");U.width=B.offsetWidth,U.height=B.offsetHeight;var F=U.getContext("2d");try{return F&&(F.drawImage(B,0,0,U.width,U.height),this.options.allowTaint||F.getImageData(0,0,U.width,U.height)),U}catch{this.context.logger.info("Unable to clone video as it is tainted",B)}var G=B.ownerDocument.createElement("canvas");return G.width=B.offsetWidth,G.height=B.offsetHeight,G},I.prototype.appendChildNode=function(B,U,F){vc(U)&&(jl(U)||U.hasAttribute(Dh)||typeof this.options.ignoreElements=="function"&&this.options.ignoreElements(U))||this.options.copyStyles&&vc(U)&&Uh(U)||B.appendChild(this.cloneNode(U,F))},I.prototype.cloneChildNodes=function(B,U,F){for(var G=this,ue=B.shadowRoot?B.shadowRoot.firstChild:B.firstChild;ue;ue=ue.nextSibling)if(vc(ue)&&oc(ue)&&typeof ue.assignedNodes=="function"){var _e=ue.assignedNodes();_e.length&&_e.forEach(function(Ge){return G.appendChildNode(U,Ge,F)})}else this.appendChildNode(U,ue,F)},I.prototype.cloneNode=function(B,U){if(Bs(B))return document.createTextNode(B.data);if(!B.ownerDocument)return B.cloneNode(!1);var F=B.ownerDocument.defaultView;if(F&&vc(B)&&(wu(B)||PA(B))){var G=this.createElementClone(B);G.style.transitionProperty="none";var ue=F.getComputedStyle(B),_e=F.getComputedStyle(B,":before"),Ge=F.getComputedStyle(B,":after");this.referenceElement===B&&wu(G)&&(this.clonedReferenceElement=G),wc(G)&&lh(G);var Ve=this.counters.parse(new mt(this.context,ue)),ut=this.resolvePseudoContent(B,G,_e,No.BEFORE);Mh(B)&&(U=!0),Fh(B)||this.cloneChildNodes(B,G,U),ut&&G.insertBefore(ut,G.firstChild);var pt=this.resolvePseudoContent(B,G,Ge,No.AFTER);return pt&&G.appendChild(pt),this.counters.pop(Ve),(ue&&(this.options.copyStyles||PA(B))&&!nc(B)||U)&&hA(ue,G),B.scrollTop===0&&B.scrollLeft===0||this.scrolledElements.push([G,B.scrollLeft,B.scrollTop]),(QA(B)||os(B))&&(QA(G)||os(G))&&(G.value=B.value),G}return B.cloneNode(!1)},I.prototype.resolvePseudoContent=function(B,U,F,G){var ue=this;if(F){var _e=F.content,Ge=U.ownerDocument;if(Ge&&_e&&_e!=="none"&&_e!=="-moz-alt-content"&&F.display!=="none"){this.counters.parse(new mt(this.context,F));var Ve=new at(this.context,F),ut=Ge.createElement("html2canvaspseudoelement");hA(F,ut),Ve.content.forEach(function(Pt){if(Pt.type===0)ut.appendChild(Ge.createTextNode(Pt.value));else if(Pt.type===22){var Qt=Ge.createElement("img");Qt.src=Pt.value,Qt.style.opacity="1",ut.appendChild(Qt)}else if(Pt.type===18){if(Pt.name==="attr"){var Fr=Pt.values.filter(Tn);Fr.length&&ut.appendChild(Ge.createTextNode(B.getAttribute(Fr[0].value)||""))}else if(Pt.name==="counter"){var Nt=Pt.values.filter(ha),tr=Nt[0],ji=Nt[1];if(tr&&Tn(tr)){var ci=ue.counters.getCounterValue(tr.value),oi=ji&&Tn(ji)?r.parse(ue.context,ji.value):3;ut.appendChild(Ge.createTextNode(Yc(ci,oi,!1)))}}else if(Pt.name==="counters"){var Gn=Pt.values.filter(ha),Ii=(tr=Gn[0],Gn[1]);if(ji=Gn[2],tr&&Tn(tr)){var Si=ue.counters.getCounterValues(tr.value),ai=ji&&Tn(ji)?r.parse(ue.context,ji.value):3,nn=Ii&&Ii.type===0?Ii.value:"",xn=Si.map(function(Qr){return Yc(Qr,ai,!1)}).join(nn);ut.appendChild(Ge.createTextNode(xn))}}}else if(Pt.type===20)switch(Pt.value){case"open-quote":ut.appendChild(Ge.createTextNode(He(Ve.quotes,ue.quoteDepth++,!0)));break;case"close-quote":ut.appendChild(Ge.createTextNode(He(Ve.quotes,--ue.quoteDepth,!1)));break;default:ut.appendChild(Ge.createTextNode(Pt.value))}}),ut.className=sh+" "+ac;var pt=G===No.BEFORE?" "+sh:" "+ac;return PA(U)?U.className.baseValue+=pt:U.className+=pt,ut}}},I.destroy=function(B){return!!B.parentNode&&(B.parentNode.removeChild(B),!0)},I}();(function(I){I[I.BEFORE=0]="BEFORE",I[I.AFTER=1]="AFTER"})(No||(No={}));var Hn,oh=function(I,B){var U=I.createElement("iframe");return U.className="html2canvas-container",U.style.visibility="hidden",U.style.position="fixed",U.style.left="-10000px",U.style.top="0px",U.style.border="0",U.width=B.width.toString(),U.height=B.height.toString(),U.scrolling="no",U.setAttribute(Dh,"true"),I.body.appendChild(U),U},Ic=function(I){return new Promise(function(B){I.complete?B():I.src?(I.onload=B,I.onerror=B):B()})},Vn=function(I){return Promise.all([].slice.call(I.images,0).map(Ic))},ah=function(I){return new Promise(function(B,U){var F=I.contentWindow;if(!F)return U("No window assigned for iframe");var G=F.document;F.onload=I.onload=function(){F.onload=I.onload=null;var ue=setInterval(function(){G.body.childNodes.length>0&&G.readyState==="complete"&&(clearInterval(ue),B(I))},50)}})},Zl=["all","d","content"],hA=function(I,B){for(var U=I.length-1;U>=0;U--){var F=I.item(U);Zl.indexOf(F)===-1&&B.style.setProperty(F,I.getPropertyValue(F))}return B},Lh=function(I){var B="";return I&&(B+="<!DOCTYPE ",I.name&&(B+=I.name),I.internalSubset&&(B+=I.internalSubset),I.publicId&&(B+='"'+I.publicId+'"'),I.systemId&&(B+='"'+I.systemId+'"'),B+=">"),B},Ep=function(I,B,U){I&&I.defaultView&&(B!==I.defaultView.pageXOffset||U!==I.defaultView.pageYOffset)&&I.defaultView.scrollTo(B,U)},Ip=function(I){var B=I[0],U=I[1],F=I[2];B.scrollLeft=U,B.scrollTop=F},zh=":before",Sp=":after",sh="___html2canvas___pseudoelement_before",ac="___html2canvas___pseudoelement_after",aa=`{
    content: "" !important;
    display: none !important;
}`,lh=function(I){Rh(I,"."+sh+zh+aa+`
         .`+ac+Sp+aa)},Rh=function(I,B){var U=I.ownerDocument;if(U){var F=U.createElement("style");F.textContent=B,I.appendChild(F)}},Sc=function(){function I(){}return I.getOrigin=function(B){var U=I._link;return U?(U.href=B,U.href=U.href,U.protocol+U.hostname+U.port):"about:blank"},I.isSameOrigin=function(B){return I.getOrigin(B)===I._origin},I.setContext=function(B){I._link=B.document.createElement("a"),I._origin=I.getOrigin(B.location.href)},I._origin="about:blank",I}(),fn=function(){function I(B,U){this.context=B,this._options=U,this._cache={}}return I.prototype.addImage=function(B){var U=Promise.resolve();return this.has(B)||(DA(B)||Hh(B))&&(this._cache[B]=this.loadImage(B)).catch(function(){}),U},I.prototype.match=function(B){return this._cache[B]},I.prototype.loadImage=function(B){return V(this,void 0,void 0,function(){var U,F,G,ue,_e=this;return o(this,function(Ge){switch(Ge.label){case 0:return U=Sc.isSameOrigin(B),F=!cl(B)&&this._options.useCORS===!0&&Sa.SUPPORT_CORS_IMAGES&&!U,G=!cl(B)&&!U&&!DA(B)&&typeof this._options.proxy=="string"&&Sa.SUPPORT_CORS_XHR&&!F,U||this._options.allowTaint!==!1||cl(B)||DA(B)||G||F?(ue=B,G?[4,this.proxy(ue)]:[3,2]):[2];case 1:ue=Ge.sent(),Ge.label=2;case 2:return this.context.logger.debug("Added image "+B.substring(0,256)),[4,new Promise(function(Ve,ut){var pt=new Image;pt.onload=function(){return Ve(pt)},pt.onerror=ut,(dA(ue)||F)&&(pt.crossOrigin="anonymous"),pt.src=ue,pt.complete===!0&&setTimeout(function(){return Ve(pt)},500),_e._options.imageTimeout>0&&setTimeout(function(){return ut("Timed out ("+_e._options.imageTimeout+"ms) loading image")},_e._options.imageTimeout)})];case 3:return[2,Ge.sent()]}})})},I.prototype.has=function(B){return this._cache[B]!==void 0},I.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},I.prototype.proxy=function(B){var U=this,F=this._options.proxy;if(!F)throw new Error("No proxy defined");var G=B.substring(0,256);return new Promise(function(ue,_e){var Ge=Sa.SUPPORT_RESPONSE_TYPE?"blob":"text",Ve=new XMLHttpRequest;Ve.onload=function(){if(Ve.status===200)if(Ge==="text")ue(Ve.response);else{var Pt=new FileReader;Pt.addEventListener("load",function(){return ue(Pt.result)},!1),Pt.addEventListener("error",function(Qt){return _e(Qt)},!1),Pt.readAsDataURL(Ve.response)}else _e("Failed to proxy resource "+G+" with status code "+Ve.status)},Ve.onerror=_e;var ut=F.indexOf("?")>-1?"&":"?";if(Ve.open("GET",""+F+ut+"url="+encodeURIComponent(B)+"&responseType="+Ge),Ge!=="text"&&Ve instanceof XMLHttpRequest&&(Ve.responseType=Ge),U._options.imageTimeout){var pt=U._options.imageTimeout;Ve.timeout=pt,Ve.ontimeout=function(){return _e("Timed out ("+pt+"ms) proxying "+G)}}Ve.send()})},I}(),pA=/^data:image\/svg\+xml/i,Ah=/^data:image\/.*;base64,/i,Oh=/^data:image\/.*/i,Hh=function(I){return Sa.SUPPORT_SVG_DRAWING||!eu(I)},cl=function(I){return Oh.test(I)},dA=function(I){return Ah.test(I)},DA=function(I){return I.substr(0,4)==="blob"},eu=function(I){return I.substr(-3).toLowerCase()==="svg"||pA.test(I)},yr=function(){function I(B,U){this.type=0,this.x=B,this.y=U}return I.prototype.add=function(B,U){return new I(this.x+B,this.y+U)},I}(),Bl=function(I,B,U){return new yr(I.x+(B.x-I.x)*U,I.y+(B.y-I.y)*U)},Zo=function(){function I(B,U,F,G){this.type=1,this.start=B,this.startControl=U,this.endControl=F,this.end=G}return I.prototype.subdivide=function(B,U){var F=Bl(this.start,this.startControl,B),G=Bl(this.startControl,this.endControl,B),ue=Bl(this.endControl,this.end,B),_e=Bl(F,G,B),Ge=Bl(G,ue,B),Ve=Bl(_e,Ge,B);return U?new I(this.start,F,_e,Ve):new I(Ve,Ge,ue,this.end)},I.prototype.add=function(B,U){return new I(this.start.add(B,U),this.startControl.add(B,U),this.endControl.add(B,U),this.end.add(B,U))},I.prototype.reverse=function(){return new I(this.end,this.endControl,this.startControl,this.start)},I}(),as=function(I){return I.type===1},Iu=function(){function I(B){var U=B.styles,F=B.bounds,G=Ol(U.borderTopLeftRadius,F.width,F.height),ue=G[0],_e=G[1],Ge=Ol(U.borderTopRightRadius,F.width,F.height),Ve=Ge[0],ut=Ge[1],pt=Ol(U.borderBottomRightRadius,F.width,F.height),Pt=pt[0],Qt=pt[1],Fr=Ol(U.borderBottomLeftRadius,F.width,F.height),Nt=Fr[0],tr=Fr[1],ji=[];ji.push((ue+Ve)/F.width),ji.push((Nt+Pt)/F.width),ji.push((_e+tr)/F.height),ji.push((ut+Qt)/F.height);var ci=Math.max.apply(Math,ji);ci>1&&(ue/=ci,_e/=ci,Ve/=ci,ut/=ci,Pt/=ci,Qt/=ci,Nt/=ci,tr/=ci);var oi=F.width-Ve,Gn=F.height-Qt,Ii=F.width-Pt,Si=F.height-tr,ai=U.borderTopWidth,nn=U.borderRightWidth,xn=U.borderBottomWidth,Qr=U.borderLeftWidth,Fi=Fn(U.paddingTop,B.bounds.width),fo=Fn(U.paddingRight,B.bounds.width),Va=Fn(U.paddingBottom,B.bounds.width),jn=Fn(U.paddingLeft,B.bounds.width);this.topLeftBorderDoubleOuterBox=ue>0||_e>0?rn(F.left+Qr/3,F.top+ai/3,ue-Qr/3,_e-ai/3,Hn.TOP_LEFT):new yr(F.left+Qr/3,F.top+ai/3),this.topRightBorderDoubleOuterBox=ue>0||_e>0?rn(F.left+oi,F.top+ai/3,Ve-nn/3,ut-ai/3,Hn.TOP_RIGHT):new yr(F.left+F.width-nn/3,F.top+ai/3),this.bottomRightBorderDoubleOuterBox=Pt>0||Qt>0?rn(F.left+Ii,F.top+Gn,Pt-nn/3,Qt-xn/3,Hn.BOTTOM_RIGHT):new yr(F.left+F.width-nn/3,F.top+F.height-xn/3),this.bottomLeftBorderDoubleOuterBox=Nt>0||tr>0?rn(F.left+Qr/3,F.top+Si,Nt-Qr/3,tr-xn/3,Hn.BOTTOM_LEFT):new yr(F.left+Qr/3,F.top+F.height-xn/3),this.topLeftBorderDoubleInnerBox=ue>0||_e>0?rn(F.left+2*Qr/3,F.top+2*ai/3,ue-2*Qr/3,_e-2*ai/3,Hn.TOP_LEFT):new yr(F.left+2*Qr/3,F.top+2*ai/3),this.topRightBorderDoubleInnerBox=ue>0||_e>0?rn(F.left+oi,F.top+2*ai/3,Ve-2*nn/3,ut-2*ai/3,Hn.TOP_RIGHT):new yr(F.left+F.width-2*nn/3,F.top+2*ai/3),this.bottomRightBorderDoubleInnerBox=Pt>0||Qt>0?rn(F.left+Ii,F.top+Gn,Pt-2*nn/3,Qt-2*xn/3,Hn.BOTTOM_RIGHT):new yr(F.left+F.width-2*nn/3,F.top+F.height-2*xn/3),this.bottomLeftBorderDoubleInnerBox=Nt>0||tr>0?rn(F.left+2*Qr/3,F.top+Si,Nt-2*Qr/3,tr-2*xn/3,Hn.BOTTOM_LEFT):new yr(F.left+2*Qr/3,F.top+F.height-2*xn/3),this.topLeftBorderStroke=ue>0||_e>0?rn(F.left+Qr/2,F.top+ai/2,ue-Qr/2,_e-ai/2,Hn.TOP_LEFT):new yr(F.left+Qr/2,F.top+ai/2),this.topRightBorderStroke=ue>0||_e>0?rn(F.left+oi,F.top+ai/2,Ve-nn/2,ut-ai/2,Hn.TOP_RIGHT):new yr(F.left+F.width-nn/2,F.top+ai/2),this.bottomRightBorderStroke=Pt>0||Qt>0?rn(F.left+Ii,F.top+Gn,Pt-nn/2,Qt-xn/2,Hn.BOTTOM_RIGHT):new yr(F.left+F.width-nn/2,F.top+F.height-xn/2),this.bottomLeftBorderStroke=Nt>0||tr>0?rn(F.left+Qr/2,F.top+Si,Nt-Qr/2,tr-xn/2,Hn.BOTTOM_LEFT):new yr(F.left+Qr/2,F.top+F.height-xn/2),this.topLeftBorderBox=ue>0||_e>0?rn(F.left,F.top,ue,_e,Hn.TOP_LEFT):new yr(F.left,F.top),this.topRightBorderBox=Ve>0||ut>0?rn(F.left+oi,F.top,Ve,ut,Hn.TOP_RIGHT):new yr(F.left+F.width,F.top),this.bottomRightBorderBox=Pt>0||Qt>0?rn(F.left+Ii,F.top+Gn,Pt,Qt,Hn.BOTTOM_RIGHT):new yr(F.left+F.width,F.top+F.height),this.bottomLeftBorderBox=Nt>0||tr>0?rn(F.left,F.top+Si,Nt,tr,Hn.BOTTOM_LEFT):new yr(F.left,F.top+F.height),this.topLeftPaddingBox=ue>0||_e>0?rn(F.left+Qr,F.top+ai,Math.max(0,ue-Qr),Math.max(0,_e-ai),Hn.TOP_LEFT):new yr(F.left+Qr,F.top+ai),this.topRightPaddingBox=Ve>0||ut>0?rn(F.left+Math.min(oi,F.width-nn),F.top+ai,oi>F.width+nn?0:Math.max(0,Ve-nn),Math.max(0,ut-ai),Hn.TOP_RIGHT):new yr(F.left+F.width-nn,F.top+ai),this.bottomRightPaddingBox=Pt>0||Qt>0?rn(F.left+Math.min(Ii,F.width-Qr),F.top+Math.min(Gn,F.height-xn),Math.max(0,Pt-nn),Math.max(0,Qt-xn),Hn.BOTTOM_RIGHT):new yr(F.left+F.width-nn,F.top+F.height-xn),this.bottomLeftPaddingBox=Nt>0||tr>0?rn(F.left+Qr,F.top+Math.min(Si,F.height-xn),Math.max(0,Nt-Qr),Math.max(0,tr-xn),Hn.BOTTOM_LEFT):new yr(F.left+Qr,F.top+F.height-xn),this.topLeftContentBox=ue>0||_e>0?rn(F.left+Qr+jn,F.top+ai+Fi,Math.max(0,ue-(Qr+jn)),Math.max(0,_e-(ai+Fi)),Hn.TOP_LEFT):new yr(F.left+Qr+jn,F.top+ai+Fi),this.topRightContentBox=Ve>0||ut>0?rn(F.left+Math.min(oi,F.width+Qr+jn),F.top+ai+Fi,oi>F.width+Qr+jn?0:Ve-Qr+jn,ut-(ai+Fi),Hn.TOP_RIGHT):new yr(F.left+F.width-(nn+fo),F.top+ai+Fi),this.bottomRightContentBox=Pt>0||Qt>0?rn(F.left+Math.min(Ii,F.width-(Qr+jn)),F.top+Math.min(Gn,F.height+ai+Fi),Math.max(0,Pt-(nn+fo)),Qt-(xn+Va),Hn.BOTTOM_RIGHT):new yr(F.left+F.width-(nn+fo),F.top+F.height-(xn+Va)),this.bottomLeftContentBox=Nt>0||tr>0?rn(F.left+Qr+jn,F.top+Si,Math.max(0,Nt-(Qr+jn)),tr-(xn+Va),Hn.BOTTOM_LEFT):new yr(F.left+Qr+jn,F.top+F.height-(xn+Va))}return I}();(function(I){I[I.TOP_LEFT=0]="TOP_LEFT",I[I.TOP_RIGHT=1]="TOP_RIGHT",I[I.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",I[I.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(Hn||(Hn={}));var rn=function(I,B,U,F,G){var ue=(Math.sqrt(2)-1)/3*4,_e=U*ue,Ge=F*ue,Ve=I+U,ut=B+F;switch(G){case Hn.TOP_LEFT:return new Zo(new yr(I,ut),new yr(I,ut-Ge),new yr(Ve-_e,B),new yr(Ve,B));case Hn.TOP_RIGHT:return new Zo(new yr(I,B),new yr(I+_e,B),new yr(Ve,ut-Ge),new yr(Ve,ut));case Hn.BOTTOM_RIGHT:return new Zo(new yr(Ve,B),new yr(Ve,B+Ge),new yr(I+_e,ut),new yr(I,ut));case Hn.BOTTOM_LEFT:default:return new Zo(new yr(Ve,ut),new yr(Ve-_e,ut),new yr(I,B+Ge),new yr(I,B))}},tu=function(I){return[I.topLeftBorderBox,I.topRightBorderBox,I.bottomRightBorderBox,I.bottomLeftBorderBox]},Vh=function(I){return[I.topLeftContentBox,I.topRightContentBox,I.bottomRightContentBox,I.bottomLeftContentBox]},sc=function(I){return[I.topLeftPaddingBox,I.topRightPaddingBox,I.bottomRightPaddingBox,I.bottomLeftPaddingBox]},lc=function(){function I(B,U,F){this.offsetX=B,this.offsetY=U,this.matrix=F,this.type=0,this.target=6}return I}(),Ac=function(){function I(B,U){this.path=B,this.target=U,this.type=1}return I}(),ch=function(){function I(B){this.opacity=B,this.type=2,this.target=6}return I}(),Tp=function(I){return I.type===0},uh=function(I){return I.type===1},cc=function(I){return I.type===2},Tc=function(I,B){return I.length===B.length&&I.some(function(U,F){return U===B[F]})},hh=function(I,B,U,F,G){return I.map(function(ue,_e){switch(_e){case 0:return ue.add(B,U);case 1:return ue.add(B+F,U);case 2:return ue.add(B+F,U+G);case 3:return ue.add(B,U+G)}return ue})},Fc=function(){function I(B){this.element=B,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return I}(),Uc=function(){function I(B,U){if(this.container=B,this.parent=U,this.effects=[],this.curves=new Iu(this.container),this.container.styles.opacity<1&&this.effects.push(new ch(this.container.styles.opacity)),this.container.styles.transform!==null){var F=this.container.bounds.left+this.container.styles.transformOrigin[0].number,G=this.container.bounds.top+this.container.styles.transformOrigin[1].number,ue=this.container.styles.transform;this.effects.push(new lc(F,G,ue))}if(this.container.styles.overflowX!==0){var _e=tu(this.curves),Ge=sc(this.curves);Tc(_e,Ge)?this.effects.push(new Ac(_e,6)):(this.effects.push(new Ac(_e,2)),this.effects.push(new Ac(Ge,4)))}}return I.prototype.getEffects=function(B){for(var U=[2,3].indexOf(this.container.styles.position)===-1,F=this.parent,G=this.effects.slice(0);F;){var ue=F.effects.filter(function(Ve){return!uh(Ve)});if(U||F.container.styles.position!==0||!F.parent){if(G.unshift.apply(G,ue),U=[2,3].indexOf(F.container.styles.position)===-1,F.container.styles.overflowX!==0){var _e=tu(F.curves),Ge=sc(F.curves);Tc(_e,Ge)||G.unshift(new Ac(Ge,6))}}else G.unshift.apply(G,ue);F=F.parent}return G.filter(function(Ve){return R(Ve.target,B)})},I}(),fA=function(I,B,U,F){I.container.elements.forEach(function(G){var ue=R(G.flags,4),_e=R(G.flags,2),Ge=new Uc(G,I);R(G.styles.display,2048)&&F.push(Ge);var Ve=R(G.flags,8)?[]:F;if(ue||_e){var ut=ue||G.styles.isPositioned()?U:B,pt=new Fc(Ge);if(G.styles.isPositioned()||G.styles.opacity<1||G.styles.isTransformed()){var Pt=G.styles.zIndex.order;if(Pt<0){var Qt=0;ut.negativeZIndex.some(function(Nt,tr){return Pt>Nt.element.container.styles.zIndex.order?(Qt=tr,!1):Qt>0}),ut.negativeZIndex.splice(Qt,0,pt)}else if(Pt>0){var Fr=0;ut.positiveZIndex.some(function(Nt,tr){return Pt>=Nt.element.container.styles.zIndex.order?(Fr=tr+1,!1):Fr>0}),ut.positiveZIndex.splice(Fr,0,pt)}else ut.zeroOrAutoZIndexOrTransformedOrOpacity.push(pt)}else G.styles.isFloating()?ut.nonPositionedFloats.push(pt):ut.nonPositionedInlineLevel.push(pt);fA(Ge,pt,ue?pt:U,Ve)}else G.styles.isInlineLevel()?B.inlineLevel.push(Ge):B.nonInlineLevel.push(Ge),fA(Ge,B,U,Ve);R(G.flags,8)&&Mc(G,Ve)})},Mc=function(I,B){for(var U=I instanceof Ju?I.start:1,F=I instanceof Ju&&I.reversed,G=0;G<B.length;G++){var ue=B[G];ue.container instanceof ec&&typeof ue.container.value=="number"&&ue.container.value!==0&&(U=ue.container.value),ue.listValue=Yc(U,ue.container.styles.listStyleType,!0),U+=F?-1:1}},ru=function(I){var B=new Uc(I,null),U=new Fc(B),F=[];return fA(B,U,U,F),Mc(B.container,F),U},ph=function(I,B){switch(B){case 0:return Ja(I.topLeftBorderBox,I.topLeftPaddingBox,I.topRightBorderBox,I.topRightPaddingBox);case 1:return Ja(I.topRightBorderBox,I.topRightPaddingBox,I.bottomRightBorderBox,I.bottomRightPaddingBox);case 2:return Ja(I.bottomRightBorderBox,I.bottomRightPaddingBox,I.bottomLeftBorderBox,I.bottomLeftPaddingBox);default:return Ja(I.bottomLeftBorderBox,I.bottomLeftPaddingBox,I.topLeftBorderBox,I.topLeftPaddingBox)}},Nh=function(I,B){switch(B){case 0:return Ja(I.topLeftBorderBox,I.topLeftBorderDoubleOuterBox,I.topRightBorderBox,I.topRightBorderDoubleOuterBox);case 1:return Ja(I.topRightBorderBox,I.topRightBorderDoubleOuterBox,I.bottomRightBorderBox,I.bottomRightBorderDoubleOuterBox);case 2:return Ja(I.bottomRightBorderBox,I.bottomRightBorderDoubleOuterBox,I.bottomLeftBorderBox,I.bottomLeftBorderDoubleOuterBox);default:return Ja(I.bottomLeftBorderBox,I.bottomLeftBorderDoubleOuterBox,I.topLeftBorderBox,I.topLeftBorderDoubleOuterBox)}},Kh=function(I,B){switch(B){case 0:return Ja(I.topLeftBorderDoubleInnerBox,I.topLeftPaddingBox,I.topRightBorderDoubleInnerBox,I.topRightPaddingBox);case 1:return Ja(I.topRightBorderDoubleInnerBox,I.topRightPaddingBox,I.bottomRightBorderDoubleInnerBox,I.bottomRightPaddingBox);case 2:return Ja(I.bottomRightBorderDoubleInnerBox,I.bottomRightPaddingBox,I.bottomLeftBorderDoubleInnerBox,I.bottomLeftPaddingBox);default:return Ja(I.bottomLeftBorderDoubleInnerBox,I.bottomLeftPaddingBox,I.topLeftBorderDoubleInnerBox,I.topLeftPaddingBox)}},Gh=function(I,B){switch(B){case 0:return kc(I.topLeftBorderStroke,I.topRightBorderStroke);case 1:return kc(I.topRightBorderStroke,I.bottomRightBorderStroke);case 2:return kc(I.bottomRightBorderStroke,I.bottomLeftBorderStroke);default:return kc(I.bottomLeftBorderStroke,I.topLeftBorderStroke)}},kc=function(I,B){var U=[];return as(I)?U.push(I.subdivide(.5,!1)):U.push(I),as(B)?U.push(B.subdivide(.5,!0)):U.push(B),U},Ja=function(I,B,U,F){var G=[];return as(I)?G.push(I.subdivide(.5,!1)):G.push(I),as(U)?G.push(U.subdivide(.5,!0)):G.push(U),as(F)?G.push(F.subdivide(.5,!0).reverse()):G.push(F),as(B)?G.push(B.subdivide(.5,!1).reverse()):G.push(B),G},iu=function(I){var B=I.bounds,U=I.styles;return B.add(U.borderLeftWidth,U.borderTopWidth,-(U.borderRightWidth+U.borderLeftWidth),-(U.borderTopWidth+U.borderBottomWidth))},mA=function(I){var B=I.styles,U=I.bounds,F=Fn(B.paddingLeft,U.width),G=Fn(B.paddingRight,U.width),ue=Fn(B.paddingTop,U.width),_e=Fn(B.paddingBottom,U.width);return U.add(F+B.borderLeftWidth,ue+B.borderTopWidth,-(B.borderRightWidth+B.borderLeftWidth+F+G),-(B.borderTopWidth+B.borderBottomWidth+ue+_e))},Su=function(I,B){return I===0?B.bounds:I===2?mA(B):iu(B)},Tu=function(I,B){return I===0?B.bounds:I===2?mA(B):iu(B)},gA=function(I,B,U){var F=Su(ul(I.styles.backgroundOrigin,B),I),G=Tu(ul(I.styles.backgroundClip,B),I),ue=LA(ul(I.styles.backgroundSize,B),U,F),_e=ue[0],Ge=ue[1],Ve=Ol(ul(I.styles.backgroundPosition,B),F.width-_e,F.height-Ge);return[Fu(ul(I.styles.backgroundRepeat,B),Ve,ue,F,G),Math.round(F.left+Ve[0]),Math.round(F.top+Ve[1]),_e,Ge]},Cs=function(I){return Tn(I)&&I.value===Xa.AUTO},nu=function(I){return typeof I=="number"},LA=function(I,B,U){var F=B[0],G=B[1],ue=B[2],_e=I[0],Ge=I[1];if(!_e)return[0,0];if(Ai(_e)&&Ge&&Ai(Ge))return[Fn(_e,U.width),Fn(Ge,U.height)];var Ve=nu(ue);if(Tn(_e)&&(_e.value===Xa.CONTAIN||_e.value===Xa.COVER))return nu(ue)?U.width/U.height<ue!=(_e.value===Xa.COVER)?[U.width,U.width/ue]:[U.height*ue,U.height]:[U.width,U.height];var ut=nu(F),pt=nu(G),Pt=ut||pt;if(Cs(_e)&&(!Ge||Cs(Ge)))return ut&&pt?[F,G]:Ve||Pt?Pt&&Ve?[ut?F:G*ue,pt?G:F/ue]:[ut?F:U.width,pt?G:U.height]:[U.width,U.height];if(Ve){var Qt=0,Fr=0;return Ai(_e)?Qt=Fn(_e,U.width):Ai(Ge)&&(Fr=Fn(Ge,U.height)),Cs(_e)?Qt=Fr*ue:Ge&&!Cs(Ge)||(Fr=Qt/ue),[Qt,Fr]}var Nt=null,tr=null;if(Ai(_e)?Nt=Fn(_e,U.width):Ge&&Ai(Ge)&&(tr=Fn(Ge,U.height)),Nt===null||Ge&&!Cs(Ge)||(tr=ut&&pt?Nt/F*G:U.height),tr!==null&&Cs(_e)&&(Nt=ut&&pt?tr/G*F:U.width),Nt!==null&&tr!==null)return[Nt,tr];throw new Error("Unable to calculate background-size for element")},ul=function(I,B){var U=I[B];return U===void 0?I[0]:U},Fu=function(I,B,U,F,G){var ue=B[0],_e=B[1],Ge=U[0],Ve=U[1];switch(I){case 2:return[new yr(Math.round(F.left),Math.round(F.top+_e)),new yr(Math.round(F.left+F.width),Math.round(F.top+_e)),new yr(Math.round(F.left+F.width),Math.round(Ve+F.top+_e)),new yr(Math.round(F.left),Math.round(Ve+F.top+_e))];case 3:return[new yr(Math.round(F.left+ue),Math.round(F.top)),new yr(Math.round(F.left+ue+Ge),Math.round(F.top)),new yr(Math.round(F.left+ue+Ge),Math.round(F.height+F.top)),new yr(Math.round(F.left+ue),Math.round(F.height+F.top))];case 1:return[new yr(Math.round(F.left+ue),Math.round(F.top+_e)),new yr(Math.round(F.left+ue+Ge),Math.round(F.top+_e)),new yr(Math.round(F.left+ue+Ge),Math.round(F.top+_e+Ve)),new yr(Math.round(F.left+ue),Math.round(F.top+_e+Ve))];default:return[new yr(Math.round(G.left),Math.round(G.top)),new yr(Math.round(G.left+G.width),Math.round(G.top)),new yr(Math.round(G.left+G.width),Math.round(G.height+G.top)),new yr(Math.round(G.left),Math.round(G.height+G.top))]}},dh="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",ou="Hidden Text",jh=function(){function I(B){this._data={},this._document=B}return I.prototype.parseMetrics=function(B,U){var F=this._document.createElement("div"),G=this._document.createElement("img"),ue=this._document.createElement("span"),_e=this._document.body;F.style.visibility="hidden",F.style.fontFamily=B,F.style.fontSize=U,F.style.margin="0",F.style.padding="0",F.style.whiteSpace="nowrap",_e.appendChild(F),G.src=dh,G.width=1,G.height=1,G.style.margin="0",G.style.padding="0",G.style.verticalAlign="baseline",ue.style.fontFamily=B,ue.style.fontSize=U,ue.style.margin="0",ue.style.padding="0",ue.appendChild(this._document.createTextNode(ou)),F.appendChild(ue),F.appendChild(G);var Ge=G.offsetTop-ue.offsetTop+2;F.removeChild(ue),F.appendChild(this._document.createTextNode(ou)),F.style.lineHeight="normal",G.style.verticalAlign="super";var Ve=G.offsetTop-F.offsetTop+2;return _e.removeChild(F),{baseline:Ge,middle:Ve}},I.prototype.getMetrics=function(B,U){var F=B+" "+U;return this._data[F]===void 0&&(this._data[F]=this.parseMetrics(B,U)),this._data[F]},I}(),fh=function(){function I(B,U){this.context=B,this.options=U}return I}(),$h=1e4,qh=function(I){function B(U,F){var G=I.call(this,U,F)||this;return G._activeEffects=[],G.canvas=F.canvas?F.canvas:document.createElement("canvas"),G.ctx=G.canvas.getContext("2d"),F.canvas||(G.canvas.width=Math.floor(F.width*F.scale),G.canvas.height=Math.floor(F.height*F.scale),G.canvas.style.width=F.width+"px",G.canvas.style.height=F.height+"px"),G.fontMetrics=new jh(document),G.ctx.scale(G.options.scale,G.options.scale),G.ctx.translate(-F.x,-F.y),G.ctx.textBaseline="bottom",G._activeEffects=[],G.context.logger.debug("Canvas renderer initialized ("+F.width+"x"+F.height+") with scale "+F.scale),G}return E(B,I),B.prototype.applyEffects=function(U){for(var F=this;this._activeEffects.length;)this.popEffect();U.forEach(function(G){return F.applyEffect(G)})},B.prototype.applyEffect=function(U){this.ctx.save(),cc(U)&&(this.ctx.globalAlpha=U.opacity),Tp(U)&&(this.ctx.translate(U.offsetX,U.offsetY),this.ctx.transform(U.matrix[0],U.matrix[1],U.matrix[2],U.matrix[3],U.matrix[4],U.matrix[5]),this.ctx.translate(-U.offsetX,-U.offsetY)),uh(U)&&(this.path(U.path),this.ctx.clip()),this._activeEffects.push(U)},B.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},B.prototype.renderStack=function(U){return V(this,void 0,void 0,function(){return o(this,function(F){switch(F.label){case 0:return U.element.container.styles.isVisible()?[4,this.renderStackContent(U)]:[3,2];case 1:F.sent(),F.label=2;case 2:return[2]}})})},B.prototype.renderNode=function(U){return V(this,void 0,void 0,function(){return o(this,function(F){switch(F.label){case 0:return R(U.container.flags,16),U.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(U)]:[3,3];case 1:return F.sent(),[4,this.renderNodeContent(U)];case 2:F.sent(),F.label=3;case 3:return[2]}})})},B.prototype.renderTextWithLetterSpacing=function(U,F,G){var ue=this;F===0?this.ctx.fillText(U.text,U.bounds.left,U.bounds.top+G):SA(U.text).reduce(function(_e,Ge){return ue.ctx.fillText(Ge,_e,U.bounds.top+G),_e+ue.ctx.measureText(Ge).width},U.bounds.left)},B.prototype.createFontStyle=function(U){var F=U.fontVariant.filter(function(_e){return _e==="normal"||_e==="small-caps"}).join(""),G=yA(U.fontFamily).join(", "),ue=ua(U.fontSize)?""+U.fontSize.number+U.fontSize.unit:U.fontSize.number+"px";return[[U.fontStyle,F,U.fontWeight,ue,G].join(" "),G,ue]},B.prototype.renderTextNode=function(U,F){return V(this,void 0,void 0,function(){var G,ue,_e,Ge,Ve,ut,pt,Pt,Qt=this;return o(this,function(Fr){return G=this.createFontStyle(F),ue=G[0],_e=G[1],Ge=G[2],this.ctx.font=ue,this.ctx.direction=F.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",Ve=this.fontMetrics.getMetrics(_e,Ge),ut=Ve.baseline,pt=Ve.middle,Pt=F.paintOrder,U.textBounds.forEach(function(Nt){Pt.forEach(function(tr){switch(tr){case 0:Qt.ctx.fillStyle=po(F.color),Qt.renderTextWithLetterSpacing(Nt,F.letterSpacing,ut);var ji=F.textShadow;ji.length&&Nt.text.trim().length&&(ji.slice(0).reverse().forEach(function(ci){Qt.ctx.shadowColor=po(ci.color),Qt.ctx.shadowOffsetX=ci.offsetX.number*Qt.options.scale,Qt.ctx.shadowOffsetY=ci.offsetY.number*Qt.options.scale,Qt.ctx.shadowBlur=ci.blur.number,Qt.renderTextWithLetterSpacing(Nt,F.letterSpacing,ut)}),Qt.ctx.shadowColor="",Qt.ctx.shadowOffsetX=0,Qt.ctx.shadowOffsetY=0,Qt.ctx.shadowBlur=0),F.textDecorationLine.length&&(Qt.ctx.fillStyle=po(F.textDecorationColor||F.color),F.textDecorationLine.forEach(function(ci){switch(ci){case 1:Qt.ctx.fillRect(Nt.bounds.left,Math.round(Nt.bounds.top+ut),Nt.bounds.width,1);break;case 2:Qt.ctx.fillRect(Nt.bounds.left,Math.round(Nt.bounds.top),Nt.bounds.width,1);break;case 3:Qt.ctx.fillRect(Nt.bounds.left,Math.ceil(Nt.bounds.top+pt),Nt.bounds.width,1)}}));break;case 1:F.webkitTextStrokeWidth&&Nt.text.trim().length&&(Qt.ctx.strokeStyle=po(F.webkitTextStrokeColor),Qt.ctx.lineWidth=F.webkitTextStrokeWidth,Qt.ctx.lineJoin=window.chrome?"miter":"round",Qt.ctx.strokeText(Nt.text,Nt.bounds.left,Nt.bounds.top+ut)),Qt.ctx.strokeStyle="",Qt.ctx.lineWidth=0,Qt.ctx.lineJoin="miter"}})}),[2]})})},B.prototype.renderReplacedElement=function(U,F,G){if(G&&U.intrinsicWidth>0&&U.intrinsicHeight>0){var ue=mA(U),_e=sc(F);this.path(_e),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(G,0,0,U.intrinsicWidth,U.intrinsicHeight,ue.left,ue.top,ue.width,ue.height),this.ctx.restore()}},B.prototype.renderNodeContent=function(U){return V(this,void 0,void 0,function(){var F,G,ue,_e,Ge,Ve,ut,pt,Pt,Qt,Fr,Nt,tr,ji,ci,oi,Gn,Ii;return o(this,function(Si){switch(Si.label){case 0:this.applyEffects(U.getEffects(4)),F=U.container,G=U.curves,ue=F.styles,_e=0,Ge=F.textNodes,Si.label=1;case 1:return _e<Ge.length?(Ve=Ge[_e],[4,this.renderTextNode(Ve,ue)]):[3,4];case 2:Si.sent(),Si.label=3;case 3:return _e++,[3,1];case 4:if(!(F instanceof TA))return[3,8];Si.label=5;case 5:return Si.trys.push([5,7,,8]),[4,this.context.cache.match(F.src)];case 6:return ci=Si.sent(),this.renderReplacedElement(F,G,ci),[3,8];case 7:return Si.sent(),this.context.logger.error("Error loading image "+F.src),[3,8];case 8:if(F instanceof FA&&this.renderReplacedElement(F,G,F.canvas),!(F instanceof Sh))return[3,12];Si.label=9;case 9:return Si.trys.push([9,11,,12]),[4,this.context.cache.match(F.svg)];case 10:return ci=Si.sent(),this.renderReplacedElement(F,G,ci),[3,12];case 11:return Si.sent(),this.context.logger.error("Error loading svg "+F.svg.substring(0,255)),[3,12];case 12:return F instanceof Zc&&F.tree?[4,new B(this.context,{scale:this.options.scale,backgroundColor:F.backgroundColor,x:0,y:0,width:F.width,height:F.height}).render(F.tree)]:[3,14];case 13:ut=Si.sent(),F.width&&F.height&&this.ctx.drawImage(ut,0,0,F.width,F.height,F.bounds.left,F.bounds.top,F.bounds.width,F.bounds.height),Si.label=14;case 14:if(F instanceof Jn&&(pt=Math.min(F.bounds.width,F.bounds.height),F.type===cA?F.checked&&(this.ctx.save(),this.path([new yr(F.bounds.left+.39363*pt,F.bounds.top+.79*pt),new yr(F.bounds.left+.16*pt,F.bounds.top+.5549*pt),new yr(F.bounds.left+.27347*pt,F.bounds.top+.44071*pt),new yr(F.bounds.left+.39694*pt,F.bounds.top+.5649*pt),new yr(F.bounds.left+.72983*pt,F.bounds.top+.23*pt),new yr(F.bounds.left+.84*pt,F.bounds.top+.34085*pt),new yr(F.bounds.left+.39363*pt,F.bounds.top+.79*pt)]),this.ctx.fillStyle=po(Yu),this.ctx.fill(),this.ctx.restore()):F.type===UA&&F.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(F.bounds.left+pt/2,F.bounds.top+pt/2,pt/4,0,2*Math.PI,!0),this.ctx.fillStyle=po(Yu),this.ctx.fill(),this.ctx.restore())),Zh(F)&&F.value.length){switch(Pt=this.createFontStyle(ue),Gn=Pt[0],Qt=Pt[1],Fr=this.fontMetrics.getMetrics(Gn,Qt).baseline,this.ctx.font=Gn,this.ctx.fillStyle=po(ue.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=Uu(F.styles.textAlign),Ii=mA(F),Nt=0,F.styles.textAlign){case 1:Nt+=Ii.width/2;break;case 2:Nt+=Ii.width}tr=Ii.add(Nt,0,0,-Ii.height/2+1),this.ctx.save(),this.path([new yr(Ii.left,Ii.top),new yr(Ii.left+Ii.width,Ii.top),new yr(Ii.left+Ii.width,Ii.top+Ii.height),new yr(Ii.left,Ii.top+Ii.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new jc(F.value,tr),ue.letterSpacing,Fr),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!R(F.styles.display,2048))return[3,20];if(F.styles.listStyleImage===null)return[3,19];if((ji=F.styles.listStyleImage).type!==0)return[3,18];ci=void 0,oi=ji.url,Si.label=15;case 15:return Si.trys.push([15,17,,18]),[4,this.context.cache.match(oi)];case 16:return ci=Si.sent(),this.ctx.drawImage(ci,F.bounds.left-(ci.width+10),F.bounds.top),[3,18];case 17:return Si.sent(),this.context.logger.error("Error loading list-style-image "+oi),[3,18];case 18:return[3,20];case 19:U.listValue&&F.styles.listStyleType!==-1&&(Gn=this.createFontStyle(ue)[0],this.ctx.font=Gn,this.ctx.fillStyle=po(ue.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",Ii=new K(F.bounds.left,F.bounds.top+Fn(F.styles.paddingTop,F.bounds.width),F.bounds.width,Ca(ue.lineHeight,ue.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new jc(U.listValue,Ii),ue.letterSpacing,Ca(ue.lineHeight,ue.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),Si.label=20;case 20:return[2]}})})},B.prototype.renderStackContent=function(U){return V(this,void 0,void 0,function(){var F,G,ue,_e,Ge,Ve,ut,pt,Pt,Qt,Fr,Nt,tr,ji,ci;return o(this,function(oi){switch(oi.label){case 0:return R(U.element.container.flags,16),[4,this.renderNodeBackgroundAndBorders(U.element)];case 1:oi.sent(),F=0,G=U.negativeZIndex,oi.label=2;case 2:return F<G.length?(ci=G[F],[4,this.renderStack(ci)]):[3,5];case 3:oi.sent(),oi.label=4;case 4:return F++,[3,2];case 5:return[4,this.renderNodeContent(U.element)];case 6:oi.sent(),ue=0,_e=U.nonInlineLevel,oi.label=7;case 7:return ue<_e.length?(ci=_e[ue],[4,this.renderNode(ci)]):[3,10];case 8:oi.sent(),oi.label=9;case 9:return ue++,[3,7];case 10:Ge=0,Ve=U.nonPositionedFloats,oi.label=11;case 11:return Ge<Ve.length?(ci=Ve[Ge],[4,this.renderStack(ci)]):[3,14];case 12:oi.sent(),oi.label=13;case 13:return Ge++,[3,11];case 14:ut=0,pt=U.nonPositionedInlineLevel,oi.label=15;case 15:return ut<pt.length?(ci=pt[ut],[4,this.renderStack(ci)]):[3,18];case 16:oi.sent(),oi.label=17;case 17:return ut++,[3,15];case 18:Pt=0,Qt=U.inlineLevel,oi.label=19;case 19:return Pt<Qt.length?(ci=Qt[Pt],[4,this.renderNode(ci)]):[3,22];case 20:oi.sent(),oi.label=21;case 21:return Pt++,[3,19];case 22:Fr=0,Nt=U.zeroOrAutoZIndexOrTransformedOrOpacity,oi.label=23;case 23:return Fr<Nt.length?(ci=Nt[Fr],[4,this.renderStack(ci)]):[3,26];case 24:oi.sent(),oi.label=25;case 25:return Fr++,[3,23];case 26:tr=0,ji=U.positiveZIndex,oi.label=27;case 27:return tr<ji.length?(ci=ji[tr],[4,this.renderStack(ci)]):[3,30];case 28:oi.sent(),oi.label=29;case 29:return tr++,[3,27];case 30:return[2]}})})},B.prototype.mask=function(U){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(U.slice(0).reverse()),this.ctx.closePath()},B.prototype.path=function(U){this.ctx.beginPath(),this.formatPath(U),this.ctx.closePath()},B.prototype.formatPath=function(U){var F=this;U.forEach(function(G,ue){var _e=as(G)?G.start:G;ue===0?F.ctx.moveTo(_e.x,_e.y):F.ctx.lineTo(_e.x,_e.y),as(G)&&F.ctx.bezierCurveTo(G.startControl.x,G.startControl.y,G.endControl.x,G.endControl.y,G.end.x,G.end.y)})},B.prototype.renderRepeat=function(U,F,G,ue){this.path(U),this.ctx.fillStyle=F,this.ctx.translate(G,ue),this.ctx.fill(),this.ctx.translate(-G,-ue)},B.prototype.resizeImage=function(U,F,G){var ue;if(U.width===F&&U.height===G)return U;var _e=((ue=this.canvas.ownerDocument)!==null&&ue!==void 0?ue:document).createElement("canvas");return _e.width=Math.max(1,F),_e.height=Math.max(1,G),_e.getContext("2d").drawImage(U,0,0,U.width,U.height,0,0,F,G),_e},B.prototype.renderBackgroundImage=function(U){return V(this,void 0,void 0,function(){var F,G,ue,_e,Ge,Ve;return o(this,function(ut){switch(ut.label){case 0:F=U.styles.backgroundImage.length-1,G=function(pt){var Pt,Qt,Fr,Nt,tr,ji,ci,oi,Gn,Ii,Si,ai,nn,xn,Qr,Fi,fo,Va,jn,Ta,Es,Xo,ss,Cl,El,$n,ls,sa,e,n,s;return o(this,function(p){switch(p.label){case 0:if(pt.type!==0)return[3,5];Pt=void 0,Qt=pt.url,p.label=1;case 1:return p.trys.push([1,3,,4]),[4,ue.context.cache.match(Qt)];case 2:return Pt=p.sent(),[3,4];case 3:return p.sent(),ue.context.logger.error("Error loading background-image "+Qt),[3,4];case 4:return Pt&&(Fr=gA(U,F,[Pt.width,Pt.height,Pt.width/Pt.height]),Fi=Fr[0],Xo=Fr[1],ss=Fr[2],jn=Fr[3],Ta=Fr[4],xn=ue.ctx.createPattern(ue.resizeImage(Pt,jn,Ta),"repeat"),ue.renderRepeat(Fi,xn,Xo,ss)),[3,6];case 5:vl(pt)?(Nt=gA(U,F,[null,null,null]),Fi=Nt[0],Xo=Nt[1],ss=Nt[2],jn=Nt[3],Ta=Nt[4],tr=gl(pt.angle,jn,Ta),ji=tr[0],ci=tr[1],oi=tr[2],Gn=tr[3],Ii=tr[4],(Si=document.createElement("canvas")).width=jn,Si.height=Ta,ai=Si.getContext("2d"),nn=ai.createLinearGradient(ci,Gn,oi,Ii),zs(pt.stops,ji).forEach(function(g){return nn.addColorStop(g.stop,po(g.color))}),ai.fillStyle=nn,ai.fillRect(0,0,jn,Ta),jn>0&&Ta>0&&(xn=ue.ctx.createPattern(Si,"repeat"),ue.renderRepeat(Fi,xn,Xo,ss))):pr(pt)&&(Qr=gA(U,F,[null,null,null]),Fi=Qr[0],fo=Qr[1],Va=Qr[2],jn=Qr[3],Ta=Qr[4],Es=pt.position.length===0?[es]:pt.position,Xo=Fn(Es[0],jn),ss=Fn(Es[Es.length-1],Ta),Cl=Rs(pt,Xo,ss,jn,Ta),El=Cl[0],$n=Cl[1],El>0&&$n>0&&(ls=ue.ctx.createRadialGradient(fo+Xo,Va+ss,0,fo+Xo,Va+ss,El),zs(pt.stops,2*El).forEach(function(g){return ls.addColorStop(g.stop,po(g.color))}),ue.path(Fi),ue.ctx.fillStyle=ls,El!==$n?(sa=U.bounds.left+.5*U.bounds.width,e=U.bounds.top+.5*U.bounds.height,s=1/(n=$n/El),ue.ctx.save(),ue.ctx.translate(sa,e),ue.ctx.transform(1,0,0,n,0,0),ue.ctx.translate(-sa,-e),ue.ctx.fillRect(fo,s*(Va-e)+e,jn,Ta*s),ue.ctx.restore()):ue.ctx.fill())),p.label=6;case 6:return F--,[2]}})},ue=this,_e=0,Ge=U.styles.backgroundImage.slice(0).reverse(),ut.label=1;case 1:return _e<Ge.length?(Ve=Ge[_e],[5,G(Ve)]):[3,4];case 2:ut.sent(),ut.label=3;case 3:return _e++,[3,1];case 4:return[2]}})})},B.prototype.renderSolidBorder=function(U,F,G){return V(this,void 0,void 0,function(){return o(this,function(ue){return this.path(ph(G,F)),this.ctx.fillStyle=po(U),this.ctx.fill(),[2]})})},B.prototype.renderDoubleBorder=function(U,F,G,ue){return V(this,void 0,void 0,function(){var _e,Ge;return o(this,function(Ve){switch(Ve.label){case 0:return F<3?[4,this.renderSolidBorder(U,G,ue)]:[3,2];case 1:return Ve.sent(),[2];case 2:return _e=Nh(ue,G),this.path(_e),this.ctx.fillStyle=po(U),this.ctx.fill(),Ge=Kh(ue,G),this.path(Ge),this.ctx.fill(),[2]}})})},B.prototype.renderNodeBackgroundAndBorders=function(U){return V(this,void 0,void 0,function(){var F,G,ue,_e,Ge,Ve,ut,pt,Pt=this;return o(this,function(Qt){switch(Qt.label){case 0:return this.applyEffects(U.getEffects(2)),F=U.container.styles,G=!ts(F.backgroundColor)||F.backgroundImage.length,ue=[{style:F.borderTopStyle,color:F.borderTopColor,width:F.borderTopWidth},{style:F.borderRightStyle,color:F.borderRightColor,width:F.borderRightWidth},{style:F.borderBottomStyle,color:F.borderBottomColor,width:F.borderBottomWidth},{style:F.borderLeftStyle,color:F.borderLeftColor,width:F.borderLeftWidth}],_e=uc(ul(F.backgroundClip,0),U.curves),G||F.boxShadow.length?(this.ctx.save(),this.path(_e),this.ctx.clip(),ts(F.backgroundColor)||(this.ctx.fillStyle=po(F.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(U.container)]):[3,2];case 1:Qt.sent(),this.ctx.restore(),F.boxShadow.slice(0).reverse().forEach(function(Fr){Pt.ctx.save();var Nt=tu(U.curves),tr=Fr.inset?0:$h,ji=hh(Nt,-tr+(Fr.inset?1:-1)*Fr.spread.number,(Fr.inset?1:-1)*Fr.spread.number,Fr.spread.number*(Fr.inset?-2:2),Fr.spread.number*(Fr.inset?-2:2));Fr.inset?(Pt.path(Nt),Pt.ctx.clip(),Pt.mask(ji)):(Pt.mask(Nt),Pt.ctx.clip(),Pt.path(ji)),Pt.ctx.shadowOffsetX=Fr.offsetX.number+tr,Pt.ctx.shadowOffsetY=Fr.offsetY.number,Pt.ctx.shadowColor=po(Fr.color),Pt.ctx.shadowBlur=Fr.blur.number,Pt.ctx.fillStyle=Fr.inset?po(Fr.color):"rgba(0,0,0,1)",Pt.ctx.fill(),Pt.ctx.restore()}),Qt.label=2;case 2:Ge=0,Ve=0,ut=ue,Qt.label=3;case 3:return Ve<ut.length?(pt=ut[Ve]).style!==0&&!ts(pt.color)&&pt.width>0?pt.style!==2?[3,5]:[4,this.renderDashedDottedBorder(pt.color,pt.width,Ge,U.curves,2)]:[3,11]:[3,13];case 4:return Qt.sent(),[3,11];case 5:return pt.style!==3?[3,7]:[4,this.renderDashedDottedBorder(pt.color,pt.width,Ge,U.curves,3)];case 6:return Qt.sent(),[3,11];case 7:return pt.style!==4?[3,9]:[4,this.renderDoubleBorder(pt.color,pt.width,Ge,U.curves)];case 8:return Qt.sent(),[3,11];case 9:return[4,this.renderSolidBorder(pt.color,Ge,U.curves)];case 10:Qt.sent(),Qt.label=11;case 11:Ge++,Qt.label=12;case 12:return Ve++,[3,3];case 13:return[2]}})})},B.prototype.renderDashedDottedBorder=function(U,F,G,ue,_e){return V(this,void 0,void 0,function(){var Ge,Ve,ut,pt,Pt,Qt,Fr,Nt,tr,ji,ci,oi,Gn,Ii,Si,ai;return o(this,function(nn){return this.ctx.save(),Ge=Gh(ue,G),Ve=ph(ue,G),_e===2&&(this.path(Ve),this.ctx.clip()),as(Ve[0])?(ut=Ve[0].start.x,pt=Ve[0].start.y):(ut=Ve[0].x,pt=Ve[0].y),as(Ve[1])?(Pt=Ve[1].end.x,Qt=Ve[1].end.y):(Pt=Ve[1].x,Qt=Ve[1].y),Fr=Math.abs(G===0||G===2?ut-Pt:pt-Qt),this.ctx.beginPath(),_e===3?this.formatPath(Ge):this.formatPath(Ve.slice(0,2)),Nt=F<3?3*F:2*F,tr=F<3?2*F:F,_e===3&&(Nt=F,tr=F),ji=!0,Fr<=2*Nt?ji=!1:Fr<=2*Nt+tr?(Nt*=ci=Fr/(2*Nt+tr),tr*=ci):(oi=Math.floor((Fr+tr)/(Nt+tr)),Gn=(Fr-oi*Nt)/(oi-1),tr=(Ii=(Fr-(oi+1)*Nt)/oi)<=0||Math.abs(tr-Gn)<Math.abs(tr-Ii)?Gn:Ii),ji&&(_e===3?this.ctx.setLineDash([0,Nt+tr]):this.ctx.setLineDash([Nt,tr])),_e===3?(this.ctx.lineCap="round",this.ctx.lineWidth=F):this.ctx.lineWidth=2*F+1.1,this.ctx.strokeStyle=po(U),this.ctx.stroke(),this.ctx.setLineDash([]),_e===2&&(as(Ve[0])&&(Si=Ve[3],ai=Ve[0],this.ctx.beginPath(),this.formatPath([new yr(Si.end.x,Si.end.y),new yr(ai.start.x,ai.start.y)]),this.ctx.stroke()),as(Ve[1])&&(Si=Ve[1],ai=Ve[2],this.ctx.beginPath(),this.formatPath([new yr(Si.end.x,Si.end.y),new yr(ai.start.x,ai.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},B.prototype.render=function(U){return V(this,void 0,void 0,function(){var F;return o(this,function(G){switch(G.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=po(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),F=ru(U),[4,this.renderStack(F)];case 1:return G.sent(),this.applyEffects([]),[2,this.canvas]}})})},B}(fh),Zh=function(I){return I instanceof qc||I instanceof rc||I instanceof Jn&&I.type!==UA&&I.type!==cA},uc=function(I,B){switch(I){case 0:return tu(B);case 2:return Vh(B);default:return sc(B)}},Uu=function(I){switch(I){case 1:return"center";case 2:return"right";default:return"left"}},Mu=["-apple-system","system-ui"],yA=function(I){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?I.filter(function(B){return Mu.indexOf(B)===-1}):I},zA=function(I){function B(U,F){var G=I.call(this,U,F)||this;return G.canvas=F.canvas?F.canvas:document.createElement("canvas"),G.ctx=G.canvas.getContext("2d"),G.options=F,G.canvas.width=Math.floor(F.width*F.scale),G.canvas.height=Math.floor(F.height*F.scale),G.canvas.style.width=F.width+"px",G.canvas.style.height=F.height+"px",G.ctx.scale(G.options.scale,G.options.scale),G.ctx.translate(-F.x,-F.y),G.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+F.width+"x"+F.height+" at "+F.x+","+F.y+") with scale "+F.scale),G}return E(B,I),B.prototype.render=function(U){return V(this,void 0,void 0,function(){var F,G;return o(this,function(ue){switch(ue.label){case 0:return F=gu(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,U),[4,vn(F)];case 1:return G=ue.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=po(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(G,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},B}(fh),vn=function(I){return new Promise(function(B,U){var F=new Image;F.onload=function(){B(F)},F.onerror=U,F.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(I))})},Fp=function(){function I(B){var U=B.id,F=B.enabled;this.id=U,this.enabled=F,this.start=Date.now()}return I.prototype.debug=function(){for(var B=[],U=0;U<arguments.length;U++)B[U]=arguments[U];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,q([this.id,this.getTime()+"ms"],B)):this.info.apply(this,B))},I.prototype.getTime=function(){return Date.now()-this.start},I.prototype.info=function(){for(var B=[],U=0;U<arguments.length;U++)B[U]=arguments[U];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,q([this.id,this.getTime()+"ms"],B))},I.prototype.warn=function(){for(var B=[],U=0;U<arguments.length;U++)B[U]=arguments[U];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,q([this.id,this.getTime()+"ms"],B)):this.info.apply(this,B))},I.prototype.error=function(){for(var B=[],U=0;U<arguments.length;U++)B[U]=arguments[U];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,q([this.id,this.getTime()+"ms"],B)):this.info.apply(this,B))},I.instances={},I}(),mh=function(){function I(B,U){var F;this.windowBounds=U,this.instanceName="#"+I.instanceCount++,this.logger=new Fp({id:this.instanceName,enabled:B.logging}),this.cache=(F=B.cache)!==null&&F!==void 0?F:new fn(this,B)}return I.instanceCount=1,I}(),Pc=function(I,B){return B===void 0&&(B={}),Qc(I,B)};typeof window<"u"&&Sc.setContext(window);var Qc=function(I,B){return V(void 0,void 0,void 0,function(){var U,F,G,ue,_e,Ge,Ve,ut,pt,Pt,Qt,Fr,Nt,tr,ji,ci,oi,Gn,Ii,Si,ai,nn,xn,Qr,Fi,fo,Va,jn,Ta,Es,Xo,ss,Cl,El,$n,ls,sa,e;return o(this,function(n){switch(n.label){case 0:if(!I||typeof I!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(!(U=I.ownerDocument))throw new Error("Element is not attached to a Document");if(!(F=U.defaultView))throw new Error("Document is not attached to a Window");return G={allowTaint:(nn=B.allowTaint)!==null&&nn!==void 0&&nn,imageTimeout:(xn=B.imageTimeout)!==null&&xn!==void 0?xn:15e3,proxy:B.proxy,useCORS:(Qr=B.useCORS)!==null&&Qr!==void 0&&Qr},ue=P({logging:(Fi=B.logging)===null||Fi===void 0||Fi,cache:B.cache},G),_e={windowWidth:(fo=B.windowWidth)!==null&&fo!==void 0?fo:F.innerWidth,windowHeight:(Va=B.windowHeight)!==null&&Va!==void 0?Va:F.innerHeight,scrollX:(jn=B.scrollX)!==null&&jn!==void 0?jn:F.pageXOffset,scrollY:(Ta=B.scrollY)!==null&&Ta!==void 0?Ta:F.pageYOffset},Ge=new K(_e.scrollX,_e.scrollY,_e.windowWidth,_e.windowHeight),Ve=new mh(ue,Ge),ut=(Es=B.foreignObjectRendering)!==null&&Es!==void 0&&Es,pt={allowTaint:(Xo=B.allowTaint)!==null&&Xo!==void 0&&Xo,onclone:B.onclone,ignoreElements:B.ignoreElements,inlineImages:ut,copyStyles:ut},Ve.logger.debug("Starting document clone with size "+Ge.width+"x"+Ge.height+" scrolled to "+-Ge.left+","+-Ge.top),Pt=new Ec(Ve,I,pt),(Qt=Pt.clonedReferenceElement)?[4,Pt.toIFrame(U,Ge)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return Fr=n.sent(),Nt=wc(Qt)||th(Qt)?Y(Qt.ownerDocument):ae(Ve,Qt),tr=Nt.width,ji=Nt.height,ci=Nt.left,oi=Nt.top,Gn=gh(Ve,Qt,B.backgroundColor),Ii={canvas:B.canvas,backgroundColor:Gn,scale:(Cl=(ss=B.scale)!==null&&ss!==void 0?ss:F.devicePixelRatio)!==null&&Cl!==void 0?Cl:1,x:((El=B.x)!==null&&El!==void 0?El:0)+ci,y:(($n=B.y)!==null&&$n!==void 0?$n:0)+oi,width:(ls=B.width)!==null&&ls!==void 0?ls:Math.ceil(tr),height:(sa=B.height)!==null&&sa!==void 0?sa:Math.ceil(ji)},ut?(Ve.logger.debug("Document cloned, using foreign object rendering"),[4,new zA(Ve,Ii).render(Qt)]):[3,3];case 2:return Si=n.sent(),[3,5];case 3:return Ve.logger.debug("Document cloned, element located at "+ci+","+oi+" with size "+tr+"x"+ji+" using computed rendering"),Ve.logger.debug("Starting DOM parsing"),ai=eh(Ve,Qt),Gn===ai.styles.backgroundColor&&(ai.styles.backgroundColor=Ra.TRANSPARENT),Ve.logger.debug("Starting renderer for element at "+Ii.x+","+Ii.y+" with size "+Ii.width+"x"+Ii.height),[4,new qh(Ve,Ii).render(ai)];case 4:Si=n.sent(),n.label=5;case 5:return((e=B.removeContainer)===null||e===void 0||e)&&(Ec.destroy(Fr)||Ve.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),Ve.logger.debug("Finished rendering"),[2,Si]}})})},gh=function(I,B,U){var F=B.ownerDocument,G=F.documentElement?Vl(I,getComputedStyle(F.documentElement).backgroundColor):Ra.TRANSPARENT,ue=F.body?Vl(I,getComputedStyle(F.body).backgroundColor):Ra.TRANSPARENT,_e=typeof U=="string"?Vl(I,U):U===null?Ra.TRANSPARENT:4294967295;return B===F.documentElement?ts(G)?ts(ue)?_e:ue:G:_e};return Pc}();/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 */function p1(C,E={}){const P=[{type:"script",value:`//api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/${E.version}/mapbox-gl-geocoder.min.js`,id:"byk-gc-js"},{type:"link",value:`//api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/${E.version}/mapbox-gl-geocoder.css`,id:"byk-gc-css"}],V=E.customStylesheetUrl;V&&P.push({type:"link",value:V,id:"byk-gcsu-css"});let o=()=>{};return function(q,K){for(const{type:ae,value:Y,id:ie}of q){if(document.getElementById(ie))return void(ae==="script"&&K());const be=document.createElement(ae);be.id=ie,ae==="script"?(be.async=!0,be.defer=!0,be.src=Y,be.onload=()=>K()):(be.rel="stylesheet",be.href=Y),document.body.appendChild(be)}}(P,()=>{o=function(q,K){const ae=new window.MapboxGeocoder(q);return ae.addTo(`#${K.id}`),q.value&&ae.setInput(q.value),function(Y,ie,be,ze){const it=[];for(const[tt,_t]of Object.entries(ie)){const yt=Bt=>{const[rt,It]=_t(Y,Bt,be);ze.dispatchEvent(new CustomEvent(rt,{detail:It}))};Y.on(tt,yt),it.push([tt,yt])}return()=>{for(const[tt,_t]of it)Y.off(tt,_t)}}(ae,d1,!1,K)}(E,C)}),{destroy(){o()}}}const d1={results:(C,E)=>["results",E],result:(C,E)=>["result",E],loading:(C,E)=>["loading",E],error:(C,E)=>["error",E],clear:(C,E)=>["clear",E],load:C=>["ready",{geocoder:C}]};function f1(C){let E,P,V;return{c(){E=wr("div"),Dt(E,"id",C[0]),Dt(E,"class","svelte-1k1b3t4")},m(o,q){Di(o,E,q),P||(V=[Np(p1.call(null,E,C[1])),gn(E,"ready",C[2]),gn(E,"results",C[11]),gn(E,"result",C[12]),gn(E,"loading",C[13]),gn(E,"error",C[14]),gn(E,"clear",C[15]),gn(E,"load",C[16])],P=!0)},p:zo,i:zo,o:zo,d(o){o&&Ci(E),P=!1,VA(V)}}}function m1(C,E,P){let{accessToken:V}=E,{options:o={}}=E,{version:q="v4.5.1"}=E,{types:K=["country","region","postcode","district","place","locality","neighborhood","address"]}=E,{placeholder:ae="Search"}=E,{value:Y=null}=E,{customStylesheetUrl:ie=!1}=E,{geocoder:be}=E;const ze=fc(),it="bsm-"+Math.random().toString(36).substring(6),tt=Object.assign({version:q,accessToken:V,types:K.join(","),placeholder:ae,customStylesheetUrl:ie,value:Y},o);return C.$$set=_t=>{"accessToken"in _t&&P(4,V=_t.accessToken),"options"in _t&&P(5,o=_t.options),"version"in _t&&P(6,q=_t.version),"types"in _t&&P(7,K=_t.types),"placeholder"in _t&&P(8,ae=_t.placeholder),"value"in _t&&P(9,Y=_t.value),"customStylesheetUrl"in _t&&P(10,ie=_t.customStylesheetUrl),"geocoder"in _t&&P(3,be=_t.geocoder)},[it,tt,function({detail:_t}){P(3,be=_t.geocoder),ze("ready")},be,V,o,q,K,ae,Y,ie,function(_t){Tl.call(this,C,_t)},function(_t){Tl.call(this,C,_t)},function(_t){Tl.call(this,C,_t)},function(_t){Tl.call(this,C,_t)},function(_t){Tl.call(this,C,_t)},function(_t){Tl.call(this,C,_t)}]}class g1 extends us{constructor(E){super(),cs(this,E,m1,f1,Ua,{accessToken:4,options:5,version:6,types:7,placeholder:8,value:9,customStylesheetUrl:10,geocoder:3})}}function kg(C,E,P){const V=C.slice();return V[0]=E[P],V}function Pg(C){let E,P,V,o=C[0]+"";return{c(){E=wr("option"),P=dl(o),E.__value=V=C[0],E.value=E.__value},m(q,K){Di(q,E,K),ar(E,P)},p(q,K){4&K&&o!==(o=q[0]+"")&&qu(P,o),4&K&&V!==(V=q[0])&&(E.__value=V,E.value=E.__value)},d(q){q&&Ci(E)}}}function y1(C){let E,P,V,o,q=C[2],K=[];for(let ae=0;ae<q.length;ae+=1)K[ae]=Pg(kg(C,q,ae));return{c(){E=wr("div"),P=wr("select");for(let ae=0;ae<K.length;ae+=1)K[ae].c();C[1]===void 0&&pp(()=>C[4].call(P))},m(ae,Y){Di(ae,E,Y),ar(E,P);for(let ie=0;ie<K.length;ie+=1)K[ie].m(P,null);_d(P,C[1]),V||(o=gn(P,"change",C[4]),V=!0)},p(ae,[Y]){if(4&Y){let ie;for(q=ae[2],ie=0;ie<q.length;ie+=1){const be=kg(ae,q,ie);K[ie]?K[ie].p(be,Y):(K[ie]=Pg(be),K[ie].c(),K[ie].m(P,null))}for(;ie<K.length;ie+=1)K[ie].d(1);K.length=q.length}6&Y&&_d(P,ae[1])},i:zo,o:zo,d(ae){ae&&Ci(E),Vc(K,ae),V=!1,o()}}}function _1(C,E,P){let V;hu(C,pu,be=>P(5,V=be));let{mode:o}=E,{mapsNum:q}=E;const K=fc();let ae=o!=null?o:"",Y=zp;const ie=be=>{be===1&&P(2,Y=zp.filter(ze=>ze!=="swipe")),be===2&&P(2,Y=zp.filter(ze=>ze!=="responsive")),be>2&&be<=4&&P(2,Y=zp.filter(ze=>ze!=="swipe"&&ze!=="responsive")),be>4&&P(2,Y=zp.filter(ze=>ze!=="swipe"&&ze!=="phone"&&ze!=="responsive")),V||P(2,Y=["mirror"]),Y.includes(ae)||P(1,ae=Y[0])};return pu.subscribe(()=>{ie(q)}),C.$$set=be=>{"mode"in be&&P(0,o=be.mode),"mapsNum"in be&&P(3,q=be.mapsNum)},C.$$.update=()=>{8&C.$$.dirty&&ie(q),2&C.$$.dirty&&(be=>{K("viewMode",{mode:be})})(ae)},[o,ae,Y,q,function(){ae=Xg(this),P(1,ae),P(2,Y)}]}class v1 extends us{constructor(E){super(),cs(this,E,_1,y1,Ua,{mode:0,mapsNum:3})}}function Qg(C,E,P){const V=C.slice();return V[13]=E[P],V}function Dg(C,E,P){const V=C.slice();return V[16]=E[P],V}function Lg(C){let E,P,V,o=Object.keys(C[1]),q=[];for(let K=0;K<o.length;K+=1)q[K]=Rg(Qg(C,o,K));return{c(){E=wr("select");for(let K=0;K<q.length;K+=1)q[K].c();Dt(E,"id","locations"),C[0]===void 0&&pp(()=>C[6].call(E))},m(K,ae){Di(K,E,ae);for(let Y=0;Y<q.length;Y+=1)q[Y].m(E,null);_d(E,C[0]),P||(V=gn(E,"change",C[6]),P=!0)},p(K,ae){if(2&ae){let Y;for(o=Object.keys(K[1]),Y=0;Y<o.length;Y+=1){const ie=Qg(K,o,Y);q[Y]?q[Y].p(ie,ae):(q[Y]=Rg(ie),q[Y].c(),q[Y].m(E,null))}for(;Y<q.length;Y+=1)q[Y].d(1);q.length=o.length}3&ae&&_d(E,K[0])},d(K){K&&Ci(E),Vc(q,K),P=!1,V()}}}function zg(C){let E,P,V,o=Object.keys(C[16])[0]+"";return{c(){E=wr("option"),P=dl(o),E.__value=V=JSON.stringify(C[16]),E.value=E.__value},m(q,K){Di(q,E,K),ar(E,P)},p(q,K){2&K&&o!==(o=Object.keys(q[16])[0]+"")&&qu(P,o),2&K&&V!==(V=JSON.stringify(q[16]))&&(E.__value=V,E.value=E.__value)},d(q){q&&Ci(E)}}}function Rg(C){let E,P,V,o=C[1][C[13]],q=[];for(let K=0;K<o.length;K+=1)q[K]=zg(Dg(C,o,K));return{c(){E=wr("optgroup"),P=wr("option"),P.textContent="Go to...";for(let K=0;K<q.length;K+=1)q[K].c();P.__value="",P.value=P.__value,P.disabled=!0,P.selected=!0,P.hidden=!0,Dt(E,"label",V=C[13])},m(K,ae){Di(K,E,ae),ar(E,P);for(let Y=0;Y<q.length;Y+=1)q[Y].m(E,null)},p(K,ae){if(2&ae){let Y;for(o=K[1][K[13]],Y=0;Y<o.length;Y+=1){const ie=Dg(K,o,Y);q[Y]?q[Y].p(ie,ae):(q[Y]=zg(ie),q[Y].c(),q[Y].m(E,null))}for(;Y<q.length;Y+=1)q[Y].d(1);q.length=o.length}2&ae&&V!==(V=K[13])&&Dt(E,"label",V)},d(K){K&&Ci(E),Vc(q,K)}}}function x1(C){let E,P=C[1]&&Lg(C);return{c(){P&&P.c(),E=fp()},m(V,o){P&&P.m(V,o),Di(V,E,o)},p(V,[o]){V[1]?P?P.p(V,o):(P=Lg(V),P.c(),P.m(E.parentNode,E)):P&&(P.d(1),P=null)},i:zo,o:zo,d(V){P&&P.d(V),V&&Ci(E)}}}function w1(C,E,P){let{bearing:V}=E,{center:o}=E,{pitch:q}=E,{zoom:K}=E;const ae=fc();let Y;gp.subscribe(tt=>P(1,{gazetteer:Y}=tt,Y));const ie=(tt,_t)=>Number.parseFloat(tt).toFixed(_t),be=tt=>{if(!Y)return"";const _t=Object.keys(Y).reduce((yt,Bt)=>yt=yt.concat(Y[Bt]),[]).find(yt=>{const Bt=Object.values(yt)[0];return Object.keys(Bt).every(rt=>{if(rt==="center"&&tt.center){const{lng:It,lat:gt}=Bt.center,{lng:Zt,lat:dr}=tt.center;return ie(It,4)===ie(Zt,4)&&ie(gt,4)===ie(dr,4)}return ie(Bt[rt],2)===ie(tt[rt],2)})});return _t?JSON.stringify(_t):""};let ze=be({zoom:K,center:o,pitch:q,bearing:V});const it=()=>{const{options:tt}=(_t=>{if(!_t)return{};try{const yt=JSON.parse(_t),Bt=Object.keys(yt)[0],rt=yt[Bt];return ae("mapState",{options:rt}),{label:Bt,options:rt}}catch(yt){return console.error(yt),{}}})(ze);tt&&ae("mapState",{options:tt})};return C.$$set=tt=>{"bearing"in tt&&P(2,V=tt.bearing),"center"in tt&&P(3,o=tt.center),"pitch"in tt&&P(4,q=tt.pitch),"zoom"in tt&&P(5,K=tt.zoom)},C.$$.update=()=>{60&C.$$.dirty&&(tt=>{if(!ze)return;const _t=be(tt);ze!==_t&&P(0,ze="")})({zoom:K,center:o,pitch:q,bearing:V}),1&C.$$.dirty&&it()},[ze,Y,V,o,q,K,function(){ze=Xg(this),P(0,ze),P(1,Y)}]}class b1 extends us{constructor(E){super(),cs(this,E,w1,x1,Ua,{bearing:2,center:3,pitch:4,zoom:5})}}function Og(C,E,P){const V=C.slice();return V[24]=E[P],V}function B1(C){let E,P,V,o,q;return P=new lp({props:{icon:bx}}),{c(){E=wr("button"),qo(P.$$.fragment),Dt(E,"class","fullscreen-btn show-ui svelte-cqvb43"),Dt(E,"title","Show UI")},m(K,ae){Di(K,E,ae),Do(P,E,null),V=!0,o||(q=[gn(E,"click",C[12]),Np(kd.call(null,E,{shift:!0,control:!0,code:"KeyF",callback:C[12]}))],o=!0)},p:zo,i(K){V||(ti(P.$$.fragment,K),V=!0)},o(K){xi(P.$$.fragment,K),V=!1},d(K){K&&Ci(E),Lo(P),o=!1,VA(q)}}}function C1(C){let E,P,V,o,q,K,ae,Y,ie,be,ze,it,tt,_t,yt,Bt,rt,It,gt,Zt,dr,Xr,ur,_r,Rr,ei,rr,kt,Rt,br,Or,Kr,di,ri,ii,ki,kn,Zi,Bn,la,Xi,cn,wi,Vi,Ln,Wi,ni,Pn,an,qn;q=new lp({props:{icon:C[7]?Ag:cg}});let un=C[7]&&Hg(C);be=new v1({props:{mode:C[3],mapsNum:C[4].length}}),be.$on("viewMode",C[19]),tt=new g1({props:{accessToken:C[2],geocoder:null}}),tt.$on("result",C[9]);const Wr=[C[5]];let Nn={};for(let Hr=0;Hr<Wr.length;Hr+=1)Nn=HA(Nn,Wr[Hr]);Bt=new b1({props:Nn}),Bt.$on("mapState",C[20]),di=new lp({props:{icon:Cx}}),Bn=new lp({props:{icon:wx}}),Wi=new lp({props:{icon:Bx}});let Ri=C[6].length>0&&Vg(C);return{c(){E=wr("div"),P=wr("div"),V=wr("div"),o=wr("div"),qo(q.$$.fragment),ae=to(),un&&un.c(),Y=to(),ie=wr("div"),qo(be.$$.fragment),ze=to(),it=wr("div"),qo(tt.$$.fragment),_t=to(),yt=wr("div"),qo(Bt.$$.fragment),rt=to(),It=wr("div"),gt=wr("div"),Zt=wr("label"),dr=wr("span"),dr.textContent="Label Collisions",Xr=to(),ur=wr("input"),_r=to(),Rr=wr("label"),ei=wr("span"),ei.textContent="Tile Boundaries",rr=to(),kt=wr("input"),Rt=to(),br=wr("div"),Or=wr("div"),Kr=wr("button"),qo(di.$$.fragment),ri=dl(" Add map"),kn=to(),Zi=wr("button"),qo(Bn.$$.fragment),la=dl(`
            Copy image`),wi=to(),Vi=wr("div"),Ln=wr("button"),qo(Wi.$$.fragment),ni=to(),Ri&&Ri.c(),Dt(o,"class","link-button svelte-cqvb43"),cp(o,"margin-right","6px"),Dt(o,"title",K=C[7]?"Unlink locations":"Link locations"),Dt(V,"class","control-section svelte-cqvb43"),Dt(ie,"class","control-section svelte-cqvb43"),Dt(it,"class","control-section svelte-cqvb43"),Dt(yt,"class","control-section svelte-cqvb43"),Dt(ur,"type","checkbox"),Dt(kt,"type","checkbox"),Dt(gt,"class","checkboxes svelte-cqvb43"),Dt(It,"class","control-section svelte-cqvb43"),cp(Kr,"margin-right","6px"),Kr.disabled=ii=C[4].length>=8,Dt(Kr,"title",ki=C[4].length>=8?"Maximum of 8 maps allowed.":""),Zi.disabled=Xi=C[3]==="swipe",Dt(Zi,"title",cn=C[3]==="swipe"?"Must be in phone or mirror mode to screenshot.":"Copy image to clipboard"),Dt(Or,"class","buttons svelte-cqvb43"),Dt(br,"class","control-section svelte-cqvb43"),Dt(Ln,"class","fullscreen-btn svelte-cqvb43"),Dt(Ln,"title","Hide UI"),Dt(Vi,"class","control-section svelte-cqvb43"),Dt(P,"class","control-row svelte-cqvb43"),Dt(E,"class","map-controls svelte-cqvb43")},m(Hr,Ji){Di(Hr,E,Ji),ar(E,P),ar(P,V),ar(V,o),Do(q,o,null),ar(V,ae),un&&un.m(V,null),ar(P,Y),ar(P,ie),Do(be,ie,null),ar(P,ze),ar(P,it),Do(tt,it,null),ar(P,_t),ar(P,yt),Do(Bt,yt,null),ar(P,rt),ar(P,It),ar(It,gt),ar(gt,Zt),ar(Zt,dr),ar(Zt,Xr),ar(Zt,ur),ur.checked=C[0],ar(gt,_r),ar(gt,Rr),ar(Rr,ei),ar(Rr,rr),ar(Rr,kt),kt.checked=C[1],ar(P,Rt),ar(P,br),ar(br,Or),ar(Or,Kr),Do(di,Kr,null),ar(Kr,ri),ar(Or,kn),ar(Or,Zi),Do(Bn,Zi,null),ar(Zi,la),ar(P,wi),ar(P,Vi),ar(Vi,Ln),Do(Wi,Ln,null),ar(E,ni),Ri&&Ri.m(E,null),Pn=!0,an||(qn=[gn(o,"click",C[13]),gn(ur,"change",C[21]),gn(kt,"change",C[22]),gn(Kr,"click",C[10]),gn(Zi,"click",C[11]),gn(Ln,"click",C[12]),Np(kd.call(null,Ln,{shift:!0,control:!0,code:"KeyF",callback:C[12]}))],an=!0)},p(Hr,Ji){const Cn={};128&Ji&&(Cn.icon=Hr[7]?Ag:cg),q.$set(Cn),(!Pn||128&Ji&&K!==(K=Hr[7]?"Unlink locations":"Link locations"))&&Dt(o,"title",K),Hr[7]?un?(un.p(Hr,Ji),128&Ji&&ti(un,1)):(un=Hg(Hr),un.c(),ti(un,1),un.m(V,null)):un&&(Ul(),xi(un,1,1,()=>{un=null}),Ml());const $i={};8&Ji&&($i.mode=Hr[3]),16&Ji&&($i.mapsNum=Hr[4].length),be.$set($i);const yn={};4&Ji&&(yn.accessToken=Hr[2]),tt.$set(yn);const En=32&Ji?du(Wr,[Hc(Hr[5])]):{};Bt.$set(En),1&Ji&&(ur.checked=Hr[0]),2&Ji&&(kt.checked=Hr[1]),(!Pn||16&Ji&&ii!==(ii=Hr[4].length>=8))&&(Kr.disabled=ii),(!Pn||16&Ji&&ki!==(ki=Hr[4].length>=8?"Maximum of 8 maps allowed.":""))&&Dt(Kr,"title",ki),(!Pn||8&Ji&&Xi!==(Xi=Hr[3]==="swipe"))&&(Zi.disabled=Xi),(!Pn||8&Ji&&cn!==(cn=Hr[3]==="swipe"?"Must be in phone or mirror mode to screenshot.":"Copy image to clipboard"))&&Dt(Zi,"title",cn),Hr[6].length>0?Ri?Ri.p(Hr,Ji):(Ri=Vg(Hr),Ri.c(),Ri.m(E,null)):Ri&&(Ri.d(1),Ri=null)},i(Hr){Pn||(ti(q.$$.fragment,Hr),ti(un),ti(be.$$.fragment,Hr),ti(tt.$$.fragment,Hr),ti(Bt.$$.fragment,Hr),ti(di.$$.fragment,Hr),ti(Bn.$$.fragment,Hr),ti(Wi.$$.fragment,Hr),Pn=!0)},o(Hr){xi(q.$$.fragment,Hr),xi(un),xi(be.$$.fragment,Hr),xi(tt.$$.fragment,Hr),xi(Bt.$$.fragment,Hr),xi(di.$$.fragment,Hr),xi(Bn.$$.fragment,Hr),xi(Wi.$$.fragment,Hr),Pn=!1},d(Hr){Hr&&Ci(E),Lo(q),un&&un.d(),Lo(be),Lo(tt),Lo(Bt),Lo(di),Lo(Bn),Lo(Wi),Ri&&Ri.d(),an=!1,VA(qn)}}}function Hg(C){let E,P;const V=[C[5]];let o={};for(let q=0;q<V.length;q+=1)o=HA(o,V[q]);return E=new o_({props:o}),E.$on("mapState",C[18]),{c(){qo(E.$$.fragment)},m(q,K){Do(E,q,K),P=!0},p(q,K){const ae=32&K?du(V,[Hc(q[5])]):{};E.$set(ae)},i(q){P||(ti(E.$$.fragment,q),P=!0)},o(q){xi(E.$$.fragment,q),P=!1},d(q){Lo(E,q)}}}function Vg(C){let E,P=C[6],V=[];for(let o=0;o<P.length;o+=1)V[o]=Ng(Og(C,P,o));return{c(){E=wr("div");for(let o=0;o<V.length;o+=1)V[o].c();Dt(E,"class","validation-messages svelte-cqvb43")},m(o,q){Di(o,E,q);for(let K=0;K<V.length;K+=1)V[K].m(E,null)},p(o,q){if(64&q){let K;for(P=o[6],K=0;K<P.length;K+=1){const ae=Og(o,P,K);V[K]?V[K].p(ae,q):(V[K]=Ng(ae),V[K].c(),V[K].m(E,null))}for(;K<V.length;K+=1)V[K].d(1);V.length=P.length}},d(o){o&&Ci(E),Vc(V,o)}}}function Ng(C){let E,P,V,o=C[24].message+"";return{c(){E=wr("div"),P=dl(o),Dt(E,"class",V=$u(`validation-message-${C[24].type}`)+" svelte-cqvb43")},m(q,K){Di(q,E,K),ar(E,P)},p(q,K){64&K&&o!==(o=q[24].message+"")&&qu(P,o),64&K&&V!==(V=$u(`validation-message-${q[24].type}`)+" svelte-cqvb43")&&Dt(E,"class",V)},d(q){q&&Ci(E)}}}function E1(C){let E,P,V,o;const q=[C1,B1],K=[];function ae(Y,ie){return Y[8]?0:1}return E=ae(C),P=K[E]=q[E](C),{c(){P.c(),V=fp()},m(Y,ie){K[E].m(Y,ie),Di(Y,V,ie),o=!0},p(Y,[ie]){let be=E;E=ae(Y),E===be?K[E].p(Y,ie):(Ul(),xi(K[be],1,1,()=>{K[be]=null}),Ml(),P=K[E],P?P.p(Y,ie):(P=K[E]=q[E](Y),P.c()),ti(P,1),P.m(V.parentNode,V))},i(Y){o||(ti(P),o=!0)},o(Y){xi(P),o=!1},d(Y){K[E].d(Y),Y&&Ci(V)}}}function I1(C,E,P){let V,o;hu(C,pu,rt=>P(7,V=rt)),hu(C,gf,rt=>P(8,o=rt));let{bearing:q}=E,{center:K}=E,{mapboxGlAccessToken:ae}=E,{pitch:Y}=E,{showCollisions:ie}=E,{viewMode:be}=E,{showBoundaries:ze}=E,{zoom:it}=E;const tt=fc();let _t,yt=[],Bt=[];return ju.subscribe(rt=>P(4,yt=rt)),C.$$set=rt=>{"bearing"in rt&&P(14,q=rt.bearing),"center"in rt&&P(15,K=rt.center),"mapboxGlAccessToken"in rt&&P(2,ae=rt.mapboxGlAccessToken),"pitch"in rt&&P(16,Y=rt.pitch),"showCollisions"in rt&&P(0,ie=rt.showCollisions),"viewMode"in rt&&P(3,be=rt.viewMode),"showBoundaries"in rt&&P(1,ze=rt.showBoundaries),"zoom"in rt&&P(17,it=rt.zoom)},C.$$.update=()=>{245760&C.$$.dirty&&P(5,_t={bearing:q,center:K,pitch:Y,zoom:it}),48&C.$$.dirty&&P(6,Bt=((rt,It)=>{const gt=[],Zt=a_(rt,It);return rt.pitch>=Zt&&gt.push({type:"warning",message:`Pitch capped at ${Zt} as that is the maximum for this zoom level.`}),gt})(_t,yt)),3&C.$$.dirty&&tt("mapState",{options:{showCollisions:ie,showBoundaries:ze}})},[ie,ze,ae,be,yt,_t,Bt,V,o,({detail:rt})=>{const{result:It}=rt,gt={center:{lat:It.center[1],lng:It.center[0]},zoom:17};It.bbox&&(gt.zoom=14),tt("mapState",{options:gt})},()=>{ju.update(rt=>{let It=rt[rt.length-1];return It={...It,index:It.index+1},rt.concat([It])}),V||cu.update(rt=>[...rt,{...rt[rt.length-1]}])},()=>{const rt=document.getElementsByClassName("maps")[0];h1(rt,{ignoreElements:It=>!(!It.className||typeof It.className!="string")&&It.className.includes("map-label")}).then(It=>{It.toBlob(gt=>navigator.clipboard.write([new ClipboardItem({"image/png":gt})]))})},()=>{gf.update(rt=>!rt)},()=>{pu.update(rt=>!rt)},q,K,Y,it,function(rt){Tl.call(this,C,rt)},function(rt){Tl.call(this,C,rt)},function(rt){Tl.call(this,C,rt)},function(){ie=this.checked,P(0,ie)},function(){ze=this.checked,P(1,ze)}]}class S1 extends us{constructor(E){super(),cs(this,E,I1,E1,Ua,{bearing:14,center:15,mapboxGlAccessToken:2,pitch:16,showCollisions:0,viewMode:3,showBoundaries:1,zoom:17})}}let A_;pu.subscribe(C=>A_=C);const c_=["maps","locations"],T1=["showCollisions","showBoundaries"],F1=["bearing","center","pitch","zoom"],U1=["bearing","lat","lng","pitch","zoom"],Kg=({zoom:C,center:E,pitch:P,bearing:V})=>[Fl(C,2),Fl(E.lat,4),Fl(E.lng,4),Fl(P!=null?P:0,1),Fl(V!=null?V:0,1)].join("/"),Gg=C=>{const[E,P,V,o,q]=C.split("/");return{bearing:q,center:{lat:P,lng:V},pitch:o,zoom:E}};function jg(C){var q;let E=JSON.parse(JSON.stringify(C));if((q=E.maps)!=null&&q.length){const K=E.maps;E.maps=K.map(ae=>(delete ae.style,ae))}let P=Object.fromEntries(Object.entries(E).filter(([K,ae])=>!F1.includes(K)&&K!=="locations").map(([K,ae])=>[K,c_.includes(K)?JSON.stringify(ae):ae]));var V;V=P,P=Object.keys(V).reduce((K,ae)=>{const Y=V[ae];return Y!==null&&(K[ae]=Y),K},{});let o={...P};return o=A_?{map:Kg(E),...o}:{locations:JSON.stringify(E.locations.map(K=>Kg(K))),...o},function(K){let ae=K.map?`map=${K.map}`:"";const Y=["map","stylePresets"];return Object.entries(K).forEach(([ie,be],ze)=>{if(Y.includes(ie))return;let it=encodeURIComponent(be);ae=`${ae}${ae!==""?"&":""}${ie}=${it}`}),ae}(o)}function M1(C){let E=Object.fromEntries(Object.entries(function(P){const V=P.split("#")[1];if(!V)return{};let o=Object.fromEntries(V.split("&").map(q=>q.split("=").map(decodeURIComponent)));return o.map&&(o={...o,...Gg(o.map)}),o.locations&&(o.locations=JSON.stringify(JSON.parse(o.locations).map(q=>Gg(q)))),o}(C)).filter(([P,V])=>!!V).map(([P,V])=>c_.includes(P)?[P,JSON.parse(V)]:T1.includes(P)?[P,V==="true"]:U1.includes(P)?[P,+V||0]:[P,V]));return E.map&&delete E.map,E}const $g=C=>{const{mapState:E,maps:P,viewMode:V,stylePresets:o}=C;return{...E,viewMode:V,maps:P,stylePresets:o,...M1(window.location.hash)}};function k1(C){let E,P,V,o,q,K,ae,Y;o=new u1({props:{maps:C[2],mapState:C[1],viewMode:C[0].viewMode}}),o.$on("mapState",C[4]),o.$on("setDimensions",C[6]);const ie=[{mapboxGlAccessToken:C[3]},C[1],{viewMode:C[0].viewMode}];let be={};for(let ze=0;ze<ie.length;ze+=1)be=HA(be,ie[ze]);return ae=new S1({props:be}),ae.$on("mapState",C[4]),ae.$on("viewMode",C[5]),{c(){E=wr("base"),P=to(),V=wr("main"),qo(o.$$.fragment),q=to(),K=wr("div"),qo(ae.$$.fragment),Dt(E,"href","/"),Dt(K,"class","map-controls-container svelte-13vsfrg"),Dt(V,"class","svelte-13vsfrg")},m(ze,it){ar(document.head,E),Di(ze,P,it),Di(ze,V,it),Do(o,V,null),ar(V,q),ar(V,K),Do(ae,K,null),Y=!0},p(ze,[it]){const tt={};4&it&&(tt.maps=ze[2]),2&it&&(tt.mapState=ze[1]),1&it&&(tt.viewMode=ze[0].viewMode),o.$set(tt);const _t=11&it?du(ie,[8&it&&{mapboxGlAccessToken:ze[3]},2&it&&Hc(ze[1]),1&it&&{viewMode:ze[0].viewMode}]):{};ae.$set(_t)},i(ze){Y||(ti(o.$$.fragment,ze),ti(ae.$$.fragment,ze),Y=!0)},o(ze){xi(o.$$.fragment,ze),xi(ae.$$.fragment,ze),Y=!1},d(ze){Ci(E),ze&&Ci(P),ze&&Ci(V),Lo(o),Lo(ae)}}}function P1(C,E,P){var _t;let V;hu(C,cu,yt=>P(9,V=yt));let{localConfig:o}=E;const q=(yt=>({maps:[{id:"mapbox-streets",name:"Mapbox Streets",type:"mapbox-gl",url:"mapbox://styles/mapbox/streets-v11"},{id:"mapbox-light",name:"Mapbox Light",type:"mapbox-gl",url:"mapbox://styles/mapbox/light-v10"}].map((Bt,rt)=>{var It,gt;return(gt=(It=yt==null?void 0:yt.stylePresets)==null?void 0:It[rt])!=null?gt:Bt}),mapState:{bearing:0,center:{lng:-73.92169,lat:40.83962},pitch:0,showCollisions:!1,zoom:13.25},viewMode:"swipe",gazetteer:{Scenarios:[{"Zoomed out":{pitch:0,zoom:10}},{"Zoomed in/Tilted":{pitch:45,zoom:16}}],Locations:[{"San Francisco, CA":{zoom:18,center:{lng:-122.4193,lat:37.7648}}},{"Washington DC":{zoom:12,center:{lng:-77.0435,lat:38.9098}}}]},branchPatterns:[{pattern:"",styles:[]}],stylePresetUrls:[],...yt}))(o),{mapboxGlAccessToken:K,stylePresetUrls:ae}=q;gp.set(q);let Y=$g(q),ie={},be=!1;const ze=()=>location.hash.slice(1)!==jg(Y);ju.set(Y.maps.map((yt,Bt)=>({...yt,index:Bt}))),mf.set(Y.stylePresets),cu.set((_t=Y==null?void 0:Y.locations)!=null?_t:null),V&&V.length&&pu.set(!1);let it=[];Fd(()=>{ae.length>0&&ae.forEach(async yt=>{const Bt=await(async rt=>{const It=await fetch(rt),gt=await It.json();return I_(gt)?gt:(console.warn(`Style presets at ${rt} is not valid, check the format`),[])})(yt);mf.update(rt=>[...rt,...Bt])})}),window.addEventListener("hashchange",()=>{if(!be&&ze()&&(P(0,Y=$g(q)),Y.maps.length)){const yt=it.map((Bt,rt)=>({...Bt,index:rt}));ju.set(yt)}be=!1}),ju.subscribe(yt=>{P(0,Y={...Y,maps:yt})}),cu.subscribe(yt=>{P(0,Y={...Y,locations:yt})}),pu.subscribe(yt=>{if(!yt&&!V){const Bt=it.map(()=>ie);cu.set(Bt)}yt&&V&&cu.set(null)});const tt=Df(()=>{var yt;ze()&&(be=!0,yt=Y,window.location.hash=jg(yt))},250);return ry.setRTLTextPlugin("https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.0/mapbox-gl-rtl-text.js"),ny.setRTLTextPlugin("https://unpkg.com/@mapbox/mapbox-gl-rtl-text@0.2.3/mapbox-gl-rtl-text.min.js"),C.$$set=yt=>{"localConfig"in yt&&P(7,o=yt.localConfig)},C.$$.update=()=>{5&C.$$.dirty&&(s_(it,Y.maps)||P(2,it=Y.maps)),6&C.$$.dirty&&P(1,ie=Mf(ie,it)),1&C.$$.dirty&&Y&&tt(),1&C.$$.dirty&&(Y||height||width)&&P(1,ie=(()=>{const{bearing:yt,center:Bt,pitch:rt,showCollisions:It,showBoundaries:gt,zoom:Zt,height:dr,width:Xr}=Y;return{bearing:yt,center:Bt,pitch:rt,showCollisions:It,showBoundaries:gt,zoom:Zt,...dr&&{height:dr},...Xr&&{width:Xr}}})())},[Y,ie,it,K,yt=>{let Bt={...ie,...yt.detail.options};P(0,Y={...Y,...Mf(Bt,it)})},yt=>{P(0,Y={...Y,viewMode:yt.detail.mode})},yt=>{P(0,Y={...Y,...yt.detail})},o]}class Q1 extends us{constructor(E){super(),cs(this,E,P1,k1,Ua,{localConfig:7})}}const D1=(C,E)=>new Q1({target:C,props:E});var L1=Object.freeze({__proto__:null}),z1=Object.freeze({__proto__:null});D1(document.body,{localConfig:{mapboxGlAccessToken:"pk.eyJ1IjoieHVyeG9zYW56IiwiYSI6Ii1ObkhtWkUifQ.BK7TVbrk0v0-1NVn_ndWZw",stylePresets:[{id:"elastic-desaturated-master",name:"Elastic Light (master)",type:"maplibre-gl",url:"https://raw.githubusercontent.com/elastic/osm-bright-desaturated-gl-style/master/style.json"},{id:"elastic-classic",name:"Elastic Classic (master)",type:"maplibre-gl",url:"https://raw.githubusercontent.com/elastic/osm-bright-gl-style/master/style.json"},{id:"elastic-dark",name:"Elastic Dark (master)",type:"maplibre-gl",url:"https://raw.githubusercontent.com/elastic/dark-matter-gl-style/master/style.json"}]}});
